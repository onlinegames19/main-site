window.Runtime=function t(e,s){let r=this,h={};function n(t,e,s){this.x=t,this.y=e,this.text=s}h.extend=function(t,e){let s=Object.create(t.prototype||t);if(void 0!==e&&(e=e.prototype||e))for(let r in e)e.hasOwnProperty(r)&&(s[r]=e[r]);return s},h.HIWORD=function(t){return t>>16},h.LOWORD=function(t){return 65535&t},h.MAKELONG=function(t,e){return e<<16|65535&t},h.getRValueFlash=function(t){return t>>>16&255},h.getGValueFlash=function(t){return t>>>8&255},h.getBValueFlash=function(t){return 255&t},h.RGBFlash=function(t,e,s){return(255&t)<<16|(255&e)<<8|255&s},h.swapRGB=function(t){return(255&(255&t))<<16|(255&(t>>>8&255))<<8|255&(t>>>16&255)},h.clamp=function(t,e,s){return Math.min(Math.max(t,e),s)},h.getColorString=function(t){for(var e=(t>>>16&255).toString(16),s=(t>>>8&255).toString(16),r=(255&t).toString(16);e.length<2;)e="0"+e;for(;s.length<2;)s="0"+s;for(;r.length<2;)r="0"+r;return"#"+e+s+r},h.floatToInt=function(t){return t<0?Math.ceil(t):Math.floor(t)},h.approximateInt=function(t){return Math.round(t)},h.isInt=function(t){return Math.ceil(t)==t},h.createEllipse=function(t,e,s,r,h){ox=r/2*.5522848,oy=h/2*.5522848,xe=e+r,ye=s+h,xm=e+r/2,ym=s+h/2,t.beginPath(),t.moveTo(e,ym),t.bezierCurveTo(e,ym-oy,xm-ox,s,xm,s),t.bezierCurveTo(xm+ox,s,xe,ym-oy,xe,ym),t.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye),t.bezierCurveTo(xm-ox,ye,e,ym+oy,e,ym),t.closePath()},h.drawRect=function(t,e){t.beginPath(),t.moveTo(e.left,e.top),t.lineTo(e.right,e.top),t.lineTo(e.right,e.bottom),t.lineTo(e.left,e.bottom),t.lineTo(e.left,e.top),t.closePath(),t.stroke()},h.drawLine=function(t,e,s,r,h){t.beginPath(),t.moveTo(e,s),t.lineTo(r,h),t.closePath(),t.stroke()},h.formatDiscName=function(t,e){for(var s=t.toString();s.length<4;)s="0"+s;return s+"."+e},h.compareStringsIgnoreCase=function(t,e){return t==e||(t=t.toLowerCase())==(e=e.toLowerCase())},h.parseName=function(t){let e=t.lastIndexOf("\\");return e>0&&(t=t.substring(e+1)),t},h.MAX_HEIGHTS=40,h.aHeightNormalToLF=[0,1,2,3,5,7,8,9,11,12,13,15,16,17,19,20,21,23,24,25,27,28,29,31,32,33,35,36,37,39,40,41,43,44,45,47,48,49,51,52],h.heightNormalToLF=function(t){return t<h.MAX_HEIGHTS?h.aHeightNormalToLF[t]:Math.round(96*t/72)},h.DT_LEFT=0,h.DT_TOP=0,h.DT_CENTER=1,h.DT_RIGHT=2,h.DT_BOTTOM=8,h.DT_VCENTER=4,h.DT_SINGLELINE=32,h.DT_CALCRECT=1024,h.DT_VALIGN=2048,h.drawText=function(t,e,s,r,n,a){if(0==e.length)return(1024&s)!=0&&(r.right=r.left,r.bottom=r.top),0;n.isGraphic||(t.font=n.getFont());let l=0,u=e.indexOf("\n");if(u>=0){let d,p,m,f,$=new E;$.copyRect(r);let g=0,P=0;do m=-1,g<e.length&&(m=e.indexOf("\r",g)),f=Math.max(u,m),m==u-1&&u--,d=e.substring(g,u),p=h.drawIt(t,d,s,$,a,n),P=Math.max(P,$.right-$.left),l+=p,$.top+=p,$.bottom=r.bottom,$.right=r.right,u=-1,(g=f+1)<e.length?u=e.indexOf("\n",g):(p=h.drawIt(t,"",s,$,a,n),P=Math.max(P,$.right-$.left),l+=p,$.top+=p,$.bottom=r.bottom,$.right=r.right);while(u>=0);return g<e.length&&(d=e.substring(g),p=h.drawIt(t,d,s,$,a,n),P=Math.max(P,$.right-$.left),l+=p),(s&h.DT_CALCRECT)!=0&&(r.right=r.left+P,r.bottom=$.bottom),l}return h.drawIt(t,e,s|h.DT_VALIGN,r,a,n)},h.xPos=null,h.drawIt=function(t,e,s,r,a,l){0==e.length&&(e=" "),u=l.getHeight(),d=l.isGraphic?l.measureText(" "):t.measureText(" ").width;let u,d,p,m,f,$,g,P,E,_=r.right-r.left,A=0,v=0,O=0,S=0,T=0;null==h.xPos&&(h.xPos=Array(100));let b=!1,C=!1,L=r.top,I=u;(1&I)!=0&&I++;let F=L;do{for(O=A,f=0,m=0,T+=u;;){if(h.xPos[f]=m,f+=1,p=v,v=-1,O<e.length&&(v=e.indexOf(" ",O)),-1==v&&(v=e.length),v<O){m-=d;break}if(g=e.substring(O,v),m+($=l.isGraphic?l.measureText(g):t.measureText(g).width)>_){if(--f>0){$-=d,m-=d,v=p;break}for(P=O;P<v;P++){if(m+($=l.isGraphic?l.measureText(e.substring(P,P+1)):t.measureText(e.substring(P,P+1)).width)>=_){if(--P>0){S=Math.max(m,S),(s&h.DT_CALCRECT)==0&&(m=(s&h.DT_CENTER)!=0?r.left+(r.right-r.left)/2-m/2:(s&h.DT_RIGHT)!=0?r.right-m:r.left,g=e.substring(O,P),a.push(new n(m,L,g))),v=P-1,b=!0,C=!0;break}v=-1,v=P<e.length?e.indexOf(" ",P):-1,b=!0,v>=0&&(C=!0);break}m+=$}}if(b||(m+=$)+d>_)break;m+=d,O=v+1}if(!1==C){if(b)break;if(S=Math.max(m,S),(s&h.DT_CALCRECT)==0)for(E=0,m=(s&h.DT_CENTER)!=0?r.left+(r.right-r.left)/2-m/2:(s&h.DT_RIGHT)!=0?r.right-m:r.left,O=A;E<f&&(v=-1,O<e.length&&(v=e.indexOf(" ",O)),-1==v&&(v=e.length),!(v<O));E++)g=e.substring(O,v),a.push(new n(m+h.xPos[E],L,g)),O=v+1}b=!1,C=!1,L+=u,A=v+1}while(A<e.length);return r.right=r.left+S,r.bottom=F+T,T},h.displayText=function(t,e,s,r,n,a,l,u){let d,p;if(n.isGraphic)for(d=0;d<r.length;d++)p=r[d],n.fillText(t,p.text,e+p.x,s+p.y);else for(d=0,t.font=n.getFont(),t.fillStyle=h.getColorString(a),t.textAlign="left",t.textBaseline="top";d<r.length;d++)p=r[d],t.fillText(p.text,e+p.x,s+p.y)},h.intToString=function(t,e){let s=t.toString();if((e&aT.CPTDISPFLAG_INTNDIGITS)!=0){let r=e&aT.CPTDISPFLAG_INTNDIGITS;if(s.length>r)s=s.substring(s.length-r);else for(;s.length<r;)s="0"+s}return s},h.doubleToString=function(t,e){let s;if((e&aT.CPTDISPFLAG_FLOAT_FORMAT)==0)s=t.toString();else{let r,h,n,a=!1,l=Math.floor(((e&aT.CPTDISPFLAG_FLOATNDIGITS)>>aT.CPTDISPFLAG_FLOATNDIGITS_SHIFT)+1),u=-1;if((e&aT.CPTDISPFLAG_FLOAT_USENDECIMALS)!=0?u=(e&aT.CPTDISPFLAG_FLOATNDECIMALS)>>aT.CPTDISPFLAG_FLOATNDECIMALS_SHIFT:0!=t&&t>-1&&t<1&&(u=l,a=!0),s=u<0?t.toPrecision(l):t.toFixed(u),(e&aT.CPTDISPFLAG_FLOAT_PADD)!=0)for(h=0,r=0;h<s.length;h++)"."!=(n=s.charAt(h))&&"+"!=n&&"-"!=n&&"e"!=n&&"E"!=n&&r++;let d=!1;for("-"==s.charAt(0)&&(d=!0,s=s.substr(1));r<l;)s="0"+s,r++;d&&(s="-"+s)}return s},h.subtractFilename=function(t,e){for(var s=t,r=e,h=r.indexOf("\\");h>=0;)s.substring(0,h)==r.substring(0,h)&&(r=r.substring(h+1),s=s.substring(h+1)),h=r.indexOf("\\",h+1);return s};let a=!1,l=!1,u=!1,d=window.XMLHttpRequest?new XMLHttpRequest:null;if(d&&d.overrideMimeType)try{l="string"==typeof new XMLHttpRequest().responseType,navigator.userAgent.toLowerCase().indexOf("safari")>=0&&(l=!1)}catch(p){}else{a=!0;let m=document.createElement("script");m.type="text/vbscript",m.innerHTML='Function BinFileReaderImpl_IE_VBAjaxLoader(fileName)\n	                Dim xhr\n	                Set xhr = CreateObject("Microsoft.XMLHTTP")\n	                xhr.Open "GET", fileName, False\n	                xhr.setRequestHeader "Accept-Charset", "x-user-defined"\n	                xhr.send\n	                Dim byteArray()\n	                if xhr.Status = 200 Then\n	                    Dim byteString\n	                    Dim i\n	                    byteString=xhr.responseBody\n	                    ReDim byteArray(LenB(byteString))\n	                    For i = 1 To LenB(byteString)\n	                        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n	                    Next\n	                End If\n	                BinFileReaderImpl_IE_VBAjaxLoader=byteArray\n	            End Function',document.head.appendChild(m)}if(l){let f=new FileReader;try{f.readAsBinaryString&&(u=!0)}catch($){}f=null}function g(){this.ccfBytes="",this.pointer=0,this.offset=0,this.bUnicode=!1}function P(){this.array=[]}function E(t,e,s,r){t?this.left=t:this.left=0,e?this.top=e:this.top=0,s?this.right=s:this.right=0,r?this.bottom=r:this.bottom=0}function _(){this.x=0,this.y=0}function A(){this.x1=0,this.y1=0,this.x2=0,this.y2=0}function v(){this.lfHeight=12,this.lfWeight=400,this.lfItalic=0,this.lfFaceName="Arial",this.isGraphic=!1}function O(t,e){this.app=t,this.flags=e,this.strings=new P,this.currentFileName=null}function S(t,e,s){this.app=t,this.width=e,this.height=s,this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=s,this.canvasContext=this.canvas.getContext("2d")}function T(){let t;this.isOpera=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,this.isFirefox="undefined"!=typeof InstallTrigger,this.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||"[object SafariRemoteNotification]"===(t=!window.safari||safari.pushNotification).toString(),this.isIE=!!document.documentMode,this.isEdge=!this.isIE&&!!window.StyleMedia,this.isChrome=!!window.chrome&&!!window.chrome.webstore,this.isChrome?this.browser="Chrome":this.isEdge?this.browser="Edge":this.isIE?this.browser="Explorer":this.isFirefox?this.browser="Firefox":this.isOpera?this.browser="Opera":this.isSafari?this.browser="Safari":this.browser=this.searchString(T.dataBrowser)||"Unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"Unknown version",this.OS=this.searchString(T.dataOS)||"Unknown OS"}function b(){this.mode=null,this.dwMax=null,this.pImages=null,this.pRh=null}function C(){this.mode=0,this.app=null,this.pImages=null}function L(){this.characters=null,this.width=0,this.height=0,this.image=null,this.color=0,this.flags=0,this.fontName=null,this.fontHeight=0,this.fontFlags=0,this.interline=0,this.interchar=0,this.nChars=0,this.charWidths=null,this.isGraphic=!0}function I(){}function F(){this.flags=0,this.name=null,this.index=0}function R(){}function M(){}function w(){}function k(){}function N(){}function D(){}function H(){}function B(){}function G(){}function Y(){}function j(){}function X(){}function W(){}function V(){}function U(){}function K(){}function q(){}function z(){}function J(){}function Q(){}function Z(){}function tt(){}function te(){}function ti(){}function ts(){}function tr(){}function th(){}function to(){}function tn(){}function ta(){}function th(){}function tl(){}function tu(){}function tc(){}function td(){}function tp(){}function tm(){}function tf(){}function t$(){}function tg(){}function tP(){}function t8(){}function tE(){}function t_(){}function tA(){}function t0(){}function tv(){}function tO(){}function tS(){}function tT(){}function tb(){}function tC(){}function tL(){}function tI(){}function tF(){}function ty(){}function tx(){}function tR(){}function tM(){}function t2(){}function tw(){}function tk(){}function tN(){}function t1(){}function tD(){}function t4(){}function t3(){}function tH(){}function tB(){}function t6(){}function tG(){}function t5(){}function tY(){}function tj(){}function tX(){}function tW(){}function t7(){}function tV(){}function tU(){}function tK(){}function tq(){}function tz(){}function tJ(){}function tQ(){}function tZ(){}function t9(){}function et(){}function t9(){}function ee(){}function ei(){}function es(){}function er(){}function eh(){}function eo(){}function en(){}function ea(){}function el(){}function eu(){}function ec(){}function ed(){}function ep(){}function em(){}function ef(){}function e$(){}function eg(){}function eP(){}function e8(){}function eE(){}function e_(){}function eA(){this.replace=null}function e0(){}function ev(){}function eO(){}function eS(){}function eT(){}function eb(){}function eC(){}function eL(){}function eI(){}function eF(){}function ey(){}function ex(){}function eR(){}function eM(){}function e2(){}function ew(){}function ek(){}function eN(){}function e1(){}function eD(){}function e4(){}function e3(){}function eH(){}function eB(){}function e6(){}function eG(){}function e5(){}function eY(){}function ej(){}function eX(){}function eW(){}function e7(){}function eV(){}function eU(){}function eK(){}function eq(){}function ez(){}function eJ(){}function eQ(){}function eZ(){}function e9(){}function it(){}function ie(){}function ii(){}function is(){}function ir(){}function ih(){}function io(){}function ia(){}function il(){}function iu(){}function ic(){}function id(){}function ip(){}function im(){}function i$(){}function ig(){}function iP(){}function i8(){}function iE(){}function i_(){}function iA(){}function i0(){}function iv(){}function iO(){}function iS(){}function iT(){}function ib(){}function iC(){}function iL(){}function iI(){}function iF(){}function e8(){}function iy(){}function ix(){}function iR(){}function iM(){}function i2(){}function iw(){}function ik(){}function iN(){}function i1(){}function iD(){}function i4(){}function i3(){}function iH(){}function iB(){}function i6(){}function iG(){}function i5(){}function iY(){}function ij(){}function iX(){}function iW(){}function i7(){}function iX(){}function iV(){}function iU(){}function iK(){}function iq(){}function iz(){}function iJ(){}function iQ(){}function iZ(){}function i9(){}function st(){}function se(){}function si(){}function ss(){}function sr(){}function sh(){}function so(){}function sn(){}function sa(){}function sl(){}function su(){}function sc(){}function sd(){}function sp(){}function sm(){}function sf(){}function s$(){}function sg(){}function sP(){}function s8(){}function sE(){}function s_(){}function sA(){}function s0(){}function sv(){}function sO(){}function sS(){}function sT(){}function sb(){}function sC(){}function sL(){}function sI(){}function sF(){}function sy(){}function sx(){}function sR(){}function sM(){}function s2(){}function sw(){}function sk(){}function sN(){}function s1(){}function sD(){}function s4(){}function s3(){}function sH(){}function sB(){}function s6(){}function sG(){}function s5(){}function sY(){}function sj(){}function sX(){}function sW(){}function s7(){}function sV(){}function sU(){}function sK(){}function sq(){}function sz(){}function sJ(){}function sQ(){}function sZ(){}function s9(){}function rt(){}function re(){}function ri(){}function rs(){}function rr(){}function rh(){}function ro(){}function rn(){}function ra(){}function rl(){}function ru(){}function rc(){}function rd(){}function rp(){}function rm(){}function rf(){}function r$(){}function rg(){}function rP(){}function r8(){}function rE(){}function r_(){}function rA(){}function r0(){}function rv(){}function rO(){}function rS(){}function rT(){}function rb(){}function rC(){}function rL(){}function rI(){}function rF(){}function ry(){}function rx(){}function rR(){}function rM(){}function r2(){}function rw(){}function rk(){}function rN(){}function r1(){}function rD(){}function r4(){}function r3(){}function rH(){}function rB(){}function r6(){}function rG(){}function r5(){}function rY(){}function rj(){}function rX(){}function rW(){}function r7(){}function rV(){}function rU(){}function rK(){}function rq(){}function rz(){}function rJ(){}function rQ(){}function rZ(){}function r9(){}function ht(){}function he(){}function hi(){}function hs(){}function hr(){}function hh(){}function ho(){}function ho(){}function hn(){}function ha(){}function hl(){}function hu(){}function hc(){}function hd(){}function hp(){}function hm(){}function hf(){}function h$(){}function hg(){}function hP(){}function h8(){}function hE(){}function h_(){}function hA(){}function h0(){}function hv(){}function hO(){}function hS(){}function hT(){}function hb(){}function hC(){}function hL(){}function hI(){}function hF(){}function hy(){}function hx(){}function hR(){}function hM(){}function h2(){}function hw(){}function hk(){}function hN(){}function h1(){}function hD(){}function h4(){}function h3(){}function hH(){}function hB(){}function h6(){}function hG(){}function h5(){}function hY(){}function hj(){}function hX(){}function hW(){}function h7(){}function hV(){}function hU(){}function hK(){}function hq(){}function hK(){}function hz(){}function hJ(){}function hQ(){}function hZ(){}function h9(){}function ot(){}function oe(){}function oi(){}function os(){}function or(){}function oh(){}function oo(){}function on(){}function oa(){}function ol(){}function ou(){}function oc(){}function od(){}function op(){}function om(){}function of(){}function o$(){}function og(){}function oP(){}function o8(){}function oE(){}function o_(){}function oA(){}function o0(){}function ov(){}function oO(){}function oS(){}function oT(){}function ob(){}function oC(){}function oL(){}function oI(){}function oF(){}function oR(){}function oM(){}function o2(){}function ow(){}function ok(){}function oN(){}function o1(){}function oD(){}function o4(){}function o3(){}function oH(){}function oB(){}function o6(){}function oG(){}function o5(){}function oY(){}function oj(){}function oX(){}function oW(){}function o7(){}function oV(){}function oU(){}function oK(){}function oR(){}function oq(){}function oz(){}function oJ(){}function oQ(){}function oZ(){}function o9(){}function nt(){}function ne(){}function ni(){}function ns(){}function nr(){}function nh(){}function no(){}function nn(){}function na(){}function nl(){}function nu(){}function nc(){}function nd(){}function np(){}function nm(){}function nf(){}function n$(){}function ng(){}function nP(){}function n8(){}function nE(){}function n_(){}function nA(){}function n0(){}function nv(){}function nO(){}function nA(){}function nS(){}function nT(){}function nb(){}function nC(){}function nL(){}function nI(){r.application.loadApplication()}function nF(){r.application.loadInfo()}function ny(t,e,s,r){this.isSubApp=!0===r,this.isSubApp?(this.canvas=t.canvas,this.parent_element=t.parent_element,this.cName=null):"string"==typeof t?(this.canvas=document.getElementById(t),this.parent_element=this.canvas.parentElement,this.cName=t):t instanceof HTMLElement&&(this.canvas=document.createElement("canvas"),this.parent_element=t,this.cName=null);let h=this.container=t.container||document.createElement("div");h.appendChild(this.canvas),this.parent_element.appendChild(h),h.style.overflow="hidden",h.style.position="relative",h.style.transform="translateZ(0)",h.style.margin="0",h.style.padding="0",h.style.display="block",h.style.boxSizing="content-box",h.className="MMFDiv",this.frameOffsets=null,this.frameEffects=null,this.frameEffectParams=null,this.frameMaxIndex=0,this.framePasswords=null,this.appName=null,this.nGlobalValuesInit=0,this.globalValuesInitTypes=null,this.globalValuesInit=null,this.nGlobalStringsInit=0,this.globalStringsInit=null,this.OIList=null,this.imageBank=null,this.fontBank=null,this.soundBank=null,this.soundPlayer=null,this.soundContext=null,this.soundContextType=0,this.appRunningState=0,this.lives=null,this.scores=null,this.playerNames=null,this.gValues=null,this.gStrings=null,this.startFrame=0,this.nextFrame=0,this.currentFrame=0,this.frame=null,this.file=null,this.parentApp=null,this.parentOptions=0,this.parentWidth=0,this.parentHeight=0,this.refTime=0,this.run=null,this.preloader=null,this.loadPreloader=!1,this.xOffset=0,this.yOffset=0,this.gaFlags=0,this.gaNewFlags=0,this.gaMode=0,this.gaOtherFlags=0,this.gaCxWin=0,this.gaCyWin=0,this.gaScoreInit=0,this.gaLivesInit=0,this.gaBorderColour=0,this.gaNbFrames=0,this.gaFrameRate=0,this.pcCtrlType=null,this.pcCtrlKeys=null,this.frameHandleToIndex=null,this.frameMaxHandle=0,this.cx=0,this.cy=0,this.mouseX=0,this.mouseY=0,this.bMouseIn=!1,this.keyBuffer=null,this.cursorCount=0,this.cursor="auto",this.sysEvents=null,this.quit=!1,this.m_bLoading=!1,this.extensionStorage=null,this.extLoader=null,this.embeddedFiles=null,this.bUnicode=!1,this.xMouseOffset=0,this.yMouseOffset=0,this.mouseDoubleClickCode=null,this.mouseDoubleClickTimestamp=null,this.deltaWheel=0,this.effect=0,this.effectParam=0,this.alpha=0,this.dwOptions=0,this.dwBuildType=0,this.dwBuildFlags=0,this.wScreenRatioTolerance=0,this.wScreenAngle=0,this.file=e,this.resources="",this.path=s;var n=s.lastIndexOf("/");if(n>=0&&(this.resources=s.substring(0,n+1)),this.frameColor=0,this.appEditorFilename=null,this.run=null,this.timer=0,this.imagesToLoad=0,this.imagesLoaded=0,this.bLoading=!1,this.keyNew=!1,this.subApps=[],this.preloaderType=-1,this.preloaderCircleCenterX=0,this.preloaderCircleCenterY=0,this.preloaderCircleRadius=0,this.preloaderCircleThickness=0,this.preloaderCircleColor=0,this.preloaderBackColor=0,this.preloaderFrameNumber=0,this.transition=null,this.transitionManager=null,this.transitionDisplay=null,this.transitionOldSurface=null,this.bStartFadeIn=!1,this.browserDetect=new T,this.touchesID=null,this.touchesX=null,this.touchesY=null,this.mouseTouch=ny.TOUCHID_EMPTY,this.nTouches=0,this.joystick=null,this.joystickOn=0,this.accelerometer=0,this.accelerometerHandler=null,this.accX=0,this.accY=0,this.accZ=0,this.accGravX=0,this.accGravY=0,this.accGravZ=0,this.scaleX=this.scaleY=1,this.hasFocus=!0,this.bStoppedFocus=!1,this.iOS=!1,this.firstFrameColor=0,this.previousFrameGraphics=null,this.graphicFonts=null,this.infoVersion=-1,this.infoFile=null,this.infoCounter=1e9,this.infoPath=null,window.location.href.indexOf("192.")>=0){var n=window.location.href.indexOf("21700/");n>=0&&(this.infoPath=window.location.href.substring(0,n+6),this.infoVersion=-1,this.infoCounter=25)}this.bZoom=!1,this.dataLoadingStep=3,this.dataToLoad=new P,this.dataLoading=new P,this.mosaics=[],this.mosaicMaxHandle=0,this.silentSound=null,this.m_touchMe="Please touch the screen to start",this.oldFrameRate=-1e3,this.fullScreen=!1,this.versionCode="***version***",this.versionCodePos=0,this.versionCodeDisplay=0,this.codePage=-1,this.modalSubappObject=null}function nx(t,e,s){this.changedTouches=[,],this.changedTouches[0]={pageX:t,pageY:e,target:s,identifier:ny.FAKE_TOUCHIDENTIFIER}}function nR(t){this.app=t,this.rhPtr=null,this.leWidth=0,this.leHeight=0,this.leBackground=0,this.leClearBackground=!1,this.leFlags=0,this.leVirtualRect=null,this.leEditWinWidth=0,this.leEditWinHeight=0,this.frameName=null,this.nLayers=0,this.layers=null,this.LOList=null,this.evtProg=null,this.maxObjects=0,this.leX=0,this.leY=0,this.leLastScrlX=0,this.leLastScrlY=0,this.startLeX=0,this.startLeY=0,this.m_wRandomSeed=0,this.m_dwMvtTimerBase=0,this.fadeIn=null,this.fadeOut=null,this.mosaicHandles=null,this.mosaicX=null,this.mosaicY=null,this.mosaicMaxHandle=0,this.joystick=0,this.html5Options=0}function nM(t){for(e=0,this.app=t,this.channels=null,this.bMultipleSounds=!1,this.bOn=!0,this.volumes=null,this.bLocked=null,this.pans=null,this.mainVolume=0,this.mainPan=0,this.dataToDecode=null,this.decoding=!1,this.channels=Array(nM.NCHANNELS),this.volumes=Array(nM.NCHANNELS),this.bLocked=Array(nM.NCHANNELS),this.bOn=!0,this.bMultipleSounds=!0;e<nM.NCHANNELS;e++)this.channels[e]=null,this.volumes[e]=100,this.bLocked[e]=!1;this.mainVolume=100,this.mainPan=0;let e,s=new Audio,r=[,,,,];for(e=0,r[0]=s.canPlayType("audio/ogg"),r[1]=s.canPlayType("audio/x-m4a"),r[2]=s.canPlayType("audio/mpeg"),r[3]=s.canPlayType("audio/wav"),this.probablePlayableFormats=0,this.maybePlayableFormats=0;e<4;e++)"probably"==r[e]&&(this.probablePlayableFormats|=1<<e),"maybe"==r[e]&&(this.maybePlayableFormats|=1<<e);for(var h=t;null!=h.parentApp;)h=h.parentApp;this.context=h.soundContext,this.contextType=h.soundContextType,null==this.context&&("undefined"!=typeof AudioContext?(this.context=new AudioContext,this.contextType=1):"undefined"!=typeof webkitAudioContext&&(this.context=new webkitAudioContext,this.contextType=0),h.soundContext=this.context,h.soundContextType=this.contextType)}function n2(t){this.app=t}function nw(t){this.app=t,this.isLoaded=!1,this.subApp=null,this.context=this.app.context,this.radius=this.app.preloaderCircleRadius,this.color=this.app.preloaderCircleColor,this.xCenter=this.app.preloaderCircleCenterX,this.xCenter<0&&(this.xCenter=this.app.gaCxWin/2),this.yCenter=this.app.preloaderCircleCenterY,this.yCenter<0&&(this.yCenter=this.app.gaCyWin/2),this.currentAngle=0,this.size=this.app.preloaderCircleThickness,this.oldAngle=0,this.counter=25,this.phase=0,this.image=new Image;let e=this;this.image.onload=function(){e.isLoaded=!0},this.image.src=this.app.resources+"Preloader.png"}function nk(t){this.app=t,this.context=this.app.context,this.currentPosition=0,this.width=100,this.height=12,this.position=0,this.backColor=10526880,this.borderColor=8421504,this.barColor=0,this.rect=new E,this.rect.left=this.app.gaCxWin/2-this.width/2,this.rect.top=this.app.gaCyWin/2-this.height/2,this.rect.right=this.rect.left+this.width,this.rect.bottom=this.rect.top+this.height,this.reset()}function nN(t){this.app=t,this.isLoaded=!1,this.appSprite=new ly,this.subApp=new ny(this.app,this.app.file,this.app.path,!0),this.subApp.setParentApp(this.app,this.app.preloaderFrameNumber,0,this.appSprite,this.app.gaCxWin,this.app.gaCyWin),this.subApp.digest(),this.subApp.loadPreloader=!1,this.subApp.subAppStopped=!1,this.subApp.dwOptions&=~ny.AH2OPT_LOADDATAATSTART,this.subApp.startApplication(),this.subApp.setMouseOffsets(0,0),this.subApp.stepApplication(),this.appSprite.x=this.app.gaCxWin/2-this.subApp.frame.leWidth/2,this.appSprite.y=this.app.gaCyWin/2-this.subApp.frame.leHeight/2,this.stopOnLoad=(this.app.dwOptions&ny.AH2OPT_PRELOADERQUIT)!=0,this.app.subApps.push(this.subApp),this.delay=0}function n1(t){this.app=t,this.joyBack=null,this.joyFront=null,this.fire1U=null,this.fire2U=null,this.fire1D=null,this.fire2D=null,this.imagesX=[,,,],this.imagesY=[,,,],this.joystickX=0,this.joystickY=0,this.joystick=0,this.flags=0,this.touches=[,,,],this.bSetPositions=!1,this.isJoystick=!0,this.joydeadzone=0,this.joyanglezone=0,this.joyradsize=0}function nD(t){this.rhApp=t,this.rhFrame=null,this.rhMaxOI=0,this.rhStopFlag=0,this.rhEvFlag=0,this.rhNPlayers=0,this.rhGameFlags=0,this.rhPlayer=0,this.rhQuit=0,this.rhQuitBis=0,this.rhReturn=0,this.rhQuitParam=0,this.rhNObjects=0,this.rhMaxObjects=0,this.rhOiList=null,this.rhEvtProg=null,this.rhLevelSx=0,this.rhLevelSy=0,this.rhWindowX=0,this.rhWindowY=0,this.rhVBLDeltaOld=0,this.rhVBLObjet=0,this.rhVBLOld=0,this.rhMT_VBLStep=0,this.rhMT_VBLCount=0,this.rhMT_MoveStep=0,this.rhLoopCount=0,this.rhTimer=0,this.rhTimerOld=0,this.rhTimerDelta=0,this.rhOiListPtr=0,this.rhObListNext=0,this.rhDestroyPos=0,this.rhMouseUsed=0,this.rh2OldPlayer=null,this.rh2NewPlayer=null,this.rh2InputMask=null,this.rh2MouseKeys=0,this.rh2CreationCount=0,this.rh2MouseX=0,this.rh2MouseY=0,this.rh2MouseSaveX=0,this.rh2MouseSaveY=0,this.rh2PauseCompteur=0,this.rh2PauseTimer=0,this.rh2PauseVbl=0,this.rh3DisplayX=0,this.rh3DisplayY=0,this.rh3WindowSx=0,this.rh3WindowSy=0,this.rh3CollisionCount=0,this.rh3Scrolling=0,this.rh3XMinimum=0,this.rh3YMinimum=0,this.rh3XMaximum=0,this.rh3YMaximum=0,this.rh3XMinimumKill=0,this.rh3YMinimumKill=0,this.rh3XMaximumKill=0,this.rh3YMaximumKill=0,this.rh3Graine=0,this.rh4DemoMode=0,this.rh4PauseKey=0,this.rh4CurrentFastLoop=null,this.rh4EndOfPause=0,this.rh4MouseWheelDelta=0,this.rh4OnMouseWheel=0,this.rh4FastLoops=null,this.rh4ExpValue1=0,this.rh4ExpValue2=0,this.rh4KpxReturn=0,this.rh4ObjectCurCreate=0,this.rh4ObjectAddCreate=0,this.rh4DoUpdate=0,this.rh4VBLDelta=0,this.rh4LoopTheoric=0,this.rh4EventCount=0,this.rh4BackDrawRoutines=null,this.rh4WindowDeltaX=0,this.rh4WindowDeltaY=0,this.rh4TimeOut=0,this.rh4TabCounter=0,this.rh4PosPile=0,this.rh4Results=null,this.rh4Operators=null,this.rh4OpeNull=null,this.rh4CurToken=0,this.rh4Tokens=null,this.rh4FrameRateArray=null,this.rh4FrameRatePos=0,this.rh4FrameRatePrevious=0,this.rhDestroyList=null,this.rh4SaveFrame=0,this.rh4SaveFrameCount=0,this.rh4MvtTimerCoef=0,this.questionObjectOn=null,this.bOperande=!1,this.rhWheelCount=0,this.rhObjectList=null,this.currentTabObject=null,this.buttonClickCount=-1,this.isColArray=[,,],this.flagFloat=!1,this.fadeTimerDelta=0,this.rhJoystickMask=255,this.noResume=!1,this.quitPause=!1}function n4(){this.cobLevObj=null,this.cobLevObjSeg=0,this.cobFlags=0,this.cobX=0,this.cobY=0,this.cobDir=0,this.cobLayer=0,this.cobZOrder=0}function n3(){this.oilOi=0,this.oilListSelected=0,this.oilType=0,this.oilObject=0,this.oilEvents=0,this.oilWrap=0,this.oilNextFlag=!1,this.oilNObjects=0,this.oilActionCount=0,this.oilActionLoopCount=0,this.oilCurrentRoutine=0,this.oilCurrentOi=0,this.oilNext=0,this.oilEventCount=0,this.oilNumOfSelected=0,this.oilOEFlags=0,this.oilLimitFlags=0,this.oilLimitList=0,this.oilOIFlags=0,this.oilOCFlags2=0,this.oilInkEffect=0,this.oilEffectParam=0,this.oilHFII=0,this.oilBackColor=0,this.oilQualifiers=null,this.oilName=null,this.oilEventCountOR=0,this.oilColList=null}function nH(){this.name=null,this.objects=null}function nB(){this.value=null,this.rsMini=0,this.rsMaxi=0,this.rsMiniDouble=0,this.rsMaxiDouble=0}function n6(){this.text=null,this.rsMini=0}function nG(){this.values=null,this.strings=null,this.flags=0}function n5(){this.m_type=0,this.m_subType=n5.MSUBTYPE_OBJECT,this.m_identifier=0,this.m_stopFlag=!1,this.m_pHo=null,this.m_body=null,this.m_currentAngle=0,this.m_eventCount=0,this.m_collidingObject=null,this.ho=null,this.rh=null,this.rc=new E,this.m_addVX=0,this.m_addVY=0,this.m_addVFlag=!1,this.m_setVX=0,this.m_setVY=0,this.m_setVFlag=!1,this.m_image=-1,this.m_background=!1}function nY(){this.anDirs=null,this.anTrigo=null,this.anAntiTrigo=null}function nj(){this.ahAnimMax=0,this.ahAnims=null,this.ahAnimExists=null}function nX(){this.adMinSpeed=0,this.adMaxSpeed=0,this.adRepeat=0,this.adRepeatFrame=0,this.adNumberOfFrame=0,this.adFrames=null}function nW(){this.hoPtr=null,this.raAnimForced=0,this.raAnimDirForced=0,this.raAnimSpeedForced=0,this.raAnimStopped=!1,this.raAnimOn=0,this.raAnimOffset=null,this.raAnimDir=0,this.raAnimPreviousDir=0,this.raAnimDirOffset=null,this.raAnimSpeed=0,this.raAnimMinSpeed=0,this.raAnimMaxSpeed=0,this.raAnimDeltaSpeed=0,this.raAnimCounter=0,this.raAnimDelta=0,this.raAnimRepeat=0,this.raAnimRepeatLoop=0,this.raAnimFrame=0,this.raAnimNumberOfFrame=0,this.raAnimFrameForced=0,this.raRoutineAnimation=0,this.raOldAngle=-1}function n7(t,e){this.imageBank=t,this.app=t.app,this.handle=e}function nV(t){this.app=t,this.file=null,this.images=null,this.nHandlesReel=0,this.nHandlesTotal=0,this.nImages=0,this.offsetsToImage=null,this.handleToIndex=null,this.useCount=null,this.rcInfo=null,this.hsInfo=null,this.apInfo=null,this.pIfo=null,this.mosaics=null,this.oldMosaics=null,this.mosaicLoaded=null}function nU(){this.app=null,this.handle=0,this.width=0,this.height=0,this.xSpot=0,this.ySpot=0,this.xAP=0,this.yAP=0,this.useCount=0,this.img=null,this.maskNormal=null,this.maskPlatform=null,this.maskRotation=null,this.filePointer=null,this.mosaic=0,this.mosaicX=0,this.mosaicY=0,this.texID=-1,this.texCoords=null}function nK(t){this.app=t,this.file=null,this.fonts=null,this.offsetsToFonts=null,this.nFonts=0,this.handleToIndex=null,this.maxHandlesReel=0,this.maxHandlesTotal=0,this.useCount=null,this.nullFont=new nq,this.nullFont.createDefaultFont()}function nq(){this.useCount=0,this.handle=0,this.lfHeight=0,this.lfWeight=0,this.lfItalic=0,this.lfFaceName=null,this.font=null,this.isGraphic=!1}function nz(t){this.app=t,this.sounds=null,this.nHandlesReel=0,this.nHandlesTotal=0,this.nSounds=0,this.offsetsToSounds=null,this.handleToIndex=null,this.useCount=null,this.file=null}function nJ(t){this.application=t,this.context=t.soundPlayer.context,this.contextType=t.soundPlayer.contextType,this.gainNode=t.soundPlayer.gainNode,this.type=0,this.file=t.file,this.handle=-1,this.source=null,this.sound=null,this.useCount=0,this.bUninterruptible=!1,this.nLoops=0,this.numSound=0,this.name=null,this.bPaused=!1,this.bAllowGlobalResume=!1,this.bPlaying=!1,this.frequency=0,this.response=null,this.gain=null}function nQ(t,e){this.name=t,this.pointers=[],this.position=0,this.m_bOR=!1,this.fastLoopIndex=e}function nZ(t){this.application=t,this.rhPtr=null,this.maxObjects=0,this.maxOi=0,this.nPlayers=0,this.nConditions=Array(ac.NUMBEROF_SYSTEMTYPES+ac.OBJ_LAST),this.nQualifiers=0,this.nEvents=0,this.qualifiers=null,this.events=null,this.qualToOiList=null,this.listPointers=null,this.eventPointersGroup=null,this.eventPointersCnd=null,this.limitBuffer=null,this.rhEvents=Array(ac.NUMBEROF_SYSTEMTYPES+1),this.rhEventAlways=!1,this.rh4TimerEventsBase=0,this.colBuffer=null,this.qualOilPtr=0,this.qualOilPos=0,this.qualOilPtr2=0,this.qualOilPos2=0,this.rh4CheckDoneInstart=!1,this.rhEventGroup=null,this.rhCurCode=0,this.rh4PickFlags=[,,,,],this.rh2ActionLoop=!1,this.rh2ActionOn=!1,this.rh2EnablePick=!1,this.rh2EventCount=0,this.rh2ActionCount=0,this.rh2ActionLoopCount=0,this.rh4EventCountOR=0,this.rh4ConditionsFalse=!1,this.rh3DoStop=!1,this.rh2EventQualPos=null,this.rh2EventQualPosNum=0,this.rh2EventPos=0,this.rh2EventPosOiList=0,this.rh2EventPrev=null,this.rh2EventPrevOiList=null,this.evtNSelectedObjects=0,this.repeatFlag=!1,this.rh2EventType=0,this.rhCurOi=0,this.rhCurParam0=0,this.rhCurParam1=0,this.rh2CurrentClick=0,this.rh4_2ndObject=null,this.bReady=!1,this.rh2ShuffleBuffer=null,this.rhCurObjectNumber=0,this.rh1stObjectNumber=0,this.rh2PushedEvents=null,this.callEndForEach=!1,this.bTestAllKeys=!1,this.maxEvents=0,this.complexOnLoop=!1}function n9(){this.evgNCond=0,this.evgNAct=0,this.evgFlags=0,this.evgInhibit=0,this.evgInhibitCpt=0,this.evgEvents=null}function at(){}function ae(){this.id=0,this.evg=0}function ai(){this.qOi=0,this.qType=0}function as(t,e,s,r,h){this.routine=t,this.code=e,this.param=s,this.pHo=r,this.oi=h}function ar(){this.qoiCurrentOi=0,this.qoiNext=0,this.qoiActionPos=0,this.qoiCurrentRoutine=0,this.qoiActionCount=0,this.qoiActionLoopCount=0,this.qoiNextFlag=!1,this.qoiSelectedFlag=!1,this.qoiList=null}function ah(){this.next=null,this.oi=0,this.index=0,this.name=null,this.number=0,this.stop=!1,this.objects=[]}function ao(){this.next=null,this.type=0,this.name=null,this.timer=0,this.timerNext=0,this.timerPosition=0,this.loops=0,this.index=0,this.bDelete=!1}function an(){let t;for(t=0,this.loHandle=0,this.loOiHandle=0,this.loX=0,this.loY=0,this.loParentType=0,this.loOiParentHandle=0,this.loLayer=0,this.loType=0,this.loInstances=null,this.loInstances=[,,,,];t<4;t++)this.loInstances[t]=null}function aa(){this.list=null,this.handleToIndex=null,this.nIndex=0,this.loFranIndex=0}function al(t){this.app=t,this.pName=null,this.x=0,this.y=0,this.dx=0,this.dy=0,this.pObstacles=null,this.pPlatforms=null,this.addedBackdrops=null,this.bVisible=!1,this.pLadders=null,this.nZOrderMax=0,this.dwOptions=0,this.xCoef=0,this.yCoef=0,this.nBkdLOs=0,this.nFirstLOIndex=0,this.effect=0,this.effectParam=0,this.backUp_dwOptions=0,this.backUp_xCoef=0,this.backUp_yCoef=0,this.backUp_nBkdLOs=0,this.backUp_nFirstLOIndex=0,this.planeBack=null,this.planeQuickDisplay=null,this.planeSprites=null,this.angle=0,this.scale=this.scaleX=this.scaleY=1,this.xSpot=this.xDest=320,this.ySpot=this.yDest=240}function au(t,e,s,r,h,n){if(this.app=t,this.levelObject=r,this.type=0,this.obstacleType=0,this.x=e,this.y=s,this.width=0,this.height=0,this.poi=null,this.colBox=!1,this.imageUsed=null,this.borderWidth=0,this.color1=null,this.color2=null,this.borderColor=null,this.effect=0,this.effectParam=0,this.body=null,this.ho=null,r){if(this.poi=this.app.OIList.getOIFromHandle(r.loOiHandle),this.type=this.poi.oiType,this.obstacleType=this.poi.oiOC.ocObstacleType,this.borderWidth=this.poi.oiOC.ocBorderSize,this.gradientFlags=this.poi.oiOC.ocGradientFlags,this.effect=this.poi.oiInkEffect,this.effectParam=this.poi.oiInkEffectParam,this.width=this.poi.oiOC.ocCx,this.height=this.poi.oiOC.ocCy,this.colBox=0!=this.poi.oiOC.ocColMode,this.color1=this.poi.oiOC.ocColor1,this.color2=this.poi.oiOC.ocColor2,this.borderColor=this.poi.oiOC.ocBorderColor,1==this.type)this.imageUsed=this.app.imageBank.getImageFromHandle(this.poi.oiOC.ocImage),this.width=this.imageUsed.width,this.height=this.imageUsed.height;else if(this.type>=32){for(var a=this.app.run,l=null,u=0,d=0;d<a.rhNObjects;d++){for(;null==a.rhObjectList[u];)u++;if(l=a.rhObjectList[u],u++,l.lo==r)break}this.ho=l}}else{switch(this.type=ac.OBJ_PASTED,this.imageUsed=h,this.width=this.imageUsed.width,this.height=this.imageUsed.height,this.x-=this.imageUsed.xSpot,this.y-=this.imageUsed.ySpot,n){case 0:this.obstacleType=ap.OBSTACLE_NONE;break;case 1:this.obstacleType=ap.OBSTACLE_SOLID;break;case 2:this.obstacleType=ap.OBSTACLE_PLATFORM;break;case 3:this.obstacleType=ap.OBSTACLE_LADDER}this.colBox=!1}}function ac(){this.oiHandle=0,this.oiType=0,this.oiFlags=0,this.oiInkEffect=0,this.oiInkEffectParam=0,this.oiName=null,this.oiOC=null,this.oiFileOffset=0,this.oiLoadFlags=0,this.oiLoadCount=0,this.oiCount=0}function ad(){this.oiMaxIndex=0,this.ois=0,this.oiMaxHandle=0,this.oiHandleToIndex=null,this.oiToLoad=null,this.oiLoaded=null,this.currentOI=0}function ap(){}function am(){this.ocImage=0}function af(){this.ocBorderSize=0,this.ocBorderColor=0,this.ocShape=0,this.ocFillType=0,this.ocLineFlags=0,this.ocColor1=0,this.ocColor2=0,this.ocGradientFlags=0,this.ocImage=0}function a$(){this.ocOEFlags=0,this.ocQualifiers=null,this.ocFlags2=0,this.ocOEPrefs=0,this.ocIdentifier=0,this.ocBackColor=0,this.ocMovements=null,this.ocValues=null,this.ocStrings=null,this.ocAnimations=null,this.ocCounters=null,this.ocObject=null,this.ocExtension=0,this.ocVersion=0,this.ocID=0,this.ocPrivate=0,this.ocFadeIn=null,this.ocFadeOut=null}function ag(){this.odCx=0,this.odCy=0,this.odVersion=0,this.odNStartFrame=0,this.odOptions=0,this.odName=null}function aP(){this.ctInit=0,this.ctMini=0,this.ctMaxi=0}function a8(){this.odCx=0,this.odCy=0,this.odPlayer=0,this.odDisplayType=0,this.odDisplayFlags=0,this.odFont=0,this.ocBorderSize=0,this.ocBorderColor=0,this.ocShape=0,this.ocFillType=0,this.ocLineFlags=0,this.ocColor1=0,this.ocColor2=0,this.ocGradientFlags=0,this.nFrames=0,this.frames=null}function aE(){this.odDWSize=0,this.odVersion=0,this.odOptions=0,this.odBackColor=0,this.odCx=0,this.odCy=0,this.text=null}function a_(){this.tsFont=0,this.tsFlags=0,this.tsColor=0,this.tsText=null}function aA(){this.otCx=0,this.otCy=0,this.otNumberOfText=0,this.otTexts=null}function a0(){this.hoNumber=0,this.hoNextSelected=0,this.hoAdRunHeader=null,this.hoHFII=0,this.hoOi=0,this.hoNumPrev=0,this.hoNumNext=0,this.hoType=0,this.hoCreationId=0,this.hoOiList=null,this.hoEvents=0,this.hoPrevNoRepeat=null,this.hoBaseNoRepeat=null,this.hoMark1=0,this.hoMark2=0,this.hoMT_NodeName=null,this.hoEventNumber=0,this.hoCommon=null,this.hoCalculX=0,this.hoX=0,this.hoCalculY=0,this.hoY=0,this.hoImgXSpot=0,this.hoImgYSpot=0,this.hoImgWidth=0,this.hoImgHeight=0,this.hoOEFlags=0,this.hoFlags=0,this.hoSelectedInOR=0,this.hoOffsetValue=0,this.hoLayer=0,this.hoLimitFlags=0,this.hoNextQuickDisplay=0,this.hoCurrentParam=0,this.hoIdentifier=0,this.hoCallRoutine=!1,this.roc=null,this.rom=null,this.roa=null,this.rov=null,this.ros=null}function av(){this.smoothing=!1,this.image=null,this.bShown=!1,this.nLayer=0,this.pLayer=null,this.startFade=0,this.sprite=null,this.bHandCursor=!1,this.rcRotate=null,this.ptRotate=null,this.bVisible=!0,this.scaleX=1,this.scaleY=1,this.angle=0,this.x=0,this.y=0,this.transitionImage=null}function aO(){this.flags=0,this.odOptions=0,this.subApp=null,this.oldX=0,this.oldY=0,this.level=-1,this.oldLevel=-1,this.layer=null,this.bVisible=!0}function aS(){this.rcPlayer=0,this.rcMovementType=0,this.rcAnim=0,this.rcImage=-1,this.rcScaleX=1,this.rcScaleY=1,this.rcAngle=0,this.rcDir=0,this.rcSpeed=0,this.rcMinSpeed=0,this.rcMaxSpeed=0,this.rcChanged=!1,this.rcCheckCollides=!1,this.rcOldX=0,this.rcOldY=0,this.rcOldImage=-1,this.rcOldAngle=0,this.rcOldDir=0,this.rcOldX1=0,this.rcOldY1=0,this.rcOldX2=0,this.rcOldY2=0}function aT(){this.type=0,this.rsValue=0,this.rsMini=0,this.rsMaxi=0,this.rsBoxCx=0,this.rsBoxCy=0,this.bShown=!1,this.bQuickDisplay=!1,this.rsColor1=0,this.rsColor2=0,this.rsOldFrame=0,this.nIndex=0,this.displayFlags=0,this.bDeleted=!1,this.bFloat=!1,this.plane=null,this.pLayer=null,this.fontHeight=0,this.font=null,this.bAddedToPlane=!1,this.computed=!1}function ab(){this.rsPlayer=0,this.rsValue=0,this.rsBoxCx=0,this.rsBoxCy=0,this.rsFont=0,this.rsColor1=0,this.type=0,this.bShown=!0,this.nLayer=0,this.nIndex=0,this.plane=null,this.displayFlags=0,this.pLayer=null,this.bAddedToFrame=!1,this.fontHeight=0,this.alpha=1,this.composite="source-over",this.computed=!1}function aC(){this.rsPlayer=0,this.rsValue=0,this.rsBoxCx=0,this.rsBoxCy=0,this.rsFont=0,this.rsColor1=0,this.type=0,this.bShown=!0,this.nLayer=0,this.nIndex=0,this.plane=null,this.displayFlags=0,this.pLayer=null,this.bAddedToFrame=!1,this.fontHeight=0,this.alpha=1,this.composite="source-over",this.computed=!1}function aL(){this.rsTextBuffer=null,this.currentText=null,this.rsMaxi=0,this.rsMini=0,this.rsFont=0,this.rsTextColor=0,this.nLayer=0,this.font=null,this.bShown=!0,this.flags=0,this.rsHidden=0,this.pLayer=null,this.plane=null,this.bAddedToPlane=!1,this.rect=new E,this.deltaY=0,this.rsBoxCx=0,this.rsBoxCy=0,this.textSurface=null,this.computed=!1}function aI(){this.rsBoxCx=0,this.rsBoxCy=0,this.rcA=null,this.currentDown=0,this.xMouse=0,this.yMouse=0,this.textSurfaces=[]}function aF(t,e){this.ext=e.rhApp.extLoader.loadRunObject(t),this.noHandle=!1,this.privateData=0,this.objectCount=0,this.objectNumber=0,this.bAddedToPlane=!1,this.bShown=!0,this.nLayer=0,this.pLayer=null,this.plane=null}function ay(){}function ax(){this.x=0,this.y=0,this.dir=0,this.layer=0,this.bRepeat=!1}function aR(t){this.value1=t.file.readAShort(),this.value2=t.file.readAShort()}function aM(t){this.timer=t.file.readAInt(),this.loops=t.file.readAInt(),this.comparaison=t.file.readAShort()}function a2(t){this.color=t.file.readAColor()}function aw(t){this.delay=t.file.readAInt(),this.compteur=t.file.readAInt()}function ak(t){this.comparaison=t.file.readAShort();for(var e,s,r,h=t.file.getFilePointer(),n=0;n++,0!=(s=t.file.readAInt());)(e=t.file.readAShort())>6&&t.file.skipBytes(e-6);for(t.file.seek(h),this.tokens=Array(n),r=0;r<n;r++)this.tokens[r]=rW.create(t.file)}function aN(t){let e=t.file.readAShort();t.file.skipBytes(4),this.data=0,e>6&&(this.data=t.file.getFilePointer(),t.file.skipBytes(e-6))}function a1(t){this.grpFlags=t.file.readAShort(),this.grpId=t.file.readAShort()}function aD(t){t.file.skipBytes(4),this.pointer=0,this.id=t.file.readAShort()}function a4(t){this.value=t.file.readAInt(),this.value2=0}function a3(t){this.key=t.file.readAShort()}function aH(t){this.oiList=t.file.readShort(),this.oi=t.file.readShort(),this.type=t.file.readShort()}function aB(){}function a6(t){this.posOINUMParent=t.file.readShort(),this.posFlags=t.file.readShort(),this.posX=t.file.readShort(),this.posY=t.file.readShort(),this.posSlope=t.file.readShort(),this.posAngle=t.file.readShort(),this.posDir=t.file.readAInt(),this.posTypeParent=t.file.readShort(),this.posOiList=t.file.readShort(),this.posLayer=t.file.readShort()}function aG(t){this.posOINUMParent=t.file.readShort(),this.posFlags=t.file.readShort(),this.posX=t.file.readShort(),this.posY=t.file.readShort(),this.posSlope=t.file.readShort(),this.posAngle=t.file.readShort(),this.posDir=t.file.readAInt(),this.posTypeParent=t.file.readShort(),this.posOiList=t.file.readShort(),this.posLayer=t.file.readShort(),this.cdpHFII=t.file.readAShort(),this.cdpOi=t.file.readAShort()}function a5(t){this.posOINUMParent=t.file.readShort(),this.posFlags=t.file.readShort(),this.posX=t.file.readShort(),this.posY=t.file.readShort(),this.posSlope=t.file.readShort(),this.posAngle=t.file.readShort(),this.posDir=t.file.readAInt(),this.posTypeParent=t.file.readShort(),this.posOiList=t.file.readShort(),this.posLayer=t.file.readShort(),this.cdpHFII=t.file.readShort(),this.cdpOi=t.file.readShort(),t.file.skipBytes(4),this.shtSpeed=t.file.readAShort()}function aY(t){this.sndHandle=t.file.readAShort(),this.sndFlags=t.file.readAShort()}function aj(t){this.value=t.file.readAShort()}function aX(t){this.string=t.file.readAString()}function aW(t){this.timer=t.file.readAInt(),this.loops=t.file.readAInt()}function a7(t){this.x1=t.file.readShort(),this.y1=t.file.readShort(),this.x2=t.file.readShort(),this.y2=t.file.readShort()}function aV(){this.clips=[]}function aU(t){if(this.xScale=1,this.yScale=1,this.oldEffect=-1,this.smoothing=!1,this.oldSmoothing=!1,this.dxw=0,this.dyw=0,!(this._context=t.getContext("2d")))throw Error("Failed to init standard renderer")}function aK(){this.dllName="",this.transID=0,this.transDuration=0,this.transFlags=0,this.transColor=0,this.dataOffset=0}function aq(){}function az(){this.m_initTime=0,this.m_currentTime=0,this.m_endTime=0,this.m_duration=0,this.m_overflow=!1,this.m_running=!1,this.m_starting=!1,this.source1=null,this.source2=null,this.dest=null,this.destContext=null}function aJ(t){this.app=t}function aQ(){}function aZ(){this.dwStyle=0,this.m_source2Width=0,this.m_source2Height=0,this.m_style=0}function a9(){this.dwStyle=0,this.m_source2Width=0,this.m_source2Height=0}function lt(){this.bpNbBands=0,this.bpDirection=0,this.m_wbande=0,this.m_rw=0,this.m_prc=null}function le(){this.dwPos=0,this.dwPos2=0,this.m_source2Width=0,this.m_source2Height=0}function li(){this.m_direction=0,this.m_wbande=0,this.m_rw=0}function ls(){}function lr(){this.dwPos=0,this.dwStyle=0,this.dwScrolling=0,this.m_source2Width=0,this.m_source2Height=0}function lh(){this.m_spotPercent,this.m_spotSize=0,this.m_nbBlockPerLine=0,this.m_nbBlockPerCol=0,this.m_nbBlocks=0,this.m_lastNbBlocks=0,this.m_bitbuf=null}function lo(){this.dwStyle=0,this.m_source2Width=0,this.m_source2Height=0}function ln(){this.dwStyle=0,this.m_source2Width=0,this.m_source2Height=0,this.m_refresh=0}function la(){this.m_direction,this.m_wbande,this.m_rw}function ll(){this.dwStyle=0,this.dwPos=0,this.dwStretch=0,this.m_source2Width=0,this.m_source2Height=0}function lu(){this.dwStyle=0,this.m_source2Width=0,this.m_source2Height=0}function lc(){this.dwStyle=0,this.m_source2Width=0,this.m_source2Height=0,this.m_phase=0}function ld(){this.dwStyle=0,this.m_source2Width=0,this.m_source2Height=0,this.m_index=0,this.m_index2=0}function lp(){this.dwPos=0,this.dwCheck1=0,this.dwCheck2=0,this.m_source2Width=0,this.m_source2Height=0,this.m_angle=0}function lm(){this.dwPos=0,this.dwCheck1=0,this.m_source2Width=0,this.m_source2Height=0,this.m_curcircle=0}function lf(){this.zpSpotPercent=0,this.zpStartPoint=0,this.zpDirection=0,this.m_spotSize=0,this.m_nbBlockPerLine=0,this.m_nbBlockPerCol=0,this.m_nbBlocks=0,this.m_lastNbBlocks=0,this.m_curx=0,this.m_cury=0,this.m_currentDirection=0,this.m_currentStartPoint=0,this.m_left=0,this.m_top=0,this.m_right=0,this.m_bottom=0}function l$(){this.dwStyle=0,this.dwPos=0,this.m_source2Width=0,this.m_source2Height=0,this.m_linepos=0,this.m_dir=0}function lg(){}function lP(){this.dwPos=0,this.m_source2Width=0,this.m_source2Height=0}d=null,g.prototype={readUnsignedByte:function(){return 255&this.ccfBytes.charCodeAt(this.pointer++)},getChecksum:function(){let t,e=0;for(t=0;t<this.end;t++)e+=255&this.ccfBytes.charCodeAt(t)^170;return e},getFile:function(t,e,s){if(this.callback=e,a)try{let r,h=BinFileReaderImpl_IE_VBAjaxLoader(t).toArray(),n=h.length;for(n>s&&(n=s),r=0;r<n;r++)this.ccfBytes+=String.fromCharCode(h[r]);this.end=this.ccfBytes.length,this.callback()}catch(d){}else{let p=new XMLHttpRequest;p.open("GET",t,!0);let m=this;l?(p.responseType="blob",p.onload=function(){if(4==p.readyState&&200==p.status){let t=new FileReader;t.onloadend=function(){if(u)m.ccfBytes+=t.result;else{let e,s=new Uint8Array(t.result);for(e=0;e<s.length;e++)m.ccfBytes+=String.fromCharCode(s[e])}m.end=m.ccfBytes.length,m.callback()},u?t.readAsBinaryString(p.response):t.readAsArrayBuffer(p.response)}},p.send(null)):(p.overrideMimeType("text/plain; charset=x-user-defined"),p.onload=function(){4==p.readyState&&200==p.status&&(m.ccfBytes+=p.responseText,m.end=m.ccfBytes.length,m.callback())},p.send(null))}},openFileASync:function(t,e){this.parent=e;let s=new XMLHttpRequest;s.open("GET",t,!0),s.overrideMimeType("text/plain; charset=x-user-defined");let r=this;s.onload=function(){if(4==s.readyState&&200==s.status){r.ccfBytes=s.responseText,r.end=r.ccfBytes.length,r.pointer=0,r.offset=0,r.bUnicode=!1,r.parent.dataReceived(!0);return}},s.send(null)},getBytes:function(){return this.ccfBytes},setBinary:function(t){this.ccfBytes=t,this.end=t.length;let e=this;this.readUnsignedByte=function(){return 255&e.ccfBytes.charCodeAt(e.pointer++)}},createFromFile:function(t,e){let s=new g;return s.ccfBytes=this.ccfBytes,s.offset=t,s.pointer=t,s.end=t+e,s.bUnicode=this.bUnicode,s},getLength:function(){return this.end-this.offset},setUnicode:function(t){this.bUnicode=t},detectUnicode:function(){let t=this.readUnsignedByte(),e=this.readUnsignedByte(),s=this.readUnsignedByte();255==t&&254==e?(this.bUnicode=!0,this.pointer--):239==t&&187==e&&191==s?this.bUnicode=!1:(this.bUnicode=!1,this.pointer-=3)},skipBytes:function(t){this.pointer+=t},adjustTo8:function(){(7&this.pointer)!=0&&(this.pointer+=8-(7&this.pointer))},isEOF:function(){return this.pointer>=this.end},readInString:function(t){let e,s="";for(e=0;e<t;e++)s+=String.fromCharCode(this.readUnsignedByte());return s},readAByte:function(){return this.readUnsignedByte()},readAShort:function(){let t,e;return t=this.readUnsignedByte(),256*(e=this.readUnsignedByte())+t},readShort:function(){t=this.readUnsignedByte();let t,e,s=256*(e=this.readUnsignedByte())+t;return s<32768?s:s-65536},readAChar:function(){let t,e;return t=this.readUnsignedByte(),256*(e=this.readUnsignedByte())+t},readACharArray:function(t){let e,s,r,h=[];for(r=0;r<t;r++)e=this.readUnsignedByte(),s=this.readUnsignedByte(),h[r]=256*s+e;return h},readAInt:function(){t=this.readUnsignedByte(),e=this.readUnsignedByte(),s=this.readUnsignedByte();let t,e,s,r,h=16777216*(r=this.readUnsignedByte())+65536*s+256*e+t;return h<=2147483647?h:h-4294967296},readAColor:function(){let t,e,s,r;return t=this.readUnsignedByte(),e=this.readUnsignedByte(),s=this.readUnsignedByte(),this.readUnsignedByte(),r=65536*t+256*e+s},readAFloat:function(){t=this.readUnsignedByte(),e=this.readUnsignedByte(),s=this.readUnsignedByte();let t,e,s,r,h=16777216*(r=this.readUnsignedByte())+65536*s+256*e+t;return h>2147483648&&(h-=4294967295),h/65536},readADouble:function(){t=this.readUnsignedByte(),e=this.readUnsignedByte(),s=this.readUnsignedByte(),r=this.readUnsignedByte(),h=this.readUnsignedByte(),n=this.readUnsignedByte(),a=this.readUnsignedByte();let t,e,s,r,h,n,a,l,u=72057594037927940*(l=this.readUnsignedByte())+281474976710656*a+1099511627776*n+4294967296*h+16777216*r+65536*s+256*e+t;return u>0x7fffffffffffffff&&(u-=18446744073709552e3),u/4294967296},readAString:function(t){let e="";if(this.bUnicode){if(arguments.length<1){if(this.isEOF())return e;for(var s=this.pointer,r=this.readAChar();r&&!this.isEOF();)r=this.readAChar();var h=(this.pointer-s-2)/2;return this.pointer=s,e=this.readAString(h),this.readUnsignedByte(),this.readUnsignedByte(),e}e="";for(var n,s=this.pointer,a=0;a<t&&0!=(n=this.readAChar());a++)e+=String.fromCharCode(n);return this.pointer=s+2*t,e}if(arguments.length<1){if(this.isEOF())return e;for(var s=this.pointer,r=this.readUnsignedByte();r&&!this.isEOF();)r=this.readUnsignedByte();var h=this.pointer-s-1;return this.pointer=s,e=this.readAString(h),this.readUnsignedByte(),e}for(var n,s=this.pointer,a=0;a<t&&0!=(n=this.readUnsignedByte());++a)e+=String.fromCharCode(n);return this.pointer=s+t,e},readAStringEOL:function(){let t,e,s,r,h=this.pointer,n="";if(!1==this.bUnicode){if(this.isEOF())return;for(t=this.readUnsignedByte();10!=t&&13!=t&&!this.isEOF();)t=this.readUnsignedByte();return e=this.pointer,this.pointer=h,s=1,10!=t&&13!=t&&(s=0),e>h+s&&(n=this.readAString(e-h-s)),(10==t||13==t)&&(this.readUnsignedByte(),r=this.readAByte(),10==t&&13!=r&&this.pointer--,13==t&&10!=r&&this.pointer--),n}if(!this.isEOF()){for(t=this.readAChar();10!=t&&13!=t&&!this.isEOF();)t=this.readAChar();return e=this.pointer,this.pointer=h,s=2,10!=t&&13!=t&&(s=0),e>h+s&&(n=this.readAString((e-h-s)/2)),(10==t||13==t)&&(this.pointer+=2,r=this.readAChar(),10==t&&13!=r&&(this.pointer-=2),13==t&&10!=r&&(this.pointer-=2)),n}},skipAString:function(){let t;if(!1==this.bUnicode)do t=this.readUnsignedByte();while(0!=t&&!this.EOF());else do t=this.readAChar();while(0!=t&&!this.EOF())},getFilePointer:function(){return this.pointer},seek:function(t){t>=this.end&&(t=this.end),this.pointer=t},skipBack:function(t){let e=this.pointer;(e-=t)<0&&(e=0),this.pointer=e},readBytesAsArray:function(t){let e,s=t.length;for(e=0;e<s;e++)t[e]=this.readUnsignedByte()},readBuffer:function(t){let e,s=[];for(e=0;e<t;e++)s[e]=this.readUnsignedByte();return s},readLogFont:function(){let t=new v;return t.readLogFont(this),t},readLogFont16:function(){let t=new v;return t.readLogFont16(this),t}},P.prototype={add:function(t){this.array.push(t)},isEmpty:function(){return this.array.length()},insert:function(t,e){this.array.splice(t,0,e)},get:function(t){return t<this.array.length?this.array[t]:null},put:function(t,e){this.array[t]=e},set:function(t,e){t<this.array.length&&(this.array[t]=e)},removeIndex:function(t){t<this.array.length&&this.array.splice(t,1)},indexOf:function(t){return this.array.indexOf(t)},contains:function(t){return this.array.indexOf(t)>=0},removeObject:function(t){let e=this.array.indexOf(t);e>=0&&this.array.splice(e,1)},size:function(){return this.array.length},clear:function(){this.array.length=0}},E.prototype={load:function(t){this.left=t.readAInt(),this.top=t.readAInt(),this.right=t.readAInt(),this.bottom=t.readAInt()},copyRect:function(t){this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom},ptInRect:function(t,e){return t>=this.left&&t<this.right&&e>=this.top&&e<this.bottom},intersectRect:function(t){return(this.left>=t.left&&this.left<t.right||this.right>=t.left&&this.right<t.right||t.left>=this.left&&t.left<this.right||t.right>=this.left&&t.right<this.right)&&(this.top>=t.top&&this.top<t.bottom||this.bottom>=t.top&&this.bottom<t.bottom||t.top>=this.top&&t.top<this.bottom||t.bottom>=this.top&&t.bottom<this.bottom)}},v.prototype={copy:function(t){this.lfHeight=t.lfHeight,this.lfWeight=t.lfWeight,this.lfItalic=t.lfItalic,this.lfFaceName=t.lfFaceName},getFont:function(){t=this.lfItalic?"italic ":"normal ";let t,e=100*Math.floor(this.lfWeight/100);return t+=(e=Math.min(e=Math.max(e,100),900))+" ",t+=this.lfHeight+"px ",t+=this.lfFaceName},getHeight:function(){return this.lfHeight+Math.ceil(this.lfHeight/8)},init:function(){this.lfFaceName="Arial",this.lfHeight=13,this.lfWeight=400,this.lfItalic=0},readLogFont:function(t){this.lfHeight=t.readAInt(),this.lfHeight<0&&(this.lfHeight=-this.lfHeight),t.skipBytes(12),this.lfWeight=t.readAInt(),this.lfItalic=t.readAByte(),this.lfUnderline=t.readAByte(),this.lfStrikeOut=t.readAByte(),t.skipBytes(5),this.lfFaceName=t.readAString(32)},readLogFont16:function(t){this.lfHeight=t.readShort(),this.lfHeight<0&&(this.lfHeight=-this.lfHeight),t.skipBytes(6),this.lfWeight=t.readAShort(),this.lfItalic=t.readAByte(),this.lfUnderline=t.readAByte(),this.lfStrikeOut=t.readAByte(),t.skipBytes(5);let e=t.bUnicode;t.bUnicode=!1,this.lfFaceName=t.readAString(32),t.bUnicode=e}},O.separator="{@24}",O.INIFLAG_UTF8=1,O.INIFLAG_UTF16=2,O.prototype={saveIni:function(){if(null!=this.strings&&null!=this.currentFileName){let t,e="";for(t=0;t<this.strings.size();t++)e+=this.strings.get(t)+O.separator;localStorage.setItem(this.currentFileName,e)}},loadIni:function(t){let e=!0;if(null!=this.currentFileName&&h.compareStringsIgnoreCase(t,this.currentFileName)&&(e=!1),e){this.saveIni(),this.currentFileName=t,this.strings=new P;let s=localStorage.getItem(this.currentFileName);if(s)for(let r=0,n=s.indexOf(O.separator,0);n>=0;)this.strings.add(s.substring(r,n)),r=n+O.separator.length,n=s.indexOf(O.separator,r);else{let a=null;if(null==a){let l=this.app.getEmbeddedFile(this.currentFileName);null!=l&&(a=l.open())}if(a){let u=!1;for(a.detectUnicode(),void 0!==this.flags&&(this.flags&O.INIFLAG_UTF8&&(this.bUnicode=!1,u=!0),this.flags&O.INIFLAG_UTF16&&(this.bUnicode=!0));!1==a.isEOF();){let d=a.readAStringEOL();if(u&&(d=this.decodeUtf8(d)),"<"==d.substring(0,1)){this.strings.clear();break}if(null==d)break;this.strings.add(d)}}}}},decodeUtf8:function(t){for(var e="",s=0,r=0,h=0,n=0;s<t.length;)(r=t.charCodeAt(s))<128?(e+=String.fromCharCode(r),s++):r>191&&r<224?(e+=String.fromCharCode((31&r)<<6|63&(h=t.charCodeAt(s+1))),s+=2):(e+=String.fromCharCode((15&r)<<12|(63&(h=t.charCodeAt(s+1)))<<6|63&(n=t.charCodeAt(s+2))),s+=3);return e},findSection:function(t){for(e=0;e<this.strings.size();e++)if("["==(s=this.strings.get(e)).charAt(0)){var e,s,r,n=s.lastIndexOf("]");if(n>=1&&(r=s.substring(1,n),h.compareStringsIgnoreCase(t,r)))return e}return -1},findKey:function(t,e){for(;t<this.strings.size()&&"["!=(s=this.strings.get(t)).charAt(0);t++)if((n=s.indexOf("="))>=0){for(var s,r,n,a=0;a<n&&32==s.charCodeAt(a);)a++;for(;n>a&&32==s.charCodeAt(n-1);)n--;if(n>a&&(r=s.substring(0,n),h.compareStringsIgnoreCase(r,e)))return t}return -1},getPrivateProfileString:function(t,e,s,r){this.loadIni(r);let h=this.findSection(t);if(h>=0&&(h=this.findKey(h+1,e))>=0){let n=this.strings.get(h),a=n.indexOf("=");return n.substring(a+1)}return s},writePrivateProfileString:function(t,e,s,r){this.loadIni(r);let h,n=this.findSection(t);if(n<0){h="["+t+"]",this.strings.add(h),h=e+"="+s,this.strings.add(h);return}let a=this.findKey(n+1,e);if(a>=0){h=e+"="+s,this.strings.set(a,h);return}for(a=n+1;a<this.strings.size();a++)if("["==(h=this.strings.get(a)).charAt(0)){h=e+"="+s,this.strings.insert(a,h);return}h=e+"="+s,this.strings.add(h)},deleteItem:function(t,e,s){this.loadIni(s);let r=this.findSection(t);if(r>=0){let h=this.findKey(r+1,e);h>=0&&this.strings.removeIndex(h),this.saveIni()}},deleteGroup:function(t,e){this.loadIni(e);let s=this.findSection(t);if(s>=0){for(this.strings.removeIndex(s);!(++s>=this.strings.size())&&"["!=this.strings.get(s).charAt(0);)this.strings.removeIndex(s);this.saveIni()}}},S.prototype={measureText:function(t,e){return(e=this.app.getGraphicFont(e)).isGraphic?e.measureText(t):(this.canvasContext.font=e.getFont(),this.canvasContext.measureText(t).width)},setText:function(t,e,s,r,n){if(t==this.lastText&&e==this.lastFlags&&s==this.lastRect&&r==this.lastFont&&n==this.lastColor)return this.lastHt;let a=this.canvasContext;a.clearRect(0,0,this.width,this.height),s||(s=new E(0,0,this.width,this.height));let l=[];r=this.app.getGraphicFont(r);let u=h.drawText(a,t,e,s,r,l);if(0!=u){let d=0;(e&h.DT_BOTTOM)!=0?d=this.height-u:(e&h.DT_VCENTER)!=0&&(d=this.height/2-u/2),h.displayText(a,0,d,l,r,n,0,0)}return this.lastText=t,this.lastFlags=e,this.lastRect=s,this.lastFont=r,this.lastColor=n,this.lastHt=u,u},manualClear:function(t){if(!t){this.canvasContext.clearRect(0,0,this.width,this.height);return}this.canvasContext.fillStyle=h.getColorString(t),this.canvasContext.fillRect(0,0,this.width,this.height)},manualDrawText:function(t,e,s,r,n,a,l){this.canvasContext;let u=[];s||(s=new E(0,0,this.width,this.height)),n=this.app.getGraphicFont(n);let d=h.drawText(this.canvasContext,t,e,s,n,u);if(0!=d){let p=0;switch((e&h.DT_BOTTOM)!=0?p=this.height-d:(e&h.DT_VCENTER)!=0&&(p=this.height/2-d/2),a){case 1:h.displayText(this.canvasContext,1,p+1,u,n,l,0,0),h.displayText(this.canvasContext,0,p,u,n,r,0,0);break;case 2:h.displayText(this.canvasContext,1,p,u,n,l,0,0),h.displayText(this.canvasContext,1,p+2,u,n,l,0,0),h.displayText(this.canvasContext,0,p+1,u,n,l,0,0),h.displayText(this.canvasContext,2,p+1,u,n,l,0,0),h.displayText(this.canvasContext,1,p+1,u,n,r,0,0);break;case 0:h.displayText(this.canvasContext,0,p,u,n,r,0,0)}}},resize:function(t,e){(t!=this.width||e!=this.height)&&(this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e)},draw:function(t,e,s,r,h){t.renderSimpleImage(this.canvas,e,s,this.width,this.height,r,h)}},T.dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],T.dataOS=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"MacOS"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPod",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Windows Phone",identity:"Windows Phone"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],T.prototype={searchString:function(t){for(let e=0;e<t.length;e++){let s=t[e].string,r=t[e].prop;if(this.versionSearchString=t[e].versionSearch||t[e].identity,s){if(-1!=s.indexOf(t[e].subString))return t[e].identity}else if(r)return t[e].identity}},searchVersion:function(t){let e=t.indexOf(this.versionSearchString);if(-1!=e)return parseFloat(t.substring(e+this.versionSearchString.length+1))}},C.prototype={replaceColor:function(t,e,s,r){this.app=t.rhApp;let n,a,l=e.hoOi,u=t.rhApp.OIList.getOIFromHandle(l);if(null!=u){this.dwMax=-1,this.mode=0,u.enumElements(this,null);for(var d=e;(2147483648&d.hoNumPrev)==0;)d=t.rhObjectList[2147483647&d.hoNumPrev];for(;-1!=d.roc.rcImage&&d.roc.rcImage>this.dwMax&&(this.dwMax=d.roc.rcImage),-1!=d.roc.rcOldImage&&d.roc.rcOldImage>this.dwMax&&(this.dwMax=d.roc.rcOldImage),(2147483648&d.hoNumNext)==0;)d=t.rhObjectList[d.hoNumNext];for(n=0,this.pImages=Array(this.dwMax+1);n<this.dwMax+1;n++)this.pImages[n]=-1;for(this.mode=1,u.enumElements(this,null),a=0;a<=this.dwMax;a++)if(-1!=this.pImages[a]){let p=t.rhApp.imageBank.getImageFromHandle(a),m=h.performReplacement(t.rhApp,p,r,s);null!=m&&(this.pImages[a]=t.rhApp.imageBank.addImage(m))}for(d=e;(2147483648&d.hoNumPrev)==0;)d=t.rhObjectList[2147483647&d.hoNumPrev];for(;-1!=d.roc.rcImage&&-1!=this.pImages[d.roc.rcImage]&&(d.roc.rcImage=this.pImages[d.roc.rcImage]),-1!=d.roc.rcOldImage&&-1!=this.pImages[d.roc.rcOldImage]&&(d.roc.rcOldImage=this.pImages[d.roc.rcOldImage]),(2147483648&d.hoNumNext)==0;)d=t.rhObjectList[d.hoNumNext];this.mode=2,u.enumElements(this,null),this.mode=3,u.enumElements(this,null),u.oiLoadFlags|=ac.OILF_TORELOAD}},enumerate:function(t){switch(this.mode){case 0:t>this.dwMax&&(this.dwMax=t);break;case 1:this.pImages[t]=1;break;case 2:this.app.imageBank.delImage(t);break;case 3:var e=this.app.imageBank.getImageFromHandle(this.pImages[t]);return e.useCount++,this.pImages[t]}return -1}},h.performReplacement=function(t,e,s,r){let h,n,a,l=document.createElement("canvas");l.width=e.width,l.height=e.height;let u=l.getContext("2d");0==e.mosaic?u.drawImage(e.img,0,0):u.drawImage(t.imageBank.mosaics[e.mosaic],e.mosaicX,e.mosaicY,e.width,e.height,0,0,e.width,e.height);let d=u.getImageData(0,0,e.width,e.height),p=r>>16&255,m=r>>8&255,f=255&r,$=s>>16&255,g=s>>8&255,P=255&s;for(a=0;a<e.height;a++)for(n=0;n<e.width;n++)h=(a*e.width+n)*4,d.data[h]==$&&d.data[h+1]==g&&d.data[h+2]==P&&(d.data[h]=p,d.data[h+1]=m,d.data[h+2]=f);u.putImageData(d,0,0);let E=new nU;return E.app=t,E.width=e.width,E.height=e.height,E.xSpot=e.xSpot,E.ySpot=e.ySpot,E.xAP=e.xAP,E.yAP=e.yAP,E.useCount=0,E.img=l,E.maskNormal=e.maskNormal,E.maskPlatform=e.maskPlatform,E.maskRotation=e.maskRotation,E},L.FONTFLAG_ITALIC=1,L.FONTFLAG_UNDERLINE=2,L.FONTFLAG_BOLD=4,L.FLAG_PRIORITY=8,L.prototype={compareFont:function(t){if(this.fontName!=t.lfFaceName||this.fontHeight!=t.lfHeight)return!1;let e=(this.fontFlags&L.FONTFLAG_ITALIC)!=0,s=0!=t.lfItalic;return e==s&&(e=(this.fontFlags&L.FONTFLAG_BOLD)!=0)==(s=t.lfWeight>400)},getHeight:function(){return this.height+this.interline},measureText:function(t){let e,s,r=0,h=t.length;for(e=0;e<h;e++)(s=this.characters.indexOf(t.charAt(e)))>=0?r+=this.charWidths[s]+this.interchar:r+=this.width;return r},measureChar:function(t){let e=characters.indexOf(String.fromCharCode(t));return e>=0?this.charWidths[e]+this.interchar:this.width},fillText:function(t,e,s,r){let n,a,l,u,d,p,m=e.length,f=this.image;if((this.flags&L.FLAG_PRIORITY)==0)for(n=0;n<m;n++)(u=this.characters.indexOf(e.charAt(n)))>=0?(p=Math.floor(u/this.nChars),d=u-p*this.nChars,l=p*(this.height+1),a=d*(this.width+1),0==f.mosaic?t.drawImage(f.img,a,l,this.width,this.height,Math.round(s),Math.round(r),this.width,this.height):t.drawImage(f.app.imageBank.mosaics[f.mosaic],a+f.mosaicX,l+f.mosaicY,this.width,this.height,Math.round(s),Math.round(r),this.width,this.height),s+=this.charWidths[u]+this.interchar):(t.fillStyle=h.getColorString(this.color),t.fillRect(s,r,this.width,this.height),s+=this.width);else for(s+=this.measureText(e),n=m-1;n>=0;n--)(u=this.characters.indexOf(e.charAt(n)))>=0?(s-=this.charWidths[u]+this.interchar,p=u/this.nChars,d=u-p*this.nChars,l=p*(this.height+1),a=d*(this.width+1),0==f.mosaic?t.drawImage(f.img,a,l,this.width,this.height,Math.round(s),Math.round(r),this.width,this.height):t.drawImage(f.app.imageBank.mosaics[f.mosaic],a+f.mosaicX,l+f.mosaicY,this.width,this.height,Math.round(s),Math.round(r),this.width,this.height)):(s-=this.width,t.fillStyle=h.getColorString(this.color),t.fillRect(s,r,this.width,this.height))}},(function t(e){this.rhPtr=e,this.run=this.rhPtr.run,this.eventProgram=this.run.rhEvtProg,this.ObjectList=this.run.rhObjectList,this.OiList=this.run.rhOiList,this.QualToOiList=this.eventProgram.qualToOiList}).prototype={selectAll:function(t){let e=this.OiList[t];e.oilNumOfSelected=e.oilNObjects,e.oilListSelected=e.oilObject,e.oilEventCount=this.eventProgram.rh2EventCount;for(let s=e.oilObject;(2147483648&s)==0;){let r=this.ObjectList[s];r.hoNextSelected=r.hoNumNext,s=r.hoNumNext}},selectNone:function(t){let e=this.OiList[t];null!=e&&(e.oilNumOfSelected=0,e.oilListSelected=-1,e.oilEventCount=this.eventProgram.rh2EventCount)},selectOneObject:function(t){let e=t.hoOiList;e.oilNumOfSelected=1,e.oilEventCount=this.eventProgram.rh2EventCount,e.oilListSelected=t.hoNumber,this.ObjectList[t.hoNumber].hoNextSelected=-1},selectObjects:function(t,e){let s=this.OiList[t];if(null!=s&&(s.oilNumOfSelected=e.length,s.oilEventCount=eventProgram.rh2EventCount,0!=e.length)){let r=0,h=e[r].hoNumber;for(s.oilListSelected=h;r<e.length;)currentNumber=e[r++].hoNumber,this.ObjectList[h].hoNextSelected=currentNumber,h=currentNumber;this.ObjectList[h].hoNextSelected=-1}},filterObjects:function(t,e,s,r){return(32768&e)!=0?((this.filterQualifierObjects(t,32767&e,s,r)?1:0)^(s?1:0))!=0:((this.filterNonQualifierObjects(t,e,s,r)?1:0)^(s?1:0))!=0},filterQualifierObjects:function(t,e,s,r){for(var h=this.QualToOiList[e],n=!1,a=0;a<h.qoiList.length;){let l=h.qoiList[a+1];n=((n?1:0)|(this.filterNonQualifierObjects(t,l,s,r)?1:0))!=0,a+=2}return n},filterNonQualifierObjects:function(t,e,s,r){let h=this.OiList[e];if(null==h)return!1;let n=!1;if(h.oilEventCount!=this.eventProgram.rh2EventCount&&this.selectAll(e),h.oilNumOfSelected<=0)return!1;for(var a=-1,l=0,u=h.oilListSelected,d=null;(2147483648&u)==0;){let p=this.ObjectList[u],m=((r(t,p)?1:0)^(s?1:0))!=0;n=((n?1:0)|(m?1:0))!=0,m&&(-1==a&&(a=u),null!=d&&(d.hoNextSelected=u),d=p,l++),u=p.hoNextSelected}return null!=d&&(d.hoNextSelected=-1),h.oilListSelected=a,h.oilNumOfSelected=l,n},getNumberOfSelected:function(t){if((32768&t)!=0){t&=32767;for(var e=0,s=this.QualToOiList[t],r=0;r<s.qoiList.length;)e+=this.OiList[s.qoiList[r+1]].oilNumOfSelected,r+=2;return e}return this.OiList[t].oilNumOfSelected},objectIsOfType:function(t,e){if((32768&e)!=0){e&=32767;for(let s=this.QualToOiList[e],r=0;r<s.qoiList.length;){if(this.OiList[s.qoiList[r+1]].oilOi==t.hoOi)return!0;r+=2}return!1}return t.hoOi==this.OiList[e].oilOi},GetOILFromOI:function(t){for(i=0;i<this.run.rhMaxOI;++i){let e=this.OiList[i];if(e.oilOi==t)return e}return null}},(function t(e,s){this.tokens=new P;let r=0,h=e.indexOf(s);if(1==s.length&&10==s.charCodeAt(0)){for(;h>=0;){if(h>r){var n=e.substring(r,h);n.length>0&&13==n.charCodeAt(n.length-1)&&(n=n.substr(0,n.length-1)),this.tokens.add(n)}r=h+s.length,h=e.indexOf(s,r)}if(e.length>r){var n=e.substring(r,e.length);n.length>0&&13==n.charCodeAt(n.length-1)&&(n=n.substr(0,n.length-1)),this.tokens.add(n)}}else{for(;h>=0;)h>r&&this.tokens.add(e.substring(r,h)),r=h+s.length,h=e.indexOf(s,r);e.length>r&&this.tokens.add(e.substring(r,e.length))}this.numToken=0}).prototype={countTokens:function(){return this.tokens.size()},nextToken:function(){if(this.numToken<this.tokens.size()){let t=this.tokens.get(this.numToken++);return null==t?"":t}return""}},I.ACTFLAGS_REPEAT=1,I.ACT_EXTSETFRICTION=17408,I.ACT_EXTSETELASTICITY=17664,I.ACT_EXTAPPLYIMPULSE=17920,I.ACT_EXTAPPLYANGULARIMPULSE=18176,I.ACT_EXTAPPLYFORCE=18432,I.ACT_EXTAPPLYTORQUE=18688,I.ACT_EXTSETLINEARVELOCITY=18944,I.ACT_EXTSETANGULARVELOCITY=19200,I.ACT_EXTFOREACH=19456,I.ACT_EXTFOREACH2=19712,I.ACT_EXTSTOPFORCE=19968,I.ACT_EXTSTOPTORQUE=20224,I.ACT_EXTSETDENSITY=20480,I.ACT_EXTSETGRAVITYSCALE=20736,I.ACT_STARTLOOP=983039,I.create=function(t){let e,s=!1,r=!1,h=!1,n=!1,a=!1,l=!1,u=!1,d=!1,p=!1,m=t.file.getFilePointer(),f=t.file.readAShort(),$=null,g=t.file.readAInt();switch(g){case 65535:case 131071:case 1572863:case 1638399:case 1245182:case 1507326:case 1572862:case 2162685:case 2228221:case 2293757:case 2359293:case 2424829:$=new R;break;case 262143:case 1900543:case 2031615:$=new G;break;case 327679:case 2424831:case 2555903:$=new X;break;case 393215:case 2162687:case 2293759:$=new M;break;case 458751:$=new k;break;case 524287:$=new N;break;case 983039:$=new V;break;case 1048575:$=new j;break;case 1114111:$=new B;break;case 1179647:$=new D;break;case 1310719:$=new H;break;case 1835007:case 1966079:$=new Y,s=!0;break;case 2097151:case 2228223:$=new w,r=!0;break;case 2359295:case 2490367:$=new W,h=!0;break;case 65534:$=new ti;break;case 131070:$=new tm;break;case 327678:$=new te;break;case 458750:$=new tf;break;case 524286:$=new Q;break;case 589822:$=new th;break;case 786430:$=new Z;break;case 851966:$=new tt;break;case 917502:$=new J;break;case 983038:$=new tr;break;case 1048574:$=new tp;break;case 1114110:$=new to;break;case 1179646:$=new ta;break;case 1310718:$=new tu;break;case 1376254:$=new tl;break;case 1441790:$=new td;break;case 1638398:$=new z;break;case 1703934:$=new ts;break;case 2031614:$=new q;break;case 2097150:$=new t$;break;case 2162686:$=new tn;break;case 2228222:$=new tc;break;case 65533:$=new eh;break;case 131069:$=new em;break;case 196605:$=new er;break;case 262141:case 1179645:$=new eo;break;case 327677:$=new es;break;case 393213:$=new eb;break;case 458749:$=new eC;break;case 524285:$=new tQ;break;case 589821:$=new tZ;break;case 655357:$=new t9;break;case 983037:$=new eu;break;case 1048573:$=new ec;break;case 1114109:$=new en;break;case 1245181:$=new ed;break;case 1310717:$=new ea;break;case 1376253:$=new el;break;case 1441789:$=new eP;break;case 1507325:$=new eg;break;case 1572861:$=new et;break;case 1638397:$=new ei;break;case 1703933:$=new ee;break;case 1769469:$=new e$;break;case 1835005:$=new ef;break;case 2097149:$=new ep;break;case 65532:$=new tJ;break;case 131068:$=new tq;break;case 196604:$=new tz;break;case 65530:$=new U;break;case 131066:$=new K;break;case 65529:$=new t7;break;case 131065:$=new tX;break;case 196601:$=new tG;break;case 262137:$=new t5;break;case 327673:$=new tK;break;case 393209:$=new t6;break;case 458745:$=new tU;break;case 524281:$=new tV;break;case 589817:$=new tY;break;case 655353:$=new tj;break;case 720889:$=new tW;break;case 65531:$=new eL;break;case 131067:$=new eI;break;case 5242883:$=new tg;break;case 5308419:$=new tP;break;case 5373955:$=new t8;break;case 5439491:$=new tv;break;case 5505027:$=new t0;break;case 5570563:$=new tA;break;case 5636099:$=new t_;break;case 5701635:$=new tE;break;case 5767171:$=new tO;break;case 5242882:$=new eE;break;case 5308418:$=new e8;break;case 5373954:$=new iF;break;case 5439490:$=new eS;break;case 5505026:$=new eA;break;case 5570562:$=new e0;break;case 5636098:$=new ev;break;case 5701634:$=new eO;break;case 5767170:$=new e_;break;case 5242887:$=new tI;break;case 5308423:$=new tS;break;case 5373959:$=new tF;break;case 5439495:$=new tL;break;case 5505031:$=new tC;break;case 5570567:$=new tT;break;case 5636103:$=new tb;break;case 5242884:$=new eT;break;case 5242889:$=new tk;break;case 5308425:$=new tN;break;case 5373961:$=new tM;break;case 5439497:$=new tw;break;case 5505033:$=new ty;break;case 5636105:$=new tR;break;case 5701641:$=new tH;break;case 5767177:$=new tB;break;case 5832713:$=new tx;break;case 5898249:$=new t3;break;case 5963785:$=new t2;break;case 6029321:$=new t1;break;case 6094857:$=new tD;break;case 6160393:$=new t4;break;default:switch(4294901760&g){case 65536:$=new ip;break;case 131072:$=new i0;break;case 196608:$=new iv;break;case 262144:$=new iR;break;case 327680:$=new iy;break;case 393216:$=new iC;break;case 458752:$=new ej;break;case 524288:$=new i1;break;case 589824:$=new ex;break;case 655360:$=new eQ;break;case 720896:$=new eV;break;case 786432:$=new eU;break;case 851968:$=new eZ;break;case 917504:$=new eY;break;case 983040:$=new iM;break;case 1048576:$=new ix;break;case 1114112:$=new e4;break;case 1179648:$=new e3;break;case 1245184:$=new eB;break;case 1310720:$=new eK;break;case 1376256:$=new eq;break;case 1441792:$=new eJ;break;case 1507328:$=new is;break;case 1572864:$=new eN;break;case 1638400:$=new ib;break;case 1703936:$=new eG;break;case 1769472:$=new iT;break;case 1835008:$=new eD;break;case 1900544:$=new iO;break;case 1966080:$=new iS;break;case 2031616:$=new iE,n=!0;break;case 2097152:$=new i2,a=!0;break;case 2162688:$=new ik,l=!0;break;case 2228224:$=new e1;break;case 2293760:$=new io,u=!0;break;case 2359296:$=new ew,d=!0;break;case 2424832:$=new eM,p=!0;break;case 2490368:$=new e5;break;case 2555904:$=new ig;break;case 2621440:$=new eH;break;case 2686976:$=new ez;break;case 2752512:$=new e9;break;case 2818048:$=new ii;break;case 2883584:$=new i$;break;case 2949120:$=new ir;break;case 3014656:$=new eR;break;case 3080192:$=new ic;break;case 3145728:$=new e6;break;case 3211264:$=new iA;break;case 3276800:$=new il;break;case 3342336:$=new iu;break;case 3407872:$=new ie;break;case 3473408:$=new id;break;case 3538944:$=new i8;break;case 3604480:case 4063232:case 4194304:case 4390912:$=new R;break;case 3670016:$=new iP;break;case 3735552:$=new iI;break;case 3801088:$=new iL;break;case 3866624:$=new eW;break;case 3932160:$=new eX;break;case 3997696:$=new e7;break;case 4128768:$=new ih;break;case 4259840:$=new it;break;case 4325376:$=new im;break;case 4456448:$=new iD;break;case 4521984:$=new i4;break;case 4587520:$=new i5;break;case 4653056:$=new i3;break;case 4718592:$=new iH;break;case 4784128:$=new iB;break;case 4849664:$=new i6;break;case 4915200:$=new iG;break;case 4980736:$=new eF;break;case 5046272:$=new ey;break;case 5111808:$=new iY;break;case 5177344:$=new ij;break;default:$=new lH}}if(null!=$){if($.evtCode=g,$.evtOi=t.file.readShort(),$.evtOiList=t.file.readShort(),$.evtFlags=t.file.readAByte(),$.evtFlags2=t.file.readAByte(),$.evtNParams=t.file.readAByte(),$.evtDefType=t.file.readAByte(),$.evtNParams>0)for(e=0,$.evtParams=Array($.evtNParams);e<$.evtNParams;e++)$.evtParams[e]=ay.create(t);if(s||r||h){var P=$.evtParams[0];$.num=P.value;var E=$.evtParams[1];$.value=E.tokens[0].value}if(n||a||l){var _=null,P=$.evtParams[0];if(53!=P.code){var A=P.value,E=$.evtParams[1];A>=0&&2==E.tokens.length&&(E.tokens[1].code<=0||E.tokens[1].code>=1310720)&&(65535==E.tokens[0].code||1572863==E.tokens[0].code)&&(n?((_=new i_).num=A,_.value=E.tokens[0].value):a?((_=new iw).num=A,_.value=E.tokens[0].value):l&&((_=new iN).num=A,_.value=E.tokens[0].value)),null!=_&&(_.evtCode=$.evtCode,_.evtOi=$.evtOi,_.evtOiList=$.evtOiList,_.evtFlags=$.evtFlags,_.evtFlags2=$.evtFlags2,_.evtNParams=$.evtNParams,_.evtDefType=$.evtDefType,_.evtParams=$.evtParams,$=_)}}if(u||d||p){var _=null,v=$.evtParams[0];2==v.tokens.length&&(v.tokens[1].code<=0||v.tokens[1].code>=1310720)&&65535==v.tokens[0].code&&(u?(_=new ia).mask=1<<v.tokens[0].value:d?(_=new ek).mask=1<<v.tokens[0].value:p&&((_=new e2).mask=1<<v.tokens[0].value)),null!=_&&(_.evtCode=$.evtCode,_.evtOi=$.evtOi,_.evtOiList=$.evtOiList,_.evtFlags=$.evtFlags,_.evtFlags2=$.evtFlags2,_.evtNParams=$.evtNParams,_.evtDefType=$.evtDefType,_.evtParams=$.evtParams,$=_)}}return t.file.seek(m+f),$},F.FLFLAG_STOP=1,R.prototype={execute:function(t){}},M.prototype={execute:function(t){e=52==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0])-1:this.evtParams[0].value;let e,s=t.get_EventExpressionAny(this.evtParams[1]);t.rhApp.addGlobalValueAt(e,s)}},w.prototype={execute:function(t){t.rhApp.addGlobalValueAt(this.num,this.value)}},k.prototype={execute:function(t){let e=this.evtParams[0].pointer,s=t.rhEvtProg.events[e].evgEvents[0].evtParams[0],r=(s.grpFlags&a1.GRPFLAGS_GROUPINACTIVE)!=0;s.grpFlags&=~a1.GRPFLAGS_GROUPINACTIVE,r&&this.grpActivate(t,e)},grpActivate:function(t,e){let s,r=t.rhEvtProg.events[e],h=r.evgEvents[0],n=h.evtParams[0],a=!1;if((n.grpFlags&a1.GRPFLAGS_PARENTINACTIVE)==0)for(r.evgFlags&=~n9.EVGFLAGS_INACTIVE,e++,a=!1,s=1;;){switch((h=(r=t.rhEvtProg.events[e]).evgEvents[0]).evtCode){case -589825:if(n=h.evtParams[0],1==s&&(n.grpFlags&=~a1.GRPFLAGS_PARENTINACTIVE),(n.grpFlags&a1.GRPFLAGS_GROUPINACTIVE)==0){e=this.grpActivate(t,e);continue}s++;break;case -655361:0==--s&&(r.evgFlags&=~n9.EVGFLAGS_INACTIVE,a=!0,e++);break;case -1441793:1==s&&(r.evgFlags&=~n9.EVGFLAGS_INACTIVE,r.evgFlags&=~n9.EVGFLAGS_ONCE);break;default:1==s&&(r.evgFlags&=~n9.EVGFLAGS_INACTIVE)}if(a)break;e++}else for(e++,a=!1,s=1;;e++){switch((h=(r=t.rhEvtProg.events[e]).evgEvents[0]).evtCode){case -589825:s++;break;case -655361:0==--s&&(a=!0,e++)}if(a)break}return e}},N.prototype={execute:function(t){let e=this.evtParams[0].pointer,s=t.rhEvtProg.events[e].evgEvents[0].evtParams[0],r=(s.grpFlags&a1.GRPFLAGS_GROUPINACTIVE)==0;s.grpFlags|=a1.GRPFLAGS_GROUPINACTIVE,!0==r&&(s.grpFlags&a1.GRPFLAGS_PARENTINACTIVE)==0&&this.grpDeactivate(t,e)},grpDeactivate:function(t,e){let s,r,h,n=t.rhEvtProg.events[e],a=n.evgEvents[0],l=a.evtParams[0];for(n.evgFlags|=n9.EVGFLAGS_INACTIVE,e++,r=!1,s=1;;){switch((a=(n=t.rhEvtProg.events[e]).evgEvents[0]).evtCode){case -589825:if(h=((l=a.evtParams[0]).grpFlags&a1.GRPFLAGS_PARENTINACTIVE)==0,1==s&&(l.grpFlags|=a1.GRPFLAGS_PARENTINACTIVE),!1!=h&&(l.grpFlags&a1.GRPFLAGS_GROUPINACTIVE)==0){e=this.grpDeactivate(t,e);continue}s++;break;case -655361:0==--s&&(n.evgFlags|=n9.EVGFLAGS_INACTIVE,r=!0,e++);break;default:1==s&&(n.evgFlags|=n9.EVGFLAGS_INACTIVE)}if(r)break;e++}return e}},D.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.rh3Graine=e}},H.prototype={execute:function(t){e=59==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0])-1:this.evtParams[0].value;let e,s=t.get_EventExpressionString(this.evtParams[1]);t.rhApp.setGlobalStringAt(e,s)}},B.prototype={execute:function(t){let e=this.evtParams[0];if(e.tokens[0].code==rW.EXP_LONG&&0==e.tokens[1].code){var s=t.get_EventExpressionInt(this.evtParams[1]),r=t.rh4FastLoops.get(e.tokens[0].value);r.index=s}else{var r,n,a=t.get_EventExpressionString(this.evtParams[0]);if(0==a.length)return;var s=t.get_EventExpressionInt(this.evtParams[1]);for(n=0;n<t.rh4FastLoops.size();n++)if(r=t.rh4FastLoops.get(n),h.compareStringsIgnoreCase(r.name,a)){r.index=s;return}}}},G.prototype={execute:function(t){e=52==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0])-1:this.evtParams[0].value;let e,s=t.get_EventExpressionAny(this.evtParams[1]);t.rhApp.setGlobalValueAt(e,s)}},Y.prototype={execute:function(t){t.rhApp.setGlobalValueAt(this.num,this.value)}},j.prototype={execute:function(t){let e=this.evtParams[0];if(e.tokens[0].code==rW.EXP_LONG&&0==e.tokens[1].code){var s=t.rh4FastLoops.get(e.tokens[0].value);s.flags|=F.FLFLAG_STOP}else{var s,r,n=t.get_EventExpressionString(this.evtParams[0]);if(0==n.length)return;for(r=0;r<t.rh4FastLoops.size();r++)s=t.rh4FastLoops.get(r),h.compareStringsIgnoreCase(s.name,n)&&(s.flags|=F.FLFLAG_STOP)}}},X.prototype={execute:function(t){e=52==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0])-1:this.evtParams[0].value;let e,s=t.get_EventExpressionAny(this.evtParams[1]);t.rhApp.addGlobalValueAt(e,-s)}},W.prototype={execute:function(t){t.rhApp.addGlobalValueAt(this.num,-this.value)}},V.prototype={execute:function(t){if(!1==t.rhEvtProg.complexOnLoop&&this.evtParams[0].fastFastLoop){var e,s,r=t.rh4PosOnLoop[this.evtParams[0].fastFastLoop-1];if(!1==r.m_bOR){s=Math.floor(t.get_EventExpressionInt(this.evtParams[1]));var h=t.rh4FastLoops.get(r.fastLoopIndex);h.flags&=~F.FLFLAG_STOP;var n=!1;s<0&&(n=!0,s=10);var a=t.rh4CurrentFastLoop,l=t.rhEvtProg.rh2ActionLoop,u=t.rhEvtProg.rh2ActionLoopCount;for(t.rhEvtProg.rhEventGroup,h.index=0;h.index<s&&(t.rh4CurrentFastLoop=h.name,t.rhEvtProg.rh2ActionOn=!1,t.rhEvtProg.computeEventFastLoopList(r.pointers),(h.flags&F.FLFLAG_STOP)==0);h.index++)n&&(s=h.index+10);t.rhEvtProg.rh2ActionLoopCount=u,t.rhEvtProg.rh2ActionLoop=l,t.rh4CurrentFastLoop=a,t.rhEvtProg.rh2ActionOn=!0;return}}if(0!=(e=t.get_EventExpressionString(this.evtParams[0])).length){s=Math.floor(t.get_EventExpressionInt(this.evtParams[1]));var d=t.addFastLoop(e),h=t.rh4FastLoops.get(d);h=t.rh4FastLoops.get(d),h.flags&=~F.FLFLAG_STOP;var n=!1;s<0&&(n=!0,s=10);var a=t.rh4CurrentFastLoop,l=t.rhEvtProg.rh2ActionLoop,u=t.rhEvtProg.rh2ActionLoopCount;for(t.rhEvtProg.rhEventGroup,h.index=0;h.index<s&&(t.rh4CurrentFastLoop=h.name,t.rhEvtProg.rh2ActionOn=!1,t.rhEvtProg.handle_GlobalEvents(-983041),(h.flags&F.FLFLAG_STOP)==0);h.index++)n&&(s=h.index+10);t.rhEvtProg.rh2ActionLoopCount=u,t.rhEvtProg.rh2ActionLoop=l,t.rh4CurrentFastLoop=a,t.rhEvtProg.rh2ActionOn=!0}}},U.prototype={execute:function(t){0==t.rhMouseUsed&&t.hideMouse()}},K.prototype={execute:function(t){0==t.rhMouseUsed&&t.showMouse()}},q.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.rhApp.soundPlayer.lockChannel(e-1)}},z.prototype={execute:function(t){t.rhApp.soundPlayer.pause()}},J.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.rhApp.soundPlayer.pauseChannel(e-1)}},Q.prototype={execute:function(t){let e=this.evtParams[0];t.rhApp.soundPlayer.pauseSample(e.sndHandle)}},Z.prototype={execute:function(t){let e=this.evtParams[0],s=(e.sndFlags&aY.PSOUNDFLAG_UNINTERRUPTABLE)!=0,r=t.get_EventExpressionInt(this.evtParams[1]);t.rhApp.soundPlayer.play(e.sndHandle,1,r-1,s)}},tt.prototype={execute:function(t){let e=this.evtParams[0],s=(e.sndFlags&aY.PSOUNDFLAG_UNINTERRUPTABLE)!=0,r=t.get_EventExpressionInt(this.evtParams[1]),h=t.get_EventExpressionInt(this.evtParams[2]);t.rhApp.soundPlayer.play(e.sndHandle,h,r-1,s)}},te.prototype={execute:function(t){let e=this.evtParams[0],s=t.get_EventExpressionInt(this.evtParams[1]),r=(e.sndFlags&aY.PSOUNDFLAG_UNINTERRUPTABLE)!=0;t.rhApp.soundPlayer.play(e.sndHandle,s,-1,r)}},ti.prototype={execute:function(t){let e=this.evtParams[0],s=(e.sndFlags&aY.PSOUNDFLAG_UNINTERRUPTABLE)!=0;t.rhApp.soundPlayer.play(e.sndHandle,1,-1,s)}},ts.prototype={execute:function(t){t.rhApp.soundPlayer.resume()}},tr.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.rhApp.soundPlayer.resumeChannel(e-1)}},th.prototype={execute:function(t){let e=this.evtParams[0];t.rhApp.soundPlayer.resumeSample(e.sndHandle)}},to.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=t.get_EventExpressionInt(this.evtParams[1]);s>=0&&t.rhApp.soundPlayer.setPositionChannel(e-1,s)}},tn.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=t.get_EventExpressionInt(this.evtParams[1]);s>=0&&t.rhApp.soundPlayer.setFrequencyChannel(e-1,s)}},ta.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=t.get_EventExpressionInt(this.evtParams[1]);s>=0&&s<=100&&t.rhApp.soundPlayer.setVolumeChannel(e-1,s)}},th.prototype={execute:function(t){let e=this.evtParams[0];t.rhApp.soundPlayer.resumeSample(e.sndHandle)}},tl.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);e>=0&&e<=100&&t.rhApp.soundPlayer.setMainVolume(e)}},tu.prototype={execute:function(t){let e=this.evtParams[0].sndHandle,s=t.get_EventExpressionInt(this.evtParams[1]);s>=0&&t.rhApp.soundPlayer.setPositionSample(e,s)}},tc.prototype={execute:function(t){let e=this.evtParams[0].sndHandle,s=t.get_EventExpressionInt(this.evtParams[1]);s>=0&&t.rhApp.soundPlayer.setFrequencySample(e,s)}},td.prototype={execute:function(t){let e=this.evtParams[0].sndHandle,s=t.get_EventExpressionInt(this.evtParams[1]);s>=0&&s<=100&&t.rhApp.soundPlayer.setVolumeSample(e,s)}},tp.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.rhApp.soundPlayer.stopChannel(e-1)}},tm.prototype={execute:function(t){t.rhApp.soundPlayer.stopAllSounds()}},tf.prototype={execute:function(t){let e=this.evtParams[0];t.rhApp.soundPlayer.stopSample(e.sndHandle)}},t$.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.rhApp.soundPlayer.unlockChannel(e-1)}},tg.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&((e.rsHidden&nD.COF_FIRSTTEXT)!=0?(e.ros.obHide(),e.ros.rsFlags&=~l2.RSFLAG_VISIBLE,e.hoFlags|=a0.HOF_NOCOLLISION):(e.hoFlags|=a0.HOF_DESTROYED,t.destroy_Add(e.hoNumber)))}},tP.prototype={execute:function(t){let e=this.evtParams[1];t.txtDoDisplay(this,e.value)}},t8.prototype={execute:function(t){let e=this.evtParams[1],s=t.txtDoDisplay(this,e.value);if(s>=0){let r=this.evtParams[2],h=t.rhObjectList[s];2==r.code?(h.ros.rsFlash=r.timer,h.ros.rsFlashCpt=r.timer):(h.ros.rsFlash=t.get_EventExpressionInt(r),h.ros.rsFlashCpt=h.ros.rsFlash)}}},tE.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.txtChange(-1)}},t_.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=e.rsMini+1;e.txtChange(s)}}},tA.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=e.rsMini-1;s<0&&(s=0),e.txtChange(s)}}},t0.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(e=31==this.evtParams[0].code?this.evtParams[0].value:t.get_EventExpressionInt(this.evtParams[0])-1,s.txtChange(e))}},tv.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(24==this.evtParams[0].code?e=this.evtParams[0].color:(e=t.get_EventExpressionInt(this.evtParams[0]),e=h.swapRGB(e)),nD.setObjectTextColor(s,e))}},tO.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionString(this.evtParams[0]);(null==e.rsTextBuffer||null!=e.rsTextBuffer&&s!=e.rsTextBuffer)&&(e.txtSetString(s),e.txtChange(-1))}}},tS.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionAny(this.evtParams[0]);e.cpt_Add(s)}}},tT.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(this.evtParams[0].code==ay.PARAM_EXPRESSIONNUM?(e=t.get_EventExpressionInt(this.evtParams[0]),e=h.swapRGB(e)):e=this.evtParams[0].color,s.cpt_SetColor1(e))}},tb.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(this.evtParams[0].code==ay.PARAM_EXPRESSIONNUM?(e=t.get_EventExpressionInt(this.evtParams[0]),e=h.swapRGB(e)):e=this.evtParams[0].color,s.cpt_SetColor2(e))}},tC.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionAny(this.evtParams[0]);e.cpt_SetMax(s)}}},tL.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionAny(this.evtParams[0]);e.cpt_SetMin(s)}}},tI.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionAny(this.evtParams[0]);e.cpt_ToFloat(s),e.cpt_Change(s)}}},tF.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionAny(this.evtParams[0]);e.cpt_Sub(s)}}},ty.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.endApp()}},tx.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.hide()}},tR.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.jumpFrame(s)}}},tM.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.nextFrame()}},t2.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.pause()}},tw.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.previousFrame()}},tk.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.restartApp()}},tN.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.restartFrame()}},t1.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.resume()}},tD.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.setWidth(s)}}},t4.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.setHeight(s)}}},t3.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0])-1,r=t.get_EventExpressionString(this.evtParams[1]);e.setGlobalString(s,r)}}},tH.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0])-1,r=t.get_EventExpressionAny(this.evtParams[1]);e.setGlobalValue(s,r)}}},tB.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.show()}},t6.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=this.evtOi;e=t.rhApp.getLives()[s]+e,t.actPla_FinishLives(s,e)}},tG.prototype={execute:function(t){t.rh2InputMask[this.evtOi]=0}},t5.prototype={execute:function(t){t.rh2InputMask[this.evtOi]=255}},tY.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);if(!(e>ny.CTRLTYPE_KEYBOARD)){e==ny.CTRLTYPE_MOUSE&&(e=ny.CTRLTYPE_KEYBOARD);let s=this.evtOi;s>=4||(t.rhApp.getCtrlType()[s]=e)}}},tj.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);if(!(e>=8)){let s=this.evtOi;if(!(s>=4)){let r=this.evtParams[1].key;t.rhApp.pcCtrlKeys[s*ny.MAX_KEY+e]=r}}}},tX.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=this.evtOi;t.actPla_FinishLives(s,e)}},tW.prototype={execute:function(t){let e=this.evtOi;if(!(e>=ny.MAX_PLAYER)){let s=t.get_EventExpressionString(this.evtParams[0]);t.rhApp.playerNames[e]=s}}},t7.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=this.evtOi,r=t.rhApp.getScores();r[s]=e,t.update_PlayerObjects(s,ac.OBJ_SCORE,r[s])}},tV.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=this.evtOi;e=t.rhApp.getLives()[s]-e,t.actPla_FinishLives(s,e)}},tU.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=this.evtOi,r=t.rhApp.getScores();r[s]-=e,r[s]<0&&(r[s]=0),t.update_PlayerObjects(s,ac.OBJ_SCORE,r[s])}},tK.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=this.evtOi,r=t.rhApp.getScores();r[s]+=e,t.update_PlayerObjects(s,ac.OBJ_SCORE,r[s])}},tq.prototype={execute:function(t){e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer;for(var e,s=t.get_EventExpressionString(this.evtParams[1]),r=t.rh4TimerEvents,h=null;null!=r;)h=r,r=r.next;let n=new ao;null==h?t.rh4TimerEvents=n:h.next=n,n.type=ao.TIMEREVENTTYPE_ONESHOT,n.timer=t.rhTimer+e,n.name=s,n.next=null}},tz.prototype={execute:function(t){e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer;let e,s,r=t.get_EventExpressionInt(this.evtParams[1]);s=22==this.evtParams[2].code?t.get_EventExpressionInt(this.evtParams[2]):this.evtParams[2].timer;for(var h=t.get_EventExpressionString(this.evtParams[3]),n=t.rh4TimerEvents,a=null;null!=n;)a=n,n=n.next;let l=new ao;null==a?t.rh4TimerEvents=l:a.next=l,l.type=ao.TIMEREVENTTYPE_REPEAT,l.timer=t.rhTimer+e,l.timerNext=s,l.timerPosition=0,l.loops=r,l.index=0,l.next=null,l.name=h}},tJ.prototype={execute:function(t){e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer;let e,s=t.rhApp.timer;t.rhTimer=e,t.rhTimerOld=s-t.rhTimer,t.rhEvtProg.restartTimerEvents()}},tQ.prototype={execute:function(t){let e=this.evtParams[0],s=new ax;e.read_Position(t,0,s),t.setDisplay(s.x,s.y,s.layer,3)}},tZ.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.setDisplay(e,0,-1,1)}},t9.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.setDisplay(0,e,-1,2)}},et.prototype={execute:function(t){let e;24==this.evtParams[0].code?e=this.evtParams[0].color:(e=t.get_EventExpressionInt(this.evtParams[0]),e=h.swapRGB(e)),t.rhFrame.leBackground=e,t.rhApp.frameColor=e}},t9.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.setDisplay(0,e,-1,2)}},ee.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0])-1;t.deleteAllBackdrop2(e)}},ei.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0])-1,s=t.get_EventExpressionInt(this.evtParams[1]),r=t.get_EventExpressionInt(this.evtParams[2]),h=0!=t.get_EventExpressionInt(this.evtParams[3]);t.deleteBackdropAt(e,s,r,h)}},es.prototype={execute:function(t){t.rhApp.subAppStopped=!0,t.rhApp.isSubApp&&(t.rhQuit=nD.LOOPEXIT_ENDGAME)}},er.prototype={execute:function(t){let e;if(26==this.evtParams[0].code){if(e=this.evtParams[0].value,-1==t.rhApp.HCellToNCell(e))return}else{if((e=t.get_EventExpressionInt(this.evtParams[0])-1)<0||e>=4096)return;t.rhApp.bShiftFrameNumber&&e++,e|=32768}t.rhQuit=nD.LOOPEXIT_GOTOLEVEL,t.rhQuitParam=e,t.rhApp.subAppStopped=!0}},eh.prototype={execute:function(t){t.rhQuit=nD.LOOPEXIT_NEXTLEVEL,t.rhApp.subAppStopped=!0}},eo.prototype={execute:function(t){t.rh4PauseKey=this.evtParams[0].key,t.rhQuit=nD.LOOPEXIT_PAUSEGAME}},en.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);t.rhApp.gaFrameRate=e}},ea.prototype={execute:function(t){t.rhApp.gaNewFlags|=ny.GANF_VSYNC}},el.prototype={execute:function(t){t.rhApp.gaNewFlags&=~ny.GANF_VSYNC}},eu.prototype={execute:function(t){t.rhApp.enterFullScreen()}},ec.prototype={execute:function(t){t.rhApp.exitFullScreen()}},ed.prototype={execute:function(t){t.rh4PauseKey=-1,t.rhQuit=nD.LOOPEXIT_PAUSEGAME}},ep.prototype={execute:function(t){}},em.prototype={execute:function(t){t.rhApp.subAppStopped=!0,t.rhQuit=nD.LOOPEXIT_PREVLEVEL}},ef.prototype={execute:function(t){let e,s=t.get_EventExpressionInt(this.evtParams[0]),r=t.rhFrame.leHeight;for(t.rhFrame.leHeight=s,r==t.rhFrame.leVirtualRect.bottom&&(t.rhFrame.leVirtualRect.bottom=t.rhLevelSy=s),e=0;e<t.rhFrame.nLayers;e++)t.rhFrame.layers[e].resetLevelBackground();t.drawLevel()}},e$.prototype={execute:function(t){let e,s=t.get_EventExpressionInt(this.evtParams[0]),r=t.rhFrame.leWidth;for(t.rhFrame.leWidth=s,r==t.rhFrame.leVirtualRect.right&&(t.rhFrame.leVirtualRect.right=t.rhLevelSx=s),e=0;e<t.rhFrame.nLayers;e++)t.rhFrame.layers[e].resetLevelBackground();t.drawLevel()}},eg.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);e<t.rhFrame.leHeight&&(e=t.rhFrame.leHeight),e>2147479552&&(e=2147479552),t.rhFrame.leVirtualRect.bottom!=e&&(t.rhFrame.leVirtualRect.bottom=t.rhLevelSy=e)}},eP.prototype={execute:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);e<t.rhFrame.leWidth&&(e=t.rhFrame.leWidth),e>2147479552&&(e=2147479552),t.rhFrame.leVirtualRect.right!=e&&(t.rhFrame.leVirtualRect.right=t.rhLevelSx=e)}},e8.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=e.getChildMaxIndex();e.setChildIndex(s-1)}}},eE.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&(null!=e.roa&&e.roa.animIn(0),t.activeToBackdrop(e,this.evtParams[0].value))}},e_.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);(s%=360)<0&&(s+=360);let r=t.GetMBase(e);if(r){r.setAngle(s);return}let h=!1;0!=t.get_EventExpressionInt(this.evtParams[1])&&(h=!0);let n=!1;if((e.ros.rsFlags&l2.RSFLAG_ROTATE_ANTIA)!=0&&(n=!0),e.roc.rcAngle!=s||n!=h){e.roc.rcAngle=s,e.ros.rsFlags&=~l2.RSFLAG_ROTATE_ANTIA,h&&(e.ros.rsFlags|=l2.RSFLAG_ROTATE_ANTIA),e.roc.rcChanged=!0;let a=e.hoAdRunHeader.rhApp.imageBank.getImageInfoEx(e.roc.rcImage,e.roc.rcAngle,e.roc.rcScaleX,e.roc.rcScaleY);e.hoImgWidth=a.width,e.hoImgHeight=a.height,e.hoImgXSpot=a.xSpot,e.hoImgYSpot=a.ySpot}}}},eA.prototype={execute:function(t){let e,s,r=t.rhEvtProg.get_ActionObjects(this);null!=r&&(r.roa.animIn(0),24==this.evtParams[0].code?e=this.evtParams[0].color:(e=t.get_EventExpressionInt(this.evtParams[0]),e=h.swapRGB(e)),24==this.evtParams[1].code?s=this.evtParams[1].color:(s=t.get_EventExpressionInt(this.evtParams[1]),s=h.swapRGB(s)),e!=s&&(null==this.replace&&(this.replace=new C),this.replace.replaceColor(t,r,s,e)))}},e0.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionDouble(this.evtParams[0]);s<0&&(s=0);let r=!1;0!=t.get_EventExpressionInt(this.evtParams[1])&&(r=!0),e.ros.rsFlags&=~l2.RSFLAG_ROTATE_ANTIA,r&&(e.ros.rsFlags|=l2.RSFLAG_ROTATE_ANTIA),e.setScale(s,s)}}},ev.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionDouble(this.evtParams[0]);s<0&&(s=0);let r=!1;0!=t.get_EventExpressionInt(this.evtParams[1])&&(r=!0),e.ros.rsFlags&=~l2.RSFLAG_ROTATE_ANTIA,r&&(e.ros.rsFlags|=l2.RSFLAG_ROTATE_ANTIA),e.setScale(s,e.roc.rcScaleY)}}},eO.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionDouble(this.evtParams[0]);s<0&&(s=0);let r=!1;0!=t.get_EventExpressionInt(this.evtParams[1])&&(r=!0),e.ros.rsFlags&=~l2.RSFLAG_ROTATE_ANTIA,r&&(e.ros.rsFlags|=l2.RSFLAG_ROTATE_ANTIA),e.setScale(e.roc.rcScaleX,s)}}},eS.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&(null!=e.roa&&e.roa.animIn(0),t.activeToBackdrop(e,this.evtParams[0].value))}},eT.prototype={execute:function(t){if((32768&this.evtOiList)==0){this.qstCreate(t,this.evtOi);return}if((32767&this.evtOiList)!=32767){let e,s=t.rhEvtProg.qualToOiList[32767&this.evtOiList];for(e=0;e<s.qoiList.length;e+=2)this.qstCreate(t,s.qoiList[e])}},qstCreate:function(t,e){let s=this.evtParams[0],r=new ax;s.read_Position(t,16,r)&&t.f_CreateObject(s.cdpHFII,e,r.x,r.y,r.dir,0,t.rhFrame.nLayers-1,-1)}},eb.prototype={execute:function(t){t.rhQuit=nD.LOOPEXIT_NEWGAME}},eC.prototype={execute:function(t){t.rhQuit=nD.LOOPEXIT_RESTART}},eL.prototype={execute:function(t){let e=this.evtParams[0],s=new ax;if(e.read_Position(t,17,s)){s.bRepeat?(this.evtFlags|=I.ACTFLAGS_REPEAT,t.rhEvtProg.rh2ActionLoop=!0):this.evtFlags&=~I.ACTFLAGS_REPEAT;let r=t.f_CreateObject(e.cdpHFII,e.cdpOi,s.x,s.y,s.dir,0,s.layer,-1);if(r>=0){let h=t.rhObjectList[r];t.rhEvtProg.evt_AddCurrentObject(h),h&&h.hoType>=32&&t.addPhysicsAttractor(h);let n=t.GetMBase(h);n?n.CreateBody():null!=t.rhBox2DBase&&t.rh4Box2DBase.rAddNormalObject(h)}}}},eI.prototype={execute:function(t){let e=t.get_EventExpressionString(this.evtParams[0]),s=new ax;if(this.evtParams[1].read_Position(t,17,s)){for(s.bRepeat?(this.evtFlags|=I.ACTFLAGS_REPEAT,t.rhEvtProg.rh2ActionLoop=!0):this.evtFlags&=~I.ACTFLAGS_REPEAT,r=t.rhApp.OIList.getFirstOI();null!=r&&!(r.oiType>=2&&h.compareStringsIgnoreCase(r.oiName,e));r=t.rhApp.OIList.getNextOI());if(null!=r){var r,n=t.f_CreateObject(-1,r.oiHandle,s.x,s.y,s.dir,0,s.layer,-1);if(n>=0){let a=t.rhObjectList[n];t.rhEvtProg.evt_AddCurrentObject(a),a&&a.hoType>=32&&t.addPhysicsAttractor(a);let l=t.GetMBase(a);l?l.CreateBody():null!=t.rhBox2DBase&&t.rh4Box2DBase.rAddNormalObject(a)}}}}},eF.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionString(this.evtParams[0]);t.rhEvtProg.addForEach(s,e,this.evtOiList),t.rhEvtProg.callEndForEach=!0}}},ey.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionString(this.evtParams[1]);t.rhEvtProg.addForEach(s,e,this.evtOiList),null!=(e=t.rhEvtProg.get_CurrentObjects(this.evtParams[0].oiList))&&t.rhEvtProg.addForEach(s,e,this.evtParams[0].oiList),t.rhEvtProg.callEndForEach=!0}}},ex.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rom&&null!=e.rom.rmMovement.bounce&&e.rom.rmMovement.bounce()}},eR.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionString(this.evtParams[0]);e.roc.rcMovementType==l6.MVTYPE_TAPED&&e.rom.rmMovement.mtBranchNode(s)}}},eM.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.rov){let s=1<<t.get_EventExpressionInt(this.evtParams[0]);(e.rov.rvValueFlags&s)!=0?e.rov.rvValueFlags&=~s:e.rov.rvValueFlags|=s}}},e2.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rov&&((e.rov.rvValueFlags&this.mask)!=0?e.rov.rvValueFlags&=~this.mask:e.rov.rvValueFlags|=this.mask)}},ew.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.rov){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rov.rvValueFlags&=~(1<<s)}}},ek.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rov&&(e.rov.rvValueFlags&=~this.mask)}},eN.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){if(3==e.hoType){(e.rsHidden&nD.COF_FIRSTTEXT)!=0?(e.ros.obHide(),e.ros.rsFlags&=~l2.RSFLAG_VISIBLE,e.hoFlags|=a0.HOF_NOCOLLISION):(e.hoFlags|=a0.HOF_DESTROYED,t.destroy_Add(e.hoNumber));return}(e.hoFlags&a0.HOF_DESTROYED)==0&&(e.hoFlags|=a0.HOF_DESTROYED,(e.hoOEFlags&a$.OEFLAG_ANIMATIONS)!=0||(e.hoOEFlags&a$.OEFLAG_SPRITES)!=0?t.init_Disappear(e):(e.hoCallRoutine=!1,t.destroy_Add(e.hoNumber)))}}},e1.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);if(null!=s){e=53==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value;let r=this.evtParams[2];0==t.rhEvtProg.rh2ActionLoopCount?r.value=t.get_EventExpressionInt(this.evtParams[1]):r.value++,e>=0&&null!=s.rov&&(e>=s.rov.rvValues.length&&s.rov.growValues(e+10),s.rov.rvValues[e]=r.value)}}},eD.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.ros&&(e.ros.obHide(),e.ros.rsFlags&=~l2.RSFLAG_VISIBLE,2==this.evtParams[0].code?(e.ros.rsFlash=this.evtParams[0].timer,e.ros.rsFlashCpt=this.evtParams[0].timer):(e.ros.rsFlash=t.get_EventExpressionInt(this.evtParams[0]),e.ros.rsFlashCpt=e.ros.rsFlash))}},e4.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(e=10==this.evtParams[0].code?this.evtParams[0].value:t.get_EventExpressionInt(this.evtParams[0]),s.roa.animation_Force(e),s.roc.rcChanged=!0)}},e3.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(e=29==this.evtParams[0].code?t.get_Direction(this.evtParams[0].value):t.get_EventExpressionInt(this.evtParams[0]),s.roa.animDir_Force(e),s.roc.rcChanged=!0)}},eH.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.roa.animFrame_Force(s),e.roc.rcChanged=!0}}},eB.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(e=t.get_EventExpressionInt(this.evtParams[0]),s.roa.animSpeed_Force(e))}},e6.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionString(this.evtParams[0]);e.roc.rcMovementType==l6.MVTYPE_TAPED&&e.rom.rmMovement.mtGotoNode(s)}}},eG.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&nD.objectHide(e)}},e5.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.ros){let s=this.evtParams[0],r=s.value1,h=s.value2;r==l2.BOP_BLEND&&(h=0),e.ros.modifSpriteEffect(r,h)}}},eY.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=this.evtParams[0],r=new ax;if(s.read_Position(t,0,r)){let h=r.x,n=r.y;h-=e.hoX,n-=e.hoY;let a=t.GetMBase(e);if(null==a){let l=nD.get_DirFromPente(h,n);l&=31,t.getDir(e)!=l&&(e.roc.rcDir=l,e.roc.rcChanged=!0,e.rom.rmMovement.setDir(l))}else{let u=180*Math.atan2(-n,h)/3.141592653589;u<0&&(u=360+u),a.setAngle(u)}}}}},ej.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);null!=e.rom&&e.rom.rmMovement.setMaxSpeed(s)}}},eX.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.ros){let s=t.rhEvtProg.get_ParamActionObjects(this.evtParams[0].oiList,this);if(null==s)return;let r=s.getChildIndex();e.getChildIndex()<r&&e.setChildIndex(r+1)}}},eW.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.ros){let s=t.rhEvtProg.get_ParamActionObjects(this.evtParams[0].oiList,this);if(null==s)return;let r=s.getChildIndex();r<e.getChildIndex()&&e.setChildIndex(r)}}},e7.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.ros){let s=t.get_EventExpressionInt(this.evtParams[0]);s>0&&s<=t.rhFrame.nLayers&&e.hoLayer!=s-1&&(s-=1,t.rhFrame.layers[s],null!=e.ros&&(e.hoLayer=s,e.ros.rsLayer=s,e.delSprite(),e.ros.createSprite(!1)))}}},eV.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rom&&e.rom.nextMovement(e)}},eU.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rom&&e.rom.previousMovement(e)}},eK.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&(e.roa.animation_Restore(),e.roc.rcChanged=!0)}},eq.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&(e.roa.animDir_Restore(),e.roc.rcChanged=!0)}},ez.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&(e.roa.animFrame_Restore(),e.roc.rcChanged=!0)}},eJ.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.roa.animSpeed_Restore()}},eQ.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rom&&e.rom.rmMovement.reverse()}},eZ.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value,null!=s.rom&&s.rom.selectMovement(s,e))}},e9.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.setAcc(s)}}},it.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.ros){let s=h.clamp(255-t.get_EventExpressionInt(this.evtParams[0]),0,255),r=(e.ros.rsEffect&l2.BOP_RGBAFILTER)==0;e.ros.rsEffect=e.ros.rsEffect&l2.BOP_MASK|l2.BOP_RGBAFILTER;let n=16777215;r||(n=e.ros.rsEffectParam);let a=16777215&n;e.ros.rsEffectParam=s<<24|a,e.ros.modifSpriteEffect(e.ros.rsEffect,e.ros.rsEffectParam)}}},ie.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]),r=nD.getObjectFont(e);0!=s?r.lfWeight=700:r.lfWeight=400,nD.setObjectFont(e,r,null)}}},ii.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.setDec(s)}}},is.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(e=29==this.evtParams[0].code?t.get_Direction(this.evtParams[0].value):t.get_EventExpressionInt(this.evtParams[0]),e&=31,t.getDir(s)!=e&&(s.roc.rcDir=e,s.roc.rcChanged=!0,s.rom.rmMovement.setDir(e),2==s.hoType&&s.roa.animIn(0)))}},ir.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=this.evtParams[0].value;e.rom.rmMovement.set8Dirs(s)}}},ih.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=this.evtParams[0].string,r=l2.BOP_COPY;null!=s&&0!=s.length&&("Add"==s?r=l2.BOP_ADD:"Invert"==s?r=l2.BOP_INVERT:"Sub"==s?r=l2.BOP_SUB:"Mono"==s?r=l2.BOP_MONO:"Blend"==s?r=l2.BOP_BLEND:"XOR"==s?r=l2.BOP_XOR:"OR"==s?r=l2.BOP_OR:"AND"==s&&(r=l2.BOP_AND)),e.ros.modifSpriteEffect(r,e.ros.rsEffectParam)}}},(function t(){}).prototype={execute:function(t){}},io.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.rov){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rov.rvValueFlags|=1<<s}}},ia.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rov&&(e.rov.rvValueFlags|=this.mask)}},il.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionString(this.evtParams[0]),r=nD.getObjectFont(e);r.lfFaceName=s,nD.setObjectFont(e,r,null)}}},iu.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]),r=t.get_EventExpressionInt(this.evtParams[1]),n=nD.getObjectFont(e),a=n.lfHeight;if(n.lfHeight=h.heightNormalToLF(s),0==r)nD.setObjectFont(e,n,null);else if(s!=a){let l=new E,u=1;0!=a&&(u=s/a),l.right=Math.floor(e.hoImgWidth*u),l.bottom=Math.floor(e.hoImgHeight*u),l.left=0,l.top=0,nD.setObjectFont(e,n,l)}}}},ic.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.setGravity(s)}}},id.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]),r=nD.getObjectFont(e);r.lfItalic=s,nD.setObjectFont(e,r,null)}}},ip.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=this.evtParams[0],r=new ax;if(s.read_Position(t,1,r)&&(nD.setXPosition(e,r.x),nD.setYPosition(e,r.y),-1!=r.dir)){let h=r.dir&=31;t.getDir(e)!=h&&(e.roc.rcDir=h,e.roc.rcChanged=!0,e.rom.rmMovement.setDir(h),2==e.hoType&&e.roa.animIn(0))}}}},im.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);if(null!=s&&null!=s.ros){let r=t.get_EventExpressionInt(this.evtParams[0]),n=(s.ros.rsEffect&l2.BOP_RGBAFILTER)==0;s.ros.rsEffect=s.ros.rsEffect&l2.BOP_MASK|l2.BOP_RGBAFILTER;let a=s.ros.rsEffectParam,l=(e=n?-1==s.ros.rsEffectParam?4278190080:255-2*s.ros.rsEffectParam<<24:4278190080&a)|h.swapRGB(16777215&r);s.ros.rsEffectParam=l,s.ros.modifSpriteEffect(s.ros.rsEffect,s.ros.rsEffectParam)}}},i$.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.setRotSpeed(s)}}},ig.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=e.ros){let s=t.get_EventExpressionInt(this.evtParams[0]);s<0&&(s=0),s>128&&(s=128),e.roc.rcChanged=!0,e.ros.setSemiTransparency(s)}}},iP.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(22==this.evtParams[0].code?(e=t.get_EventExpressionInt(this.evtParams[0]),e=h.swapRGB(e)):e=this.evtParams[0].color,nD.setObjectTextColor(s,e))}},i8.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]),r=nD.getObjectFont(e);r.lfUnderline=s,nD.setObjectFont(e,r,null)}}},iE.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);if(null!=s&&(e=53==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value)>=0&&null!=s.rov){e>=s.rov.rvValues.length&&s.rov.growValues(e+10);let r=t.get_EventExpressionAny(this.evtParams[1]);s.rov.rvValues[e]=r}}},i_.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&this.num>=0&&null!=e.rov&&(this.num>=e.rov.rvValues.length&&e.rov.growValues(this.num+10),e.rov.rvValues[this.num]=this.value)}},iA.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);null!=s&&(e=62==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value)>=0&&null!=s.rov&&(e>s.rov.rvStrings.length&&s.rov.rvStrings.growStrings(e+10),s.rov.rvStrings[e]=t.get_EventExpressionString(this.evtParams[1]))}},i0.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);nD.setXPosition(e,Math.floor(s))}}},iv.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);nD.setYPosition(e,Math.floor(s))}}},iO.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=this.evtParams[0],r=new ax;s.read_Position(t,17,r)&&e.shtCreate(s,r.x,r.y,r.dir)}}},iS.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=new ax;if(this.evtParams[0].read_Position(t,17,s)){let r=new ax;if(this.evtParams[1].read_Position(t,0,r)){let h=r.x,n=r.y,a=nD.get_DirFromPente(h-s.x,n-s.y);e.shtCreate(this.evtParams[0],s.x,s.y,a)}}}}},iT.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&nD.objectShow(e)}},ib.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&t.rhEvtProg.rh2ShuffleBuffer.add(e)}},iC.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=t.get_EventExpressionInt(this.evtParams[0]);null!=e.rom&&e.rom.rmMovement.setSpeed(s)}}},iL.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.setChildIndex(0)}},iI.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=e.getChildMaxIndex();e.setChildIndex(s)}}},iF.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&e.setChildIndex(0)}},e8.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=e.getChildMaxIndex();e.setChildIndex(s)}}},iy.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rom&&e.rom.rmMovement.start()}},ix.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&(e.roa.raAnimStopped=!1)}},iR.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rom&&e.rom.rmMovement.stop()}},iM.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&(e.roa.raAnimStopped=!0)}},i2.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);if(null!=s&&(e=53==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value)>=0&&null!=s.rov){e>=s.rov.rvValues.length&&s.rov.growValues(e+10);let r=t.get_EventExpressionAny(this.evtParams[1]);s.rov.rvValues[e]+=r}}},iw.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&this.num>=0&&null!=e.rov&&(this.num>=e.rov.rvValues.length&&e.rov.growValues(this.num+10),e.rov.rvValues[this.num]+=this.value)}},ik.prototype={execute:function(t){let e,s=t.rhEvtProg.get_ActionObjects(this);if(null!=s&&(e=53==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value)>=0&&null!=s.rov){e>=s.rov.rvValues.length&&s.rov.growValues(e+10);let r=t.get_EventExpressionAny(this.evtParams[1]);s.rov.rvValues[e]-=r}}},iN.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&this.num>=0&&null!=e.rov&&(this.num>=e.rov.rvValues.length&&e.rov.growValues(this.num+10),e.rov.rvValues[this.num]-=this.value)}},i1.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=e.rom&&(e.rom.rmEventFlags|=ur.EF_WRAP)}},iD.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.callMovement(I.ACT_EXTSETFRICTION,s)}}},i4.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.callMovement(I.ACT_EXTSETELASTICITY,s)}}},i3.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.callMovement(I.ACT_EXTAPPLYANGULARIMPULSE,s)}}},iH.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=[];s[0]=t.get_EventExpressionInt(this.evtParams[0]),s[1]=t.get_EventExpressionInt(this.evtParams[1]),e.rom.rmMovement.callMovement(I.ACT_EXTAPPLYFORCE,s)}}},iB.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.callMovement(I.ACT_EXTAPPLYTORQUE,s)}}},i6.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=[];s[0]=t.get_EventExpressionDouble(this.evtParams[0]),s[1]=t.get_EventExpressionDouble(this.evtParams[1]),e.rom.rmMovement.callMovement(I.ACT_EXTSETLINEARVELOCITY,s)}}},iG.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=t.get_EventExpressionInt(this.evtParams[0]);e.rom.rmMovement.callMovement(I.ACT_EXTSETANGULARVELOCITY,s)}}},i5.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e&&null!=t.GetMBase(e)){let s=[];s[0]=t.get_EventExpressionInt(this.evtParams[0]),s[1]=t.get_EventExpressionInt(this.evtParams[1]),e.rom.rmMovement.callMovement(I.ACT_EXTAPPLYIMPULSE,s)}}},iY.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=t.GetMBase(e)&&e.rom.rmMovement.callMovement(I.ACT_EXTSTOPFORCE,0)}},ij.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);null!=e&&null!=t.GetMBase(e)&&e.rom.rmMovement.callMovement(I.ACT_EXTSTOPTORQUE,0)}},iX.NUM_ONEVENT=6,iX.CND_ONLOOP=-983041,iX.CND_OR=-1507329,iX.CND_ORLOGICAL=-1572865,iX.create=function(t){let e,s=t.file.getFilePointer(),r=t.file.readAShort(),h=null,n=t.file.readAInt();switch(n){case -2555905:h=new rX;break;case -2490369:case -2097153:h=new i9;break;case -2424833:case -2031617:h=new iZ;break;case -2359297:case -1966081:h=new iQ;break;case -2293761:case -1900545:h=new iJ;break;case -2228225:case -1835009:h=new iz;break;case -2162689:case -1769473:h=new iq;break;case -1703937:case -1572865:case -1507329:case -655361:case -589825:case -524289:case -65537:case -131075:h=new iW;break;case -1638401:h=new iV;break;case -1441793:h=new si;break;case -1245185:h=new st;break;case -983041:h=new so;break;case -720897:h=new se;break;case -458753:h=new iK;break;case -393217:h=new sr;break;case -327681:h=new sh;break;case -262145:h=new sn;break;case -196609:h=new ss;break;case -131073:h=new iU;break;case -1:case -65539:h=new i7;break;case -524290:h=new ri;break;case -458754:h=new rt;break;case -327682:h=new rs;break;case -131074:h=new s9;break;case -2:h=new re;break;case -458755:h=new sI;break;case -393219:h=new sF;break;case -327683:h=new sy;break;case -262147:h=new sx;break;case -196611:h=new sR;break;case -3:h=new sM;break;case -458756:h=new sD;break;case -393220:h=new s4;break;case -327684:h=new s2;break;case -262148:h=new sk;break;case -196612:h=new sw;break;case -131076:h=new sN;break;case -65540:h=new s1;break;case -4:h=new s3;break;case -720902:h=new sJ;break;case -655366:h=new sQ;break;case -589830:h=new sz;break;case -524294:h=new sZ;break;case -458758:h=new sK;break;case -393222:h=new sV;break;case -327686:h=new s7;break;case -262150:h=new sW;break;case -196614:h=new sq;break;case -131078:h=new sU;break;case -65542:h=new sj;break;case -6:h=new sX;break;case -327687:h=new sB;break;case -262151:h=new sG;break;case -196615:h=new sH;break;case -131079:h=new s6;break;case -65543:h=new sY;break;case -7:h=new s5;break;case -1441797:h=new su;break;case -1376261:h=new sp;break;case -1310725:h=new sf;break;case -1245189:h=new sg;break;case -1179653:h=new sT;break;case -1114117:h=new sc;break;case -1048581:h=new sa;break;case -983045:h=new s8;break;case -917509:h=new s0;break;case -851973:h=new sO;break;case -786437:h=new s_;break;case -720901:h=new sm;break;case -655365:h=new s$;break;case -458757:h=new sP;break;case -393221:h=new sb;break;case -327685:h=new sd;break;case -262149:h=new sl;break;case -196613:h=new sE;break;case -131077:h=new sv;break;case -65541:h=new sS;break;case -5:h=new sA;break;case -5308409:h=new rc;break;case -5439484:h=new rr;break;case -5373948:h=new ro;break;case -5308412:h=new rh;break;case -5505015:h=new rl;break;case -5439479:h=new ru;break;case -5373943:h=new rn;break;case -5308407:h=new ra;break;default:switch(4294901760&n){case -2818048:case -2752512:h=new r_;break;case -2686976:h=new sL;break;case -2621440:h=new rk;break;case -2555904:h=new rN;break;case -2490368:h=new r2;break;case -2424832:h=new ry;break;case -2359296:h=new r0;break;case -2293760:h=new rG;break;case -2228224:h=new sC;break;case -2162688:h=new rD;break;case -2097152:h=new rH;break;case -2031616:h=new r4;break;case -1966080:h=new r3;break;case -1900544:h=new rY;break;case -1835008:h=new rd;break;case -1769472:h=new rE;break;case -1703936:h=new rA;break;case -1638400:h=new rI;break;case -1572864:h=new rL;break;case -1507328:h=new rx;break;case -1441792:h=new r1;break;case -1376256:h=new rb;break;case -1310720:h=new r6;break;case -1245184:h=new r$;break;case -1179648:h=new rg;break;case -1114112:h=new rv;break;case -1048576:h=new rO;break;case -983040:h=new r8;break;case -917504:h=new rT;break;case -851968:h=new rS;break;case -786432:h=new rB;break;case -720896:h=new rF;break;case -655360:h=new rw;break;case -589824:h=new rM;break;case -524288:h=new rC;break;case -458752:h=new rj;break;case -393216:h=new rf;break;case -327680:h=new r5;break;case -262144:h=new rR;break;case -196608:h=new rm;break;case -131072:h=new rp;break;case -65536:h=new rP;break;default:h=new lB}}if(null!=h&&(h.evtCode=n,h.evtOi=t.file.readShort(),h.evtOiList=t.file.readShort(),h.evtFlags=t.file.readAByte(),h.evtFlags2=t.file.readAByte(),h.evtNParams=t.file.readAByte(),h.evtDefType=t.file.readAByte(),h.evtIdentifier=t.file.readAShort(),h.evtNParams>0))for(e=0,h.evtParams=Array(h.evtNParams);e<h.evtNParams;e++)h.evtParams[e]=ay.create(t);return t.file.seek(s+r),h},iX.negaTRUE=function(t){return!(t.evtFlags2&at.EVFLAG2_NOT)},iX.negaFALSE=function(t){return!!(t.evtFlags2&at.EVFLAG2_NOT)},iX.negate=function(t,e){return t.evtFlags2&at.EVFLAG2_NOT?!e:e},iX.compute_GlobalNoRepeat=function(t){let e=t.rhEvtProg.rhEventGroup,s=e.evgInhibit;e.evgInhibit=t.rhLoopCount;let r=t.rhLoopCount;return r!=s&&--r!=s},iX.compute_NoRepeatCol=function(t,e){let s,r=e.hoBaseNoRepeat;if(null==r)r=new P,e.hoBaseNoRepeat=r;else for(s=0;s<r.size();s++)if(r.get(s)==t)return!1;if(r.add(t),null==(r=e.hoPrevNoRepeat))return!0;for(s=0;s<r.size();s++)if(r.get(s)==t)return!1;return!0},iX.checkMark=function(t,e){return 0!=e&&(e==t.rhLoopCount||e==t.rhLoopCount-1)},iW.prototype={eva1:function(t,e){return!1},eva2:function(t){return!1}},i7.prototype={eva1:function(t,e){return!0},eva2:function(t){return!0}},iX.prototype={compute_NoRepeat:function(t){return iX.compute_NoRepeatCol(this.evtIdentifier,t)},evaChooseValueOld:function(t,e){for(var s=0,r=t.rhEvtProg.evt_FirstObjectFromType(ac.OBJ_SPR);null!=r;){s++;let h=t.get_EventExpressionInt(this.evtParams[0]);!1==e.evaluate(r,h)&&(s--,t.rhEvtProg.evt_DeleteCurrentObject()),r=t.rhEvtProg.evt_NextObjectFromType()}return 0!=s},evaChooseValue:function(t,e){for(var s=0,r=t.rhEvtProg.evt_FirstObjectFromType(-1);null!=r;){s++;let h=t.get_EventExpressionInt(this.evtParams[0]);!1==e.evaluate(r,h)&&(s--,t.rhEvtProg.evt_DeleteCurrentObject()),r=t.rhEvtProg.evt_NextObjectFromType()}return 0!=s},evaExpObject:function(t,e){var s,r=t.rhEvtProg.evt_FirstObject(this.evtOiList),h=t.rhEvtProg.evtNSelectedObjects,n=this.evtParams[0],a=n.tokens[0];if((a.code==rW.EXP_LONG||a.code==rW.EXP_DOUBLE)&&0==n.tokens[1].code)for(var s=a.value;null!=r;)!1==e.evaExpRoutine(r,s,n.comparaison)&&(h--,t.rhEvtProg.evt_DeleteCurrentObject()),r=t.rhEvtProg.evt_NextObject();else for(;null!=r;)s=t.get_EventExpressionInt(n),!1==e.evaExpRoutine(r,s,n.comparaison)&&(h--,t.rhEvtProg.evt_DeleteCurrentObject()),r=t.rhEvtProg.evt_NextObject();return 0!=h},evaObject:function(t,e){for(var s=t.rhEvtProg.evt_FirstObject(this.evtOiList),r=t.rhEvtProg.evtNSelectedObjects;null!=s;)!1==e.evaObjectRoutine(s)&&(r--,t.rhEvtProg.evt_DeleteCurrentObject()),s=t.rhEvtProg.evt_NextObject();return 0!=r},compareCondition:function(t,e,s){let r=t.get_EventExpressionAny(this.evtParams[e]),h=this.evtParams[e].comparaison;return nD.compareTo(s,r,h)},isColliding:function(t){if(t.rhEvtProg.rh4ConditionsFalse)return t.rhEvtProg.evt_FirstObject(this.evtOiList),t.rhEvtProg.evt_FirstObject(this.evtParams[0].oiList),!1;let e,s,r,h,n=!1;(this.evtFlags2&at.EVFLAG2_NOT)!=0&&(n=!0);let a=t.rhEvtProg.evt_FirstObject(this.evtOiList);if(null==a)return iX.negaFALSE(this);let l=t.rhEvtProg.evtNSelectedObjects,u=this.evtParams[0].oi;u>=0?(t.isColArray[0]=u,t.isColArray[1]=this.evtParams[0].oiList,e=t.isColArray):e=t.rhEvtProg.qualToOiList[32767&this.evtParams[0].oiList].qoiList;let d=!1,p=new P;do{if(null==(s=t.objectAllCol_IXY(a,a.roc.rcImage,a.roc.rcAngle,a.roc.rcScaleX,a.roc.rcScaleY,a.hoX,a.hoY,e)))!1==n&&(l--,t.rhEvtProg.evt_DeleteCurrentObject());else{for(r=0,d=!1;r<s.size();r++)((h=s.get(r)).hoFlags&a0.HOF_DESTROYED)==0&&(p.add(h),d=!0);!0==n?!0==d&&(l--,t.rhEvtProg.evt_DeleteCurrentObject()):!1==d&&(l--,t.rhEvtProg.evt_DeleteCurrentObject())}a=t.rhEvtProg.evt_NextObject()}while(null!=a);if(0==l||null==(a=t.rhEvtProg.evt_FirstObject(this.evtParams[0].oiList)))return!1;if(l=t.rhEvtProg.evtNSelectedObjects,!1==n){do{for(r=0;r<p.size()&&a!=(h=p.get(r));r++);r==p.size()&&(l--,t.rhEvtProg.evt_DeleteCurrentObject()),a=t.rhEvtProg.evt_NextObject()}while(null!=a);return 0!=l}do{for(r=0;r<p.size();r++)if(a==(h=p.get(r))){l--,t.rhEvtProg.evt_DeleteCurrentObject();break}a=t.rhEvtProg.evt_NextObject()}while(null!=a);return 0!=l}},iV.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=t.get_EventExpressionInt(this.evtParams[1]);return!!(e>=s||s>=1&&e>0&&e<=s&&t.random(s)<=e)}},iU.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionAny(this.evtParams[0]),s=t.get_EventExpressionAny(this.evtParams[1]),r=this.evtParams[1].comparaison;return nD.compareTo(e,s,r)}},iK.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){e=52==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0])-1:this.evtParams[0].value;let e,s=t.rhApp.getGlobalValueAt(e),r=t.get_EventExpressionAny(this.evtParams[1]),h=this.evtParams[1].comparaison;return nD.compareTo(s,r,h)}},iq.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0].value;return t.rhApp.getGlobalValueAt(e)==this.evtParams[1].tokens[0].value}},iz.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0].value;return t.rhApp.getGlobalValueAt(e)!=this.evtParams[1].tokens[0].value}},iJ.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0].value;return t.rhApp.getGlobalValueAt(e)<=this.evtParams[1].tokens[0].value}},iQ.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0].value;return t.rhApp.getGlobalValueAt(e)<this.evtParams[1].tokens[0].value}},iZ.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0].value;return t.rhApp.getGlobalValueAt(e)>=this.evtParams[1].tokens[0].value}},i9.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0].value;return t.rhApp.getGlobalValueAt(e)>this.evtParams[1].tokens[0].value}},st.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){e=59==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0])-1:this.evtParams[0].value;let e,s=t.rhApp.getGlobalStringAt(e),r=t.get_EventExpressionAny(this.evtParams[1]),h=this.evtParams[1].comparaison;return nD.compareTo(s,r,h)}},se.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return(t.rhEvtProg.events[this.evtParams[0].pointer].evgFlags&n9.EVGFLAGS_INACTIVE)!=0?iX.negaFALSE(this):iX.negaTRUE(this)}},si.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhEvtProg.rhEventGroup;return(e.evgFlags&n9.EVGFLAGS_ONCE)==0&&(e.evgFlags|=n9.EVGFLAGS_ONCE,!0)}},ss.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhEvtProg.rhEventGroup;return(e.evgFlags&n9.EVGFLAGS_NOMORE)!=0||(e.evgFlags&(n9.EVGFLAGS_REPEAT|n9.EVGFLAGS_NOTALWAYS))==0&&(this.evtParams[0].code==ay.PARAM_EXPRESSIONNUM?e.evgInhibit=t.get_EventExpressionInt(this.evtParams[0])/10:e.evgInhibit=this.evtParams[0].timer/10,e.evgInhibitCpt=0,e.evgFlags|=n9.EVGFLAGS_NOMORE,!0)}},sr.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhEvtProg.rhEventGroup;return(e.evgFlags&n9.EVGFLAGS_NOTALWAYS)!=0||(e.evgFlags&n9.EVGFLAGS_NOMORE)==0&&(e.evgInhibit=-2,e.evgFlags|=n9.EVGFLAGS_NOTALWAYS,!0)}},sh.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhEvtProg.rhEventGroup;return(e.evgFlags&n9.EVGFLAGS_ONCE)==0&&(e.evgFlags|=n9.EVGFLAGS_ONCE,!0)}},so.prototype={eva1:function(t,e){let s=this.evtParams[0];if(2==s.tokens.length&&262143==s.tokens[0].code&&0==s.tokens[1].code)return!!h.compareStringsIgnoreCase(t.rh4CurrentFastLoop,s.tokens[0].string);let r=t.get_EventExpressionString(s);return!1!=h.compareStringsIgnoreCase(t.rh4CurrentFastLoop,r)&&(t.rhEvtProg.rh2ActionOn=!1,!0)},eva2:function(t){return!1}},sn.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhEvtProg.rhEventGroup;return(e.evgFlags&n9.EVGFLAGS_REPEAT)!=0||(e.evgFlags&n9.EVGFLAGS_NOMORE)==0&&(e.evgInhibitCpt=t.get_EventExpressionInt(this.evtParams[0]),e.evgFlags|=n9.EVGFLAGS_REPEAT,!0)}},sa.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){if(t.rhEvtProg.count_ObjectsFromType(0,-1),0==t.rhEvtProg.evtNSelectedObjects)return!1;let e=t.random(t.rhEvtProg.evtNSelectedObjects),s=t.rhEvtProg.count_ObjectsFromType(0,e);return t.rhEvtProg.evt_DeleteCurrent(),t.rhEvtProg.evt_AddCurrentObject(s),!0}},sl.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){if(t.rhEvtProg.count_ObjectsFromType(ac.OBJ_SPR,-1),0==t.rhEvtProg.evtNSelectedObjects)return!1;let e=t.random(t.rhEvtProg.evtNSelectedObjects),s=t.rhEvtProg.count_ObjectsFromType(ac.OBJ_SPR,e);return t.rhEvtProg.evt_DeleteCurrentType(ac.OBJ_SPR),t.rhEvtProg.evt_AddCurrentObject(s),!0}},su.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=t.get_EventExpressionInt(this.evtParams[1]),r=t.get_EventExpressionInt(this.evtParams[2]),h=t.get_EventExpressionInt(this.evtParams[3]);return 0!=t.rhEvtProg.select_LineOfSight(e,s,r,h)}},sc.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return 0!=t.rhEvtProg.select_ZoneTypeObjects(this.evtParams[0],0)}},sd.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return 0!=t.rhEvtProg.select_ZoneTypeObjects(this.evtParams[0],ac.OBJ_SPR)}},sp.prototype=h.extend(new iX,{eva1:function(t,e){return this.eva2(t)},eva2:function(t){return this.evaChooseValue(t,this)},evaluate:function(t,e){return null!=t.rov&&(t.rov.rvValueFlags&1<<e)==0}}),sm.prototype=h.extend(new iX,{eva1:function(t,e){return this.eva2(t)},eva2:function(t){return this.evaChooseValueOld(t,this)},evaluate:function(t,e){return null!=t.rov&&(t.rov.rvValueFlags&1<<e)==0}}),sf.prototype=h.extend(new iX,{eva1:function(t,e){return this.eva2(t)},eva2:function(t){return this.evaChooseValue(t,this)},evaluate:function(t,e){return null!=t.rov&&(t.rov.rvValueFlags&1<<e)!=0}}),s$.prototype=h.extend(new iX,{eva1:function(t,e){return this.eva2(t)},eva2:function(t){return this.evaChooseValueOld(t,this)},evaluate:function(t,e){return null!=t.rov&&(t.rov.rvValueFlags&1<<e)!=0}}),sg.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){for(var e=0,s=t.rhEvtProg.evt_FirstObjectFromType(-1);null!=s;){e++,r=53==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value;var r,h=t.get_EventExpressionAny(this.evtParams[1]);if(null!=s.rov){let n=s.rov.getValue(r),a=this.evtParams[1].comparaison;!1==nD.compareTo(n,h,a)&&(t.rhEvtProg.evt_DeleteCurrentObject(),e--)}s=t.rhEvtProg.evt_NextObjectFromType()}return 0!=e}},sP.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){for(var e=0,s=t.rhEvtProg.evt_FirstObjectFromType(ac.OBJ_SPR);null!=s;){e++,r=53==evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value;var r,h=t.get_EventExpressionAny(this.evtParams[1]);if(null!=s.rov){let n=s.rov.getValue(r),a=this.evtParams[1].comparaison;!1==nD.compareTo(n,h,a)&&(t.rhEvtProg.evt_DeleteCurrentObject(),e--)}s=t.rhEvtProg.evt_NextObjectFromType()}return 0!=e}},s8.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0];if(t.rhEvtProg.count_ZoneTypeObjects(e,-1,0),0==t.rhEvtProg.evtNSelectedObjects)return!1;let s=t.random(t.rhEvtProg.evtNSelectedObjects),r=t.rhEvtProg.count_ZoneTypeObjects(e,s,0);return t.rhEvtProg.evt_DeleteCurrent(),t.rhEvtProg.evt_AddCurrentObject(r),!0}},sE.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0];if(t.rhEvtProg.count_ZoneTypeObjects(e,-1,ac.OBJ_SPR),0==t.rhEvtProg.evtNSelectedObjects)return!1;let s=t.random(t.rhEvtProg.evtNSelectedObjects),r=t.rhEvtProg.count_ZoneTypeObjects(e,s,ac.OBJ_SPR);return t.rhEvtProg.evt_DeleteCurrent(),t.rhEvtProg.evt_AddCurrentObject(r),!0}},s_.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return t.rhEvtProg.count_ZoneTypeObjects(this.evtParams[0],-1,0),0==t.rhEvtProg.evtNSelectedObjects}},sA.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return t.rhEvtProg.count_ZoneTypeObjects(this.evtParams[0],-1,ac.OBJ_SPR),0==t.rhEvtProg.evtNSelectedObjects}},s0.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionAny(this.evtParams[0]),s=this.evtParams[0].comparaison;return nD.compareTo(t.rhNObjects,e,s)}},sv.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){t.rhEvtProg.count_ObjectsFromType(ac.OBJ_SPR,-1);let e=t.get_EventExpressionAny(this.evtParams[0]),s=this.evtParams[0].comparaison;return nD.compareTo(t.rhEvtProg.evtNSelectedObjects,e,s)}},sO.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){t.rhEvtProg.count_ZoneTypeObjects(this.evtParams[0],-1,0);let e=t.get_EventExpressionAny(this.evtParams[1]),s=this.evtParams[1].comparaison;return nD.compareTo(t.rhEvtProg.evtNSelectedObjects,e,s)}},sS.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){t.rhEvtProg.count_ZoneTypeObjects(this.evtParams[0],-1,ac.OBJ_SPR);let e=t.get_EventExpressionAny(this.evtParams[1]),s=this.evtParams[1].comparaison;return nD.compareTo(t.rhEvtProg.evtNSelectedObjects,e,s)}},sT.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);return t.rhEvtProg.pickFromId(e)}},sb.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);return t.rhEvtProg.pickFromId(e)}},sC.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){if(t.rhEvtProg.count_ObjectsFromOiList(this.evtOiList,-1),0==t.rhEvtProg.evtNSelectedObjects)return!1;let e=t.random(t.rhEvtProg.evtNSelectedObjects),s=t.rhEvtProg.count_ObjectsFromOiList(this.evtOiList,e);return t.rhEvtProg.evt_ForceOneObject(this.evtOiList,s),!0}},sL.prototype={eva1:function(t,e){let s=t.get_EventExpressionString(this.evtParams[0]);return!!(null!=t.rh4CurrentForEach&&h.compareStringsIgnoreCase(t.rh4CurrentForEach.name,s)||null!=t.rh4CurrentForEach2&&h.compareStringsIgnoreCase(t.rh4CurrentForEach2.name,s))&&(t.rhEvtProg.evt_ForceOneObject(this.evtOiList,e),!0)},eva2:function(t){let e=null,s=t.get_EventExpressionString(this.evtParams[0]),r=t.rh4CurrentForEach;if(null!=r&&h.compareStringsIgnoreCase(r.name,s)&&r.oi==this.evtOiList||null!=(r=t.rh4CurrentForEach2)&&h.compareStringsIgnoreCase(r.name,s)&&r.oi==this.evtOiList){let n=r.index%r.number;e=r.objects[n]}return null!=e&&(t.rhEvtProg.evt_ForceOneObject(this.evtOiList,e),!0)}},sI.prototype={eva1:function(t,e){return!0},eva2:function(t){return t.rh4EndOfPause==t.rhLoopCount-1}},sF.prototype={eva1:function(t,e){return(t.rhApp.gaNewFlags&ny.GANF_VSYNC)!=0&&window.requestAnimationFrame},eva2:function(t){return(t.rhApp.gaNewFlags&ny.GANF_VSYNC)!=0&&window.requestAnimationFrame}},sy.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]),s=t.get_EventExpressionInt(this.evtParams[1]);return null!=t.y_GetLadderAt(-1,e,s)?iX.negaTRUE(this):iX.negaFALSE(this)}},sx.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0])-t.rhWindowX,s=t.get_EventExpressionInt(this.evtParams[1])-t.rhWindowY;return t.colMask_Test_XY(e,s,-1,nR.CM_TEST_OBSTACLE)?iX.negaTRUE(this):iX.negaFALSE(this)}},sR.prototype={eva1:function(t,e){return!0},eva2:function(t){return!1}},sM.prototype={eva1:function(t,e){return!(t.rhLoopCount>2)},eva2:function(t){return!(t.rhLoopCount>2)}},s2.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionString(this.evtParams[0]);return h.compareStringsIgnoreCase(e,t.rhEvtProg.rhCurParam0)}},sw.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0];return e.compteur-=t.rhTimerDelta,!(e.compteur>0)&&(e.compteur+=e.delay,!0)}},sk.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e;return e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer,t.rh4TimeOut>e}},sN.prototype={eva1:function(t,e){if((this.evtFlags&at.EVFLAGS_DONE)!=0)return!1;let s=this.evtParams[0].timer;return!(t.rhTimer<s)&&(this.evtFlags|=at.EVFLAGS_DONE,!0)},eva2:function(t){return!1}},s1.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e;return e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer,!(t.rhTimer>e)}},sD.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e,s=this.evtParams[1];if(0==s.value2)e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer,s.value=e,s.value2=-1;else if(s.value-=t.rhTimerDelta,s.value<=0)return e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer,s.value+=e,!0;return!1}},s4.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer;let e,s=this.evtParams[1];return t.rhTimer>=e&&(s.value==t.rhLoopCount?(s.value=t.rhLoopCount+1,!1):(s.value=t.rhLoopCount+1,!0))}},s3.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e;return e=22==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].timer,t.rhTimer>e}},sH.prototype={eva1:function(t,e){if(this.evtOi!=t.rhEvtProg.rhCurOi)return!1;let s=t.rhEvtProg.rhCurParam0;return(s&=this.evtParams[0].value)==this.evtParams[0].value},eva2:function(t){let e=this.evtOi,s=t.rh2NewPlayer[e]&t.rhPlayer[e];return s&=this.evtParams[0].value,this.evtParams[0].value==s}},sB.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhPlayer[this.evtOi];return(e&=this.evtParams[0].value)!=this.evtParams[0].value?iX.negaFALSE(this):iX.negaTRUE(this)}},s6.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionAny(this.evtParams[0]),s=this.evtParams[0].comparaison;return nD.compareTo(t.rhApp.getLives()[this.evtOi],e,s)}},sG.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return 0==t.rhApp.getLives()[this.evtOi]}},s5.prototype={eva1:function(t,e){return!1},eva2:function(t){return!1}},sY.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhApp.getScores(),s=t.get_EventExpressionAny(this.evtParams[0]),r=this.evtParams[0].comparaison;return nD.compareTo(e[this.evtOi],s,r)}},sj.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return iX.negate(this,t.rhApp.keyBuffer[this.evtParams[0].key])}},sX.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return!1==t.rhApp.keyBuffer[this.evtParams[0].key]?iX.negaFALSE(this):iX.compute_GlobalNoRepeat(t)?iX.negaTRUE(this):iX.negaFALSE(this)}},sW.prototype={eva1:function(t,e){let s=t.rhEvtProg.rhCurParam0;return this.evtParams[0].value==s},eva2:function(t){return this.evtParams[0].value==t.rhEvtProg.rh2CurrentClick}},s7.prototype={eva1:function(t,e){let s=t.rhEvtProg.rhCurParam0;if(this.evtParams[0].value==s){let r=this.evtParams[1];if(t.rh2MouseX>=r.x1&&t.rh2MouseX<r.x2&&t.rh2MouseY>=r.y1&&t.rh2MouseY<r.y2)return!0}return!1},eva2:function(t){if(this.evtParams[0].value==t.rhEvtProg.rh2CurrentClick){let e=this.evtParams[1];if(t.rh2MouseX>=e.x1&&t.rh2MouseX<e.x2&&t.rh2MouseY>=e.y1&&t.rh2MouseY<e.y2)return!0}return!1}},sV.prototype={eva1:function(t,e){let s,r=this.evtParams[0];if(t.rhEvtProg.rhCurParam0!=r.value)return!1;let h=t.rhEvtProg.rhCurParam1,n=this.evtParams[1];if(h==n.oi)return t.rhEvtProg.evt_AddCurrentObject(t.rhEvtProg.rh4_2ndObject),!0;let a=n.oiList;if((32768&a)==0)return!1;let l=t.rhEvtProg.qualToOiList[32767&a];for(s=0;s<l.qoiList.length;s+=2)if(l.qoiList[s]==h)return t.rhEvtProg.evt_AddCurrentQualifier(a),t.rhEvtProg.evt_AddCurrentObject(t.rhEvtProg.rh4_2ndObject),!0;return!1},eva2:function(t){let e=this.evtParams[0];if(t.rhEvtProg.rh2CurrentClick!=e.value)return!1;let s=this.evtParams[1];return t.getMouseOnObjectsEDX(s.oiList,!1)}},sU.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0];return t.rh2MouseX>=e.x1&&t.rh2MouseX<e.x2&&t.rh2MouseY>=e.y1&&t.rh2MouseY<e.y2?iX.negaTRUE(this):iX.negaFALSE(this)}},sK.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=0;switch(this.evtParams[0].key){case 1:e=ny.VK_LBUTTON;break;case 2:e=ny.VK_RBUTTON;break;case 4:e=ny.VK_MBUTTON}return!1==t.rhApp.keyBuffer[e]?iX.negaFALSE(this):iX.negaTRUE(this)}},sq.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=(this.evtFlags2&at.EVFLAG2_NOT)!=0;return t.getMouseOnObjectsEDX(this.evtParams[0].oiList,e)}},sz.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return t.isMouseOn()?iX.negaTRUE(this):iX.negaFALSE(this)}},sJ.prototype={eva1:function(t,e){return!0},eva2:function(t){return t.rhWheelCount==t.rh4EventCount}},sQ.prototype={eva1:function(t,e){return!0},eva2:function(t){return t.rhWheelCount==t.rh4EventCount}},sZ.prototype={eva1:function(t,e){return!0},eva2:function(t){return!1}},s9.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return t.rhApp.soundPlayer.isSoundPlaying()?iX.negaFALSE(this):iX.negaTRUE(this)}},rt.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);return t.rhApp.soundPlayer.isChannelPlaying(e-1)?iX.negaFALSE(this):iX.negaTRUE(this)}},re.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return t.rhApp.soundPlayer.isSamplePlaying(this.evtParams[0].sndHandle)?iX.negaFALSE(this):iX.negaTRUE(this)}},ri.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.get_EventExpressionInt(this.evtParams[0]);return t.rhApp.soundPlayer.isChannelPaused(e-1)?iX.negaTRUE(this):iX.negaFALSE(this)}},rs.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=this.evtParams[0];return t.rhApp.soundPlayer.isSamplePaused(e.sndHandle)?iX.negaTRUE(this):iX.negaFALSE(this)}},rr.prototype={eva1:function(t,e){let s=t.get_EventExpressionInt(this.evtParams[0]);return t.rhEvtProg.rhCurParam0==s},eva2:function(t){return!1}},rh.prototype={eva1:function(t,e){return!0},eva2:function(t){return!1}},ro.prototype={eva1:function(t,e){return!0},eva2:function(t){return!1}},rn.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,t.appFinished())}}),ra.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,t.frameChanged())}}),rl.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,t.isPaused())}}),ru.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,t.isVisible())}}),rc.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){for(var e,s,r=t.rhEvtProg.evt_FirstObject(this.evtOiList),h=t.rhEvtProg.evtNSelectedObjects;null!=r;)e=r.cpt_GetValue(),s=t.get_EventExpressionAny(this.evtParams[0]),!1==nD.compareTo(e,s,this.evtParams[0].comparaison)&&(h--,t.rhEvtProg.evt_DeleteCurrentObject()),r=t.rhEvtProg.evt_NextObject();return 0!=h}},rd.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return(t.ros.rsFlags&l2.RSFLAG_HIDDEN)!=0}}),rp.prototype=h.extend(new iX,{eva1:function(t,e){let s;return(s=10==this.evtParams[0].code?this.evtParams[0].value:t.get_EventExpressionInt(this.evtParams[0]))==t.rhEvtProg.rhCurParam0&&(t.rhEvtProg.evt_AddCurrentObject(e),!0)},eva2:function(t){return 10==this.evtParams[0].code?this.evaObject(t,this):this.evaExpObject(t,this)},evaObjectRoutine:function(t){return this.evtParams[0].value==t.roa.raAnimOn&&0==t.roa.raAnimNumberOfFrame},evaExpRoutine:function(t,e,s){return e==t.roa.raAnimOn&&0==t.roa.raAnimNumberOfFrame}}),rm.prototype=h.extend(new iX,{eva1:function(t,e){return this.eva2(t)},eva2:function(t){return 10==this.evtParams[0].code?this.evaObject(t,this):this.evaExpObject(t,this)},evaObjectRoutine:function(t){return this.evtParams[0].value!=t.roa.raAnimOn?iX.negaFALSE(this):0!=t.roa.raAnimNumberOfFrame?iX.negaTRUE(this):iX.negaFALSE(this)},evaExpRoutine:function(t,e,s){return e!=t.roa.raAnimOn?iX.negaFALSE(this):0!=t.roa.raAnimNumberOfFrame?iX.negaTRUE(this):iX.negaFALSE(this)}}),rf.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,t.rom.rmBouncing)}}),r$.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return nD.compareTer(t.rom.rmMovement.rmAcc,e,s)}}),rg.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return nD.compareTer(t.rom.rmMovement.rmDec,e,s)}}),rP.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return nD.compareTer(t.roa.raAnimFrame,e,s)}}),r8.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return nD.compareTer(t.roc.rcSpeed,e,s)}}),rE.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e,s,r,h=t.rhEvtProg.evt_FirstObject(this.evtOiList);if(null==h)return!1;let n=t.rhEvtProg.evtNSelectedObjects,a=this.evtParams[1];do(r=53==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value)>=0&&null!=h.rov?(e=r<h.rov.rvValues.length?h.rov.getValue(r):0,s=t.get_EventExpressionAny(a),!1==nD.compareTo(e,s,a.comparaison)&&(n--,t.rhEvtProg.evt_DeleteCurrentObject())):(n--,t.rhEvtProg.evt_DeleteCurrentObject()),h=t.rhEvtProg.evt_NextObject();while(null!=h);return 0!=n}},r_.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e,s=t.rhEvtProg.evt_FirstObject(this.evtOiList);if(null==s)return!1;let r=t.rhEvtProg.evtNSelectedObjects,h=this.evtParams[0].value,n=this.evtParams[1],a=n.tokens[0].value;do h>=0&&null!=s.rov?(e=h<s.rov.rvValues.length?s.rov.getValue(h):0,!1==nD.compareTo(e,a,n.comparaison)&&(r--,t.rhEvtProg.evt_DeleteCurrentObject())):(r--,t.rhEvtProg.evt_DeleteCurrentObject()),s=t.rhEvtProg.evt_NextObject();while(null!=s);return 0!=r}},rA.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){let r=t.hoCreationId<<16|65535&t.hoNumber;return nD.compareTer(r,e,s)}}),r0.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e,s,r,h=t.rhEvtProg.evt_FirstObject(this.evtOiList);if(null==h)return!1;let n=t.rhEvtProg.evtNSelectedObjects;do(r=62==this.evtParams[0].code?t.get_EventExpressionInt(this.evtParams[0]):this.evtParams[0].value)>=0&&r<lN.STRINGS_NUMBEROF_ALTERABLE&&null!=h.rov?(e=h.rov.getString(r),s=t.get_EventExpressionAny(this.evtParams[1]),!1==nD.compareTo(e,s,this.evtParams[1].comparaison)&&(n--,t.rhEvtProg.evt_DeleteCurrentObject())):(n--,t.rhEvtProg.evt_DeleteCurrentObject()),h=t.rhEvtProg.evt_NextObject();while(null!=h);return 0!=n}},rv.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return nD.compareTer(t.hoX,e,s)}}),rO.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return nD.compareTer(t.hoY,e,s)}}),rS.prototype=h.extend(new iX,{eva1:function(t,e){return this.compute_NoRepeat(e)?(t.rhEvtProg.evt_AddCurrentObject(e),!0):(t.rhEvtProg.rhEventGroup.evgFlags&n9.EVGFLAGS_STOPINGROUP)!=0&&(t.rhEvtProg.rh3DoStop=!0,!0)},eva2:function(t){return iX.negate(this,this.evaObject(t,this))},evaObjectRoutine:function(t){return t.hoAdRunHeader.colMask_TestObject_IXY(t,t.roc.rcImage,t.roc.rcAngle,t.roc.rcScaleX,t.roc.rcScaleY,t.hoX,t.hoY,0,lx.CM_TEST_PLATFORM)}}),rT.prototype=h.extend(new iX,{eva1:function(t,e){for(var s=t.rhObjectList[t.rhEvtProg.rh1stObjectNumber],r=this.evtOi,h=this.evtParams[0],n=h.oi;;){if(r==e.hoOi){if(n==s.hoOi)break;if(n>=0)return!1;if(this.colGetList(t,h.oiList,s.hoOi))break;return!1}if(n==e.hoOi){if(r==s.hoOi)break;if(r>=0)return!1;if(this.colGetList(t,this.evtOiList,s.hoOi))break;return!1}if(r<0){if(n<0){if(this.colGetList(t,this.evtOiList,e.hoOi)){if(this.colGetList(t,h.oiList,s.hoOi))break;if(!1==this.colGetList(t,h.oiList,e.hoOi))return!1;if(this.colGetList(t,this.evtOiList,s.hoOi))break;return!1}if(this.colGetList(t,this.evtOiList,s.hoOi))break;return!1}if(n==s.hoOi)break;return!1}if(n>=0||r!=s.hoOi)return!1;break}let a=s.hoCreationId<<16|65535&this.evtIdentifier;if(!1==iX.compute_NoRepeatCol(a,e)||(a=e.hoCreationId<<16|65535&this.evtIdentifier,!1==iX.compute_NoRepeatCol(a,s))){if((t.rhEvtProg.rhEventGroup.evgFlags&n9.EVGFLAGS_STOPINGROUP)==0)return!1;t.rhEvtProg.rh3DoStop=!0}return t.rhEvtProg.evt_AddCurrentObject(e),t.rhEvtProg.evt_AddCurrentObject(s),s.rom.rmMovement.rmCollisionCount==t.rh3CollisionCount?e.rom.rmMovement.rmCollisionCount=t.rh3CollisionCount:e.rom.rmMovement.rmCollisionCount==t.rh3CollisionCount&&(s.rom.rmMovement.rmCollisionCount=t.rh3CollisionCount),!0},eva2:function(t){return this.isColliding(t)},colGetList:function(t,e,s){if(-1==e)return!1;let r,h=t.rhEvtProg.qualToOiList[32767&e];for(r=0;r<h.qoiList.length;r+=2)if(h.qoiList[r]==s)return!0;return!1}}),rb.prototype=h.extend(new iX,{eva1:function(t,e){return!0},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return t.roc.rcMovementType==l6.MVTYPE_TAPED&&iX.checkMark(t.hoAdRunHeader,t.hoMark2)}}),rC.prototype=h.extend(new iX,{eva1:function(t,e){return this.eva2(t)},eva2:function(t){return 29==this.evtParams[0].code?this.evaObject(t,this):this.evaExpObject(t,this)},evaObjectRoutine:function(t){let e,s=this.evtParams[0].value;for(e=0;e<32;e++)if((1<<e&s)!=0&&t.hoAdRunHeader.getDir(t)==e)return iX.negaTRUE(this);return iX.negaFALSE(this)},evaExpRoutine:function(t,e,s){return e&=31,iX.negate(this,t.roc.rcDir==e)}}),rL.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return e&=31,null==t.rov||(t.rov.rvValueFlags&1<<e)==0}}),rI.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){return e&=31,null!=t.rov&&(t.rov.rvValueFlags&1<<e)!=0}}),rF.prototype=h.extend(new iX,{eva1:function(t,e){return(this.evtParams[0].value&t.rhEvtProg.rhCurParam0)!=0&&(this.compute_NoRepeat(e)?(t.rhEvtProg.evt_AddCurrentObject(e),!0):(t.rhEvtProg.rhEventGroup.evgFlags&n9.EVGFLAGS_STOPINGROUP)!=0&&(t.rhEvtProg.rh3DoStop=!0,!0))},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,(t.rom.rmEventFlags&ur.EF_GOESOUTPLAYFIELD)!=0)}}),ry.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return nD.getObjectFont(t).lfWeight>=400}}),rx.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return t.hoAdRunHeader.colMask_TestObject_IXY(t,t.roc.rcImage,t.roc.rcAngle,t.roc.rcScaleX,t.roc.rcScaleY,t.hoX,t.hoY,0,lx.CM_TEST_OBSTACLE)||t.hoAdRunHeader.colMask_TestObject_IXY(t,t.roc.rcImage,t.roc.rcAngle,t.roc.rcScaleX,t.roc.rcScaleY,t.hoX,t.hoY,0,lx.CM_TEST_PLATFORM)?iX.negaTRUE(this):iX.negaFALSE(this)}}),rR.prototype=h.extend(new iX,{eva1:function(t,e){return this.isColliding(t)},eva2:function(t){return this.isColliding(t)}}),rM.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){let e=t.hoX-t.hoImgXSpot,s=e+t.hoImgWidth,r=t.hoY-t.hoImgYSpot,h=r+t.hoImgHeight;return 0!=t.hoAdRunHeader.quadran_In(e,r,s,h)?iX.negaFALSE(this):iX.negaTRUE(this)}}),r2.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return 0!=nD.getObjectFont(t).lfItalic}}),rw.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){let e=t.hoX-t.hoImgXSpot,s=e+t.hoImgWidth,r=t.hoY-t.hoImgYSpot,h=r+t.hoImgHeight;return 0!=t.hoAdRunHeader.quadran_In(e,r,s,h)?iX.negaTRUE(this):iX.negaFALSE(this)}}),rk.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return 0!=nD.getObjectFont(t).lfStrikeOut}}),rN.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return 0!=nD.getObjectFont(t).lfUnderline}}),r1.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaExpObject(t,this)},eva2:function(t){return this.evaExpObject(t,this)},evaExpRoutine:function(t,e,s){let r=t.hoAdRunHeader.rhWindowX+e,h=t.hoX-t.hoImgXSpot;if(h<=r||(r=t.hoAdRunHeader.rhWindowX+t.hoAdRunHeader.rh3WindowSx-e,(h+=t.hoImgWidth)>=r))return iX.negaTRUE(this);let n=t.hoAdRunHeader.rhWindowY+e,a=t.hoY-t.hoImgYSpot;return a<=n?iX.negaTRUE(this):(n=t.hoAdRunHeader.rhWindowY+t.hoAdRunHeader.rh3WindowSy-e,(a+=t.hoImgHeight)>=n)?iX.negaTRUE(this):iX.negaFALSE(this)}}),rD.prototype={eva1:function(t,e){return null==e?this.eva2(t):this.evtOi>=0?e.hoOi==this.evtOi:this.evaNoMoreObject(t,1)},eva2:function(t){return this.evaNoMoreObject(t,0)},evaNoMoreObject:function(t,e){let s,r,h=this.evtOiList;if((32768&h)==0)return 0==(s=t.rhOiList[h]).oilNObjects;if((32767&h)==32767)return!1;let n=t.rhEvtProg.qualToOiList[32767&h],a=0;for(r=0;r<n.qoiList.length;r+=2)a+=(s=t.rhOiList[n.qoiList[r+1]]).oilNObjects;return 0==(a-=e)}},r4.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){return 0==t.rhEvtProg.count_ZoneOneObject(this.evtOiList,this.evtParams[0])}},r3.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=t.rhEvtProg.count_ZoneOneObject(this.evtOiList,this.evtParams[0]),s=t.get_EventExpressionInt(this.evtParams[1]);return nD.compareTer(e,s,this.evtParams[1].comparaison)}},rH.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e=0,s=this.evtOiList;if((32768&s)==0)e=(r=t.rhOiList[s]).oilNObjects;else if((32767&s)!=32767){var r,h,n=t.rhEvtProg.qualToOiList[32767&s];for(h=0;h<n.qoiList.length;h+=2)e+=(r=t.rhOiList[n.qoiList[h+1]]).oilNObjects}let a=t.get_EventExpressionInt(this.evtParams[0]);return nD.compareTer(e,a,this.evtParams[0].comparaison)}},rB.prototype=h.extend(new iX,{eva1:function(t,e){return(this.evtParams[0].value&t.rhEvtProg.rhCurParam0)!=0&&(this.compute_NoRepeat(e)?(t.rhEvtProg.evt_AddCurrentObject(e),!0):(t.rhEvtProg.rhEventGroup.evgFlags&n9.EVGFLAGS_STOPINGROUP)!=0&&(t.rhEvtProg.rh3DoStop=!0,!0))},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,(t.rom.rmEventFlags&ur.EF_GOESOUTPLAYFIELD)!=0)}}),r6.prototype=h.extend(new iX,{eva1:function(t,e){return!0},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return t.roc.rcMovementType==l6.MVTYPE_TAPED&&iX.checkMark(t.hoAdRunHeader,t.hoMark1)}}),rG.prototype=h.extend(new iX,{eva1:function(t,e){let s=t.get_EventExpressionString(this.evtParams[0]);return null!=e.hoMT_NodeName&&e.hoMT_NodeName==s},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){if(t.roc.rcMovementType!=l6.MVTYPE_TAPED)return!1;if(iX.checkMark(t.hoAdRunHeader,t.hoMark1)){let e=t.hoAdRunHeader.get_EventExpressionString(this.evtParams[0]);if(null!=t.hoMT_NodeName&&t.hoMT_NodeName==e)return!0}return!1}}),r5.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,0==t.rom.rmReverse)}}),rY.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,(t.ros.rsFlags&l2.RSFLAG_HIDDEN)==0)}}),rj.prototype=h.extend(new iX,{eva1:function(t,e){return this.evaObject(t,this)},eva2:function(t){return this.evaObject(t,this)},evaObjectRoutine:function(t){return iX.negate(this,0==t.roc.rcSpeed)}}),rX.prototype={eva1:function(t,e){return this.eva2(t)},eva2:function(t){let e;return 5==(e=67==this.evtParams[0].code?this.evtParams[0].value:t.get_EventExpressionInt(this.evtParams[0]))?iX.negaTRUE(this):iX.negaFALSE(this)}},rW.EXP_EXTGETFRICTION=8960,rW.EXP_EXTGETRESTITUTION=9216,rW.EXP_EXTGETDENSITY=9472,rW.EXP_EXTGETVELOCITY=9728,rW.EXP_EXTGETANGLE=9984,rW.EXP_EXTGETMASS=10752,rW.EXP_EXTGETANGULARVELOCITY=11008,rW.EXP_STRING=262143,rW.EXP_LONG=65535,rW.EXP_DOUBLE=1572863,rW.create=function(t){let e=t.getFilePointer(),s=null,r=t.readAInt();switch(r){case 0:case 3997695:case 262142:case 983037:case 1048573:case 1245181:s=new rV;break;case 131072:s=new h4;break;case 262144:s=new hR;break;case 393216:s=new h2;break;case 524288:s=new hf;break;case 655360:s=new hM;break;case 786432:s=new h3;break;case 917504:s=new ha;break;case 1048576:s=new hk;break;case 1179648:s=new hq;break;case 65535:s=new rU;break;case 131071:s=new hH;break;case 196607:s=new hU;break;case 262143:s=new rZ;break;case 327679:s=new hj;break;case 393215:s=new hV;break;case 458751:case 524287:case 589823:case 655359:case 4063231:s=new r7;break;case 720895:s=new h5;break;case 786431:s=new hm;break;case 851967:s=new hW;break;case 917503:s=new hY;break;case 983039:s=new hC;break;case 1048575:s=new hb;break;case 1114111:s=new hv;break;case 1179647:s=new hp;break;case 1245183:s=new h$;break;case 1310719:s=new hS;break;case 1376255:s=new h6;break;case 1441791:s=new hy;break;case 1507327:s=new hT;break;case 1572863:s=new rK;break;case 1638399:s=new rQ;break;case 1900543:s=new hO;break;case 1966079:s=new ho;break;case 2031615:s=new hd;break;case 2097151:s=new h8;break;case 2162687:s=new hn;break;case 2228223:s=new hl;break;case 2293759:s=new hu;break;case 2359295:s=new hN;break;case 2686975:s=new hx;break;case 2752511:s=new hF;break;case 2818047:s=new h0;break;case 2883583:s=new hA;break;case 2949119:s=new h_;break;case 3014655:s=new hE;break;case 3080191:s=new hL;break;case 3145727:s=new hw;break;case 3211263:s=new hG;break;case 3276799:s=new hX;break;case 3342335:s=new rJ;break;case 3407871:s=new hI;break;case 3473407:s=new h7;break;case 3538943:s=new hg;break;case 3604479:s=new hB;break;case 3866623:s=new hP;break;case 3932159:s=new hc;break;case 4128767:s=new he;break;case 4194303:s=new hi;break;case 4259839:s=new hs;break;case 4325375:s=new hr;break;case 4456447:s=new hh;break;case -1:s=new h1;break;case -65537:s=new hD;break;case -131073:s=new hK;break;case 65534:s=new no;break;case 131070:s=new nl;break;case 196606:s=new na;break;case 327678:s=new nu;break;case 393214:s=new nc;break;case 458750:s=new nn;break;case 524286:s=new ns;break;case 589822:s=new nr;break;case 655358:s=new ne;break;case 720894:s=new nh;break;case 786430:s=new ni;break;case 65533:s=new or;break;case 131069:s=new oo;break;case 196605:s=new op;break;case 262141:s=new om;break;case 327677:s=new o$;break;case 393213:s=new of;break;case 458749:s=new od;break;case 524285:s=new oc;break;case 589821:s=new oh;break;case 655357:s=new on;break;case 720893:s=new os;break;case 786429:s=new ou;break;case 851965:s=new ol;break;case 917501:s=new oa;break;case 1114109:s=new oe;break;case 1179645:s=new oi;break;case 65532:s=new ot;break;case 131068:s=new hJ;break;case 196604:s=new h9;break;case 262140:s=new hQ;break;case 327676:s=new hZ;break;case 393212:s=new hz;break;case 65530:s=new np;break;case 131066:s=new nm;break;case 196602:s=new nd;break;case 65529:s=new n8;break;case 131065:s=new nP;break;case 196601:s=new nf;break;case 262137:s=new n$;break;case 327673:s=new ng;break;case 65531:s=new og;break;case 5242883:s=new oL;break;case 5308419:s=new oS;break;case 5373955:s=new ob;break;case 5439491:s=new oC;break;case 5505027:s=new oT;break;case 5242882:s=new oZ;break;case 5308418:s=new o9;break;case 5373954:s=new nt;break;case 5439490:s=new oQ;break;case 5242887:s=new oA;break;case 5308423:s=new o_;break;case 5373959:s=new oE;break;case 5439495:s=new oP;break;case 5505031:s=new o8;break;case 5242889:s=new oO;break;case 5308425:s=new ov;break;case 5373961:s=new o0;break;default:switch(4294901760&r){case 65536:s=new oz;break;case 131072:s=new o6;break;case 196608:s=new oX;break;case 262144:s=new oR;break;case 327680:s=new o2;break;case 393216:s=new ow;break;case 458752:s=new o7;break;case 524288:s=new oV;break;case 589824:s=new oJ;break;case 655360:s=new oq;break;case 720896:s=new oU;break;case 786432:s=new oB;break;case 851968:s=new ok;break;case 917504:s=new oG;break;case 983040:s=new oY;break;case 1048576:s=new rq;break;case 1114112:s=new oH;break;case 1179648:s=new o5;break;case 1245184:s=new rz;break;case 1310720:s=new o1;break;case 1376256:s=new oD;break;case 1441792:s=new oN;break;case 1507328:s=new o3;break;case 1572864:s=new o4;break;case 1638400:s=new oW;break;case 1703936:s=new oK;break;case 1769472:s=new oM;break;case 1835008:s=new oj;break;case 1900544:s=new rV;break;case 1966080:s=new r9;break;case 2031616:s=new ht;break;case 2097152:s=new oI;break;case 2162688:s=new oF;break;case 2228224:s=new nE;break;case 2293760:s=new n_;break;case 2359296:s=new nA;break;case 2424832:s=new n0;break;case 2490368:s=new nv;break;case 2555904:s=new nO;break;case 2621440:s=new nS;break;case 2686976:s=new nT;break;case 2752512:s=new nb;break;case 2818048:s=new nC;break;case 2883584:s=new nL;break;default:s=new l3}}if(null!=s&&(s.code=r,0!=r)){let h,n=t.readAShort();switch(r){case 262143:s.string=t.readAString();break;case 65535:s.value=t.readAInt();break;case 1572863:s.value=t.readADouble();break;case 1638399:case 3342335:t.skipBytes(4),s.number=t.readAShort();break;default:if((32768&(h=65535&r))!=0&&(h-=65536),h>=2||h==ac.OBJ_PLAYER)switch(s.oi=t.readShort(),s.oiList=t.readShort(),4294901760&r){case 1048576:case 1245184:s.number=t.readAShort()}}t.seek(e+n)}return s},r7.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=""}},rV.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=0}},rU.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=this.value}},rK.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=this.value,t.flagFloat=!0}},rq.prototype={evaluate:function(t){let e,s=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==s){t.rh4Results[t.rh4PosPile]=0;return}e=null!=s.rov?s.rov.getValue(this.number):0,h.isInt(e)||(t.flagFloat=!0),t.rh4Results[t.rh4PosPile]=e}},rz.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]="";return}t.rh4Results[t.rh4PosPile]=e.rov.getString(this.number)}},rJ.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhApp.getGlobalStringAt(this.number)}},rQ.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhApp.getGlobalValueAt(this.number)}},rZ.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=this.string}},r9.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);t.rh4CurToken++;let s=t.get_ExpressionInt();if(null!=e&&null!=e.rov&&s>=0&&s<e.rov.rvValues.length){let r=e.rov.getValue(s);h.isInt(r)||(t.flagFloat=!0),t.rh4Results[t.rh4PosPile]=r;return}t.rh4Results[t.rh4PosPile]=0}},ht.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);t.rh4CurToken++;let s=t.get_ExpressionInt();if(null!=e&&null!=e.rov&&s>=0&&s<lN.STRINGS_NUMBEROF_ALTERABLE){t.rh4Results[t.rh4PosPile]=e.rov.getString(s);return}t.rh4Results[t.rh4PosPile]=""}},he.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.getExpression();t.rh4CurToken++;let r=t.getExpression();t.rh4CurToken++;let n=t.getExpression(),a=r-e,l=n-s;t.rh4Results[t.rh4PosPile]=h.approximateInt(Math.sqrt(a*a+l*l))}},hi.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=180*Math.atan2(-t.getExpression(),e)/3.141592653589;s<0&&(s=360+s),t.rh4Results[t.rh4PosPile]=h.approximateInt(s)}},hs.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.getExpression();t.rh4CurToken++;let r=t.getExpression();e=Math.min(e=Math.max(e,s),r),t.rh4Results[t.rh4PosPile]=e}},hr.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.getExpression();t.rh4Results[t.rh4PosPile]=e+t.random(s-e+1)}},hh.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]="Html5"}},ho.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.abs(e)}},ho.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.abs(e)}},hn.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=57.29577951308232*Math.acos(e),t.flagFloat=!0}},ha.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]&=t.rh4Results[t.rh4PosPile+1]}},hl.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=57.29577951308232*Math.asin(e),t.flagFloat=!0}},hu.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=57.29577951308232*Math.atan(e),t.flagFloat=!0}},hc.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.getExpression();t.rh4Results[t.rh4PosPile]=57.29577951308232*Math.atan2(e,s),t.flagFloat=!0}},hd.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.ceil(e)}},hp.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]="0b"+e.toString(2)}},hm.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.cos(e/57.29577951308232),t.flagFloat=!0}},hf.prototype={evaluate:function(t){let e=t.rh4Results[t.rh4PosPile],s=t.rh4Results[t.rh4PosPile+1];0!=s?!1==t.flagFloat?t.rh4Results[t.rh4PosPile]=h.floatToInt(e/s):t.rh4Results[t.rh4PosPile]/=t.rh4Results[t.rh4PosPile+1]:t.rh4Results[t.rh4PosPile]=0}},h$.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.exp(e),t.flagFloat=!0}},hg.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.getExpression();t.rh4CurToken++;let r=t.get_ExpressionInt();if(r>=e.length){t.rh4Results[t.rh4PosPile]=-1;return}t.rh4Results[t.rh4PosPile]=e.indexOf(s,r)}},hP.prototype={evaluate:function(t){t.rh4CurToken++;let e,s=t.getExpression();t.rh4CurToken++;let r=t.get_ExpressionInt();r<1&&(r=1),t.rh4CurToken++;let h=t.get_ExpressionInt(),n=s.toString(),a=new String,l=n.indexOf(".");if(l>=0){for(e=l+1;e<n.length&&"0"==n.charAt(e);e++);e==n.length&&(l=-1)}let u=0;if(l>=0){for(s<0&&(a+="-",u++);u<l;)a+=n.charAt(u),u++;if(h>0)for(a+=".",u++,e=0;e<h&&e+u<n.length;e++)a+=n.charAt(u+e);else if(h<0)for(a+=".",u++;u<n.length;)a+=n.charAt(u),u++}else{for(;u<n.length&&"."!=n.charAt(u);)a+=n.charAt(u),u++;if(h>0)for(a+=".",e=0;e<h;e++)a+="0"}t.rh4Results[t.rh4PosPile]=a}},h8.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.floor(e)}},hE.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=e>>>16&255}},h_.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=e>>>8&255}},hA.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=255&e}},h0.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4CurToken++;let s=t.get_ExpressionInt();t.rh4CurToken++;let r=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]=((255&r)<<16)+((255&s)<<8)+(255&e)}},hv.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]="0x"+e.toString(16)}},hO.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=h.floatToInt(e)}},hS.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.get_ExpressionInt();s<0&&(s=0),s>e.length&&(s=e.length),t.rh4Results[t.rh4PosPile]=e.substring(0,s)}},hT.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=e.length}},hb.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.log(e),t.flagFloat=!0}},hC.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.log(e)/Math.log(10),t.flagFloat=!0}},hL.prototype={evaluate:function(t){t.rh4CurToken++;var e,s=t.rh4Tokens[t.rh4CurToken];if(t.rh4Tokens[t.rh4CurToken+1].code<=0||t.rh4Tokens[t.rh4CurToken+1].code>=1310720){if(s.code==rW.EXP_LONG){r=t.rh4FastLoops.get(s.value),t.rh4CurToken++,t.rh4Results[t.rh4PosPile]=r.index;return}if(s.code==rW.EXP_STRING){var r,e,n=t.rh4CurToken,a=s.string;for(t.rh4CurToken++,e=0;e<t.rh4FastLoops.size();e++)if(r=t.rh4FastLoops.get(e),h.compareStringsIgnoreCase(r.name,a)){t.rh4Tokens[n]=new rU,t.rh4Tokens[n].code=rW.EXP_LONG,t.rh4Tokens[n].value=e,t.rh4Results[t.rh4PosPile]=r.index;return}t.rh4Results[t.rh4PosPile]=0;return}}var a=t.getExpression();for(e=0;e<t.rh4FastLoops.size();e++)if(r=t.rh4FastLoops.get(e),h.compareStringsIgnoreCase(r.name,a)){t.rh4Results[t.rh4PosPile]=r.index;return}t.rh4Results[t.rh4PosPile]=0}},hI.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=e.toLowerCase()}},hF.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.max(e,s)}},hy.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.get_ExpressionInt();t.rh4CurToken++;let r=t.get_ExpressionInt();s<0&&(s=0),s>e.length&&(s=e.length),r<0&&(r=0),s+r>e.length&&(r=e.length-s),t.rh4Results[t.rh4PosPile]=e.substr(s,r)}},hx.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.min(e,s)}},hR.prototype={evaluate:function(t){t.bOperande?(t.rh4CurToken++,t.rh4Tokens[t.rh4CurToken].evaluate(t),t.rh4Results[t.rh4PosPile]=-t.rh4Results[t.rh4PosPile]):t.rh4Results[t.rh4PosPile]-=t.rh4Results[t.rh4PosPile+1]}},hM.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]%=t.rh4Results[t.rh4PosPile+1]}},h2.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]*=t.rh4Results[t.rh4PosPile+1]}},hw.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]="\n"}},hk.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]|=t.rh4Results[t.rh4PosPile+1]}},hN.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]=4294967295^e}},h1.prototype={evaluate:function(t){t.rh4CurToken++,t.rh4Results[t.rh4PosPile]=t.getExpression()}},hD.prototype={evaluate:function(t){}},h4.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]+=t.rh4Results[t.rh4PosPile+1]}},h3.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=Math.pow(t.rh4Results[t.rh4PosPile],t.rh4Results[t.rh4PosPile+1]),t.flagFloat=!0}},hH.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]=t.random(e)}},hB.prototype={evaluate:function(t){t.rh4CurToken++;let e,s=t.getExpression();t.rh4CurToken++;let r=t.getExpression();t.rh4CurToken++;let h=t.get_ExpressionInt();h>s.length&&(h=s.length);for(let n=-1;;){e=n;let a=s.indexOf(r,n+1);if(-1==a||(n=a)>h)break}t.rh4Results[t.rh4PosPile]=e}},h6.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4CurToken++;let s=t.get_ExpressionInt();s<0&&(s=0),s>e.length&&(s=e.length),t.rh4Results[t.rh4PosPile]=e.substring(e.length-s,e.length)}},hG.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.round(e)}},h5.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.sin(e/57.29577951308232),t.flagFloat=!0}},hY.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();e<0?t.rh4Results[t.rh4PosPile]=0:t.rh4Results[t.rh4PosPile]=Math.sqrt(e),t.flagFloat=!0}},hj.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=e.toString()}},hX.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt()-1;t.rh4Results[t.rh4PosPile]=t.rhApp.getGlobalStringAt(e)}},hW.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=Math.tan(e/57.29577951308232),t.flagFloat=!0}},h7.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=e.toUpperCase()}},hV.prototype={evaluate:function(t){t.rh4CurToken++;for(var e=t.getExpression(),s=0;s<e.length&&32==e.charAt(s);)s++;let r=0;if(s<e.length){if("0b"==(e=e.substr(s)).substr(0,2)||"0B"==e.substr(s,2))r=parseInt(e.substr(s+2),2);else{let n=parseInt(e);isNaN(r=parseFloat(e))||isNaN(n)||(0==r&&0!=n&&(r=n),h.floatToInt(r)==r||(t.flagFloat=!0))}}t.rh4Results[t.rh4PosPile]=r}},hU.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt()-1;t.rh4Results[t.rh4PosPile]=t.rhApp.getGlobalValueAt(e)}},hK.prototype={evaluate:function(t){}},hq.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]^=t.rh4Results[t.rh4PosPile+1]}},hK.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=0}},hz.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhEvtProg.rhCurParam1}},hJ.prototype={evaluate:function(t){let e=h.floatToInt(t.rhTimer/10);t.rh4Results[t.rh4PosPile]=e%100}},hQ.prototype={evaluate:function(t){let e=h.floatToInt(t.rhTimer/36e5);t.rh4Results[t.rh4PosPile]=e}},hZ.prototype={evaluate:function(t){let e=h.floatToInt(t.rhTimer/6e4);t.rh4Results[t.rh4PosPile]=e%60}},h9.prototype={evaluate:function(t){let e=h.floatToInt(t.rhTimer/1e3);t.rh4Results[t.rh4PosPile]=e%60}},ot.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhTimer}},oe.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=255}},oi.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=16777215}},os.prototype={evaluate:function(t){let e,s=0;for(e=0;e<nD.MAX_FRAMERATE;e++)s+=t.rh4FrameRateArray[e];t.rh4Results[t.rh4PosPile]=Math.round(1e3*nD.MAX_FRAMERATE/s)}},or.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhApp.currentFrame}},oh.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhApp.currentFrame+1}},oo.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhNPlayers}},on.prototype={evaluate:function(t){t.rh4CurToken++,e=t.get_ExpressionInt(),t.rh4CurToken++,s=t.get_ExpressionInt();let e,s,r=0;null!=t.y_GetLadderAt(-1,e,s)?r=2:t.colMask_Test_XY(e,s,-1,nR.CM_TEST_OBSTACLE)&&(r=1),t.rh4Results[t.rh4PosPile]=r}},oa.prototype={evaluate:function(t){let e=t.rhFrame.leBackground;t.rhApp.bPreloader&&(e=t.rhApp.parentApp.frame.leBackground),t.rh4Results[t.rh4PosPile]=h.swapRGB(e)}},ol.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhFrame.leVirtualRect.bottom}},ou.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhFrame.leVirtualRect.right}},oc.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhFrame.leHeight}},od.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhFrame.leWidth}},op.prototype={evaluate:function(t){let e=t.rhWindowX;(t.rh3Scrolling&nD.RH3SCROLLING_SCROLL)!=0&&(e=t.rh3DisplayX),e<0&&(e=0),t.rh4Results[t.rh4PosPile]=e}},om.prototype={evaluate:function(t){let e=t.rhWindowX;(t.rh3Scrolling&nD.RH3SCROLLING_SCROLL)!=0&&(e=t.rh3DisplayX),(e+=t.rh3WindowSx)>t.rhLevelSx&&(e=t.rhLevelSx),t.rh4Results[t.rh4PosPile]=e}},of.prototype={evaluate:function(t){let e=t.rhWindowY;(t.rh3Scrolling&nD.RH3SCROLLING_SCROLL)!=0&&(e=t.rh3DisplayY),(e+=t.rh3WindowSy)>t.rhLevelSy&&(e=t.rhLevelSy),t.rh4Results[t.rh4PosPile]=e}},o$.prototype={evaluate:function(t){let e=t.rhWindowY;(t.rh3Scrolling&nD.RH3SCROLLING_SCROLL)!=0&&(e=t.rh3DisplayY),e<0&&(e=0),t.rh4Results[t.rh4PosPile]=e}},og.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhNObjects}},oP.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=e.cpt_GetColor1();t.rh4Results[t.rh4PosPile]=h.swapRGB(s)}},o8.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=e.cpt_GetColor2();t.rh4Results[t.rh4PosPile]=h.swapRGB(s)}},oE.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.cpt_GetMax()}},o_.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.cpt_GetMin()}},oA.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.cpt_GetValue(),e.bFloat&&(t.flagFloat=!0)}},o0.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);t.rh4CurToken++;let s=t.get_ExpressionInt()-1;if(null==e){t.rh4Results[t.rh4PosPile]="";return}t.rh4Results[t.rh4PosPile]=e.getGlobalString(s)}},ov.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);t.rh4CurToken++;let s=t.get_ExpressionInt()-1;if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.getGlobalValue(s)}},oO.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.getFrameNumber()}},oS.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]="";return}null!=e.rsTextBuffer?t.rh4Results[t.rh4PosPile]=e.rsTextBuffer:t.rh4Results[t.rh4PosPile]=""}},oT.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.getCurrentResult().forceInt(0);return}t.rh4Results[t.rh4PosPile]=e.rsMaxi}},ob.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(t.rh4CurToken++,null==e){t.rh4Results[t.rh4PosPile]="";return}let s=t.get_ExpressionInt();if(s<0){null!=e.rsTextBuffer?t.rh4Results[t.rh4PosPile]=e.rsTextBuffer:t.rh4Results[t.rh4PosPile]="";return}s>=e.rsMaxi&&(s=e.rsMaxi-1);let r=e.hoCommon.ocObject;t.rh4Results[t.rh4PosPile]=r.otTexts[s].tsText}},oC.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.getCurrentResult().forceInt(0);return}null!=e.rsTextBuffer?t.rh4Results[t.rh4PosPile]=parseFloat(e.rsTextBuffer):t.rh4Results[t.rh4PosPile]=0}},oL.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rsMini+1}},oI.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);t.rh4CurToken++;let s=t.getExpression();t.rh4CurToken++;let r=t.getExpression();if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let n=s-e.hoX,a=r-e.hoY;t.rh4Results[t.rh4PosPile]=h.approximateInt(Math.sqrt(n*n+a*a))}},oF.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);t.rh4CurToken++;let s=t.getExpression();t.rh4CurToken++;let r=t.getExpression();if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let n=180*Math.atan2(-(r-e.hoY),s-e.hoX)/3.141592653589;n<0&&(n=360+n),t.rh4Results[t.rh4PosPile]=h.approximateInt(n)}},oR.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.getAcc()}},oM.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=e.ros.rsEffect,r=e.ros.rsEffectParam,h=0;switch(s&l2.BOP_MASK){case l2.BOP_EFFECTEX:h=255-(r>>24&255);break;case l2.BOP_BLEND:h=255-(128==r?0:255-2*r);break;default:s&l2.BOP_RGBAFILTER&&(h=255-(r>>24&255))}t.rh4Results[t.rh4PosPile]=h}},o2.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.getDec()}},ow.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=t.getDir(e)}},ok.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);t.rh4CurToken++;let s=t.get_ExpressionInt();if(null==e){t.rh4Results[t.rh4PosPile]=0;return}if(s&=31,null!=e.rov){let r=0;(1<<s&e.rov.rvValueFlags)!=0&&(r=1),t.rh4Results[t.rh4PosPile]=r}else t.rh4Results[t.rh4PosPile]=0}},oN.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=nD.getObjectTextColor(e);s=h.swapRGB(s),t.rh4Results[t.rh4PosPile]=s}},o1.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]="";return}let s=nD.getObjectFont(e);t.rh4Results[t.rh4PosPile]=s.lfFaceName}},oD.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=nD.getObjectFont(e);t.rh4Results[t.rh4PosPile]=Math.round(72*s.lfHeight/96)}},o4.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.getGravity()}},o3.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoLayer+1}},oH.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=0;null!=e.ros&&(s=e.ros.getSemiTransparency()),t.rh4Results[t.rh4PosPile]=s}},oB.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=e.hoCreationId<<16|65535&e.hoNumber;t.rh4Results[t.rh4PosPile]=s}},o6.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=0;null!=e.roa&&(s=e.roa.raAnimFrame),t.rh4Results[t.rh4PosPile]=s}},oG.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=0;null!=e.roa&&(s=e.roa.raAnimOn),t.rh4Results[t.rh4PosPile]=s}},o5.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=0;null!=e.roa&&(s=e.rom.rmMvtNum),t.rh4Results[t.rh4PosPile]=s}},oY.prototype={evaluate:function(t){let e=this.oiList;if((32768&e)==0)r=t.rhOiList[e],t.rh4Results[t.rh4PosPile]=r.oilNObjects;else{let s=0;if(-1!=e){var r,h,n=t.rhEvtProg.qualToOiList[32767&e];for(h=0;h<n.qoiList.length;h+=2)s+=(r=t.rhOiList[n.qoiList[h+1]]).oilNObjects}t.rh4Results[t.rh4PosPile]=s}}},oj.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=e.ros.rsEffect,r=e.ros.rsEffectParam,n=0;n=(s&l2.BOP_MASK)==l2.BOP_EFFECTEX||(s&l2.BOP_RGBAFILTER)!=0?h.swapRGB(16777215&r):16777215,t.rh4Results[t.rh4PosPile]=n}},oX.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=0;null!=e.roa&&(s=e.rom.rmMovement.getSpeed()),t.rh4Results[t.rh4PosPile]=s}},oW.prototype={evaluate:function(t){let e,s=0,r=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null!=r&&(s=r.hoX,null!=r.roa&&r.roc.rcImage>=0&&null!=(e=t.rhApp.imageBank.getImageInfoEx(r.roc.rcImage,r.roc.rcAngle,r.roc.rcScaleX,r.roc.rcScaleY)))){t.rh4Results[t.rh4PosPile]=s+e.xAP-e.xSpot;return}t.rh4Results[t.rh4PosPile]=s}},o7.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoX-e.hoImgXSpot}},oV.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoX-e.hoImgXSpot+e.hoImgWidth}},oU.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoX}},oK.prototype={evaluate:function(t){let e,s=0,r=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null!=r&&(s=r.hoY,null!=r.roa&&r.roc.rcImage>=0&&null!=(e=t.rhApp.imageBank.getImageInfoEx(r.roc.rcImage,r.roc.rcAngle,r.roc.rcScaleX,r.roc.rcScaleY)))){t.rh4Results[t.rh4PosPile]=s+e.yAP-e.ySpot;return}t.rh4Results[t.rh4PosPile]=s}},oR.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.getAcc()}},oq.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoY-e.hoImgYSpot+e.hoImgHeight}},oz.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoY}},oJ.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoY-e.hoImgYSpot}},oQ.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=e.roc.rcAngle,r=t.GetMBase(e);r&&(s=r.getAngle())==n5.ANGLE_MAGIC&&(s=e.roc.rcAngle),t.rh4Results[t.rh4PosPile]=s}},oZ.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(t.rh4CurToken++,null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=t.get_ExpressionInt();t.rh4CurToken++;let r=t.get_ExpressionInt(),n=0;-1!=e.roc.rcImage&&(n=t.rhApp.imageBank.getImageFromHandle(e.roc.rcImage).getPixel(s,r),n=h.swapRGB(n)),t.rh4Results[t.rh4PosPile]=n}},o9.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.roc.rcScaleX,t.flagFloat=!0}},nt.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.roc.rcScaleY,t.flagFloat=!0}},ne.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getDurationChannel(e-1)}},ni.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getFrequencyChannel(e-1)}},ns.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getPositionChannel(e-1)}},nr.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getDurationSample(e)}},nh.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getFrequencySample(e)}},(function t(){}).prototype={evaluate:function(t){let e=100*t.rhApp.soundPlayer.getMainPan();e<0?e-=.5:e+=.5,t.rh4Results[t.rh4PosPile]=e}},no.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getMainVolume()}},nn.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getPositionSample(e)}},na.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.get_ExpressionInt();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getVolumeChannel(e-1)}},nl.prototype={evaluate:function(t){t.rh4CurToken++;let e=t.getExpression();t.rh4Results[t.rh4PosPile]=t.rhApp.soundPlayer.getVolumeSample(e)}},nu.prototype={evaluate:function(t){t.rh4CurToken++,t.getExpression(),t.rh4Results[t.rh4PosPile]=0}},nc.prototype={evaluate:function(t){t.rh4CurToken++,t.getExpression(),t.rh4Results[t.rh4PosPile]=0}},nd.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=40*t.rhApp.deltaWheel}},np.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.getXMouse()}},nm.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.getYMouse()}},nf.prototype={evaluate:function(t){let e=this.oi,s=ny.CTRLTYPE_KEYBOARD;e<ny.MAX_PLAYER&&(s=t.rhApp.getCtrlType()[e]),s==ny.CTRLTYPE_KEYBOARD&&(s=ny.CTRLTYPE_MOUSE),t.rh4Results[t.rh4PosPile]=s}},n$.prototype={evaluate:function(t){this.oi,t.rh4CurToken++,t.get_ExpressionInt();let e="";key<ny.MAX_KEY&&(e=vkCode>=96&&vkCode<=105?"Numpad"+(c=vkCode-96).toString():vkCode>=112&&vkCode<=126?"F"+(c=vkCode-112).toString():vkCode>=48&&vkCode<=57?(c=vkCode-48).toString():vkCode>=65&&vkCode<=90?String.fromCharCode(vkCode):"Control key"),t.rh4Results[t.rh4PosPile]=e}},ng.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhApp.playerNames[this.oi]}},nP.prototype={evaluate:function(t){t.rh4Results[t.rh4PosPile]=t.rhApp.getLives()[this.oi]}},n8.prototype={evaluate:function(t){let e=t.rhApp.getScores();t.rh4Results[t.rh4PosPile]=e[this.oi]}},nE.prototype={evaluate:function(t){let e=0;null!=t.rhEvtProg.get_ExpressionObjects(this.oiList)&&(null!=t.rh4CurrentForEach&&this.oiList==t.rh4CurrentForEach.oi&&(e=t.rh4CurrentForEach.index),null!=t.rh4CurrentForEach2&&this.oiList==t.rh4CurrentForEach2.oi&&(e=t.rh4CurrentForEach2.index)),t.rh4Results[t.rh4PosPile]=e}},n_.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETFRICTION,0)}},nA.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETRESTITUTION,0)}},n0.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETDENSITY,0)}},nv.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETVELOCITY,0)}},nO.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETANGLE,0)}},nA.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETRESTITUTION,0)}},nS.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoImgWidth}},nT.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.hoImgHeight}},nb.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETMASS,0)}},nC.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==t.GetMBase(e)){t.rh4Results[t.rh4PosPile]=0;return}t.rh4Results[t.rh4PosPile]=e.rom.rmMovement.callMovement(rW.EXP_EXTGETANGULARVELOCITY,0)}},nL.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]="";return}t.rh4Results[t.rh4PosPile]=e.hoOiList.oilName}},r.FusionVersion="Clickteam Fusion HTML5 Exporter Build 291.2",ny.MAX_PLAYER=4,ny.RUNTIME_VERSION=770,ny.MAX_KEY=8,ny.GA_NOHEADING=2,ny.GA_STRETCHTOFIT=4,ny.GA_SPEEDINDEPENDANT=8,ny.GA_STRETCH=16,ny.GA_MENUHIDDEN=128,ny.GA_MENUBAR=256,ny.GA_MAXIMISE=512,ny.GA_MIX=1024,ny.GA_FULLSCREENATSTART=2048,ny.GANF_SAMPLESOVERFRAMES=1,ny.GANF_RUNFRAME=4,ny.GANF_SAMPLESEVENIFNOTFOCUS=8,ny.GANF_NOTHICKFRAME=64,ny.GANF_DONOTCENTERFRAME=128,ny.GANF_DISABLE_CLOSE=512,ny.GANF_HIDDENATSTART=1024,ny.GANF_VSYNC=4096,ny.GAOF_JAVASWING=4096,ny.GAOF_JAVAAPPLET=8192,ny.RUNTIME_CM=1,ny.SL_RESTART=0,ny.SL_STARTFRAME=1,ny.SL_FRAMEFADEINLOOP=2,ny.SL_FRAMELOOP=3,ny.SL_FRAMEFADEOUTLOOP=4,ny.SL_ENDFRAME=5,ny.SL_QUIT=6,ny.SL_WAITFORMOCHI=7,ny.MAX_VK=203,ny.VK_LEFT=37,ny.VK_RIGHT=39,ny.VK_UP=38,ny.VK_DOWN=40,ny.VK_LBUTTON=200,ny.VK_MBUTTON=201,ny.VK_RBUTTON=202,ny.VK_NUMPAD0=96,ny.VK_NUMPAD1=97,ny.VK_NUMPAD2=98,ny.VK_NUMPAD3=99,ny.VK_NUMPAD4=100,ny.VK_NUMPAD5=101,ny.VK_NUMPAD6=102,ny.VK_NUMPAD7=103,ny.VK_NUMPAD8=104,ny.VK_NUMPAD9=105,ny.VK_S=83,ny.VK_D=68,ny.VK_E=69,ny.VK_X=88,ny.VK_F12=123,ny.VK_SHIFT=16,ny.VK_CONTROL=17,ny.VK_MENU=18,ny.CTRLTYPE_MOUSE=0,ny.CTRLTYPE_JOY1=1,ny.CTRLTYPE_JOY2=2,ny.CTRLTYPE_JOY3=3,ny.CTRLTYPE_JOY4=4,ny.CTRLTYPE_KEYBOARD=5,ny.ARF_INGAMELOOP=4,ny.BUILDFLAG_TEST=128,ny.AH2OPT_KEEPSCREENRATIO=1,ny.AH2OPT_RESAMPLESTRETCH=4,ny.AH2OPT_WEBGL=65536,ny.AH2OPT_KEEPRESOURCESBETWEENFRAMES=32768,ny.AH2OPT_RUNEVENIFNOTFOCUS=1048576,ny.AH2OPT_PRELOADERQUIT=8388608,ny.AH2OPT_LOADDATAATSTART=16777216,ny.AH2OPT_LOADSOUNDSONTOUCH=33554432,ny.AH2OPT_DESTROYIFNOINACTIVATE=67108864,ny.MAX_TOUCHES=10,ny.FAKE_TOUCHIDENTIFIER=592880741,ny.TOUCHID_EMPTY=1770410840,ny.MOUSE_DOUBLE_CLICK_DELAY=300,r.loadApplication=nI,r.loadInfo=nF,ny.prototype={loadInfo:function(){let t=this.infoFile.readAInt();if(this.infoVersion<0&&(this.infoVersion=t),t!=this.infoVersion){this.infoFile.setUnicode(!0);let e=this.infoFile.readAString(),s=this.infoPath+e;window.open(s,"_self")}this.infoCounter=25},load:function(){this.numberOfFiles=this.file.readAShort(),this.currentFile=1,this.loadingFile=new g;let t=this.file.readAInt(),e=this.path.substring(0,this.path.length-1)+this.currentFile.toString();this.loadingFile.getFile(e,nI,t)},loadApplication:function(){if(this.currentFile++,this.currentFile>this.numberOfFiles){let t=new lT(this.loadingFile.getBytes(),"content").file("Application.ccj").asBinary();this.loadingFile=null,this.file=new g,this.file.setBinary(t),this.digest(),this.startApplication();return}let e=this.file.readAInt(),s=this.path.substring(0,this.path.length-1)+this.currentFile.toString();this.loadingFile.getFile(s,nI,e)},digest:function(){this.file.seek(0);var t,e,s=this.file.readBuffer(4);this.bUnicode=!1,80==s[0]&&65==s[1]&&77==s[2]&&85==s[3]&&(this.bUnicode=!0),this.file.setUnicode(this.bUnicode),this.file.skipBytes(8),this.file.skipBytes(4),this.OIList=new ad,this.imageBank=new nV(this),this.fontBank=new nK(this),this.soundBank=new nz(this),this.soundPlayer=new nM(this);for(let r=0;32639!=r;)if(r=this.file.readAShort(),a=this.file.readAShort(),0!=(l=this.file.readAInt())){switch(t=this.file.getFilePointer()+l,r){case 8739:for(this.loadAppHeader(),this.frameOffsets=Array(this.gaNbFrames),this.frameEffects=Array(this.gaNbFrames),this.frameEffectParams=Array(this.gaNbFrames),this.framePasswords=Array(this.gaNbFrames),e=0;e<this.gaNbFrames;e++)this.framePasswords[e]=null;break;case 8773:this.dwOptions=this.file.readAInt(),this.dwBuildType=this.file.readAInt(),this.dwBuildFlags=this.file.readAInt(),this.wScreenRatioTolerance=this.file.readAShort(),this.wScreenAngle=this.file.readAShort();break;case 8740:this.appName=this.file.readAString();break;case 8774:this.codePage=this.file.readAInt();break;case 8750:this.appEditorFilename=this.file.readAString();break;case 8782:this.m_touchMe=this.file.readAString();break;case 8754:this.loadGlobalValues();break;case 8755:this.loadGlobalStrings();break;case 8745:case 8767:this.extLoader=new l1(this),this.extLoader.createList(this.file),this.OIList.preLoad(this.file);break;case 8747:this.loadFrameHandles(l);break;case 8778:this.preloaderType=this.file.readAInt(),this.preloaderCircleCenterX=this.file.readAInt(),this.preloaderCircleCenterY=this.file.readAInt(),this.preloaderCircleRadius=this.file.readAInt(),this.preloaderCircleThickness=this.file.readAInt(),this.preloaderCircleColor=this.file.readAColor(),this.preloaderBackColor=this.file.readAInt(),-1!=this.preloaderBackColor&&(this.file.skipBack(4),this.preloaderBackColor=this.file.readAColor()),this.preloaderFrameNumber=this.file.readAInt(),this.loadPreloader=!0;break;case 13107:this.frameOffsets[this.frameMaxIndex]=this.file.getFilePointer();for(let h=0;32639!=h;)if(h=this.file.readAShort(),u=this.file.readAShort(),0!=(d=this.file.readAInt())){let n=this.file.getFilePointer()+d;switch(h){case 13108:0==this.frameMaxIndex&&(this.file.skipBytes(8),this.firstFrameColor=this.file.readAColor());break;case 13110:this.framePasswords[this.frameMaxIndex]=this.file.readAString();break;case 13129:this.frameEffects[this.frameMaxIndex]=this.file.readAInt(),this.frameEffectParams[this.frameMaxIndex]=this.file.readAInt();break;case 13128:var a,l,u,d,e,p=d/6;for(e=0;e<p;e++){let m=this.file.readAShort();this.file.skipBytes(4),0!=m&&(this.mosaics[m]=1,this.mosaicMaxHandle=Math.max(this.mosaicMaxHandle,m+1))}}this.file.seek(n)}this.frameMaxIndex++;break;case 8760:var f=this.file.readAInt();for(e=0,this.embeddedFiles=Array(f);e<f;e++)this.embeddedFiles[e]=new n2(this),this.embeddedFiles[e].preLoad();break;case 26214:this.imageBank.preLoad(this.file);break;case 26215:this.fontBank.preLoad(this.file);break;case 26216:this.soundBank.preLoad(this.file)}this.file.seek(t)}this.context=new aU(this.canvas),this.soundPlayer.setMultipleSounds((this.gaFlags&ny.GA_MIX)!=0),null==this.parentApp&&(this.mainSprite=new ly)},setParentApp:function(t,e,s,r,h,n){this.parentApp=t,this.parentOptions=s,this.mainSprite=r,this.startFrame=e,this.parentWidth=h,this.parentHeight=n},initScreenZoom:function(){this.bZoom=!1,this.scAngle=0,this.scScale=this.scScaleX=this.scScaleY=1,this.scXSpot=this.scXDest=this.gaCxWin/2,this.scYSpot=this.scYDest=this.gaCyWin/2},setUpdate:function(){window.setTimeout(lF.bind(this),20)},startApplication:function(){for(this.iOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent)||/iPod/i.test(navigator.userAgent),this.iOS&&this.soundBank.nHandlesReel>0&&(this.silentSound=new nJ(this),this.silentSound.loadSilent()),this.resizeCanvas(),this.sysEvents=new P,this.keyBuffer=Array(ny.MAX_VK),t=0;t<ny.MAX_VK;t++)this.keyBuffer[t]=!1;if(this.canvas.application=this,null==this.parentApp){var t,e=this;if(window.addEventListener("keypress",function(t){e.doKeyPress(t)},!1),window.addEventListener("keydown",function(t){e.doKeyDown(t)},!1),window.addEventListener("keyup",function(t){e.doKeyUp(t)},!1),window.addEventListener("blur",function(t){e.hasFocus=!1},!1),window.addEventListener("focus",function(t){e.hasFocus=!0},!1),window!==window.top)try{let s=window.top;s.addEventListener("focus",function(){e.hasFocus=!0,e.canvas.focus()}),s.addEventListener("blur",function(){e.hasFocus=!1})}catch(r){}window.addEventListener("resize",function(t){e.resizeCanvas()},!1),document.addEventListener("blur",function(t){e.hasFocus=!1},!1),document.addEventListener("focus",function(t){e.hasFocus=!0},!1),document.addEventListener("fullscreenchange",function(){e.fullScreen=document.fullscreen,e.resizeCanvas()},!1),document.addEventListener("mozfullscreenchange",function(){e.fullScreen=document.mozFullScreen,e.resizeCanvas()},!1),document.addEventListener("webkitfullscreenchange",function(){e.fullScreen=document.webkitIsFullScreen,e.resizeCanvas()},!1),window.PointerEvent?("undefined"==typeof CRunMultipleTouch||(this.canvas.setAttribute("style","-ms-touch-action: none;"),this.canvas.setAttribute("style","touch-action: none;")),this.canvas.addEventListener("pointerdown",function(t){switch(t.pointerType){case"mouse":case"pen":e.mouseDown(t,!0);break;case"touch":e.touchStart(t,!0)}t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("pointermove",function(t){switch(t.pointerType){case"mouse":case"pen":e.mouseMove(t,e.canvas);break;case"touch":e.touchMove(t,!0)}t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("pointerup",function(t){switch(t.pointerType){case"mouse":case"pen":e.mouseUp(t);break;case"touch":e.touchEnd(t,!0)}t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("pointercancel",function(t){"touch"===t.pointerType&&e.touchEnd(t,!0),t.preventDefault&&t.preventDefault()},!1)):(this.canvas.addEventListener("mousemove",function(t){e.mouseMove(t,e.canvas),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("mousedown",function(t){e.mouseDown(t,!1),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("mouseup",function(t){e.mouseUp(t),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("mouseout",function(t){e.mouseOut(t),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("click",function(t){e.click(t),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("dblclick",function(t){e.dblClick(t),t.preventDefault&&t.preventDefault()},!1)),this.canvas.addEventListener("contextmenu",function(t){t.preventDefault&&t.preventDefault()},!1);let h=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";for(document.attachEvent?document.attachEvent("on"+h,function(t){e.mouseWheel(t)}):document.addEventListener&&document.addEventListener(h,function(t){e.mouseWheel(t)},!1),document.onselectstart=function(){return!1},this.canvas.onselectstart=function(t){return t.preventDefault&&t.preventDefault(),!1},this.touchable=this.isTouchable(),this.touchCalls=new P,this.touchesID=Array(ny.MAX_TOUCHES),this.bTouchesLocked=Array(ny.MAX_TOUCHES),this.touchesLocked=Array(ny.MAX_TOUCHES),this.touchesX=Array(ny.MAX_TOUCHES),this.touchesY=Array(ny.MAX_TOUCHES),t=0;t<ny.MAX_TOUCHES;t++)this.touchesID[t]=ny.TOUCHID_EMPTY,this.touchesX[t]=0,this.touchesY[t]=0,this.bTouchesLocked[t]=!1,this.touchesLocked[t]=0;this.nTouches=0,this.touchable&&!window.PointerEvent&&(this.canvas.addEventListener("touchstart",function(t){e.touchStart(t,!1),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("touchmove",function(t){e.touchMove(t,!1),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("touchend",function(t){e.touchEnd(t,!1),t.preventDefault&&t.preventDefault()},!1),this.canvas.addEventListener("touchcancel",function(t){e.touchEnd(t,!1),t.preventDefault&&t.preventDefault()},!1)),window.focus(),this.setUpdate()}else{for(t=0,this.touchable=this.parentApp.touchable,this.touchCalls=new P,this.touchesID=Array(ny.MAX_TOUCHES),this.bTouchesLocked=Array(ny.MAX_TOUCHES),this.touchesLocked=Array(ny.MAX_TOUCHES),this.touchesX=Array(ny.MAX_TOUCHES),this.touchesY=Array(ny.MAX_TOUCHES);t<ny.MAX_TOUCHES;t++)this.touchesID[t]=ny.TOUCHID_EMPTY,this.touchesX[t]=0,this.touchesY[t]=0,this.bTouchesLocked[t]=!1,this.touchesLocked[t]=0;this.nTouches=0}this.xMouseOffset=0,this.yMouseOffset=0,this.appRunningState=0,this.currentFrame=-2,this.run=new nD(this)},resizeCanvas:function(){let t,e,s=this.gaCxWin,r=this.gaCyWin;this.fullScreen||this.gaFlags&ny.GA_STRETCH?(t=window.innerWidth,e=window.innerHeight,document.documentElement.style.overflow="hidden",document.body.scroll="no"):(t=s,e=r);let h=t/s,n=e/r;(this.dwOptions&ny.AH2OPT_KEEPSCREENRATIO||this.gaFlags&ny.GA_STRETCH&&this.gaFlags&ny.GA_STRETCHTOFIT)&&(h=n=Math.min(h,n)),(h!=this.scaleX||n!=this.scaleY)&&(this.scaleX=h,this.scaleY=n,this.canvas.width=Math.floor(this.scaleX*s),this.canvas.height=Math.floor(this.scaleY*r),this.context.setScale(this.scaleX,this.scaleY),window.innerWidth,this.canvas.width,window.innerHeight,this.canvas.height),this.run&&this.run.autoResize()},resetKeyBuffer:function(){let t;for(t=0;t<ny.MAX_VK;t++)this.keyBuffer[t]=!1},isTouchable:function(){let t,e=["Android","webOS","iPhone","iPad","iPod","Blackberry","Windows Phone","Touch"],s=navigator.userAgent;for(t in e)if(s.indexOf(e[t])>=0)return!0;return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},dataHasLoaded:function(t){this.dataLoading.removeObject(t),this.imagesLoaded++},addDataToLoad:function(t){this.dataToLoad.add(t),this.imagesToLoad++,this.loading=!0},stepApplication:function(){this.infoPath&&(this.infoCounter--,this.infoCounter<0&&(this.infoCounter=1e9,this.infoFile=new g,this.infoFile.getFile(this.infoPath+"info.dat",nF)));let t=new Date;if(this.timer=t.getTime(),!this.playApplication(!1))return this.endApplication(),!1;if(this.loading){if(null==this.preloader){let e=this.frameColor;this.loadPreloader?(this.preloader=0==this.preloaderType?new nw(this):new nN(this),0==this.preloaderType&&-1!=this.preloaderBackColor&&(e=this.preloaderBackColor)):this.preloader=new nk(this),this.preloaderLoaded=!1,this.resetted=!0,null==this.parentApp&&(this.frame.leClearBackground?this.context.clearBackground(0,0,this.canvas.width,this.canvas.height):this.context.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,e),this.setUpdate());return}if(null!=this.preloader&&!1==this.preloaderLoaded){this.preloaderLoaded=this.preloader.load(),null==this.parentApp&&this.setUpdate();return}for(;this.dataToLoad.size()>0&&this.dataLoading.size()<this.dataLoadingStep;){let s=this.dataToLoad.get(0);this.dataLoading.add(s),this.dataToLoad.removeIndex(0),s.doLoad()}this.soundPlayer.decodeData();let r=!1;0==this.dataToLoad.size()&&0==this.dataLoading.size()&&(r=!0),null!=this.preloader&&((this.dwOptions&ny.AH2OPT_LOADDATAATSTART)!=0||(this.frame.html5Options&nR.HTML5FOPT_DISPLAYPRELOADER)!=0)&&(this.resetted||(this.preloader.reset(),this.resetted=!0),this.preloader.step(),r=this.preloader.isComplete()),r&&(this.resetted=!1,this.run.resume(),this.run.callComputeNewDisplay(),this.loading=!1,this.imageBank.resetToLoad(),this.soundBank.resetToLoad(),this.fontBank.resetToLoad(),this.imagesToLoad=0,this.imagesLoaded=0,this.bStartFadeIn)&&(this.bStartFadeIn=!1,0!=this.run.doRunLoop()?this.appRunningState=ny.SL_ENDFRAME:(this.appRunningState=ny.SL_FRAMELOOP,this.startFrameFadeIn(this.transitionOldSurface),this.transitionOldSurface=null)),null==this.parentApp&&this.setUpdate()}else if(null==this.parentApp){if(null==this.transitionDisplay){this.context.resetEffect((this.dwOptions&ny.AH2OPT_RESAMPLESTRETCH)!=0),this.previousFrameGraphics?this.context.renderSimpleImage(this.previousFrameGraphics,0,0,this.gaCxWin,this.gaCyWin,0,0):this.frame.leClearBackground?this.context.clearBackground(0,0,this.gaCxWin,this.gaCyWin):this.context.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,this.frameColor);let n=this.context._context;if(this.bZoom&&(bRestore=!0,n.save(),n.translate(this.scXDest,this.scYDest),0!=this.scAngle&&n.rotate(-(.0174532925*this.scAngle)),n.scale(Math.max(.001,this.scScaleX),Math.max(.001,this.scScaleY)),n.translate(-this.scXSpot,-this.scYSpot)),this.mainSprite.draw(this.context,0,0),this.bZoom&&n.restore(),this.joystickOn&&this.joystick.draw(this.context),this.versionCodeDisplay){if(this.versionCodeDisplay--,!this.versionCodeSurface){let a=new nq;a.createDefaultFont(),a.lfHeight=16,this.versionCodeSurface=new S(this,this.gaCxWin,30),this.versionCodeSurface.manualClear(16711680),this.versionCodeSurface.manualDrawText(window.FusionVersion,h.DT_CENTER|h.DT_VCENTER,null,16777215,a,1,10526880)}this.versionCodeSurface.draw(this.context,0,0,0,0)}}else this.context.resetEffect(),this.context.renderSimpleImage(this.transitionDisplay,0,0,this.gaCxWin,this.gaCyWin,0,0);if((this.gaNewFlags&ny.GANF_VSYNC)!=0&&window.requestAnimationFrame)window.requestAnimationFrame(lF);else{let l=new Date().getTime()-this.timer;l=Math.max(1e3/this.gaFrameRate-l,1),window.setTimeout(lF,l)}}return!0},drawSubApplication:function(t,e,s,r){this.loading||(this.context.resetEffect((this.dwOptions&ny.AH2OPT_RESAMPLESTRETCH)!=0),null==this.transitionDisplay?(r||this.context.renderSolidColor(e,s,this.parentWidth,this.parentHeight,this.frameColor),this.context.clip(e,s,this.parentWidth,this.parentHeight),this.mainSprite.draw(this.context,0,0),this.context.unClip()):(this.context.resetEffect(),this.context.renderSimpleImage(this.transitionDisplay,e,s,this.gaCxWin,this.gaCyWin,0,0)))},checkFocus:function(){if((this.dwOptions&ny.AH2OPT_RUNEVENIFNOTFOCUS)==0){if(this.hasFocus)this.bStoppedFocus&&(this.run.resume(),this.bStoppedFocus=!1);else{let t=this.gaNewFlags&ny.GANF_SAMPLESEVENIFNOTFOCUS;this.run.pause(t),this.bStoppedFocus=!0}}},playApplication:function(t){this.checkFocus();let e=!0,s=!0;do switch(this.appRunningState){case ny.SL_RESTART:if(this.initGlobal(),this.nextFrame=this.startFrame,this.appRunningState=1,this.killGlobalData(),t){e=!1;break}case ny.SL_STARTFRAME:this.startTheFrame();break;case ny.SL_FRAMEFADEINLOOP:!1==this.loopFrameFadeIn()?(this.endFrameFadeIn(),(this.appRunningState==ny.SL_QUIT||this.appRunningState==ny.SL_RESTART)&&this.endFrame()):e=!1;break;case ny.SL_FRAMELOOP:this.run.doRunLoop(),0!=this.run.rhQuit?this.startFrameFadeOut()?this.appRunningState=ny.SL_FRAMEFADEOUTLOOP:this.endFrame():e=!1;break;case ny.SL_FRAMEFADEOUTLOOP:!1==this.loopFrameFadeOut()?(this.endFrameFadeOut(),(this.appRunningState==ny.SL_QUIT||this.appRunningState==ny.SL_RESTART)&&this.endFrame()):e=!1;break;case ny.SL_ENDFRAME:this.endFrame();break;default:e=!1}while(!0==e);return this.appRunningState==ny.SL_QUIT&&(s=!1),s},endApplication:function(){null!=this.soundPlayer&&this.soundPlayer.stopAllSounds()},startTheFrame:function(){for(this.nextFrame!=this.currentFrame&&(this.frame=new nR(this),this.frame.loadFullFrame(this.nextFrame)),this.frameColor=this.frame.leBackground,this.currentFrame=this.nextFrame,this.frame.leX=this.frame.leY=0,this.frame.leLastScrlX=this.frame.leLastScrlY=0,this.frame.rhOK=!1,this.initScreenZoom(),null!=this.parentApp?(this.xOffset=0,this.yOffset=0):(this.xOffset=this.gaCxWin/2-this.frame.leEditWinWidth/2,this.yOffset=this.gaCyWin/2-this.frame.leEditWinHeight/2),t=0;t<this.frame.nLayers;t++)this.frame.layers[t].createPlanes(this.xOffset,this.yOffset);if(this.frame.leFlags&nR.LEF_DISPLAYNAME&&(document.title=this.frame.frameName),this.previousFrameGraphics=null,this.frame.leFlags&nR.LEF_KEEPDISPLAY&&(this.previousFrameGraphics=this.transitionOldSurface),this.frame.leFlags&nR.LEF_TRANSPARENTBKD&&(this.frame.leClearBackground=!0),this.run.setFrame(this.frame),this.run.initRunLoop(null!=this.frame.fadeIn),this.appRunningState=ny.SL_FRAMELOOP,null!=this.frame.fadeIn){if(this.loading)this.bStartFadeIn=!0;else{var t;0!=this.run.doRunLoop()?this.appRunningState=ny.SL_ENDFRAME:(this.appRunningState=ny.SL_FRAMELOOP,this.startFrameFadeIn(this.transitionOldSurface),this.transitionOldSurface=null)}}else this.transitionOldSurface=null;this.loading?this.run.pause(!0):this.run.callComputeNewDisplay()},resetLayers:function(){let t;for(null!=this.parentApp?(this.xOffset=0,this.yOffset=0):(this.xOffset=this.gaCxWin/2-this.frame.leEditWinWidth/2,this.yOffset=this.gaCyWin/2-this.frame.leEditWinHeight/2),t=0;t<this.frame.nLayers;t++)this.frame.layers[t].resetPlanes(this.xOffset,this.yOffset)},endFrame:function(){let t,e;if(t=this.run.killRunLoop(!1),(this.gaNewFlags&ny.GANF_RUNFRAME)!=0)this.appRunningState=ny.SL_QUIT;else switch(h.LOWORD(t)){case 1:this.nextFrame=this.currentFrame+1,1==this.preloaderType&&this.nextFrame==this.preloaderFrameNumber&&this.nextFrame++,this.appRunningState=ny.SL_STARTFRAME,this.nextFrame>=this.gaNbFrames&&(this.appRunningState=ny.SL_QUIT);break;case 2:this.nextFrame=Math.max(0,this.currentFrame-1),1==this.preloaderType&&this.nextFrame==this.preloaderFrameNumber&&(0==this.nextFrame?this.nextFrame=this.currentFrame:this.nextFrame--),this.appRunningState=ny.SL_STARTFRAME;break;case 3:this.appRunningState=ny.SL_STARTFRAME,(32768&h.HIWORD(t))!=0?(this.nextFrame=32767&h.HIWORD(t),this.nextFrame>=this.gaNbFrames&&(this.nextFrame=this.gaNbFrames-1),this.nextFrame<0&&(this.nextFrame=0)):h.HIWORD(t)<this.frameMaxHandle?(this.nextFrame=this.frameHandleToIndex[h.HIWORD(t)],-1==this.nextFrame&&(this.nextFrame=this.currentFrame+1)):this.nextFrame=this.currentFrame+1;break;case 4:this.appRunningState=ny.SL_RESTART,this.nextFrame=this.startFrame;break;default:this.appRunningState=ny.SL_QUIT}if(this.appRunningState==ny.SL_STARTFRAME&&(this.nextFrame<0||this.nextFrame>=this.gaNbFrames)&&(this.appRunningState=this.currentFrame),this.appRunningState!=ny.SL_STARTFRAME||this.nextFrame!=this.currentFrame){for(e=0;e<this.frame.nLayers;e++)this.frame.layers[e].deletePlanes();this.frame=null,this.currentFrame=-1}},getTransitionManager:function(){return null==this.transitionManager&&(this.transitionManager=new aJ(this)),this.transitionManager},startFrameFadeIn:function(t){let e=null,s=null,r=this.frame.fadeIn;if(null!=r){(e=document.createElement("canvas")).width=this.gaCxWin,e.height=this.gaCyWin,(s=document.createElement("canvas")).width=this.gaCxWin,s.height=this.gaCyWin;let h=new aU(s);if(h.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,this.frameColor),this.mainSprite.draw(h,0,0),h=new aU(e),(r.transFlags&aK.TRFLAG_COLOR)!=0?h.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,r.transColor):(h.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,this.gaBorderColour),null!=t&&h.renderSimpleImage(t,0,0,t.width,t.height,0,0)),this.transitionDisplay=document.createElement("canvas"),this.transitionDisplay.width=this.gaCxWin,this.transitionDisplay.height=this.gaCyWin,this.transitionDisplay.getContext("2d").drawImage(e,0,0),this.transition=this.getTransitionManager().createTransition(r,this.transitionDisplay,e,s),null!=this.transition)return this.appRunningState=ny.SL_FRAMEFADEINLOOP,!0}return this.transitionDisplay=null,this.appRunningState=ny.SL_FRAMELOOP,this.run.createRemainingFrameObjects(),!1},loopFrameFadeIn:function(){return null!=this.transition&&!this.transition.isCompleted()&&(this.transition.stepDraw(az.TRFLAG_FADEIN),!0)},endFrameFadeIn:function(){return null!=this.transition&&(this.transition.end(),this.transition=null,this.transitionDisplay=null,this.appRunningState==ny.SL_FRAMEFADEINLOOP&&(this.appRunningState=ny.SL_FRAMELOOP),this.run.createRemainingFrameObjects()),!0},startFrameFadeOut:function(){let t=null,e=null,s=this.frame.fadeOut;if(null!=s){(t=document.createElement("canvas")).width=this.gaCxWin,t.height=this.gaCyWin,(e=document.createElement("canvas")).width=this.gaCxWin,e.height=this.gaCyWin;let r=new aU(t);if(r.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,this.frameColor),this.mainSprite.draw(r,0,0),r=new aU(e),(s.transFlags&aK.TRFLAG_COLOR)!=0?r.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,s.transColor):r.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,0),this.transitionDisplay=document.createElement("canvas"),this.transitionDisplay.width=this.gaCxWin,this.transitionDisplay.height=this.gaCyWin,this.transitionDisplay.getContext("2d").drawImage(t,0,0),this.transition=this.getTransitionManager().createTransition(s,this.transitionDisplay,t,e),null!=this.transition)return this.appRunningState=ny.SL_FRAMEFADEOUTLOOP,!0}return this.transitionDisplay=null,!1},loopFrameFadeOut:function(){if(null!=this.transition){if(this.transition.isCompleted())return this.endFrameFadeOut(),!1;this.transition.stepDraw(az.TRFLAG_FADEOUT)}return!0},endFrameFadeOut:function(){return null!=this.transition&&(this.transitionOldSurface=this.transition.source2,this.transition.end(),this.transition=null,this.transitionDisplay=null,this.appRunningState==ny.SL_FRAMEFADEOUTLOOP&&(this.appRunningState=ny.SL_ENDFRAME)),!0},loadAppHeader:function(){let t,e;for(this.file.skipBytes(4),this.gaFlags=this.file.readAShort(),this.gaNewFlags=this.file.readAShort(),this.gaMode=this.file.readAShort(),this.gaOtherFlags=this.file.readAShort(),this.gaCxWin=this.file.readAShort(),this.gaCyWin=this.file.readAShort(),this.gaScoreInit=this.file.readAInt(),this.gaLivesInit=this.file.readAInt(),this.pcCtrlType=Array(ny.MAX_PLAYER),t=0;t<ny.MAX_PLAYER;t++)this.pcCtrlType[t]=this.file.readAShort();for(t=0,this.pcCtrlKeys=Array(ny.MAX_PLAYER*ny.MAX_KEY);t<ny.MAX_PLAYER;t++)for(e=0;e<ny.MAX_KEY;e++)this.pcCtrlKeys[t*ny.MAX_KEY+e]=this.file.readAShort();this.gaBorderColour=this.file.readAColor(),this.gaNbFrames=this.file.readAInt(),this.gaFrameRate=this.file.readAInt(),this.file.skipBytes(1),this.file.skipBytes(3)},loadGlobalValues:function(){let t;for(t=0,this.nGlobalValuesInit=this.file.readAShort(),this.globalValuesInit=Array(this.nGlobalValuesInit),this.globalValuesInitTypes=Array(this.nGlobalValuesInit);t<this.nGlobalValuesInit;t++)this.globalValuesInit[t]=this.file.readAInt();this.file.readBytesAsArray(this.globalValuesInitTypes)},loadGlobalStrings:function(){let t;for(t=0,this.nGlobalStringsInit=this.file.readAInt(),this.globalStringsInit=Array(this.nGlobalStringsInit);t<this.nGlobalStringsInit;t++)this.globalStringsInit[t]=this.file.readAString()},loadFrameHandles:function(t){let e;for(e=0,this.frameMaxHandle=t/2,this.frameHandleToIndex=Array(this.frameMaxHandle);e<this.frameMaxHandle;e++)this.frameHandleToIndex[e]=this.file.readAShort()},HCellToNCell:function(t){return null==this.frameHandleToIndex||-1==t||t>=this.frameMaxHandle?-1:this.frameHandleToIndex[t]},getGraphicFont:function(t){if(this.graphicFonts){let e;for(e=0;e<this.graphicFonts.size();e++)if((gFont=this.graphicFonts.get(e)).compareFont(t))return gFont}return t},killGlobalData:function(){this.adGO=null},initGlobal:function(){let t;if(null==this.parentApp||null!=this.parentApp&&(this.parentOptions&aO.CCAF_SHARE_LIVES)==0)for(t=0,this.lives=Array(ny.MAX_PLAYER);t<ny.MAX_PLAYER;t++)this.lives[t]=4294967295^this.gaLivesInit;else this.lives=null;if(null==this.parentApp||null!=this.parentApp&&(this.parentOptions&aO.CCAF_SHARE_SCORES)==0)for(t=0,this.scores=Array(ny.MAX_PLAYER);t<ny.MAX_PLAYER;t++)this.scores[t]=4294967295^this.gaScoreInit;else this.scores=null;for(t=0,this.playerNames=Array(ny.MAX_PLAYER);t<ny.MAX_PLAYER;t++)this.playerNames[t]="";if(null==this.parentApp||null!=this.parentApp&&(this.parentOptions&aO.CCAF_SHARE_GLOBALVALUES)==0)for(t=0,this.gValues=Array(this.nGlobalValuesInit);t<this.nGlobalValuesInit;t++)this.gValues[t]=this.globalValuesInit[t];else this.gValues=null;if(null==this.parentApp||null!=this.parentApp&&(this.parentOptions&aO.CCAF_SHARE_GLOBALVALUES)==0)for(t=0,this.gStrings=Array(this.nGlobalStringsInit);t<this.nGlobalStringsInit;t++)this.gStrings[t]=this.globalStringsInit[t];else this.gStrings=null},getLives:function(){for(var t=this;null==t.lives;)t=this.parentApp;return t.lives},getScores:function(){for(var t=this;null==t.scores;)t=this.parentApp;return t.scores},getCtrlType:function(){for(var t=this;null!=t.parentApp&&(t.parentOptions&aO.CCAF_SHARE_PLAYERCTRLS)!=0;)t=t.parentApp;return t.pcCtrlType},getCtrlKeys:function(){for(var t=this;null!=t.parentApp&&(t.parentOptions&aO.CCAF_SHARE_PLAYERCTRLS)!=0;)t=t.parentApp;return t.pcCtrlKeys},getGlobalValues:function(){for(var t=this;null==t.gValues;)t=t.parentApp;return t.gValues},getNGlobalValues:function(){return null!=this.gValues?gValues.length:0},getGlobalStrings:function(){for(var t=this;null==t.gStrings;)t=t.parentApp;return t.gStrings},getNGlobalStrings:function(){return null!=this.gStrings?gStrings.length:0},checkGlobalValue:function(t){let e,s=this.getGlobalValues();if(t<0||t>1e3)return null;let r=s.length;if(t+1>r)for(e=r;e<t+1;e++)s.push(0);return s},getGlobalValueAt:function(t){let e=this.checkGlobalValue(t);return null!=e?e[t]:0},setGlobalValueAt:function(t,e){let s=this.checkGlobalValue(t);null!=s&&(s[t]=e)},addGlobalValueAt:function(t,e){let s=this.checkGlobalValue(t);null!=s&&(s[t]+=e)},checkGlobalString:function(t){let e,s=this.getGlobalStrings();if(t<0||t>1e3)return null;let r=s.length;if(t+1>r)for(e=r;e<t+1;e++)s.push("");return s},getGlobalStringAt:function(t){let e=this.checkGlobalString(t);return null!=e?e[t]:""},setGlobalStringAt:function(t,e){let s=this.checkGlobalString(t);null!=s&&(s[t]=e)},doKeyPress:function(t){t&&(this.versionCode.charCodeAt(this.versionCodePos)==t.charCode?(this.versionCodePos++,this.versionCodePos==this.versionCode.length&&(this.versionCodeDisplay=250,this.versionCodePos=0)):this.versionCodePos=0)},doKeyDown:function(t){if(t){let e,s=t.keyCode;for(this.keyBuffer[s]=!0,this.keyNew=!0,null!=this.run&&null!=this.run.rhEvtProg&&this.run.rhEvtProg.onKeyDown(s),e=0;e<this.subApps.length;e++)this.subApps[e].doKeyDown(t)}},doKeyUp:function(t){if(t){let e,s=t.keyCode;for(e=0,this.keyBuffer[s]=!1;e<this.subApps.length;e++)this.subApps[e].doKeyUp(t)}},getKeyState:function(t){return this.keyBuffer[t]},setMouseOffsets:function(t,e){this.xMouseOffset=t,this.yMouseOffset=e},mouseMove:function(t,e,s){t.pageX?(this.mouseX=t.pageX,this.mouseY=t.pageY):t.clientY&&(this.mouseX=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.mouseY=t.clientY+document.body.scrollTop+document.documentElement.scrollTop);for(var r,h=0,n=0,a=e;a&&"BODY"!=a.tagName;)h+=a.offsetTop,n+=a.offsetLeft,a=a.offsetParent;for(this.bMouseIn=!0,this.mouseX-=n+this.xMouseOffset,this.mouseY-=h+this.yMouseOffset,this.mouseX=Math.floor(this.mouseX/this.scaleX),this.mouseY=Math.floor(this.mouseY/this.scaleY),null!=this.run&&null!=this.run.rhEvtProg&&this.run.rhEvtProg.onMouseMove(),r=0;r<this.subApps.length;r++)this.subApps[r].mouseMove(t,e);this.touchable||305419896==s||this.touchMove(new nx(t.pageX,t.pageY,this.canvas),!1)},_mouseButtonFromEvent:function(t){if(t.which)switch(t.which){case 2:return ny.VK_MBUTTON;case 3:return ny.VK_RBUTTON;default:return ny.VK_LBUTTON}else switch(t.button){case 2:return ny.VK_RBUTTON;case 4:return ny.VK_MBUTTON;default:return ny.VK_LBUTTON}},mouseUp:function(t){let e,s=this._mouseButtonFromEvent(t);for(this.mouseMove(t,this.canvas,305419896),this.bMouseIn=!0,this.keyBuffer[s]=!1,e=0;e<this.subApps.length;e++)this.subApps[e].mouseUp(t);this.touchable||this.touchEnd(new nx(t.pageX,t.pageY,this.canvas),!1)},mouseDown:function(t,e){let s,r=this._mouseButtonFromEvent(t);if(this.mouseMove(t,this.canvas,305419896),this.bMouseIn=!0,this.keyNew=!0,this.keyBuffer[r]=!0,this.enableSoundsInChrome(),null!=this.run&&null!=this.run.rhEvtProg){if(e){let h=Date.now(),n=null!==this.mouseDoubleClickTimestamp&&this.mouseDoubleClickCode==r&&h-this.mouseDoubleClickTimestamp<=ny.MOUSE_DOUBLE_CLICK_DELAY?2:1;this.mouseDoubleClickCode=r,this.mouseDoubleClickTimestamp=h,this.run.rhEvtProg.onMouseButton(r-ny.VK_LBUTTON,n)}else this.browserDetect.isIE?this.run.rhEvtProg.onMouseButton(r-ny.VK_LBUTTON,1):this.run.rhEvtProg.onMouseButton(r-ny.VK_LBUTTON,t.detail%2==0?2:1)}for(s=0;s<this.subApps.length;s++)this.subApps[s].mouseDown(t,e);this.touchable||this.touchStart(new nx(t.pageX,t.pageY,this.canvas),!1),window.focus()},forceMouseButton:function(t){let e;for(e=0,this.keyBuffer[ny.VK_LBUTTON]=t;e<this.subApps.length;e++)this.subApps[e].forceMouseButton(t)},mouseOut:function(t){let e;for(e=0,this.bMouseIn=!1,this.keyBuffer[ny.VK_LBUTTON]=!1,this.keyBuffer[ny.VK_MBUTTON]=!1,this.keyBuffer[ny.VK_RBUTTON]=!1;e<this.subApps.length;e++)this.subApps[e].mouseOut(t);this.touchable||this.touchEnd(new nx(t.pageX,t.pageY,this.canvas),!1)},click:function(t){if(this.browserDetect.isIE){let e;for(e=0;e<this.subApps.length;e++)this.subApps[e].click(t)}},dblClick:function(t){if(this.browserDetect.isIE){let e;for(null!=this.run&&null!=this.run.rhEvtProg&&this.run.rhEvtProg.onMouseButton(0,2),e=0;e<this.subApps.length;e++)this.subApps[e].dblClick(t)}},mouseWheel:function(t){this.bMouseIn=!0,void 0!==t.wheelDelta?this.deltaWheel=t.wheelDelta/40:this.deltaWheel=-t.detail,null!=this.run&&null!=this.run.rhEvtProg&&this.run.onMouseWheel(this.deltaWheel)},enableSoundsInChrome:function(){this.browserDetect.isChrome&&null!=this.soundContext&&"suspended"==this.soundContext.state&&this.soundContext.resume()},touchStart:function(t,e){if(this.enableSoundsInChrome(),!this.iOS&&this.silentSound&&(this.silentSound.playIt(),this.silentSound=null),null!=this.touchesID){let s,r,h,n,a=e?1:t.changedTouches.length;for(s=0;s<a;s++)for(e?(h=t).identifier=t.pointerId:h=t.changedTouches[s],r=0;r<ny.MAX_TOUCHES;r++)if(this.touchesID[r]==ny.TOUCHID_EMPTY){for(o=0,this.touchesID[r]=h.identifier,this.bTouchesLocked[r]=!1;o<this.touchCalls.size();o++)if(this.touchCalls.get(o).touchStarted(h)){this.bTouchesLocked[r]=!0,this.touchesLocked[r]=o;break}if(!this.bTouchesLocked[r]&&(this.touchesX[r]=this.getTouchX(h),this.touchesY[r]=this.getTouchY(h),this.mouseTouch==ny.TOUCHID_EMPTY&&h.identifier!=ny.FAKE_TOUCHIDENTIFIER))for(this.mouseTouch=r,this.mouseX=this.touchesX[r],this.mouseY=this.touchesY[r],this.bMouseIn=!0,this.keyNew=!0,this.keyBuffer[ny.VK_LBUTTON]=!0,null!=this.run&&null!=this.run.rhEvtProg&&this.run.rhEvtProg.onMouseButton(0,1),n=0;n<this.subApps.length;n++)this.subApps[n].touchStart(t,e);break}}},touchMove:function(t,e){if(null!=this.touchesID){let s,r,h,n,a,l=e?1:t.changedTouches.length;for(s=0;s<l;s++)for(e?(n=t).identifier=t.pointerId:n=t.changedTouches[s],r=0;r<ny.MAX_TOUCHES;r++)if(this.touchesID[r]==n.identifier){if(this.bTouchesLocked[r])this.touchCalls.get(this.touchesLocked[r]).touchMoved(n);else{for(h=0;h<this.touchCalls.size();h++)this.touchCalls.get(h).touchMoved(n);this.touchesX[r]=this.getTouchX(n),this.touchesY[r]=this.getTouchY(n)}if(this.mouseTouch==r)for(this.mouseX=this.touchesX[r],this.mouseY=this.touchesY[r],null!=this.run&&null!=this.run.rhEvtProg&&this.run.rhEvtProg.onMouseMove(),a=0;a<this.subApps.length;a++)this.subApps[a].touchMove(t,e);break}}},touchEnd:function(t,e){if(this.iOS&&this.silentSound&&(this.silentSound.playIt(),this.silentSound=null),null!=this.touchesID){let s,r,h,n,a,l=e?1:t.changedTouches.length;for(s=0;s<l;s++)for(e?(n=t).identifier=t.pointerId:n=t.changedTouches[s],r=0;r<ny.MAX_TOUCHES;r++)if(this.touchesID[r]==n.identifier){if(this.touchesID[r]=ny.TOUCHID_EMPTY,this.bTouchesLocked[r])this.touchCalls.get(this.touchesLocked[r]).touchEnded(n);else{for(h=0;h<this.touchCalls.size();h++)this.touchCalls.get(h).touchEnded(n);this.touchesX[r]=this.getTouchX(n),this.touchesY[r]=this.getTouchY(n)}if(r==this.mouseTouch)for(a=0,this.mouseX=this.touchesX[r],this.mouseY=this.touchesY[r],this.mouseTouch=ny.TOUCHID_EMPTY,this.keyBuffer[ny.VK_LBUTTON]=!1;a<this.subApps.length;a++)this.subApps[a].touchEnd(t,e)}}},getTouchX:function(t){for(var e=t.pageX,s=t.target;s&&"BODY"!=s.tagName;)e-=s.offsetLeft,s=s.offsetParent;return Math.floor((e-this.xMouseOffset)/this.scaleX)},getTouchY:function(t){for(var e=t.pageY,s=t.target;s&&"BODY"!=s.tagName;)e-=s.offsetTop,s=s.offsetParent;return Math.floor((e-this.yMouseOffset)/this.scaleY)},addTouchCall:function(t){this.touchCalls.add(t)},removeTouchCall:function(t){this.touchCalls.removeObject(t)},getEmbeddedFile:function(t){if(null!=this.embeddedFiles){let e,s=t.lastIndexOf("\\");for(s<0&&(s=t.lastIndexOf("/")),s>=0&&(t=t.substring(s+1)),e=0;e<this.embeddedFiles.length;e++)if(this.embeddedFiles[e].path==t)return this.embeddedFiles[e]}return null},showCursor:function(t){this.cursorCount=t,this.cursorCount>=0?this.canvas.style.cursor=this.cursor:this.canvas.style.cursor="none"},enterFullScreen:function(){this.canvas.requestFullScreen?this.canvas.requestFullScreen():this.canvas.webkitRequestFullScreen?this.canvas.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):this.canvas.mozRequestFullScreen&&this.canvas.mozRequestFullScreen()},exitFullScreen:function(){this.gaFlags&=~ny.GA_STRETCH,document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()},startJoystick:function(t,e){null==this.joystick&&(this.joystick=new n1(this),this.joystick.loadImages(),this.joystick.reset(e),this.joystickOn=1,0>this.touchCalls.indexOf(this.joystick)&&this.touchCalls.add(this.joystick))},startAccJoystick:function(){this.startAccelerometer(),this.joystickOn=2},endJoystick:function(){null!=this.joystick&&(1==this.joystickOn&&this.touchCalls.removeObject(this.joystick),this.joystick=null),2==this.joystickOn&&this.endAccelerometer(),this.joystickOn=0},startAccelerometer:function(){0==this.accelerometer&&window.DeviceMotionEvent&&(this.accelerometerHandler=this._handleOnDeviceMotion.bind(this),window.addEventListener("devicemotion",this.accelerometerHandler)),this.accelerometer++},_handleOnDeviceMotion:function(t){let e=t.acceleration.x/9.780318,s=t.acceleration.y/9.780318,r=t.acceleration.z/9.780318,h=t.accelerationIncludingGravity.x/9.780318,n=t.accelerationIncludingGravity.y/9.780318,a=t.accelerationIncludingGravity.z/9.780318;switch(this.accX=e,this.accY=s,this.accZ=r,this.accGravX=h,this.accGravY=n,this.accGravZ=a,window.orientation){case 0:this.accX=-e,this.accY=s,this.accGravX=-h,this.accGravY=n;break;case 90:this.accX=s,this.accY=e,this.accGravX=n,this.accGravY=h;break;case 180:this.accX=e,this.accY=-s,this.accGravX=h,this.accGravY=-n;break;case -90:this.accX=-s,this.accY=-e,this.accGravX=-n,this.accGravY=-h}this.iOS&&(this.accX=-this.accX,this.accY=-this.accY,this.accGravX=-this.accGravX,this.accGravY=-this.accGravY)},endAccelerometer:function(){this.accelerometer--,this.accelerometer<=0&&(window.DeviceMotionEvent&&window.removeEventListener("devicemotion",this.accelerometerHandler),this.accelerometer=0)},getJoystick:function(){let t=0;return this.accGravX<-.2&&(t|=4),this.accGravX>.2&&(t|=8),this.accGravY<-.2&&(t|=1),this.accGravY>.2&&(t|=2),t},drawContinue:function(t){if(t.touchMe){switch(null==this.silentSound&&(t.touchMePhase=2),t.touchMePhase){case 0:t.touchMeAlpha>0&&(t.touchMeAlpha-=2,t.touchMeAlpha<0&&(t.touchMeAlpha=0,phase++));break;case 1:break;case 2:t.touchMeAlpha<128&&(t.touchMeAlpha+=4,t.touchMeAlpha>=128&&(t.touchMeAlpha=128,t.touchMeQuit=!0))}this.context.renderSolidColor(t.touchMeRect.left,t.touchMeRect.top,t.touchMeRect.right-t.touchMeRect.left,t.touchMeRect.bottom-t.touchMeRect.top,this.frameColor,0,0),t.touchMe.draw(this.context,t.touchMeRect.left,t.touchMeRect.top,l2.BOP_BLEND,t.touchMeAlpha),t.touchMeQuit&&(t.touchMe=null,t.touchMeRect=null,t.touchMeFont=null)}else if(t.touchMeQuit=!0,null!=this.silentSound&&(this.dwOptions&ny.AH2OPT_LOADSOUNDSONTOUCH)!=0){t.touchMeFont=new nq,t.touchMeFont.createDefaultFont(),t.touchMeFont.lfHeight=24;let e=t.touchMeFont.lfHeight+6;t.touchMe=new S(this,120,e);let s=t.touchMe.measureText(this.m_touchMe,t.touchMeFont)+64;t.touchMe.resize(s,e),t.touchMe.manualClear(),t.touchMe.manualDrawText(this.m_touchMe,h.DT_VCENTER|h.DT_CENTER,null,16776960,t.touchMeFont,2,0),t.touchMeRect=new E,t.touchMeRect.left=this.gaCxWin/2-s/2,t.touchMeRect.top=this.gaCyWin/2-e/2,t.touchMeRect.right=t.touchMeRect.left+s,t.touchMeRect.bottom=t.touchMeRect.top+e,t.touchMeAlpha=128,t.touchMePhase=0,t.touchMeQuit=!1,this.context.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,this.frameColor,0,0)}return t.touchMeQuit}},nR.LEF_DISPLAYNAME=1,nR.LEF_GRABDESKTOP=2,nR.LEF_KEEPDISPLAY=4,nR.LEF_TOTALCOLMASK=32,nR.LEF_RESIZEATSTART=256,nR.LEF_NOSURFACE=2048,nR.LEF_TIMEDMVTS=32768,nR.LEF_TRANSPARENTBKD=131072,nR.CM_TEST_OBSTACLE=0,nR.CM_TEST_PLATFORM=1,nR.CM_OBSTACLE=1,nR.CM_PLATFORM=2,nR.HEIGHT_PLATFORM=6,nR.HTML5FOPT_DISPLAYPRELOADER=256,nR.IPHONEOPT_JOYSTICK_FIRE1=1,nR.IPHONEOPT_JOYSTICK_FIRE2=2,nR.IPHONEOPT_JOYSTICK_LEFTHAND=4,nR.JOYSTICK_NONE=0,nR.JOYSTICK_TOUCH=1,nR.JOYSTICK_ACCELEROMETER=2,nR.JOYSTICK_EXT=3,nR.prototype={loadFullFrame:function(t){this.app.file.seek(this.app.frameOffsets[t]),this.evtProg=new nZ(this.app),this.LOList=new aa,this.leVirtualRect=new E;var e,s,r,h=0;for(this.m_wRandomSeed=-1;32639!=h;)if(h=this.app.file.readAShort(),s=this.app.file.readAShort(),0!=(r=this.app.file.readAInt())){switch(this.posEnd=this.app.file.getFilePointer()+r,h){case 13108:this.loadHeader(),null!=this.app.parentApp&&(this.app.parentOptions&aO.CCAF_DOCKED)!=0?(this.leEditWinWidth=this.app.cx,this.leEditWinHeight=this.app.cy):(this.leEditWinWidth=Math.min(this.app.gaCxWin,this.leWidth),this.leEditWinHeight=Math.min(this.app.gaCyWin,this.leHeight));break;case 13128:var e,n=r/6;for(e=0,this.mosaicHandles=Array(n),this.mosaicX=Array(n),this.mosaicY=Array(n),this.mosaicMaxHandle=0;e<n;e++)this.mosaicHandles[e]=this.app.file.readAShort(),this.mosaicMaxHandle=Math.max(this.mosaicMaxHandle,this.mosaicHandles[e]),this.mosaicX[e]=this.app.file.readAShort(),this.mosaicY[e]=this.app.file.readAShort();this.mosaicMaxHandle++;break;case 13130:this.joystick=this.app.file.readAShort(),this.html5Options=this.app.file.readAShort();break;case 13122:this.leVirtualRect.load(this.app.file);break;case 13124:this.m_wRandomSeed=this.app.file.readAShort();break;case 13127:this.m_dwMvtTimerBase=this.app.file.readAInt();break;case 13109:this.frameName=this.app.file.readAString();break;case 13115:this.fadeIn=new aK,this.fadeIn.load(this.app.file);break;case 13116:this.fadeOut=new aK,this.fadeOut.load(this.app.file);break;case 13121:this.loadLayers();break;case 13125:this.loadLayerEffects();break;case 13112:this.LOList.load(this.app);break;case 13117:this.evtProg.load(this.app),this.maxObjects=this.evtProg.maxObjects}this.app.file.seek(this.posEnd)}for(this.app.OIList.resetToLoad(),e=0;e<this.LOList.nIndex;e++){let a=this.LOList.getLOFromIndex(e);this.app.OIList.setToLoad(a.loOiHandle)}for(this.app.imageBank.resetToLoad(),this.app.soundBank.resetToLoad(),this.app.fontBank.resetToLoad(),this.app.OIList.load(this.app.file),this.app.OIList.enumElements(this.app.imageBank,this.app.fontBank),this.app.dwOptions&ny.AH2OPT_LOADDATAATSTART&&(this.app.fontBank.setAllToLoad(),this.app.soundBank.setAllToLoad(),0==this.app.mosaicMaxHandle&&this.app.imageBank.setAllToLoad()),this.app.imageBank.load(this.app.file),this.app.fontBank.load(this.app.file),this.evtProg.enumSounds(this.app.soundBank),this.app.soundBank.load(),this.app.OIList.resetOICurrent(),e=0;e<this.LOList.nIndex;e++){let l=this.LOList.list[e];l.loType>=ac.OBJ_SPR&&this.app.OIList.setOICurrent(l.loOiHandle)}},loadLayers:function(){let t;for(t=0,this.nLayers=this.app.file.readAInt(),this.layers=Array(this.nLayers);t<this.nLayers;t++)this.layers[t]=new al(this.app),this.layers[t].load(this.app.file)},loadLayerEffects:function(){let t;for(t=0;t<this.nLayers;t++)this.layers[t].effect=this.app.file.readAInt(),this.layers[t].effectParam=this.app.file.readAInt(),this.app.file.skipBytes(12)},loadHeader:function(){this.leWidth=this.app.file.readAInt(),this.leHeight=this.app.file.readAInt(),this.leBackground=this.app.file.readAColor(),this.leFlags=this.app.file.readAInt()}},nM.NCHANNELS=32,nM.prototype={addDataToDecode:function(t){null==this.dataToDecode&&(this.dataToDecode=new P),this.dataToDecode.add(t)},decodeData:function(){if(null!=this.dataToDecode&&this.dataToDecode.size()>0&&!this.decoding){let t=this.dataToDecode.get(0);this.dataToDecode.removeIndex(0),this.decoding=!0;let e=this;e.context.decodeAudioData(t.response,function(s){t.buffer=s,t.response=null,e.app.dataHasLoaded(t),e.decoding=!1})}},reset:function(){let t;for(t=0;t<nM.NCHANNELS;t++)this.bLocked[t]=!1},lockChannel:function(t){t>=0&&t<nM.NCHANNELS&&(this.bLocked[t]=!0)},unlockChannel:function(t){t>=0&&t<nM.NCHANNELS&&(this.bLocked[t]=!1)},play:function(t,e,s,r){if(!1!=this.bOn){let h,n=this.app.soundBank.getSoundFromHandle(t);if(null!=n){if(!1==this.bMultipleSounds&&(s=0),s<0){for(h=0;h<nM.NCHANNELS&&(null!=this.channels[h]||!1!=this.bLocked[h]);h++);if(h==nM.NCHANNELS)for(h=0;h<nM.NCHANNELS&&(!1!=this.bLocked[h]||null==this.channels[h]||!1!=this.channels[h].bUninterruptible);h++);(s=h)>=0&&s<nM.NCHANNELS&&(this.volumes[s]=this.mainVolume)}if(!(s<0)&&!(s>=nM.NCHANNELS)){if(null!=this.channels[s]){if(!0==this.channels[s].bUninterruptible)return;this.channels[s]!=n&&(this.channels[s].stop(),this.channels[s]=null)}for(h=0;h<nM.NCHANNELS;h++)this.channels[h]==n&&(this.channels[h].stop(),this.channels[h]=null);this.channels[s]=n,n.play(e,r,this.volumes[s])}}}},setMultipleSounds:function(t){this.bMultipleSounds=t},keepCurrentSounds:function(){let t;for(t=0;t<nM.NCHANNELS;t++)null!=this.channels[t]&&this.channels[t].isPlaying()&&this.app.soundBank.setToLoad(this.channels[t].handle)},setOnOff:function(t){t!=bOn&&(this.bOn=t,!1==this.bOn&&this.stopAllSounds())},getOnOff:function(){return this.bOn},stopAllSounds:function(){let t;for(t=0;t<nM.NCHANNELS;t++)null!=this.channels[t]&&(this.channels[t].stop(),this.channels[t]=null)},stopSample:function(t){let e;for(e=0;e<nM.NCHANNELS;e++)null!=this.channels[e]&&this.channels[e].handle==t&&(this.channels[e].stop(),this.channels[e]=null)},stopChannel:function(t){t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]&&(this.channels[t].stop(),this.channels[t]=null)},isSamplePaused:function(t){let e;for(e=0;e<nM.NCHANNELS;e++)if(null!=this.channels[e]&&this.channels[e].handle==t)return this.channels[e].isPaused();return!1},isSoundPlaying:function(){let t;for(t=0;t<nM.NCHANNELS;t++)if(null!=this.channels[t]&&this.channels[t].isPlaying())return!0;return!1},isSamplePlaying:function(t){let e;for(e=0;e<nM.NCHANNELS;e++)if(null!=this.channels[e]&&this.channels[e].handle==t)return this.channels[e].isPlaying();return!1},isChannelPlaying:function(t){return t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]&&this.channels[t].isPlaying()},isChannelPaused:function(t){return t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]&&this.channels[t].isPaused()},pause:function(){let t;for(t=0;t<nM.NCHANNELS;t++)null!=this.channels[t]&&this.channels[t].globalpause()},pauseChannel:function(t){t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]&&this.channels[t].pause()},pauseSample:function(t){let e;for(e=0;e<nM.NCHANNELS;e++)null!=this.channels[e]&&this.channels[e].handle==t&&this.channels[e].pause()},resume:function(){let t;for(t=0;t<nM.NCHANNELS;t++)null!=this.channels[t]&&this.channels[t].globalresume()},resumeChannel:function(t){t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]&&this.channels[t].resume()},resumeSample:function(t){let e;for(e=0;e<nM.NCHANNELS;e++)null!=this.channels[e]&&this.channels[e].handle==t&&this.channels[e].resume()},setVolumeChannel:function(t,e){e<0&&(e=0),e>100&&(e=100),t>=0&&t<nM.NCHANNELS&&(this.volumes[t]=e,null!=this.channels[t]&&this.channels[t].setVolume(e))},setFrequencyChannel:function(t,e){t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]&&this.channels[t].setFrequency(e)},setFrequencySample:function(t,e){let s;for(s=0;s<nM.NCHANNELS;s++)null!=this.channels[s]&&this.channels[s].handle==t&&this.channels[s].setFrequency(e)},setPositionChannel:function(t,e){t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]&&this.channels[t].setPosition(e)},setPositionSample:function(t,e){let s;for(s=0;s<nM.NCHANNELS;s++)null!=this.channels[s]&&this.channels[s].handle==t&&this.channels[s].setPosition(e)},getVolumeChannel:function(t){return t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]?this.volumes[t]:0},setVolumeSample:function(t,e){let s;for(e<0&&(e=0),e>100&&(e=100),s=0;s<nM.NCHANNELS;s++)null!=this.channels[s]&&this.channels[s].handle==t&&(this.volumes[s]=e,this.channels[s].setVolume(e))},setMainVolume:function(t){let e;for(e=0,this.mainVolume=t;e<nM.NCHANNELS;e++)this.volumes[e]=t,null!=this.channels[e]&&this.channels[e].setVolume(t)},getMainVolume:function(){return this.mainVolume},getChannel:function(t){let e;for(e=0;e<nM.NCHANNELS;e++)if(null!=this.channels[e]&&this.channels[e].name==t)return e;return -1},getDurationChannel:function(t){return t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]?this.channels[t].getDuration():0},getPositionChannel:function(t){return t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]?this.channels[t].getPosition():0},getFrequencyChannel:function(t){return t>=0&&t<nM.NCHANNELS&&null!=this.channels[t]?this.channels[t].getFrequency():0},getVolumeSample:function(t){let e=this.getChannel(t);return e>=0?this.volumes[e]:0},getDurationSample:function(t){let e=this.getChannel(t);return e>=0?this.channels[e].getDuration():0},getPositionSample:function(t){let e=this.getChannel(t);return e>=0?this.channels[e].getPosition():0},getFrequencySample:function(t){let e=this.getChannel(t);return e>=0?this.channels[e].getFrequency():0},checkSounds:function(){let t;for(t=0;t<nM.NCHANNELS;t++)null!=this.channels[t]&&this.channels[t].checkSound()&&(this.channels[t]=null)}},n2.prototype={preLoad:function(){let t=this.app.file.readAShort();this.path=this.app.file.readAString(t);let e=this.path.lastIndexOf("\\");e>=0&&(this.path=this.path.substring(e+1)),this.length=this.app.file.readAInt(),this.offset=this.app.file.getFilePointer(),this.app.file.skipBytes(this.length)},open:function(){return this.app.file.createFromFile(this.offset,this.length)}},nw.prototype={load:function(){return this.isLoaded},reset:function(){this.phase=0,this.oldAngle=0,this.counter=25},step:function(){switch(this.phase){case 0:-1!=this.app.preloaderBackColor?this.context.renderSolidColor(0,0,this.app.gaCxWin,this.app.gaCyWin,this.app.preloaderBackColor):this.context.clearBackground(0,0,this.app.gaCxWin,this.app.gaCyWin),this.context.renderSimpleImage(this.image,this.xCenter-this.image.width/2,this.yCenter-this.image.height/2,this.image.width,this.image.height,0,0),this.phase++;break;case 1:this.angle=this.app.imagesLoaded/this.app.imagesToLoad*2*Math.PI,this.drawIt(this.angle),this.app.imagesLoaded==this.app.imagesToLoad&&this.phase++;break;case 2:this.counter>0&&this.counter--,0==this.counter&&this.phase++;break;case 3:this.app.drawContinue(this)&&this.phase++}},isComplete:function(){return 4==this.phase},drawIt:function(t){let e,s,r,h,n,a;for(e=this.oldAngle;e<=t;e+=.005)for(s=this.xCenter+Math.cos(e)*(this.radius-this.size),r=this.yCenter-Math.sin(e)*(this.radius-this.size),h=this.xCenter+Math.cos(e)*this.radius,n=this.yCenter-Math.sin(e)*this.radius,this.context.renderLine(s,r,h,n,this.color,1,0,0),a=0;a<3;a++)s=this.xCenter+Math.cos(e)*(this.radius-this.size-a),r=this.yCenter-Math.sin(e)*(this.radius-this.size-a),h=this.xCenter+Math.cos(e)*(this.radius-this.size-a-1),n=this.yCenter-Math.sin(e)*(this.radius-this.size-a-1),this.context.renderLine(s,r,h,n,this.color,1,0,0),s=this.xCenter+Math.cos(e)*(this.radius+a),r=this.yCenter-Math.sin(e)*(this.radius+a),h=this.xCenter+Math.cos(e)*(this.radius+a+1),n=this.yCenter-Math.sin(e)*(this.radius+a+1),this.context.renderLine(s,r,h,n,this.color,1,0,0);this.oldAngle=t}},nk.prototype={load:function(){return!0},reset:function(){this.quit=!1,this.phase=0,this.alpha=128,this.position=0},step:function(){if(this.app.imagesLoaded<this.app.imagesToLoad)0===this.phase&&this.alpha>0&&(this.alpha-=2,this.alpha<=0&&(this.alpha=0,this.phase++));else switch(this.phase){case 0:case 1:this.phase=2;break;case 2:this.alpha<128&&(this.alpha+=4),this.alpha>=128&&(this.alpha=128,null==this.app.silentSound?this.quit=!0:this.phase++);break;default:this.quit=this.app.drawContinue(this);return}this.context.renderSolidColor(this.rect.left,this.rect.top,this.width,this.height,this.backColor,l2.BOP_BLEND,this.alpha),this.context.renderRect(this.rect.left,this.rect.top,this.width,this.height,this.borderColor,1,l2.BOP_BLEND,this.alpha),this.position=this.app.imagesLoaded/this.app.imagesToLoad*(this.width-2),this.context.renderSolidColor(this.rect.left+1,this.rect.top+1,this.position,this.height-2,this.barColor,l2.BOP_BLEND,this.alpha)},isComplete:function(){return this.quit&&this.app.imagesLoaded==this.app.imagesToLoad}},nN.prototype={load:function(){return this.step(),!this.subApp.loading},reset:function(){this.subApp.run.f_StopSamples(),this.subApp.run.killFrameObjects(),this.subApp.run.y_KillLevel(!1),this.subApp.run.resetFrameLayers(-1,!1),this.subApp.run.rhEvtProg.unBranchPrograms(),this.subApp.run.freeMouse(),this.subApp.run.freeRunHeader(),this.subApp.run.rhFrame.leX=this.subApp.run.rhFrame.leLastScrlX=this.subApp.run.rh3DisplayX=0,this.subApp.run.rhFrame.leY=this.subApp.run.rhFrame.leLastScrlY=this.subApp.run.rh3DisplayY=0,this.subApp.resetLayers(),this.subApp.run.allocRunHeader(),this.subApp.run.initAsmLoop(),this.subApp.run.resetFrameLayers(-1,!1),this.subApp.run.prepareFrame(),this.subApp.run.createFrameObjects(!1),this.subApp.run.drawLevel(),this.subApp.run.loadGlobalObjectsData(),this.subApp.run.rhEvtProg.prepareProgram(),this.subApp.run.rhEvtProg.assemblePrograms(this.subApp.run),this.subApp.run.f_InitLoop(),this.subApp.run.captureMouse(),this.subApp.run.rhQuit=0,this.subApp.run.rhQuitParam=0,this.subApp.subAppStopped=!1,this.app.subApps.push(this.subApp),this.delay=0},step:function(){this.subApp.subAppStopped||(this.stopOnLoad&&(this.subApp.subAppStopped=this.app.imagesLoaded==this.app.imagesToLoad),!1==this.subApp.stepApplication()&&(this.subApp.subAppStopped=!0),this.subApp.drawSubApplication(this.context,this.appSprite.x,this.appSprite.y,!1)),this.subApp.subAppStopped&&this.app.silentSound&&this.app.drawContinue(this)},isComplete:function(){let t,e=this.subApp.subAppStopped;if(this.app.silentSound&&(e=!1),e){if(this.delay>0&&(this.delay--,this.delay>0))return!1;for(t=0;t<this.app.subApps.length;t++)if(this.app.subApps[t]==this.subApp){this.app.subApps.splice(t,1);break}}return e}},n1.KEY_JOYSTICK=0,n1.KEY_FIRE1=1,n1.KEY_FIRE2=2,n1.KEY_NONE=-1,n1.MAX_TOUCHES=3,n1.JFLAG_JOYSTICK=1,n1.JFLAG_FIRE1=2,n1.JFLAG_FIRE2=4,n1.JFLAG_LEFTHANDED=8,n1.JPOS_NOTDEFINED=2147483648,n1.JOY_ANGLEGAP=70,n1.DPAD_ANGLEGAP=60,n1.DEADZONE=.5,n1.prototype={loadImages:function(){null==this.joyBack&&(this.joyBack=nU.createFromFile(this.app,"joyback.png"),this.joyFront=nU.createFromFile(this.app,"joyfront.png"),this.fire1U=nU.createFromFile(this.app,"fire1U.png"),this.fire2U=nU.createFromFile(this.app,"fire2U.png"),this.fire1D=nU.createFromFile(this.app,"fire1D.png"),this.fire2D=nU.createFromFile(this.app,"fire2D.png"))},reset:function(t){this.flags=t,null!=this.joyBack&&0!=this.joyBack.width?this.setPositions():this.bSetPositions=!0,this.isJoystick?this.joyanglezone=n1.JOY_ANGLEGAP*Math.PI/180:this.joyanglezone=n1.DPAD_ANGLEGAP*Math.PI/180},setPositions:function(){let t,e;t=this.app.gaCxWin,e=this.app.gaCyWin,(this.flags&n1.JFLAG_LEFTHANDED)==0?((this.flags&n1.JFLAG_JOYSTICK)!=0&&(this.imagesX[n1.KEY_JOYSTICK]=16+this.joyBack.width/2,this.imagesY[n1.KEY_JOYSTICK]=e-16-this.joyBack.height/2),(this.flags&n1.JFLAG_FIRE1)!=0&&(this.flags&n1.JFLAG_FIRE2)!=0?(this.imagesX[n1.KEY_FIRE1]=t-this.fire1U.width/2-32,this.imagesY[n1.KEY_FIRE1]=e-this.fire1U.height/2-16,this.imagesX[n1.KEY_FIRE2]=t-this.fire2U.width/2-16,this.imagesY[n1.KEY_FIRE2]=e-this.fire2U.height/2-this.fire1U.height-24):(this.flags&n1.JFLAG_FIRE1)!=0?(this.imagesX[n1.KEY_FIRE1]=t-this.fire1U.width/2-16,this.imagesY[n1.KEY_FIRE1]=e-this.fire1U.height/2-16):(this.flags&n1.JFLAG_FIRE2)!=0&&(this.imagesX[n1.KEY_FIRE2]=t-this.fire2U.width/2-16,this.imagesY[n1.KEY_FIRE2]=e-this.fire2U.height/2-16)):((this.flags&n1.JFLAG_JOYSTICK)!=0&&(this.imagesX[n1.KEY_JOYSTICK]=t-16-this.joyBack.width/2,this.imagesY[n1.KEY_JOYSTICK]=e-16-this.joyBack.height/2),(this.flags&n1.JFLAG_FIRE1)!=0&&(this.flags&n1.JFLAG_FIRE2)!=0?(this.imagesX[n1.KEY_FIRE1]=this.fire1U.width/2+16+2*this.fire2U.width/3,this.imagesY[n1.KEY_FIRE1]=e-this.fire1U.height/2-16,this.imagesX[n1.KEY_FIRE2]=this.fire2U.width/2+16,this.imagesY[n1.KEY_FIRE2]=e-this.fire2U.height/2-this.fire1U.height-24):(this.flags&n1.JFLAG_FIRE1)!=0?(this.imagesX[n1.KEY_FIRE1]=this.fire1U.width/2+16,this.imagesY[n1.KEY_FIRE1]=e-this.fire1U.height/2-16):(this.flags&n1.JFLAG_FIRE2)!=0&&(this.imagesX[n1.KEY_FIRE2]=this.fire2U.width/2+16,this.imagesY[n1.KEY_FIRE2]=e-this.fire2U.height/2-16))},setXPosition:function(t,e){(t&n1.JFLAG_JOYSTICK)!=0?this.imagesX[n1.KEY_JOYSTICK]=e:(t&n1.JFLAG_FIRE1)!=0?this.imagesX[n1.KEY_FIRE1]=e:(t&n1.JFLAG_FIRE2)!=0&&(this.imagesX[n1.KEY_FIRE2]=e)},setYPosition:function(t,e){(t&n1.JFLAG_JOYSTICK)!=0?this.imagesY[n1.KEY_JOYSTICK]=e:(t&n1.JFLAG_FIRE1)!=0?this.imagesY[n1.KEY_FIRE1]=e:(t&n1.JFLAG_FIRE2)!=0&&(this.imagesY[n1.KEY_FIRE2]=e)},draw:function(t){if(this.bSetPositions&&(this.bSetPositions=!1,this.setPositions()),(this.flags&n1.JFLAG_JOYSTICK)!=0&&(e=this.imagesX[n1.KEY_JOYSTICK]-this.joyBack.width/2,s=this.imagesY[n1.KEY_JOYSTICK]-this.joyBack.height/2,t.renderImage(this.joyBack,e,s,0,1,1,0,0),e=this.imagesX[n1.KEY_JOYSTICK]+this.joystickX-this.joyFront.width/2,s=this.imagesY[n1.KEY_JOYSTICK]+this.joystickY-this.joyFront.height/2,t.renderImage(this.joyFront,e,s,0,1,1,0,0)),(this.flags&n1.JFLAG_FIRE1)!=0){var e,s,r=(16&this.joystick)==0?this.fire1U:this.fire1D;e=this.imagesX[n1.KEY_FIRE1]-r.width/2,s=this.imagesY[n1.KEY_FIRE1]-r.height/2,t.renderImage(r,e,s,0,1,1,0,0)}if((this.flags&n1.JFLAG_FIRE2)!=0){var r=(32&this.joystick)==0?this.fire2U:this.fire2D;e=this.imagesX[n1.KEY_FIRE2]-r.width/2,s=this.imagesY[n1.KEY_FIRE2]-r.height/2,t.renderImage(r,e,s,0,1,1,0,0)}},touchStarted:function(t){let e=!1,s=this.app.getTouchX(t),r=this.app.getTouchY(t);this.joydeadzone=n1.DEADZONE*Math.ceil(Math.sqrt(this.joyBack.width/2*this.joyBack.width/2+this.joyBack.height/2*this.joyBack.height/2)),this.joyradsize=Math.ceil(Math.sqrt(this.joyBack.width/4*this.joyBack.width/4+this.joyBack.height/4*this.joyBack.height/4));let h=this.getKey(s,r);return h!=n1.KEY_NONE&&(this.touches[h]=t.identifier,h==n1.KEY_JOYSTICK&&(this.joystick&=240,e=!0),h==n1.KEY_FIRE1?(this.joystick|=16,e=!0):h==n1.KEY_FIRE2&&(this.joystick|=32,e=!0)),e},touchMoved:function(t){let e=this.app.getTouchX(t),s=this.app.getTouchY(t);if(this.getKey(e,s)==n1.KEY_JOYSTICK&&t.identifier==this.touches[n1.KEY_JOYSTICK]){this.joystickX=e-this.imagesX[n1.KEY_JOYSTICK],this.joystickY=s-this.imagesY[n1.KEY_JOYSTICK];let r=(2*Math.PI-Math.atan2(this.joystickY,this.joystickX))%(2*Math.PI);this.joystick&=240;let h=Math.sqrt(this.joystickX*this.joystickX+this.joystickY*this.joystickY);if(this.isJoystick?(this.joystickX=Math.cos(r)*this.joyradsize,this.joystickY=-(Math.sin(r)*this.joyradsize)):(this.joystickX<-this.joyradsize&&(this.joystickX=-this.joyradsize),this.joystickX>this.joyradsize&&(this.joystickX=this.joyradsize),this.joystickY<-this.joyradsize&&(this.joystickY=-this.joyradsize),this.joystickY>this.joyradsize&&(this.joystickY=this.joyradsize)),h>this.joydeadzone&&h<3*this.joyradsize){let n=0;if(r>=0)for(;;){if(this.insideZone(r,0,this.joyanglezone)||this.insideZone(r,2*Math.PI,this.joyanglezone)){n=8;break}if(this.insideZone(r,Math.PI/2,this.joyanglezone)){n=1;break}if(this.insideZone(r,Math.PI,this.joyanglezone)){n=4;break}if(this.insideZone(r,Math.PI/4*6,this.joyanglezone)){n=2;break}if(this.insideZone(r,Math.PI/4,Math.PI/2-this.joyanglezone)){n=9;break}if(this.insideZone(r,Math.PI/4*3,Math.PI/2-this.joyanglezone)){n=5;break}if(this.insideZone(r,Math.PI/4*5,Math.PI/2-this.joyanglezone)){n=6;break}this.insideZone(r,Math.PI/4*7,Math.PI/2-this.joyanglezone)&&(n=10);break}this.joystick|=n}}},insideZone:function(t,e,s){return t>e-s/2&&t<e+s/2},touchEnded:function(t){let e;for(e=0;e<n1.MAX_TOUCHES;e++)if(this.touches[e]==t.identifier){switch(this.touches[e]=0,e){case n1.KEY_JOYSTICK:this.joystickX=0,this.joystickY=0,this.joystick&=240;break;case n1.KEY_FIRE1:this.joystick&=-17;break;case n1.KEY_FIRE2:this.joystick&=-33}break}},getKey:function(t,e){return(this.flags&n1.JFLAG_JOYSTICK)!=0&&t>=this.imagesX[n1.KEY_JOYSTICK]-this.joyBack.width/2&&t<this.imagesX[n1.KEY_JOYSTICK]+this.joyBack.width/2&&e>this.imagesY[n1.KEY_JOYSTICK]-this.joyBack.height/2&&e<this.imagesY[n1.KEY_JOYSTICK]+this.joyBack.height/2?n1.KEY_JOYSTICK:(this.flags&n1.JFLAG_FIRE1)!=0&&t>=this.imagesX[n1.KEY_FIRE1]-this.fire1U.width/2&&t<this.imagesX[n1.KEY_FIRE1]+this.fire1U.width/2&&e>this.imagesY[n1.KEY_FIRE1]-this.fire1U.height/2&&e<this.imagesY[n1.KEY_FIRE1]+this.fire1U.height/2?n1.KEY_FIRE1:(this.flags&n1.JFLAG_FIRE2)!=0&&t>=this.imagesX[n1.KEY_FIRE2]-this.fire2U.width/2&&t<this.imagesX[n1.KEY_FIRE2]+this.fire2U.width/2&&e>this.imagesY[n1.KEY_FIRE2]-this.fire2U.height/2&&e<this.imagesY[n1.KEY_FIRE2]+this.fire2U.height/2?n1.KEY_FIRE2:n1.KEY_NONE},getJoystick:function(){return this.joystick}},nD.GAMEFLAGS_VBLINDEP=2,nD.GAMEFLAGS_LIMITEDSCROLL=4,nD.GAMEFLAGS_FIRSTLOOPFADEIN=16,nD.GAMEFLAGS_LOADONCALL=32,nD.GAMEFLAGS_REALGAME=64,nD.GAMEFLAGS_PLAY=128,nD.GAMEFLAGS_INITIALISING=512,nD.DLF_DONTUPDATE=2,nD.DLF_DRAWOBJECTS=4,nD.DLF_RESTARTLEVEL=8,nD.DLF_DONTUPDATECOLMASK=16,nD.DLF_COLMASKCLIPPED=32,nD.DLF_SKIPLAYER0=64,nD.DLF_REDRAWLAYER=128,nD.DLF_STARTLEVEL=256,nD.GAME_XBORDER=480,nD.GAME_YBORDER=300,nD.COLMASK_XMARGIN=64,nD.COLMASK_YMARGIN=16,nD.WRAP_X=1,nD.WRAP_Y=2,nD.WRAP_XY=4,nD.RH3SCROLLING_SCROLL=1,nD.RH3SCROLLING_REDRAWLAYERS=2,nD.RH3SCROLLING_REDRAWALL=4,nD.RH3SCROLLING_REDRAWTOTALCOLMASK=8,nD.OBSTACLE_NONE=0,nD.OBSTACLE_SOLID=1,nD.OBSTACLE_PLATFORM=2,nD.OBSTACLE_LADDER=3,nD.OBSTACLE_TRANSPARENT=4,nD.COF_NOMOVEMENT=1,nD.COF_HIDDEN=2,nD.COF_FIRSTTEXT=4,nD.COF_CREATEDATSTART=8,nD.MAX_FRAMERATE=10,nD.LOOPEXIT_NEXTLEVEL=1,nD.LOOPEXIT_PREVLEVEL=2,nD.LOOPEXIT_GOTOLEVEL=3,nD.LOOPEXIT_NEWGAME=4,nD.LOOPEXIT_PAUSEGAME=5,nD.LOOPEXIT_SAVEAPPLICATION=6,nD.LOOPEXIT_LOADAPPLICATION=7,nD.LOOPEXIT_SAVEFRAME=8,nD.LOOPEXIT_LOADFRAME=9,nD.LOOPEXIT_ENDGAME=-2,nD.LOOPEXIT_QUIT=100,nD.LOOPEXIT_RESTART=101,nD.BORDER_LEFT=1,nD.BORDER_RIGHT=2,nD.BORDER_TOP=4,nD.BORDER_BOTTOM=8,nD.BORDER_ALL=15,nD.MAX_INTERMEDIATERESULTS=128,nD.INTBAD=2147483647,nD.FANIDENTIFIER=1110591041,nD.TREADMILLIDENTIFIER=1110594637,nD.PARTICULESIDENTIFIER=1110600435,nD.MAGNETIDENTIFIER=1110874198,nD.ROPEANDCHAINIDENTIFIER=1110634490,nD.BASEIDENTIFIER=1110590791,nD.plMasks=[0,0,0,0,255,0,0,0,255,255,0,0,255,255,255,0,255,255,255,255],nD.Table_InOut=[0,nD.BORDER_LEFT,nD.BORDER_RIGHT,0,nD.BORDER_TOP,nD.BORDER_TOP+nD.BORDER_LEFT,nD.BORDER_TOP+nD.BORDER_RIGHT,0,nD.BORDER_BOTTOM,nD.BORDER_BOTTOM+nD.BORDER_LEFT,nD.BORDER_BOTTOM+nD.BORDER_RIGHT,0,0,0,0,0],nD.bMoveChanged=!1,nD.compareTo=function(t,e,s){switch(s){case 0:return t==e;case 1:return t!=e;case 2:return t<=e;case 3:return t<e;case 4:return t>=e;case 5:return t>e}return!1},nD.compareTer=function(t,e,s){switch(s){case 0:return t==e;case 1:return t!=e;case 2:return t<=e;case 3:return t<e;case 4:return t>=e;case 5:return t>e}return!1},nD.getObjectFont=function(t){let e=null;return null==(e=t.hoType>=ac.KPX_BASE?t.ext.getRunObjectFont():t.getFont())&&(e=new v),e},nD.setObjectFont=function(t,e,s){t.hoType>=ac.KPX_BASE?t.ext.setRunObjectFont(e,s):t.setFont(e,s)},nD.getObjectTextColor=function(t){return t.hoType>=ac.KPX_BASE?t.ext.getRunObjectTextColor():t.getFontColor()},nD.setObjectTextColor=function(t,e){t.hoType>=ac.KPX_BASE?t.ext.setRunObjectTextColor(e):t.setFontColor(e)},nD.objectShow=function(t){null!=t.ros&&(t.ros.obShow(),t.ros.rsFlags|=l2.RSFLAG_VISIBLE,t.ros.rsFlash=0)},nD.objectHide=function(t){null!=t.ros&&(t.ros.obHide(),t.ros.rsFlags&=~l2.RSFLAG_VISIBLE,t.ros.rsFlash=0)},nD.setXPosition=function(t,e){null!=t.rom?t.rom.rmMovement.setXPosition(e):t.hoX!=e&&(t.hoX=e,null!=t.roc&&(t.roc.rcChanged=!0,t.roc.rcCheckCollides=!0))},nD.setYPosition=function(t,e){null!=t.rom?t.rom.rmMovement.setYPosition(e):t.hoY!=e&&(t.hoY=e,null!=t.roc&&(t.roc.rcChanged=!0,t.roc.rcCheckCollides=!0))},nD.get_DirFromPente=function(t,e){if(0==t)return e>=0?24:8;if(0==e)return t>=0?0:16;let s,r,h=!1,n=!1;t<0&&(h=!0,t=-t),e<0&&(n=!0,e=-e);let a=256*t/e;for(r=0;!(a>=lq.CosSurSin32[r]);r+=2);return s=lq.CosSurSin32[r+1],n&&(s=-s+32,s&=31),h&&(s-=8,s&=31,s=-s,s&=31,s+=8,s&=31),s},nD.prototype={setFrame:function(t){this.rhFrame=t},allocRunHeader:function(){for(this.rhObjectList=Array(this.rhFrame.maxObjects),this.rhEvtProg=this.rhFrame.evtProg,this.rhMaxOI=0,t=this.rhApp.OIList.getFirstOI();null!=t;t=this.rhApp.OIList.getNextOI())t.oiType>=ac.OBJ_SPR&&this.rhMaxOI++;-1==this.rhFrame.m_wRandomSeed?this.rh3Graine=65535&this.rhApp.timer:this.rh3Graine=this.rhFrame.m_wRandomSeed;let t,e,s=Math.round(this.rhFrame.maxObjects/32+1);for(this.rhDestroyList=Array(s),this.rh4FastLoops=new P,this.rh4CurrentFastLoop="",this.rhMaxObjects=this.rhFrame.maxObjects,this.rhNPlayers=this.rhEvtProg.nPlayers,this.rhFrame.leX=0,this.rhFrame.leY=0,this.rhWindowX=this.rhFrame.leX,this.rhWindowY=this.rhFrame.leY,this.rh4WindowDeltaX=0,this.rh4WindowDeltaY=0,this.rhLevelSx=this.rhFrame.leVirtualRect.right,-1==this.rhLevelSx&&(this.rhLevelSx=2147479552),this.rhLevelSy=this.rhFrame.leVirtualRect.bottom,-1==this.rhLevelSy&&(this.rhLevelSy=2147479552),this.rhNObjects=0,this.rhStopFlag=0,this.rhQuit=0,this.rhQuitBis=0,this.rhGameFlags&=nD.GAMEFLAGS_PLAY,this.rhGameFlags|=nD.GAMEFLAGS_LIMITEDSCROLL,this.rh4FrameRatePos=0,this.rh4FrameRatePrevious=0,this.rh4FrameRateArray=Array(nD.MAX_FRAMERATE),this.rh4BackDrawRoutines=null,this.rh4SaveFrame=0,this.rh4SaveFrameCount=-3,this.rhWheelCount=-1,this.rh4PosOnLoop=null,this.rhGameFlags|=nD.GAMEFLAGS_REALGAME,this.rh4Results=Array(nD.MAX_INTERMEDIATERESULTS),this.rh4Operators=Array(nD.MAX_INTERMEDIATERESULTS),this.rh4OpeNull=new rV,this.rh4OpeNull.code=0,this.rh2OldPlayer=[,,,,],this.rh2NewPlayer=[,,,,],this.rh2InputMask=[,,,,],this.rhPlayer=[,,,,],this.rh4MvtTimerCoef=0,e=0;e<nD.MAX_FRAMERATE;e++)this.rh4FrameRateArray[e]=50;this.quitPause=!1,this.bodiesCreated=!1,this.rhFrame.rhOK=!0},freeRunHeader:function(){let t;for(t=0,this.rhFrame.rhOK=!1,this.rhObjectList=null,this.rhOiList=null,this.rhDestroyList=null,this.rh4CurrentFastLoop=null,this.rh4FastLoops=null,this.rh4BackDrawRoutines=null,this.rh4PosOnLoop=null;t<nD.MAX_INTERMEDIATERESULTS;t++)this.rh4Results[t]=0;this.rh4OpeNull=null},initRunLoop:function(t){if(this.allocRunHeader(),this.rhApp.joystickOn=0,null==this.rhApp.parentApp&&this.rhApp.touchable){if(this.rhFrame.joystick==nR.JOYSTICK_EXT)null==this.rhApp.joystick&&(this.rhApp.joystick=new n1(this.rhApp),this.rhApp.joystick.loadImages()),this.rhApp.joystick.reset(0),this.rhApp.startJoystick();else if(this.rhFrame.joystick!=nR.JOYSTICK_NONE){let e=0;(this.rhFrame.html5Options&nR.IPHONEOPT_JOYSTICK_FIRE1)!=0&&(e=n1.JFLAG_FIRE1),(this.rhFrame.html5Options&nR.IPHONEOPT_JOYSTICK_FIRE2)!=0&&(e|=n1.JFLAG_FIRE2),(this.rhFrame.html5Options&nR.IPHONEOPT_JOYSTICK_LEFTHAND)!=0&&(e|=n1.JFLAG_LEFTHANDED),this.rhFrame.joystick==nR.JOYSTICK_TOUCH&&(e|=n1.JFLAG_JOYSTICK),(e&(n1.JFLAG_FIRE1|n1.JFLAG_FIRE2|n1.JFLAG_JOYSTICK))!=0&&(this.rhApp.startJoystick(e),this.rhApp.joystick.reset(e)),this.rhFrame.joystick==nR.JOYSTICK_ACCELEROMETER&&this.rhApp.startAccJoystick()}}this.rhJoystickMask=255,t&&(this.rhGameFlags|=nD.GAMEFLAGS_FIRSTLOOPFADEIN),this.initAsmLoop(),this.resetFrameLayers(-1,!1),this.prepareFrame(),this.rhLoopCount=0,this.createFrameObjects(t),this.drawLevel(),this.hideShowLayers(),this.loadGlobalObjectsData(),this.rhEvtProg.prepareProgram(),this.rhEvtProg.assemblePrograms(this),this.showMouse(),this.captureMouse(),this.rhQuitParam=0,this.f_InitLoop(),this.bodiesCreated=!1},doRunLoop:function(){if(this.rh2PauseCompteur>0&&null==this.rhApp.modalSubappObject)this.quitPause&&(!0==this.rhApp.keyNew&&(this.rh4PauseKey>=0?this.rhApp.keyBuffer[this.rh4PauseKey]&&(this.resume(),this.rhQuit=0,this.rh4EndOfPause=this.rhLoopCount,this.rhEvtProg.handle_GlobalEvents(-458755)):this.rhApp.keyNew&&(this.resume(),this.rhQuit=0,this.rh4EndOfPause=this.rhLoopCount,this.rhEvtProg.handle_GlobalEvents(-458755))),this.rhApp.keyNew=!1),null!=this.questionObjectOn&&this.questionObjectOn.handleQuestion(),t=this.rhQuit;else{this.rhApp.appRunFlags|=ny.ARF_INGAMELOOP;var t=this.f_GameLoop();if(this.rhApp.appRunFlags&=~ny.ARF_INGAMELOOP,(this.rhGameFlags&nD.GAMEFLAGS_FIRSTLOOPFADEIN)!=0){let e=new Date;this.fadeTimerDelta=e.getTime()-this.rhTimerOld,this.y_KillLevel(!0),this.rhEvtProg.unBranchPrograms()}}if(t==nD.LOOPEXIT_NEXTLEVEL||t==nD.LOOPEXIT_PREVLEVEL||t==nD.LOOPEXIT_GOTOLEVEL){this.rhApp.transitionOldSurface=document.createElement("canvas"),this.rhApp.transitionOldSurface.width=this.rhApp.gaCxWin,this.rhApp.transitionOldSurface.height=this.rhApp.gaCyWin;let s=new aU(this.rhApp.transitionOldSurface);this.rhApp.frame.leClearBackground?s.clearBackground(0,0,this.gaCxWin,this.gaCyWin):s.renderSolidColor(0,0,this.gaCxWin,this.gaCyWin,this.frameColor),s.renderSolidColor(0,0,this.rhApp.gaCxWin,this.rhApp.gaCyWin,this.rhApp.frameColor),this.rhApp.mainSprite.draw(s,0,0)}if(0!=t)switch(t){case 5:this.pause(),this.rhApp.keyNew=!1,this.quitPause=!0,t=0;break;case 101:if(this.rhFrame.fade)break;this.f_StopSamples(),this.killFrameObjects(),this.y_KillLevel(!1),this.resetFrameLayers(-1,!1),this.rhEvtProg.unBranchPrograms(),this.freeMouse(),this.freeRunHeader(),this.rhFrame.leX=this.rhFrame.leLastScrlX=this.rh3DisplayX=0,this.rhFrame.leY=this.rhFrame.leLastScrlY=this.rh3DisplayY=0,this.rhApp.resetLayers(),this.allocRunHeader(),this.initAsmLoop(),this.resetFrameLayers(-1,!1),this.prepareFrame(),this.createFrameObjects(!1),this.drawLevel(),this.loadGlobalObjectsData(),this.rhEvtProg.prepareProgram(),this.rhEvtProg.assemblePrograms(this),this.f_InitLoop(),this.showMouse(),this.captureMouse(),t=0,this.rhQuitParam=0;break;case 100:case -2:this.rhEvtProg.handle_GlobalEvents(-196611)}return this.rhQuit=t,t},killRunLoop:function(t){let e;return this.rhQuit>100&&(this.rhQuit=nD.LOOPEXIT_ENDGAME),e=this.rhQuitParam,this.saveGlobalObjectsData(),this.killFrameObjects(),this.y_KillLevel(t),this.rhEvtProg.unBranchPrograms(),this.freeRunHeader(),this.freeMouse(),this.resetFrameLayers(-1,!0),this.rhApp.endJoystick(),h.MAKELONG(this.rhQuit,e)},initAsmLoop:function(){let t;for(t=0;t<this.rhMaxObjects;t++)this.rhObjectList[t]=null},prepareFrame:function(){this.rhGameFlags|=nD.GAMEFLAGS_LOADONCALL,this.rhGameFlags|=nD.GAMEFLAGS_INITIALISING,this.rh2CreationCount=0;let t,e,s,r,h,n,a=0;for(this.rhOiList=Array(this.rhMaxOI),this.rhMouseUsed=0,t=this.rhApp.OIList.getFirstOI();null!=t;t=this.rhApp.OIList.getNextOI())if((r=t.oiType)>=ac.OBJ_SPR){if(this.rhOiList[a]=new n3,this.rhOiList[a].copyData(t),this.rhOiList[a].oilHFII=-1,r==ac.OBJ_TEXT||r==ac.OBJ_QUEST){for(h=this.rhFrame.LOList.first_LevObj();null!=h;h=this.rhFrame.LOList.next_LevObj())if(h.loOiHandle==this.rhOiList[a].oilOi){this.rhOiList[a].oilHFII=h.loHandle;break}}if(a++,((e=t.oiOC).ocOEFlags&a$.OEFLAG_MOVEMENTS)!=0&&null!=e.ocMovements)for(s=0;s<e.ocMovements.nMovements;s++){let l=e.ocMovements.moveList[s];l.mvType==l6.MVTYPE_MOUSE&&(this.rhMouseUsed|=1<<l.mvControl-1)}}for(n=0;n<this.rhFrame.nLayers;n++)this.rhFrame.layers[n].nZOrderMax=1;return 0},createRemainingFrameObjects:function(){for(this.rhGameFlags&=~nD.GAMEFLAGS_FIRSTLOOPFADEIN,r=0,n=this.rhFrame.LOList.first_LevObj();null!=n;r++,n=this.rhFrame.LOList.next_LevObj())if(e=(t=this.rhApp.OIList.getOIFromHandle(n.loOiHandle)).oiOC,!((s=t.oiType)<ac.KPX_BASE)&&(e.ocOEFlags&a$.OEFLAG_RUNBEFOREFADEIN)==0&&(h=nD.COF_CREATEDATSTART,n.loParentType==an.PARENT_NONE)){if((e.ocFlags2&a$.OCFLAGS2_VISIBLEATSTART)==0){if(s!=ac.OBJ_TEXT)continue;h|=nD.COF_HIDDEN}(e.ocOEFlags&a$.OEFLAG_DONTCREATEATSTART)==0&&this.f_CreateObject(n.loHandle,n.loOiHandle,2147483648,2147483648,-1,h,-1,-1)}this.rhEvtProg.assemblePrograms(this);let t,e,s,r,h,n,a=new Date;this.rhTimerOld=a.getTime()-this.fadeTimerDelta},createFrameObjects:function(t){let e,s,r,h,n,a;for(h=0,a=this.rhFrame.LOList.first_LevObj();null!=a;h++,a=this.rhFrame.LOList.next_LevObj())if(s=(e=this.rhApp.OIList.getOIFromHandle(a.loOiHandle)).oiOC,r=e.oiType,n=nD.COF_CREATEDATSTART,a.loParentType==an.PARENT_NONE){if(r==ac.OBJ_TEXT&&(n|=nD.COF_FIRSTTEXT),(s.ocFlags2&a$.OCFLAGS2_VISIBLEATSTART)==0){if(r==ac.OBJ_QUEST)continue;n|=nD.COF_HIDDEN}if(t&&r>=ac.KPX_BASE&&(s.ocOEFlags&a$.OEFLAG_RUNBEFOREFADEIN)==0)continue;(s.ocOEFlags&a$.OEFLAG_DONTCREATEATSTART)==0&&this.f_CreateObject(a.loHandle,a.loOiHandle,2147483648,2147483648,-1,n,-1,-1)}this.rhGameFlags&=~nD.GAMEFLAGS_INITIALISING},killFrameObjects:function(){let t;for(t=0;t<this.rhMaxObjects&&0!=this.rhNObjects;t++)if(null!=this.rhObjectList[t]){var e=this.rhObjectList[t];(e.hoType<32||e.hoCommon.ocIdentifier!=nD.BASEIDENTIFIER)&&this.f_KillObject(t,!0)}for(t=0;t<this.rhMaxObjects&&0!=this.rhNObjects;t++)if(null!=this.rhObjectList[t]){var e=this.rhObjectList[t];e.hoType>=32&&e.hoCommon.ocIdentifier==nD.BASEIDENTIFIER&&this.f_KillObject(t,!0)}},y_KillLevel:function(t){t||((this.rhApp.gaNewFlags&ny.GANF_SAMPLESOVERFRAMES)==0?this.rhApp.soundPlayer.stopAllSounds():this.rhApp.soundPlayer.keepCurrentSounds())},resetFrameLayers:function(t,e){let s,r;for(-1==t?(s=0,r=this.rhFrame.nLayers):(s=t,r=t+1),s=0;s<r;s++){let h=this.rhFrame.layers[s];h.reset(),h.deleteBackObjects(),e&&h.deletePlanes()}},captureMouse:function(){0!=this.rhMouseUsed&&this.setCursorCount(-1)},freeMouse:function(){0!=this.rhMouseUsed&&this.setCursorCount(0)},setCursorCount:function(t){t>=0?this.rhApp.showCursor(1):this.rhApp.showCursor(-1)},showMouse:function(){this.rhApp.showCursor(1)},hideMouse:function(){this.rhApp.showCursor(-1)},addFastLoop:function(t){for(s=0;s<this.rh4FastLoops.size()&&(e=this.rh4FastLoops.get(s),!h.compareStringsIgnoreCase(e.name,t));s++);if(s==this.rh4FastLoops.size()){var e,s,r=new F;this.rh4FastLoops.add(r),s=this.rh4FastLoops.size()-1,r.name=t,r.flags=0}return s},saveGlobalObjectsData:function(){for(s=0;s<this.rhOiList.length;s++)if(a=(e=this.rhOiList[s]).oilObject,32767!=e.oilOi&&(2147483648&a)==0&&((h=this.rhApp.OIList.getOIFromHandle(e.oilOi)).oiFlags&ac.OIF_GLOBAL)!=0){if(t=this.rhObjectList[a],e.oilType!=ac.OBJ_TEXT&&e.oilType!=ac.OBJ_COUNTER&&null==t.rov)continue;n=e.oilName+e.oilType.toString(),null==this.rhApp.adGO&&(this.rhApp.adGO=new P);var t,e,s,r,h,n,a,l,u=!1,d=null;for(r=0;r<this.rhApp.adGO.size();r++)if(n==(d=this.rhApp.adGO.get(r)).name){u=!0;break}for(!1==u?((d=new nH).name=n,d.objects=new P,this.rhApp.adGO.add(d)):d.objects.clear();;){if(t=this.rhObjectList[a],e.oilType==ac.OBJ_TEXT){let p=new n6;p.text=t.rsTextBuffer,p.rsMini=t.rsMini,d.objects.add(p)}else if(e.oilType==ac.OBJ_COUNTER){let m=new nB;m.value=t.rsValue,m.rsMini=t.rsMini,m.rsMaxi=t.rsMaxi,m.rsMiniDouble=t.rsMiniDouble,m.rsMaxiDouble=t.rsMaxiDouble,d.objects.add(m)}else{let f=new nG;for(l=0,f.flags=t.rov.rvValueFlags,f.values=Array(t.rov.rvValues.length);l<t.rov.rvValues.length;l++)f.values[l]=t.rov.rvValues[l];for(l=0,f.strings=Array(t.rov.rvStrings.length);l<t.rov.rvStrings.length;l++)f.strings[l]=t.rov.rvStrings[l];d.objects.add(f)}if((2147483648&(a=t.hoNumNext))!=0)break}}},loadGlobalObjectsData:function(){if(null!=this.rhApp.adGO){for(a=0;a<this.rhOiList.length;a++)if(p=(n=this.rhOiList[a]).oilObject,32767!=n.oilOi&&p>=0&&((u=this.rhApp.OIList.getOIFromHandle(n.oilOi)).oiFlags&ac.OIF_GLOBAL)!=0)for(l=0,d=n.oilName+n.oilType.toString();l<this.rhApp.adGO.size();l++){let t=this.rhApp.adGO.get(l);if(d==t.name){for(let e=0;;){if(h=this.rhObjectList[p],n.oilType==ac.OBJ_TEXT){let s=t.objects.get(e);h.rsTextBuffer=s.text,h.rsMini=s.rsMini,h.roc.rcChanged=!0,h.bTxtChanged=!0}else if(n.oilType==ac.OBJ_COUNTER){let r=t.objects.get(e);h.rsValue=r.value,h.rsMini=r.rsMini,h.rsMaxi=r.rsMaxi,h.rsMiniDouble=r.rsMiniDouble,h.rsMaxiDouble=r.rsMaxiDouble,h.bCounterChanged=!0,h.roc.rcChanged=!0}else{var h,n,a,l,u,d,p,m,f=t.objects.get(e);for(h.rov.rvValueFlags=f.flags,h.rov.growValues(f.values.length),h.rov.growStrings(f.strings.length),m=0;m<f.values.length;m++)h.rov.rvValues[m]=f.values[m];for(m=0;m<f.strings.length;m++)h.rov.rvStrings[m]=f.strings[m]}if((2147483648&(p=h.hoNumNext))!=0||++e>=t.objects.size())break}break}}}},f_CreateObject:function(t,e,s,r,h,n,a,l){for(;;){let u=new n4,d=null;-1!=t&&(d=this.rhFrame.LOList.getLOFromHandle(t));let p=this.rhApp.OIList.getOIFromHandle(e),m=p.oiOC;if((m.ocFlags2&a$.OCFLAGS2_VISIBLEATSTART)==0&&(n|=nD.COF_HIDDEN),this.rhNObjects>=this.rhMaxObjects)break;let f=null,$=new a0;switch(p.oiType){case 2:f=new av;break;case 3:f=new aL;break;case 4:f=new aI;break;case 5:f=new ab;break;case 6:f=new aC;break;case 7:f=new aT;break;case 8:break;case 9:f=new aO;break;default:null==(f=new aF(p.oiType,this)).ext&&(f=null)}if(null==f)break;if(f.prototype=$,f.lo=d,l<0)for(l=0;l<this.rhMaxObjects&&null!=this.rhObjectList[l];l++);if(l>=this.rhMaxObjects)break;this.rhObjectList[l]=f,this.rhNObjects++,f.hoIdentifier=m.ocIdentifier,f.hoOEFlags=m.ocOEFlags,l>this.rh4ObjectCurCreate&&this.rh4ObjectAddCreate++,f.hoNumber=l,this.rh2CreationCount++,0==this.rh2CreationCount&&(this.rh2CreationCount=1),f.hoCreationId=this.rh2CreationCount,f.hoOi=e,f.hoHFII=t,f.hoType=p.oiType,this.oi_Insert(f),f.hoAdRunHeader=this,f.hoCallRoutine=!0,f.hoCommon=m,(f.hoOEFlags&a$.OEFLAG_MANUALSLEEP)==0&&(f.hoOEFlags&=~a$.OEFLAG_NEVERSLEEP,(f.hoLimitFlags&n3.OILIMITFLAGS_QUICKBACK)!=0&&(this.rhFrame.leFlags&nR.LEF_TOTALCOLMASK)!=0&&(f.hoOEFlags|=a$.OEFLAG_NEVERSLEEP),(f.hoLimitFlags&(n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_QUICKBORDER))!=0&&(f.hoOEFlags|=a$.OEFLAG_NEVERSLEEP));let g=s;2147483648==g&&(g=d.loX),u.cobX=g,f.hoX=g;let P=r;2147483648==P&&(P=d.loY),u.cobY=P,f.hoY=P,null!=d&&-1==a&&(a=d.loLayer),u.cobLayer=a,f.hoLayer=a;let E=this.rhFrame.layers[a];return E.nZOrderMax++,u.cobZOrder=E.nZOrderMax,u.cobFlags=n,u.cobDir=h,u.cobLevObj=d,f.roc=null,(f.hoOEFlags&(a$.OEFLAG_ANIMATIONS|a$.OEFLAG_MOVEMENTS|a$.OEFLAG_SPRITES))!=0&&(f.roc=new aS,f.roc.init()),f.rom=null,(f.hoOEFlags&a$.OEFLAG_MOVEMENTS)!=0&&(f.rom=new ur,(u.cobFlags&nD.COF_NOMOVEMENT)==0&&f.rom.init(0,f,m,u,-1)),f.roa=null,(f.hoOEFlags&a$.OEFLAG_ANIMATIONS)!=0&&(f.roa=new nW,f.roa.init(f)),f.ros=null,(f.hoOEFlags&a$.OEFLAG_SPRITES)!=0&&(f.ros=new l2,f.ros.init1(f,m,u)),f.rov=null,(f.hoOEFlags&a$.OEFLAG_VALUES)!=0&&(f.rov=new lN,f.rov.init(f,m,u)),f.init(m,u),(f.hoOEFlags&a$.OEFLAG_SPRITES)!=0&&f.ros.init2(!0),this.rhLoopCount>=1&&f.callComputeNewDisplay(),l}return -1},f_KillObject:function(t,e){let s=this.rhObjectList[t];if(null!=s){if(!0==e&&0==s.hoCreationId){this.rhObjectList[t]=null,this.rhNObjects--;return}this.killShootPtr(s),null!=s.rom&&s.rom.kill(e),null!=s.rov&&s.rov.kill(e),null!=s.ros&&s.ros.kill(e),null!=s.roc&&s.roc.kill(e),s.kill(e),this.oi_Delete(s),this.rhObjectList[t]=null,this.rhNObjects--}},destroy_Add:function(t){let e=Math.floor(t/32);this.rhDestroyList[e]|=1<<(31&t),this.rhDestroyPos++},destroy_List:function(){if(0!=this.rhDestroyPos)for(var t,e,s=0;s<this.rhMaxObjects;){if(0!=(t=this.rhDestroyList[s/32])){for(e=0,this.rhDestroyList[s/32]=0;0!=t&&e<32;e++){if((1&t)!=0){let r=this.rhObjectList[s+e];null!=r&&1==r.hoOiList.oilNObjects&&this.rhEvtProg.handle_Event(r,-2162688|r.hoType),this.f_KillObject(s+e,!1),this.rhDestroyPos--}t>>=1}if(0==this.rhDestroyPos)return}s+=32}},killShootPtr:function(t){let e,s,r=0;for(e=0;e<this.rhNObjects;e++){for(;null==this.rhObjectList[r];)r++;if(s=this.rhObjectList[r],r++,null!=s.rom&&s.roc.rcMovementType==l6.MVTYPE_BULLET){let h=s.rom.rmMovement;h.MBul_ShootObject==t&&!0==h.MBul_Wait&&h.startBullet()}}},callComputeNewDisplay:function(){let t,e,s;for(t=0,s=0;t<this.rhNObjects;t++){for(;null==this.rhObjectList[s];)s++;e=this.rhObjectList[s],s++,e.createFont()}for(t=0,s=0;t<this.rhNObjects;t++){for(;null==this.rhObjectList[s];)s++;e=this.rhObjectList[s],s++,e.callComputeNewDisplay()}},oi_Insert:function(t){let e,s=t.hoOi;for(e=0;e<this.rhMaxOI&&this.rhOiList[e].oilOi!=s;e++);let r=this.rhOiList[e];if((2147483648&r.oilObject)!=0)r.oilObject=t.hoNumber,t.hoNumPrev=2147483648|e,t.hoNumNext=2147483648;else{let h=this.rhObjectList[r.oilObject];t.hoNumPrev=h.hoNumPrev,h.hoNumPrev=t.hoNumber,t.hoNumNext=h.hoNumber,r.oilObject=t.hoNumber}t.hoEvents=r.oilEvents,t.hoOiList=r,t.hoLimitFlags=r.oilLimitFlags,-1==t.hoHFII?t.hoHFII=r.oilHFII:-1==r.oilHFII&&(r.oilHFII=t.hoHFII),r.oilNObjects+=1},oi_Delete:function(t){let e,s=t.hoOiList;if(s.oilNObjects-=1,(2147483648&t.hoNumPrev)==0){if(e=this.rhObjectList[t.hoNumPrev],(2147483648&t.hoNumNext)==0){let r=this.rhObjectList[t.hoNumNext];null!=e&&(e.hoNumNext=t.hoNumNext),null!=r&&(r.hoNumPrev=t.hoNumPrev)}else null!=e&&(e.hoNumNext=2147483648)}else(2147483648&t.hoNumNext)==0?null!=(e=this.rhObjectList[t.hoNumNext])&&(e.hoNumPrev=t.hoNumPrev,s.oilObject=e.hoNumber):s.oilObject=2147483648},CreateBodies:function(){let t,e=this.GetBase();if(null!=e){let s=0;for(t=0;t<this.rhNObjects;s++,t++){for(;null==this.rhObjectList[s];)s++;var r=this.rhObjectList[s];r.hoType>=32&&(r.hoCommon.ocIdentifier==nD.FANIDENTIFIER||r.hoCommon.ocIdentifier==nD.TREADMILLIDENTIFIER||r.hoCommon.ocIdentifier==nD.PARTICULESIDENTIFIER||r.hoCommon.ocIdentifier==nD.ROPEANDCHAINIDENTIFIER||r.hoCommon.ocIdentifier==nD.MAGNETIDENTIFIER?r.ext.rStartObject():r.hoCommon.ocIdentifier==nD.BASEIDENTIFIER&&r.ext.rStartObject())}for(t=0,s=0;t<this.rhNObjects;s++,t++){for(;null==this.rhObjectList[s];)s++;var r=this.rhObjectList[s];if((r.hoOEFlags&a$.OEFLAG_MOVEMENTS)!=0){let n=!1;if(r.roc.rcMovementType==l6.MVTYPE_EXT){var a=r.hoCommon.ocMovements.moveList[r.rom.rmMvtNum];(h.compareStringsIgnoreCase(a.moduleName,"box2d8directions")||h.compareStringsIgnoreCase(a.moduleName,"box2dspring")||h.compareStringsIgnoreCase(a.moduleName,"box2dspaceship")||h.compareStringsIgnoreCase(a.moduleName,"box2dstatic")||h.compareStringsIgnoreCase(a.moduleName,"box2dracecar")||h.compareStringsIgnoreCase(a.moduleName,"box2daxial")||h.compareStringsIgnoreCase(a.moduleName,"box2dplatform")||h.compareStringsIgnoreCase(a.moduleName,"box2dbouncingball")||h.compareStringsIgnoreCase(a.moduleName,"box2dbackground"))&&(r.rom.rmMovement.movement.CreateBody(),n=!0)}!1==n&&2==r.hoType&&e.rAddNormalObject(r)}}for(t=0,s=0;t<this.rhNObjects;s++,t++){for(;null==this.rhObjectList[s];)s++;var r=this.rhObjectList[s];if((r.hoOEFlags&a$.OEFLAG_MOVEMENTS)!=0&&r.roc.rcMovementType==l6.MVTYPE_EXT){var a=r.hoCommon.ocMovements.moveList[r.rom.rmMvtNum];(h.compareStringsIgnoreCase(a.moduleName,"box2d8directions")||h.compareStringsIgnoreCase(a.moduleName,"box2dspring")||h.compareStringsIgnoreCase(a.moduleName,"box2dspaceship")||h.compareStringsIgnoreCase(a.moduleName,"box2dstatic")||h.compareStringsIgnoreCase(a.moduleName,"box2dracecar")||h.compareStringsIgnoreCase(a.moduleName,"box2daxial")||h.compareStringsIgnoreCase(a.moduleName,"box2dplatform")||h.compareStringsIgnoreCase(a.moduleName,"box2dbouncingball")||h.compareStringsIgnoreCase(a.moduleName,"box2dbackground"))&&r.rom.rmMovement.movement.CreateJoint()}}}},GetBase:function(){if(!1==this.rh4Box2DSearched){this.rh4Box2DSearched=!0,this.rh4Box2DBase=null;let t,e=0;for(t=0;t<this.rhNObjects;e++,t++){for(;null==this.rhObjectList[e];)e++;let s=this.rhObjectList[e];if(s.hoType>=32&&s.hoCommon.ocIdentifier==nD.BASEIDENTIFIER){this.rh4Box2DBase=s.ext;break}}}return this.rh4Box2DBase},GetMBase:function(t){if(t&&(t.hoFlags&a0.HOF_DESTROYED)==0&&(t.hoOEFlags&a$.OEFLAG_MOVEMENTS)!=0&&t.roc.rcMovementType==l6.MVTYPE_EXT){let e=t.hoCommon.ocMovements.moveList[t.rom.rmMvtNum];if(h.compareStringsIgnoreCase(e.moduleName,"box2d8directions")||h.compareStringsIgnoreCase(e.moduleName,"box2dspring")||h.compareStringsIgnoreCase(e.moduleName,"box2dspaceship")||h.compareStringsIgnoreCase(e.moduleName,"box2dstatic")||h.compareStringsIgnoreCase(e.moduleName,"box2dracecar")||h.compareStringsIgnoreCase(e.moduleName,"box2daxial")||h.compareStringsIgnoreCase(e.moduleName,"box2dplatform")||h.compareStringsIgnoreCase(e.moduleName,"box2dbouncingball")||h.compareStringsIgnoreCase(e.moduleName,"box2dbackground"))return t.rom.rmMovement.movement}return null},addPhysicsAttractor:function(t){if(t.hoCommon.ocIdentifier==nD.FANIDENTIFIER||t.hoCommon.ocIdentifier==nD.TREADMILLIDENTIFIER||t.hoCommon.ocIdentifier==nD.MAGNETIDENTIFIER||t.hoCommon.ocIdentifier==nD.ROPEANDCHAINIDENTIFIER){let e,s=0;for(e=0;e<this.rhNObjects;s++,e++){for(;null==this.rhObjectList[s];)s++;let r=this.rhObjectList[s];r.hoType>=32&&r.hoCommon.ocIdentifier==nD.BASEIDENTIFIER&&(t.hoCommon.ocIdentifier==nD.FANIDENTIFIER?t.ext.identifier==r.ext.identifier&&r.ext.fans.add(t.ext):t.hoCommon.ocIdentifier==nD.TREADMILLIDENTIFIER?t.ext.identifier==r.ext.identifier&&r.ext.treadmills.add(t.ext):t.hoCommon.ocIdentifier==nD.MAGNETIDENTIFIER?t.ext.identifier==r.ext.identifier&&r.ext.magnets.add(t.ext):t.hoCommon.ocIdentifier==nD.ROPEANDCHAINIDENTIFIER&&t.ext.identifier==r.ext.identifier&&r.ext.ropes.add(t.ext))}if(t.hoCommon.ocIdentifier!=nD.ROPEANDCHAINIDENTIFIER)for(e=0,s=0;e<this.rhNObjects;s++,e++){for(;null==this.rhObjectList[s];)s++;let h=this.rhObjectList[s];if(h.hoType==ac.OBJ_SPR){let n=this.GetMBase(h);n&&t.ext.rAddObject(n)}}}},getDir:function(t){return null!=t.rom&&null!=t.rom.rmMovement?t.rom.rmMovement.getDir():t.roc.rcDir},pause:function(t){if(0==this.rh2PauseCompteur){this.rh2PauseCompteur=1,this.rh2PauseTimer=this.rhApp.timer;let e,s=0;for(e=0;e<this.rhNObjects;e++){for(;null==this.rhObjectList[s];)s++;let r=this.rhObjectList[s];s++,r.hoType>=ac.KPX_BASE&&r.ext.pauseRunObject()}t||this.rhApp.soundPlayer.pause()}},resume:function(){if(!this.noResume&&0!=this.rh2PauseCompteur){this.rh2PauseCompteur=0,this.captureMouse();let t,e=0;for(t=0;t<this.rhNObjects;t++){for(;null==this.rhObjectList[e];)e++;let s=this.rhObjectList[e];e++,s.hoType>=ac.KPX_BASE&&s.ext.continueRunObject()}this.rhApp.soundPlayer.resume();let r=this.rhApp.timer;r-=this.rh2PauseTimer,this.rhTimerOld+=r,this.rh4PauseKey=0,this.quitPause=!1}},f_StopSamples:function(){this.rhApp.soundPlayer.stopAllSounds()},autoResize:function(){let t,e=0;for(t=0;t<this.rhNObjects;t++){for(;null==this.rhObjectList[e];)e++;let s=this.rhObjectList[e];e++,s.autoResize()}},find_HeaderObject:function(t){let e,s=0;for(e=0;e<this.rhNObjects;e++){for(;null==this.rhObjectList[s];)s++;if(t==this.rhObjectList[s].hoHFII)return rhObjectList[s];s++}return null},check_Ladder:function(t,e,s){let r=this.y_GetLadderAt(t,e,s);return null!=r?r.top:nD.INTBAD},y_GetLadderAt:function(t,e,s){for(e-=this.rhWindowX,s-=this.rhWindowY,-1==t?(r=0,h=this.rhFrame.nLayers):(r=t,h=t+1);r<h;r++){var r,h,n=this.rhFrame.layers[r].getLadderAt(e,s);if(null!=n)return n}return null},f_InitLoop:function(){let t,e=this.rhApp.timer;for(t=0,this.rhTimerOld=e,this.rhTimer=0,this.rhLoopCount=0,this.rh4LoopTheoric=0,this.rhQuit=0,this.rhQuitBis=0,this.rhDestroyPos=0;t<(this.rhMaxObjects+31)/32;t++)this.rhDestroyList[t]=0;this.rh3WindowSx=this.rhFrame.leEditWinWidth,this.rh3WindowSy=this.rhFrame.leEditWinHeight,this.rh3XMinimumKill=-nD.GAME_XBORDER,this.rh3YMinimumKill=-nD.GAME_YBORDER,this.rh3XMaximumKill=this.rhLevelSx+nD.GAME_XBORDER,this.rh3YMaximumKill=this.rhLevelSy+nD.GAME_YBORDER;let s=this.rhWindowX;this.rh3DisplayX=s,(s-=nD.COLMASK_XMARGIN)<0&&(s=this.rh3XMinimumKill),this.rh3XMinimum=s;let r=this.rhWindowY;this.rh3DisplayY=r,(r-=nD.COLMASK_YMARGIN)<0&&(r=this.rh3YMinimumKill),this.rh3YMinimum=r;let h=this.rhWindowX;(h+=this.rh3WindowSx+nD.COLMASK_XMARGIN)>this.rhLevelSx&&(h=this.rh3XMaximumKill),this.rh3XMaximum=h;let n=this.rhWindowY;for((n+=this.rh3WindowSy+nD.COLMASK_YMARGIN)>this.rhLevelSy&&(n=this.rh3YMaximumKill),this.rh3YMaximum=n,this.rh3Scrolling=0,this.rh4DoUpdate=0,this.rh4EventCount=0,this.rh4TimeOut=0,this.rh2PauseCompteur=0,this.rh4FakeKey=0,t=0;t<4;t++)this.rhPlayer[t]=0,this.rh2OldPlayer[t]=0,this.rh2InputMask[t]=255;for(t=0,this.rh2MouseKeys=0,this.rhEvtProg.callEndForEach=!1,this.rh4EndOfPause=-1,this.rh4OnMouseWheel=-1,this.rh4LoadCount=-1,this.rhEvtProg.rh4CheckDoneInstart=!1,this.rh4PauseKey=0,this.rh4Box2DBase=null,this.rh4Box2DSearched=!1,this.rh4ForEachs=null,this.rh4CurrentForEach=null,this.rh4CurrentForEach2=null,this.rh4TimerEvents=null;t<nD.MAX_FRAMERATE;t++)this.rh4FrameRateArray[t]=20;this.rh4FrameRatePos=0},f_GameLoop:function(){if(this.rhApp.soundPlayer.checkSounds(),null!=this.rhApp.parentApp&&this.rhApp.loading)return this.rhTimerOld=this.rhApp.timer,this.rhTimer=0,this.rhQuit;if(null!=this.rhApp.modalSubappObject)return this.rhApp.modalSubappObject.handle(),0;this.bodiesCreated||(this.CreateBodies(),this.bodiesCreated=!0);let t,e,s=this.rhApp.timer-this.rhTimerOld,r=this.rhTimer;for(this.rhTimer=s,s-=r,this.rhTimerDelta=s,this.rh4TimeOut+=s,this.rhLoopCount+=1,this.rh4MvtTimerCoef=this.rhTimerDelta*this.rhFrame.m_dwMvtTimerBase/1e3,this.rh4FrameRateArray[this.rh4FrameRatePos]=s,this.rh4FrameRatePos++,this.rh4FrameRatePos>=nD.MAX_FRAMERATE&&(this.rh4FrameRatePos=0),t=0;t<4;t++)this.rh2OldPlayer[t]=this.rhPlayer[t];if(this.joyTest(),1==this.rhApp.joystickOn?this.rhPlayer[0]|=this.rhApp.joystick.getJoystick()&this.rhJoystickMask:2==this.rhApp.joystickOn&&(this.rhPlayer[0]|=this.rhApp.getJoystick()&this.rhJoystickMask),0!=this.rhMouseUsed){this.getMouseCoords(),this.rh2MouseKeys=0,this.rhApp.keyBuffer[ny.VK_LBUTTON]&&(this.rh2MouseKeys|=16),this.rhApp.keyBuffer[ny.VK_RBUTTON]&&(this.rh2MouseKeys|=32);let h=this.rhMouseUsed;for(t=0;t<this.rhNPlayers;t++){if((1&this.mouseUsed)!=0){let n=207&this.rhPlayer[t];n|=this.rh2MouseKeys,this.rhPlayer[t]=n}h>>=1}}else this.getMouseCoords();for(t=0;t<4;t++)if(e=this.rhPlayer[t]&nD.plMasks[4*this.rhNPlayers+t],e&=this.rh2InputMask[t],this.rhPlayer[t]=e,e^=this.rh2OldPlayer[t],this.rh2NewPlayer[t]=e,0!=e){if((240&(e&=this.rhPlayer[t]))!=0)this.rhEvtProg.rhCurOi=t,(240&(e=this.rh2NewPlayer[t]))!=0&&(this.rhEvtProg.rhCurParam0=e,this.rhEvtProg.handle_GlobalEvents(-196615)),(15&e)!=0&&(this.rhEvtProg.rhCurParam0=e,this.rhEvtProg.handle_GlobalEvents(-196615));else{let a=this.rhEvtProg.listPointers[this.rhEvtProg.rhEvents[-ac.OBJ_PLAYER]+4];0!=a&&(this.rhEvtProg.rhCurParam0=e,this.rhEvtProg.computeEventList(a,null))}}if(0!=this.rhNObjects){let l=this.rhNObjects,u=0;do{for(this.rh4ObjectAddCreate=0;null==this.rhObjectList[u];)u++;let d=this.rhObjectList[u];d.hoPrevNoRepeat=d.hoBaseNoRepeat,d.hoBaseNoRepeat=null,d.hoCallRoutine&&(this.rh4ObjectCurCreate=u,d.handle()),l+=this.rh4ObjectAddCreate,u++,l--}while(0!=l)}return(this.rh3CollisionCount++,this.rhEvtProg.compute_TimerEvents(),this.rhEvtProg.handle_TimerEvents(),this.rhEvtProg.rhEventAlways&&(this.rhGameFlags&nD.GAMEFLAGS_FIRSTLOOPFADEIN)==0&&this.rhEvtProg.computeEventList(0,null),this.rhEvtProg.handle_PushedEvents(),this.destroy_List(),this.doScroll(),this.rhEvtProg.rh2CurrentClick=-1,this.rh4EventCount++,this.rh4FakeKey=0,0==this.rhQuit)?this.rhQuitBis:((this.rhQuit==nD.LOOPEXIT_NEXTLEVEL||this.rhQuit==nD.LOOPEXIT_PREVLEVEL||this.rhQuit==nD.LOOPEXIT_ENDGAME||this.rhQuit==nD.LOOPEXIT_GOTOLEVEL||this.rhQuit==nD.LOOPEXIT_QUIT||this.rhQuit==nD.LOOPEXIT_NEWGAME)&&this.rhEvtProg.handle_GlobalEvents(-65539),this.rhQuit)},joyTest:function(){for(t=0;t<4;t++)this.rhPlayer[t]=0;let t,e,s=this.rhApp.getCtrlKeys();for(t=0;t<4;t++)for(e=0;e<ny.MAX_KEY;e++)this.rhApp.keyBuffer[s[t*ny.MAX_KEY+e]]&&(this.rhPlayer[t]|=1<<e)},getMouseCoords:function(){this.rh2MouseX=this.rhApp.mouseX+this.rhWindowX-this.rhApp.xOffset,this.rh2MouseY=this.rhApp.mouseY+this.rhWindowY-this.rhApp.yOffset},newHandle_Collisions:function(t){if(t.rom.rmMoveFlag=!1,nD.bMoveChanged=!1,t.rom.rmEventFlags=0,(t.hoLimitFlags&n3.OILIMITFLAGS_QUICKBORDER)!=0){if(0!=(r=this.quadran_In(t.roc.rcOldX1,t.roc.rcOldY1,t.roc.rcOldX2,t.roc.rcOldY2))&&0==(h=this.quadran_In(t.hoX-t.hoImgXSpot,t.hoY-t.hoImgYSpot,t.hoX-t.hoImgXSpot+t.hoImgWidth,t.hoY-t.hoImgYSpot+t.hoImgHeight))&&0!=(n=r^h)&&(t.rom.rmEventFlags|=ur.EF_GOESINPLAYFIELD,this.rhEvtProg.rhCurParam0=n,this.rhEvtProg.handle_Event(t,-720896|65535&t.hoType)),((s=this.quadran_In(t.hoX-t.hoImgXSpot,t.hoY-t.hoImgYSpot,t.hoX-t.hoImgXSpot+t.hoImgWidth,t.hoY-t.hoImgYSpot+t.hoImgHeight))&t.rom.rmWrapping)!=0){let e=t.rom.rmMoveFlag;(s&nD.BORDER_LEFT)!=0?t.rom.rmMovement.setXPosition(t.hoX+this.rhLevelSx):(s&nD.BORDER_RIGHT)!=0&&t.rom.rmMovement.setXPosition(t.hoX-this.rhLevelSx),(s&nD.BORDER_TOP)!=0?t.rom.rmMovement.setYPosition(t.hoY+this.rhLevelSy):(s&nD.BORDER_BOTTOM)!=0&&t.rom.rmMovement.setYPosition(t.hoY-this.rhLevelSy),t.roc.rcMovementType!=l6.MVTYPE_PLATFORM&&t.roc.rcMovementType!=l6.MVTYPE_EXT&&(t.rom.rmMoveFlag=e)}(r=this.quadran_Out(t.roc.rcOldX1,t.roc.rcOldY1,t.roc.rcOldX2,t.roc.rcOldY2))!=nD.BORDER_ALL&&0!=(n=~r&(h=this.quadran_Out(t.hoX-t.hoImgXSpot,t.hoY-t.hoImgYSpot,t.hoX-t.hoImgXSpot+t.hoImgWidth,t.hoY-t.hoImgYSpot+t.hoImgHeight)))&&(t.rom.rmEventFlags|=ur.EF_GOESOUTPLAYFIELD,this.rhEvtProg.rhCurParam0=n,this.rhEvtProg.handle_Event(t,-786432|65535&t.hoType))}if((t.hoLimitFlags&n3.OILIMITFLAGS_QUICKBACK)!=0&&(t.roc.rcMovementType==l6.MVTYPE_PLATFORM?t.rom.rmMovement.mpHandle_Background():this.colMask_TestObject_IXY(t,t.roc.rcImage,t.roc.rcAngle,t.roc.rcScaleX,t.roc.rcScaleY,t.hoX,t.hoY,0,nR.CM_TEST_PLATFORM)&&this.rhEvtProg.handle_Event(t,-851968|65535&t.hoType)),(t.hoLimitFlags&n3.OILIMITFLAGS_ONCOLLIDE)!=0){var s,r,h,n,a,l=this.objectAllCol_IXY(t,t.roc.rcImage,t.roc.rcAngle,t.roc.rcScaleX,t.roc.rcScaleY,t.hoX,t.hoY,t.hoOiList.oilColList);if(null!=l)for(a=0;a<l.size();a++){let u=l.get(a);if((u.hoFlags&a0.HOF_DESTROYED)==0){let d=t.hoType,p=t,m=u;p.hoType>m.hoType&&(p=u,m=t,d=p.hoType),this.rhEvtProg.rhCurParam0=m.hoOi,this.rhEvtProg.rh1stObjectNumber=m.hoNumber,this.rhEvtProg.handle_Event(p,-917504|65535&d)}}}return nD.bMoveChanged},objectAllCol_IXY:function(t,e,s,r,h,n,a,l){let u,d,p,m,f,$,g,E=null,_=n-t.hoImgXSpot,A=_+t.hoImgWidth,v=a-t.hoImgYSpot,O=v+t.hoImgHeight;if((t.hoFlags&a0.HOF_NOCOLLISION)!=0||(t.hoFlags&a0.HOF_DESTROYED)!=0)return E;let S=!1,T=null,b=-1;t.hoType==ac.OBJ_SPR&&(t.ros.rsFlags&l2.RSFLAG_COLBOX)==0&&(S=!0),t.hoType==ac.OBJ_SPR&&(b=t.ros.rsLayer);let C=t.hoFlags;t.hoFlags|=a0.HOF_NOCOLLISION;let L=0;if(null!=l){let I=0;for(I=0;I<l.length;I+=2)for(let F=this.rhOiList[l[I+1]].oilObject;(2147483648&F)==0;)if(F=(f=this.rhObjectList[F]).hoNumNext,(f.hoFlags&a0.HOF_NOCOLLISION)==0&&(f.hoFlags&a0.HOF_DESTROYED)==0&&($=f.hoX-f.hoImgXSpot,g=f.hoY-f.hoImgYSpot,$<A&&$+f.hoImgWidth>_&&g<O&&g+f.hoImgHeight>v))switch(f.hoType){case ac.OBJ_SPR:if((b<0||b>=0&&b==f.ros.rsLayer)&&(f.ros.rsFlags&l2.RSFLAG_RAMBO)!=0){if(!1==S||(f.ros.rsFlags&l2.RSFLAG_COLBOX)!=0){null==E&&(E=new P),E.add(f);break}null==T&&null!=(p=this.rhApp.imageBank.getImageFromHandle(e))&&(T=p.getMask(0,s,r,h)),null!=(d=this.rhApp.imageBank.getImageFromHandle(f.roc.rcImage))&&(u=d.getMask(0,f.roc.rcAngle,f.roc.rcScaleX,f.roc.rcScaleY)),null!=T&&null!=u&&T.testMask(_,v,0,u,$,g,0)&&(null==E&&(E=new P),E.add(f))}break;case ac.OBJ_TEXT:case ac.OBJ_COUNTER:case ac.OBJ_LIVES:case ac.OBJ_SCORE:case ac.OBJ_CCA:default:null==E&&(E=new P),E.add(f)}}else for(m=0;m<this.rhNObjects;m++){for(;null==this.rhObjectList[L];)L++;if(f=this.rhObjectList[L],L++,(f.hoFlags&a0.HOF_NOCOLLISION)==0&&($=f.hoX-f.hoImgXSpot,g=f.hoY-f.hoImgYSpot,$<A&&$+f.hoImgWidth>_&&g<O&&g+f.hoImgHeight>v))switch(f.hoType){case ac.OBJ_SPR:if((b<0||b>=0&&b==f.ros.rsLayer)&&(f.ros.rsFlags&l2.RSFLAG_RAMBO)!=0){if(!1==S||(f.ros.rsFlags&l2.RSFLAG_COLBOX)!=0){null==E&&(E=new P),E.add(f);break}null==T&&null!=(p=this.rhApp.imageBank.getImageFromHandle(e))&&(T=p.getMask(0,s,r,h)),null!=(d=this.rhApp.imageBank.getImageFromHandle(f.roc.rcImage))&&(u=d.getMask(0,f.roc.rcAngle,f.roc.rcScaleX,f.roc.rcScaleY)),null!=T&&null!=u&&T.testMask(_,v,0,u,$,g,0)&&(null==E&&(E=new P),E.add(f))}break;case ac.OBJ_TEXT:case ac.OBJ_COUNTER:case ac.OBJ_LIVES:case ac.OBJ_SCORE:case ac.OBJ_CCA:default:null==E&&(E=new P),E.add(f)}}return t.hoFlags=C,E},colMask_TestObject_IXY:function(t,e,s,r,h,n,a,l,u){let d,p,m,f,$,g,P=this.rhFrame.layers[t.hoLayer];if(t.hoType===ac.OBJ_SPR){if((t.ros.rsFlags&l2.RSFLAG_COLBOX)==0){if(null!=(d=this.rhApp.imageBank.getImageFromHandle(t.roc.rcImage)))return p=d.getMask(lR.GCMF_OBSTACLE,s,r,h),null!=P.testMask(p,n-this.rhWindowX,a-this.rhWindowY,l,u)}else{m=n-t.hoImgXSpot-this.rhWindowX,f=a-t.hoImgYSpot-this.rhWindowY,$=m+t.hoImgWidth,g=f+t.hoImgHeight;var E=null!=P.testRect(m,f,$,g,l,u);return E}return!1}m=n-t.hoImgXSpot-this.rhWindowX,f=a-t.hoImgYSpot-this.rhWindowY,$=m+t.hoImgWidth,g=f+t.hoImgHeight;var E=null!=P.testRect(m,f,$,g,l,u);return E},colMask_Test_Rect:function(t,e,s,r,h,n){let a,l,u=h;-1==h&&(h=0,u=this.rhFrame.nLayers);let d=t+s,p=e+r;for(l=h;l<u;l++)if(null!=(a=this.rhFrame.layers[l]).testRect(t-this.rhWindowX+a.x,e-this.rhWindowY+a.y,d-this.rhWindowX+a.x,p-this.rhWindowY+a.y,0,n))return!0;return!1},colMask_Test_XY:function(t,e,s,r){let h,n,a=s;for(-1==s&&(s=0,a=this.rhFrame.nLayers),n=s;n<a;n++)if((h=this.rhFrame.layers[n]).testPoint(t-this.rhWindowX+h.x,e-this.rhWindowY+h.y,r))return!0;return!1},getObjectAtXY:function(t,e){let s,r,h,n,a,l,u,d=0,p=null,m=-1;for(s=0;s<this.rhNObjects;s++){for(;null==this.rhObjectList[d];)d++;r=this.rhObjectList[d],d++,h=r.hoX-r.hoImgXSpot,n=r.hoY-r.hoImgYSpot,a=h+r.hoImgWidth,l=n+r.hoImgHeight,t>=h&&t<a&&e>=n&&e<l&&(r.hoFlags&a0.HOF_DESTROYED)==0&&r.hoType==ac.OBJ_SPR&&((r.ros.rsFlags&l2.RSFLAG_COLBOX)==0?this.rhApp.imageBank.getImageFromHandle(r.roc.rcImage).getMask(lR.GCMF_OBSTACLE,0,1,1).testPointEx(t-r.hoX,e-r.hoY,r.roc.rcAngle,r.roc.rcScaleX,r.roc.rcScaleY)&&(u=r.getChildIndex())>m&&(m=u,p=r):(u=r.getChildIndex())>m&&(m=u,p=r))}return p},quadran_Out:function(t,e,s,r){let h=0;return t<0&&(h|=nD.BORDER_LEFT),e<0&&(h|=nD.BORDER_TOP),s>this.rhLevelSx&&(h|=nD.BORDER_RIGHT),r>this.rhLevelSy&&(h|=nD.BORDER_BOTTOM),nD.Table_InOut[h]},quadran_In:function(t,e,s,r){let h=15;return t<this.rhLevelSx&&(h&=~nD.BORDER_RIGHT),e<this.rhLevelSy&&(h&=~nD.BORDER_BOTTOM),s>0&&(h&=~nD.BORDER_LEFT),r>0&&(h&=~nD.BORDER_TOP),nD.Table_InOut[h]},random:function(t){let e=31415*this.rh3Graine+1;return e&=65535,this.rh3Graine=e,e*t>>>16},get_Direction:function(t){if(0==t||-1==t)return this.random(32);let e,s=0,r=0,h=t;for(e=0;e<32;e++)(1&h)!=0&&(r++,s=e),h>>>=1;if(1==r)return s;for(e=0,r=this.random(r),h=t;e<32;e++){if((1&h)!=0&&--r<0)return e;h>>>=1}return 0},get_EventExpressionAny:function(t){return this.rh4Tokens=t.tokens,this.rh4CurToken=0,this.flagFloat=!1,this.getExpression()},get_EventExpressionInt:function(t){return this.rh4Tokens=t.tokens,this.rh4CurToken=0,this.flagFloat=!1,this.getExpression()},get_EventExpressionDouble:function(t){return this.rh4Tokens=t.tokens,this.rh4CurToken=0,this.flagFloat=!1,this.getExpression()},get_EventExpressionString:function(t){return this.rh4Tokens=t.tokens,this.rh4CurToken=0,this.flagFloat=!1,this.getExpression()},get_ExpressionInt:function(){this.flagFloat=!1;let t=this.getExpression();return t<0?Math.ceil(t):Math.floor(t)},getExpression:function(){let t,e=this.rh4PosPile;this.rh4Operators[this.rh4PosPile]=this.rh4OpeNull;do for(this.rh4PosPile++,this.bOperande=!0,this.rh4Tokens[this.rh4CurToken].evaluate(this),this.bOperande=!1,this.rh4CurToken++;;)if((t=this.rh4Tokens[this.rh4CurToken]).code>0&&t.code<1310720)t.code>this.rh4Operators[this.rh4PosPile-1].code?(this.rh4Operators[this.rh4PosPile]=t,this.rh4CurToken++,this.rh4PosPile++,this.bOperande=!0,this.rh4Tokens[this.rh4CurToken].evaluate(this),this.bOperande=!1,this.rh4CurToken++):(this.rh4PosPile--,this.rh4Operators[this.rh4PosPile].evaluate(this));else{if(this.rh4PosPile--,this.rh4PosPile==e)break;this.rh4Operators[this.rh4PosPile].evaluate(this)}while(this.rh4PosPile>e+1);return this.rh4Results[e+1]},getCurrentResult:function(){return this.rh4Results[this.rh4PosPile]},getPreviousResult:function(){return this.rh4Results[this.rh4PosPile-1]},getNextResult:function(){return this.rh4Results[this.rh4PosPile+1]},update_PlayerObjects:function(t,e,s){t++;let r,h=0;for(r=0;r<this.rhNObjects;r++){for(;null==this.rhObjectList[h];)h++;let n=this.rhObjectList[h];if(n.hoType==e)switch(e){case 5:case 6:n.rsPlayer==t&&n.setValue(s)}h++}},actPla_FinishLives:function(t,e){let s=this.rhApp.getLives();e!=s[t]&&(0==e&&0!=s[t]&&this.rhEvtProg.push_Event(0,-262151,0,null,t),s[t]=e,this.update_PlayerObjects(t,ac.OBJ_LIVES,e))},getMouseOnObjectsEDX:function(t,e){let s,r,h,n,a,l,u=this.rhEvtProg.evt_FirstObject(t);if(null==u)return!!e;let d=this.rhEvtProg.evtNSelectedObjects,p=0,m=new P;for(s=0;s<this.rhNObjects;s++){for(;null==this.rhObjectList[p];)p++;r=this.rhObjectList[p],p++,h=r.hoX-r.hoImgXSpot,n=r.hoY-r.hoImgYSpot,a=h+r.hoImgWidth,l=n+r.hoImgHeight,this.rh2MouseX>=h&&this.rh2MouseX<a&&this.rh2MouseY>=n&&this.rh2MouseY<l&&(r.hoFlags&a0.HOF_DESTROYED)==0&&(r.hoType==ac.OBJ_SPR&&(r.ros.rsFlags&l2.RSFLAG_COLBOX)==0?this.rhApp.imageBank.getImageFromHandle(r.roc.rcImage).getMask(lR.GCMF_OBSTACLE,0,1,1).testPointEx(this.rh2MouseX-r.hoX,this.rh2MouseY-r.hoY,r.roc.rcAngle,r.roc.rcScaleX,r.roc.rcScaleY)&&m.add(r):m.add(r))}if(0==m.size())return!!e;if(!1==e){do{for(p=0;p<m.size()&&(r=m.get(p))!=u;p++);p==m.size()&&(d--,this.rhEvtProg.evt_DeleteCurrentObject()),u=this.rhEvtProg.evt_NextObject()}while(null!=u);return 0!=d}do{for(p=0;p<m.size();p++)if((r=m.get(p))==u)return!1;u=this.rhEvtProg.evt_NextObject()}while(null!=u);return!0},txtDisplay:function(t,e,s){let r=t.evtParams[0],h=new ax;if(r.read_Position(this,16,h)){let n,a=0;for(n=0;n<this.rhNObjects;n++){for(;null==this.rhObjectList[a];)a++;let l=this.rhObjectList[a];if(a++,l.hoType==ac.OBJ_TEXT&&l.hoOi==e&&l.hoX==h.x&&l.hoY==h.y)return l.ros.obShow(),l.hoFlags&=~a0.HOF_NOCOLLISION,l.rsMini=-2,l.txtChange(s),l.ros.rsFlash=0,l.ros.rsFlags|=l2.RSFLAG_VISIBLE,l.hoNumber}let u=this.f_CreateObject(-1,e,h.x,h.y,0,0,this.rhFrame.nLayers-1,-1);if(u>=0)return this.rhObjectList[u].txtChange(s),u}return -1},txtDoDisplay:function(t,e){if((32768&t.evtOiList)==0)return this.txtDisplay(t,t.evtOi,e);if((32767&t.evtOiList)==32767)return -1;for(let s=32767&t.evtOiList,r=this.rhEvtProg.qualToOiList[s],h=0;h<r.qoiList.length;)this.txtDisplay(t,r.qoiList[h],e),h+=2;return -1},init_Disappear:function(t){let e=!1,s=0;if((t.hoOEFlags&a$.OEFLAG_ANIMATIONS)!=0){if(null!=t.ros&&t.ros.initFadeOut())return;null!=t.roa&&t.roa.anim_Exist(nY.ANIMID_DISAPPEAR)&&(s=1)}if(0==s&&(e=!0),e){t.hoCallRoutine=!1,this.destroy_Add(t.hoNumber);return}null!=t.ros&&(t.ros.setColFlag(!1),t.hoFlags|=a0.HOF_NOCOLLISION),null!=t.rom&&(t.rom.kill(!1),t.rom.initSimple(t,l6.MVTYPE_DISAPPEAR,!1),t.roc.rcSpeed=0),(1&s)!=0&&(t.roa.animation_Force(nY.ANIMID_DISAPPEAR),t.roa.animation_OneLoop())},isMouseOn:function(){return this.rhApp.cursorCount>0},getRGBAt:function(t,e,s){let r=0;return -1!=t.roc.rcImage&&(r=swapRGB(r=this.rhApp.imageBank.getImageFromHandle(t.roc.rcImage).getPixel(e,s))),r},drawLevel:function(){let t=new E;for(s=0;s<this.rhFrame.nLayers;s++){var e,s,r,h,n=this.rhFrame.layers[s],a=(n.dwOptions&al.FLOPT_WRAP_HORZ)!=0,l=(n.dwOptions&al.FLOPT_WRAP_VERT)!=0;if(0==s){let u=this.rhFrame.leWidth;a&&(u*=2);let d=this.rhFrame.leHeight;l&&(d*=2)}let p=n.nBkdLOs;for(r=0;r<p;r++)(e=this.rhFrame.LOList.getLOFromIndex(n.nFirstLOIndex+r)).loType<ac.OBJ_SPR&&(t.left=e.loX,t.top=e.loY),(h=new au(this.rhApp,t.left,t.top,e,null,0)).addInstance(0,n),a?((h=new au(this.rhApp,this.rhFrame.leWidth+t.left,t.top,e,null,0)).addInstance(1,n),t.left+h.width>this.rhFrame.leWidth&&(h=new au(this.rhApp,t.left-this.rhFrame.leWidth,t.top,e,null,0)).addInstance(4,n),l&&((h=new au(this.rhApp,t.left,this.rhFrame.leHeight+t.top,e,null,0)).addInstance(2,n),(h=new au(this.rhApp,this.rhFrame.leWidth+t.left,this.rhFrame.leHeight+t.top,e,null,0)).addInstance(3,n),t.top+h.height>this.rhFrame.leHeight&&(h=new au(this.rhApp,t.left,t.top-this.rhFrame.leHeight,e,null,0)).addInstance(5,n))):l&&((h=new au(this.rhApp,t.left,this.rhFrame.leHeight+t.top,e,null,0)).addInstance(2,n),t.top+h.height>this.rhFrame.leHeight&&(h=new au(this.rhApp,t.left,t.top-this.rhFrame.leHeight,e,null,0)).addInstance(5,n))}},scrollLayers:function(){let t,e,s,r,h=this.rh3DisplayX,n=this.rh3DisplayY;for(t=0;t<this.rhFrame.nLayers;t++){s=h*(e=this.rhFrame.layers[t]).xCoef+e.dx,r=n*e.yCoef+e.dy;let a=(e.dwOptions&al.FLOPT_WRAP_HORZ)!=0,l=(e.dwOptions&al.FLOPT_WRAP_VERT)!=0;a&&(s<0&&(s=s%this.rhFrame.leWidth+this.rhFrame.leWidth),s>this.rhFrame.leWidth&&(s%=this.rhFrame.leWidth)),l&&(r<0&&(r=r%this.rhFrame.leHeight+this.rhFrame.leHeight),r>this.rhFrame.leHeight&&(r%=this.rhFrame.leHeight)),e.x=s,e.y=r,e.planeBack.x=-s+this.rhApp.xOffset,e.planeBack.y=-r+this.rhApp.yOffset,e.planeQuickDisplay.x=-s+this.rhApp.xOffset,e.planeQuickDisplay.y=-r+this.rhApp.yOffset,e.planeSprites.x=-s+this.rhApp.xOffset,e.planeSprites.y=-r+this.rhApp.yOffset}this.rhFrame.leX=this.rh3DisplayX,this.rhFrame.leY=this.rh3DisplayY},hideLayer:function(t){t>=0&&t<this.rhFrame.nLayers&&this.rhFrame.layers[t].hide()},showLayer:function(t){t>=0&&t<this.rhFrame.nLayers&&this.rhFrame.layers[t].show()},hideShowLayers:function(){let t;for(t=0;t<this.rhFrame.nLayers;t++){let e=this.rhFrame.layers[t];e.dwOptions&al.FLOPT_TOHIDE&&e.hide()}},setDisplay:function(t,e,s,r){t-=Math.floor(this.rh3WindowSx/2),e-=Math.floor(this.rh3WindowSy/2);let n=t,a=e;if(-1!=s&&s<this.rhFrame.nLayers){let l=this.rhFrame.layers[s];if(l.xCoef>1){let u=n-this.rhWindowX;u/=l.xCoef,n=h.floatToInt(this.rhWindowX+u)}if(l.yCoef>1){let d=a-this.rhWindowY;d/=l.yCoef,a=h.floatToInt(this.rhWindowY+d)}}(t=n)<0&&(t=0),(e=a)<0&&(e=0);let p=t+this.rh3WindowSx,m=e+this.rh3WindowSy;p>this.rhLevelSx&&((p=this.rhLevelSx-this.rh3WindowSx)<0&&(p=0),t=p),m>this.rhLevelSy&&((m=this.rhLevelSy-this.rh3WindowSy)<0&&(m=0),e=m),(1&r)!=0&&t!=this.rhWindowX&&(this.rh3DisplayX=t,this.rh3Scrolling|=nD.RH3SCROLLING_SCROLL),(2&r)!=0&&e!=this.rhWindowY&&(this.rh3DisplayY=e,this.rh3Scrolling|=nD.RH3SCROLLING_SCROLL)},updateWindowPos:function(t,e){let s,r,h,n=0;if(this.rh4WindowDeltaX=t-this.rhWindowX,0!=this.rh4WindowDeltaX&&n++,this.rh4WindowDeltaY=e-this.rhWindowY,0!=this.rh4WindowDeltaY&&n++,0==n){for(r=0;r<this.rhFrame.nLayers;r++)if(0!=(s=this.rhFrame.layers[r]).dx||0!=s.dy){n++;break}}let a=this.rhWindowX,l=this.rhWindowY,u=t,d=e,p=this.rh4WindowDeltaX,m=this.rh4WindowDeltaY;this.rhWindowX=t,this.rh3XMinimum=t-nD.COLMASK_XMARGIN,this.rh3XMinimum<0&&(this.rh3XMinimum=this.rh3XMinimumKill),this.rhWindowY=e,this.rh3YMinimum=e-nD.COLMASK_YMARGIN,this.rh3YMinimum<0&&(this.rh3YMinimum=this.rh3YMinimumKill),this.rh3XMaximum=t+this.rh3WindowSx+nD.COLMASK_XMARGIN,this.rh3XMaximum>this.rhLevelSx&&(this.rh3XMaximum=this.rh3XMaximumKill),this.rh3YMaximum=e+this.rh3WindowSy+nD.COLMASK_YMARGIN,this.rh3YMaximum>this.rhLevelSy&&(this.rh3YMaximum=this.rh3YMaximumKill);let f=0;for(h=0;h<this.rhNObjects;h++){for(;null==this.rhObjectList[f];)f++;let $=this.rhObjectList[f];if(f++,0!=n){if(($.hoOEFlags&a$.OEFLAG_SCROLLINGINDEPENDANT)!=0){let g=p,P=m;null==$.rom?($.hoX+=g,$.hoY+=P):(g+=$.hoX,P+=$.hoY,$.rom.rmMovement.setXPosition(g),$.rom.rmMovement.setYPosition(P))}else{let E=$.hoLayer;if(E<this.rhFrame.nLayers){let _=a,A=l,v=u,O=d;((s=this.rhFrame.layers[E]).dwOptions&al.FLOPT_XCOEF)!=0&&(_=s.xCoef*_,v=s.xCoef*v),(s.dwOptions&al.FLOPT_YCOEF)!=0&&(A=s.yCoef*A,O=s.yCoef*O);let S=$.hoX+_-v+p-s.dx,T=$.hoY+A-O+m-s.dy;($.hoOEFlags&a$.OEFLAG_MOVEMENTS)==0?($.hoX=S,$.hoY=T):($.rom.rmMovement.setXPosition(S),$.rom.rmMovement.setYPosition(T)),$.forcePosition()}}}}},doScroll:function(){(this.rh3Scrolling&nD.RH3SCROLLING_SCROLL)!=0&&(this.rh3Scrolling=0,(this.rhFrame.leX!=this.rh3DisplayX||this.rhFrame.leY!=this.rh3DisplayY)&&(this.scrollLayers(),this.updateWindowPos(this.rhFrame.leX,this.rhFrame.leY)),this.rh3DisplayX=this.rhWindowX,this.rh3DisplayY=this.rhWindowY)},activeToBackdrop:function(t,e){let s=this.rhFrame.layers[t.hoLayer],r=this.rhApp.imageBank.getImageFromHandle(t.roc.rcImage),h=new au(this.rhApp,t.hoX-this.rhWindowX+s.x,t.hoY-this.rhWindowY+s.y,null,r,e);h.setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(0,s),(e==ap.OBSTACLE_SOLID||e==ap.OBSTACLE_PLATFORM)&&null!=this.rh4Box2DBase&&(h.body=this.rh4Box2DBase.rAddABackdrop(t.hoX-this.rhWindowX+s.x,t.hoY-this.rhWindowY+s.y,t.roc.rcImage,e));let n=(s.dwOptions&al.FLOPT_WRAP_HORZ)!=0,a=(s.dwOptions&al.FLOPT_WRAP_VERT)!=0;n?((h=new au(this.rhApp,this.rhFrame.leWidth+t.hoX-this.rhWindowX+s.x,t.hoY-this.rhWindowY+s.y,null,r,e)).setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(1,s),t.hoX+h.width>this.rhFrame.leWidth&&((h=new au(this.rhApp,t.hoX-this.rhWindowX+s.x-this.rhFrame.leWidth,t.hoY-this.rhWindowY+s.y,null,r,e)).setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(4,s)),a&&((h=new au(this.rhApp,t.hoX-this.rhWindowX+s.x,this.rhFrame.leHeight+t.hoY-this.rhWindowY+s.y,null,r,e)).setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(2,s),(h=new au(this.rhApp,this.rhFrame.leWidth+t.hoX-this.rhWindowX+s.x,this.rhFrame.leHeight+t.hoY-this.rhWindowY+s.y,null,r,e)).setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(3,s),t.hoY+h.height>this.rhFrame.leHeight&&((h=new au(this.rhApp,t.hoX-this.rhWindowX+s.x,t.hoY-this.rhWindowY+s.y-this.rhFrame.leHeight,null,r,e)).setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(5,s)))):a&&((h=new au(this.rhApp,t.hoX-this.rhWindowX+s.x,this.rhFrame.leHeight+t.hoY-this.rhWindowY+s.y,null,r,e)).setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(2,s),t.hoY+h.height>this.rhFrame.leHeight&&((h=new au(this.rhApp,t.hoX-this.rhWindowX+s.x,t.hoY-this.rhWindowY+s.y-this.rhFrame.leHeight,null,r,e)).setEffect(t.ros.rsEffect,t.ros.rsEffectParam),h.addInstance(5,s)))},addBackdrop:function(t,e,s,r,h,n){let a=this.rhFrame.layers[r],l=new au(this.rhApp,e-this.rhWindowX+a.x,s-this.rhWindowX+a.y,null,t,h);l.addInstance(0,a),n&&(h==ap.OBSTACLE_SOLID||h==ap.OBSTACLE_PLATFORM)&&null!=this.rh4Box2DBase&&(l.body=this.rh4Box2DBase.rAddABackdrop(pHo.hoX-this.rhWindowX+a.x,pHo.hoY-this.rhWindowY+a.y,pHo.roc.rcImage,h));let u=(a.dwOptions&al.FLOPT_WRAP_HORZ)!=0,d=(a.dwOptions&al.FLOPT_WRAP_VERT)!=0;u?((l=new au(this.rhApp,this.rhFrame.leWidth+e-this.rhWindowX+a.x,s-this.rhWindowY+a.y,null,t,h)).addInstance(1,a),e+l.width>this.rhFrame.leWidth&&(l=new au(this.rhApp,e-this.rhWindowX+a.x-this.rhFrame.leWidth,s-this.rhWindowY+a.y,null,t,h)).addInstance(4,a),d&&((l=new au(this.rhApp,e-this.rhWindowX+a.x,this.rhFrame.leHeight+s-this.rhWindowY+a.y,null,t,h)).addInstance(2,a),(l=new au(this.rhApp,this.rhFrame.leWidth+e-this.rhWindowX+a.x,this.rhFrame.leHeight+s-this.rhWindowY+a.y,null,t,h)).addInstance(3,a),s+l.height>this.rhFrame.leHeight&&(l=new au(this.rhApp,e-this.rhWindowX+a.x,s-this.rhWindowY+a.y-this.rhFrame.leHeight,null,t,h)).addInstance(5,a))):d&&((l=new au(this.rhApp,e-this.rhWindowX+a.x,this.rhFrame.leHeight+s-this.rhWindowY+a.y,null,t,h)).addInstance(2,a),s+l.height>this.rhFrame.leHeight&&(l=new au(this.rhApp,e-this.rhWindowX+a.x,s-this.rhWindowY+a.y-this.rhFrame.leHeight,null,t,h)).addInstance(5,a))},deleteAllBackdrop2:function(t){t<0||t>=this.rhFrame.nLayers||this.rhFrame.layers[t].deleteAddedBackdrops()},deleteBackdropAt:function(t,e,s,r){t<0||t>=this.rhFrame.nLayers||this.rhFrame.layers[t].deleteAddedBackdropsAt(e-this.rhWindowX,s-this.rhWindowY,r)},getStorage:function(t){if(null!=this.rhApp.extensionStorage){let e;for(e=0;e<this.rhApp.extensionStorage.size();e++){let s=this.rhApp.extensionStorage.get(e);if(s.id==t)return s}}return null},delStorage:function(t){if(null!=this.rhApp.extensionStorage){let e;for(e=0;e<this.rhApp.extensionStorage.size();e++)this.rhApp.extensionStorage.get(e).id==t&&this.rhApp.extensionStorage.removeIndex(e)}},addStorage:function(t,e){null==this.getStorage(e)&&(null==this.rhApp.extensionStorage&&(this.rhApp.extensionStorage=new P),t.id=e,this.rhApp.extensionStorage.add(t))},getXMouse:function(){return 0!=this.rhMouseUsed?0:this.rh2MouseX},getYMouse:function(){return 0!=this.rhMouseUsed?0:this.rh2MouseY},onMouseWheel:function(t){this.rhWheelCount=this.rh4EventCount,t<0?this.rhEvtProg.handle_GlobalEvents(-720902):this.rhEvtProg.handle_GlobalEvents(-655366)},findFirstObject:function(t){let e,s;if(0!=this.rhNObjects){for(e=0;e<this.rhMaxObjects;e++)if((s=this.rhObjectList[e])&&s.hoOiList.oilName==t)return this.findObjectCount=s.hoOiList.oilNObjects-1,s}return null},findNextObject:function(t){if(t&&this.findObjectCount)for(var e,s=t.hoNumber+1,r=t.hoOiList.oilName;;){if(null!=(e=this.rhObjectList[s])&&e.hoOiList.oilName==r)return this.findObjectCount--,e;s++}return this.findObjectCount=0,null}},n4.COF_HIDDEN=2,n3.OILIMITFLAGS_BORDERS=15,n3.OILIMITFLAGS_BACKDROPS=16,n3.OILIMITFLAGS_ONCOLLIDE=128,n3.OILIMITFLAGS_QUICKCOL=256,n3.OILIMITFLAGS_QUICKBACK=512,n3.OILIMITFLAGS_QUICKBORDER=1024,n3.OILIMITFLAGS_QUICKSPR=2048,n3.OILIMITFLAGS_QUICKEXT=4096,n3.OILIMITFLAGS_ALL=65535,n3.prototype={copyData:function(t){this.oilOi=t.oiHandle,this.oilType=t.oiType,this.oilOIFlags=t.oiFlags;let e,s=t.oiOC;for(this.oilOCFlags2=s.ocFlags2,this.oilInkEffect=t.oiInkEffect,this.oilEffectParam=t.oiInkEffectParam,this.oilOEFlags=s.ocOEFlags,this.oilBackColor=s.ocBackColor,this.oilEventCount=0,this.oilObject=-1,this.oilLimitFlags=n3.OILIMITFLAGS_ALL,null!=t.oiName&&(this.oilName=t.oiName),this.oilQualifiers=Array(8),e=0;e<8;e++)this.oilQualifiers[e]=s.ocQualifiers[e]}},n5.MTYPE_OBJECT=0,n5.MTYPE_ELEMENT=1,n5.MTYPE_PARTICULE=2,n5.MTYPE_FAKEOBJECT=3,n5.MTYPE_BORDERLEFT=4,n5.MTYPE_BORDERRIGHT=5,n5.MTYPE_BORDERTOP=6,n5.MTYPE_BORDERBOTTOM=7,n5.MTYPE_OBSTACLE=8,n5.MTYPE_PLATFORM=9,n5.MSUBTYPE_OBJECT=0,n5.MSUBTYPE_BOTTOM=1,n5.MSUBTYPE_TOP=2,n5.MSUBTYPE_LEFT=3,n5.MSUBTYPE_RIGHT=4,n5.ANGLE_MAGIC=123456789,n5.prototype={InitBase:function(t,e){this.m_pHo=t,this.m_type=e,this.m_stopFlag=!1,m_currentAngle=0},AddVelocity:function(t,e){this.m_addVX=t,this.m_addVY=e,this.m_addVFlag=!0},SetVelocity:function(t,e){let s=this.m_body.GetAngle(),r=this.m_body.GetPosition();r.x+=t/2.56,r.y+=e/2.56,this.m_base.rBodySetTransform(this.m_body,r,s)},ResetAddVelocity:function(){this.m_addVFlag&&(this.m_addVFlag=!1,this.m_addVX=0,this.m_addVY=0),this.m_setVFlag&&(this.m_setVFlag=!1,this.m_setVX=0,this.m_setVY=0)},PrepareCondition:function(){this.m_stopFlag=!1,this.m_eventCount=this.m_pHo.hoAdRunHeader.rh4EventCount},IsStop:function(){return this.m_stopFlag},SetStopFlag:function(t){this.m_stopFlag=t},SetCollidingObject:function(t){this.m_collidingObject=t},CreateBody:function(){return!1},CreateJoint:function(){},SetFriction:function(t){},SetRestitution:function(t){},SetGravity:function(t){},SetDensity:function(t){},init:function(t){this.ho=t,this.rh=this.ho.hoAdRunHeader},initialize:function(t){},kill:function(){},move:function(){return!1},setPosition:function(t,e){},setXPosition:function(t){},setYPosition:function(t){},stop:function(t){},bounce:function(t){},reverse:function(){},start:function(){},setSpeed:function(t){},setMaxSpeed:function(t){},setDir:function(t){},setAcc:function(t){},setDec:function(t){},setRotSpeed:function(t){},set8Dirs:function(t){},setGravity:function(t){},extension:function(t,e){return 0},actionEntry:function(t){return 0},getSpeed:function(){return 0},getAcceleration:function(){return 0},getDeceleration:function(){return 0},getGravity:function(){return 0},dirAtStart:function(t){return this.ho.rom.dirAtStart(this.ho,t,32)},animations:function(t){this.ho.roc.rcAnim=t,null!=this.ho.roa&&this.ho.roa.animate()},collisions:function(){this.ho.hoAdRunHeader.rh3CollisionCount++,this.ho.rom.rmMovement.rmCollisionCount=this.ho.hoAdRunHeader.rh3CollisionCount,this.ho.hoAdRunHeader.newHandle_Collisions(this.ho)},approachObject:function(t,e,s,r,h,n,a){t-=this.ho.hoAdRunHeader.rhWindowX,e-=this.ho.hoAdRunHeader.rhWindowY,s-=this.ho.hoAdRunHeader.rhWindowX,r-=this.ho.hoAdRunHeader.rhWindowY;let l=this.ho.rom.rmMovement.mpApproachSprite(t,e,s,r,h,n,a);return a.x+=this.ho.hoAdRunHeader.rhWindowX,a.y+=this.ho.hoAdRunHeader.rhWindowY,l},moveIt:function(){return this.ho.rom.rmMovement.newMake_Move(this.ho.roc.rcSpeed,this.hoPtr.hoAdRunHeader.getDir(this.hoPtr))},testPosition:function(t,e,s,r,h){return this.ho.rom.rmMovement.tst_SpritePosition(t,e,s,r,h)},getJoystick:function(t){return this.ho.hoAdRunHeader.rhPlayer[t]},colMaskTestRect:function(t,e,s,r,h,n){return!this.ho.hoAdRunHeader.colMask_Test_Rect(t,e,s,r,h,n)},colMaskTestPoint:function(t,e,s,r){return!this.ho.hoAdRunHeader.colMask_Test_XY(t,e,s,r)},getParamDouble:function(){return this.ho.rom.rmMovement.callParam},getParam:function(){return this.ho.rom.rmMovement.callParam},getAngle:function(){return 0},setAngle:function(t){}},nY.ANIMID_STOP=0,nY.ANIMID_WALK=1,nY.ANIMID_RUN=2,nY.ANIMID_APPEAR=3,nY.ANIMID_DISAPPEAR=4,nY.ANIMID_BOUNCE=5,nY.ANIMID_SHOOT=6,nY.ANIMID_JUMP=7,nY.ANIMID_FALL=8,nY.ANIMID_CLIMB=9,nY.ANIMID_CROUCH=10,nY.ANIMID_UNCROUCH=11,nY.ANIMID_USER1=12,nY.tableAnimTwoSpeeds=[0,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1],nY.prototype={load:function(t){let e,s=t.getFilePointer(),r=Array(32);for(e=0;e<32;e++)r[e]=t.readAShort();for(e=0,this.anDirs=Array(32),this.anTrigo=Array(32),this.anAntiTrigo=Array(32);e<32;e++)this.anDirs[e]=null,this.anTrigo[e]=0,this.anAntiTrigo[e]=0,0!=r[e]&&(this.anDirs[e]=new nX,t.seek(s+r[e]),this.anDirs[e].load(t))},enumElements:function(t){let e;for(e=0;e<32;e++)null!=this.anDirs[e]&&this.anDirs[e].enumElements(t)},approximate:function(t){let e,s,r,h,n;for(e=0;e<32;e++)if(null==this.anDirs[e]){for(s=0,h=e+1;s<32;s++,h++)if(h&=31,null!=this.anDirs[h]){this.anTrigo[e]=h;break}for(r=0,n=e-1;r<32;r++,n--)if(n&=31,null!=this.anDirs[n]){this.anAntiTrigo[e]=n;break}h==n||s<r?this.anTrigo[e]|=64:r<s&&(this.anAntiTrigo[e]|=64)}else t<16&&0==nY.tableAnimTwoSpeeds[t]&&(this.anDirs[e].adMinSpeed=this.anDirs[e].adMaxSpeed)}},nj.tableApprox=[nY.ANIMID_APPEAR,nY.ANIMID_WALK,nY.ANIMID_RUN,0,nY.ANIMID_RUN,nY.ANIMID_STOP,0,0,nY.ANIMID_WALK,nY.ANIMID_STOP,0,0,nY.ANIMID_STOP,nY.ANIMID_WALK,nY.ANIMID_RUN,0,nY.ANIMID_STOP,0,0,0,nY.ANIMID_STOP,nY.ANIMID_WALK,nY.ANIMID_RUN,0,nY.ANIMID_STOP,nY.ANIMID_WALK,nY.ANIMID_RUN,0,nY.ANIMID_WALK,nY.ANIMID_RUN,nY.ANIMID_STOP,0,nY.ANIMID_STOP,nY.ANIMID_WALK,nY.ANIMID_RUN,0,nY.ANIMID_WALK,nY.ANIMID_RUN,nY.ANIMID_STOP,0,nY.ANIMID_STOP,nY.ANIMID_WALK,nY.ANIMID_RUN,0,nY.ANIMID_STOP,nY.ANIMID_WALK,nY.ANIMID_RUN,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],nj.prototype={load:function(t){let e,s,r=t.getFilePointer();t.skipBytes(2),this.ahAnimMax=t.readAShort();let h=Array(this.ahAnimMax);for(e=0;e<this.ahAnimMax;e++)h[e]=t.readAShort();for(e=0,this.ahAnims=Array(this.ahAnimMax),this.ahAnimExists=Array(this.ahAnimMax);e<this.ahAnimMax;e++)this.ahAnims[e]=null,this.ahAnimExists[e]=0,0!=h[e]&&(this.ahAnims[e]=new nY,t.seek(r+h[e]),this.ahAnims[e].load(t),this.ahAnimExists[e]=1);for(s=0;s<this.ahAnimMax;s++)if(0==this.ahAnimExists[s]){let n=!1;if(s<12){for(e=0;e<4;e++)if(0!=this.ahAnimExists[nj.tableApprox[4*s+e]]){this.ahAnims[s]=this.ahAnims[nj.tableApprox[4*s+e]],n=!0;break}}if(!1==n){for(e=0;e<this.ahAnimMax;e++)if(0!=this.ahAnimExists[e]){this.ahAnims[s]=this.ahAnims[e];break}}}else this.ahAnims[s].approximate(s)},enumElements:function(t){let e;for(e=0;e<this.ahAnimMax;e++)0!=this.ahAnimExists[e]&&this.ahAnims[e].enumElements(t)}},nX.prototype={load:function(t){let e;for(e=0,this.adMinSpeed=t.readAByte(),this.adMaxSpeed=t.readAByte(),this.adRepeat=t.readAShort(),this.adRepeatFrame=t.readAShort(),this.adNumberOfFrame=t.readAShort(),this.adFrames=Array(this.adNumberOfFrame);e<this.adNumberOfFrame;e++)this.adFrames[e]=t.readAShort()},enumElements:function(t){let e;for(e=0;e<this.adNumberOfFrame;e++)if(null!=t){let s=t.enumerate(this.adFrames[e]);-1!=s&&(this.adFrames[e]=s)}}},nW.anim_Defined=[nY.ANIMID_STOP,nY.ANIMID_WALK,nY.ANIMID_RUN,nY.ANIMID_BOUNCE,nY.ANIMID_SHOOT,nY.ANIMID_JUMP,nY.ANIMID_FALL,nY.ANIMID_CLIMB,nY.ANIMID_CROUCH,nY.ANIMID_UNCROUCH,12,13,14,15,-1],nW.prototype={init:function(t){if(this.hoPtr=t,this.raRoutineAnimation=0,this.init_Animation(nY.ANIMID_WALK),this.anim_Exist(nY.ANIMID_APPEAR))this.raRoutineAnimation=1,this.animation_Force(nY.ANIMID_APPEAR),this.animation_OneLoop(),this.animations();else{let e;for(e=0;nW.anim_Defined[e]>=0&&!this.anim_Exist(nW.anim_Defined[e]);e++);nW.anim_Defined[e]<0&&this.anim_Exist(nY.ANIMID_DISAPPEAR)&&(this.raRoutineAnimation=2,this.animation_Force(nY.ANIMID_DISAPPEAR),this.animation_OneLoop(),this.animations())}},init_Animation:function(t){this.hoPtr.roc.rcAnim=t,this.raAnimStopped=!1,this.raAnimForced=0,this.raAnimDirForced=0,this.raAnimSpeedForced=0,this.raAnimFrameForced=0,this.raAnimCounter=0,this.raAnimFrame=0,this.raAnimOffset=null,this.raAnimDirOffset=null,this.raAnimOn=-1,this.raAnimMinSpeed=-1,this.raAnimPreviousDir=-1,this.raAnimOffset=null,this.raAnimDirOffset=null,this.animations()},check_Animate:function(){this.animIn(0)},extAnimations:function(t){this.hoPtr.roc.rcAnim=t,this.animate()},animate:function(){switch(this.raRoutineAnimation){case 0:return this.animations();case 1:this.anim_Appear();break;case 2:this.anim_Disappear()}return!1},animations:function(){let t=this.hoPtr.hoX;this.hoPtr.roc.rcOldX=t,t-=this.hoPtr.hoImgXSpot,this.hoPtr.roc.rcOldX1=t,t+=this.hoPtr.hoImgWidth,this.hoPtr.roc.rcOldX2=t;let e=this.hoPtr.hoY;return this.hoPtr.roc.rcOldY=e,e-=this.hoPtr.hoImgYSpot,this.hoPtr.roc.rcOldY1=e,e+=this.hoPtr.hoImgHeight,this.hoPtr.roc.rcOldY2=e,this.hoPtr.roc.rcOldImage=this.hoPtr.roc.rcImage,this.hoPtr.roc.rcOldAngle=this.hoPtr.roc.rcAngle,this.animIn(1)},animIn:function(t){let e,s,r,h=this.hoPtr.hoCommon,n=this.hoPtr.roc.rcSpeed,a=this.hoPtr.roc.rcAnim;if(0!=this.raAnimSpeedForced&&(n=this.raAnimSpeedForced-1),a==nY.ANIMID_WALK&&(0==n&&(a=nY.ANIMID_STOP),n>=75&&(a=nY.ANIMID_RUN)),0!=this.raAnimForced&&(a=this.raAnimForced-1),a!=this.raAnimOn){this.raAnimOn=a,a>=h.ocAnimations.ahAnimMax&&(a=h.ocAnimations.ahAnimMax-1);let l=h.ocAnimations.ahAnims[a];l!=this.raAnimOffset&&(this.raAnimOffset=l,this.raAnimDir=-1,this.raAnimFrame=0,(this.hoPtr.hoOEFlags&a$.OEFLAG_DONTRESETANIMCOUNTER)==0&&(this.raAnimCounter=0))}let u=0,d=0;this.hoPtr.hoAdRunHeader;let p=this.hoPtr.roc.rcDir%32,m=!1;if(0!=this.raAnimDirForced&&(p=this.raAnimDirForced-1),this.raAnimDir!=p){if(this.raAnimDir=p,null==(s=this.raAnimOffset.anDirs[p])){if((64&this.raAnimOffset.anAntiTrigo[p])!=0)p=63&this.raAnimOffset.anAntiTrigo[p];else if((64&this.raAnimOffset.anTrigo[p])!=0)p=63&this.raAnimOffset.anTrigo[p];else{let f=p;this.raAnimPreviousDir<0?p=63&this.raAnimOffset.anTrigo[p]:(p-=this.raAnimPreviousDir,p&=31,p=p>15?63&this.raAnimOffset.anTrigo[f]:63&this.raAnimOffset.anAntiTrigo[f])}s=this.raAnimOffset.anDirs[p]}else this.raAnimPreviousDir=p,s=this.raAnimOffset.anDirs[p];if(null!=this.raAnimOffset.anDirs[0]&&(this.hoPtr.hoCommon.ocFlags2&a$.OCFLAGS2_AUTOMATICROTATION)!=0&&(this.hoPtr.roc.rcAngle=360*this.raAnimDir/32,s=this.raAnimOffset.anDirs[0],this.raAnimDirOffset=null,m=!0),this.raAnimDirOffset!=s){this.raAnimDirOffset=s,this.raAnimRepeat=s.adRepeat,this.raAnimRepeatLoop=s.adRepeatFrame;let $=s.adMinSpeed,g=s.adMaxSpeed;if(($!=this.raAnimMinSpeed||g!=this.raAnimMaxSpeed)&&(this.raAnimMinSpeed=$,this.raAnimMaxSpeed=g,g-=$,this.raAnimDeltaSpeed=g,this.raAnimDelta=$,this.raAnimSpeed=-1),this.raAnimNumberOfFrame=s.adNumberOfFrame,0!=this.raAnimFrameForced&&this.raAnimFrameForced-1>=this.raAnimNumberOfFrame&&(this.raAnimFrameForced=0),this.raAnimFrame>=this.raAnimNumberOfFrame&&(this.raAnimFrame=0),u=s.adFrames[this.raAnimFrame],!1==this.raAnimStopped&&(this.hoPtr.roc.rcImage=u,null!=(e=this.hoPtr.hoAdRunHeader.rhApp.imageBank.getImageInfoEx(u,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY))&&(this.hoPtr.hoImgWidth=e.width,this.hoPtr.hoImgHeight=e.height,this.hoPtr.hoImgXSpot=e.xSpot,this.hoPtr.hoImgYSpot=e.ySpot,this.hoPtr.hoImgXAP=e.xAP,this.hoPtr.hoImgYAP=e.yAP),this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0),1==this.raAnimNumberOfFrame)return 0==this.raAnimMinSpeed&&(this.raAnimNumberOfFrame=0),0!=(u=this.hoPtr.roc.rcImage)&&(null!=(e=this.hoPtr.hoAdRunHeader.rhApp.imageBank.getImageInfoEx(u,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY))&&(this.hoPtr.hoImgWidth=e.width,this.hoPtr.hoImgHeight=e.height,this.hoPtr.hoImgXSpot=e.xSpot,this.hoPtr.hoImgYSpot=e.ySpot,this.hoPtr.hoImgXAP=e.xAP,this.hoPtr.hoImgYAP=e.yAP),!1)}}if(0==t&&0==this.raAnimFrameForced||!1==m&&0==this.raAnimNumberOfFrame)return!1;let P=this.raAnimDeltaSpeed;if(n!=this.raAnimSpeed){if(this.raAnimSpeed=n,0==P)this.raAnimDelta=this.raAnimMinSpeed,0!=this.raAnimSpeedForced&&(this.raAnimDelta=this.raAnimSpeedForced-1);else{let E=this.hoPtr.roc.rcMaxSpeed-this.hoPtr.roc.rcMinSpeed;0==E?0!=this.raAnimSpeedForced?(P*=n,P/=100,(P+=this.raAnimMinSpeed)>this.raAnimMaxSpeed&&(P=this.raAnimMaxSpeed),this.raAnimDelta=P):(P/=2,P+=this.raAnimMinSpeed,this.raAnimDelta=P):(P*=n,P/=E,(P+=this.raAnimMinSpeed)>this.raAnimMaxSpeed&&(P=this.raAnimMaxSpeed),this.raAnimDelta=P)}}if(s=this.raAnimDirOffset,0==(d=this.raAnimFrameForced)){if(0==this.raAnimDelta||this.raAnimStopped)return!1;r=this.raAnimCounter,d=this.raAnimFrame;let _=this.raAnimDelta;for((this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(_=Math.round(_*this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef)),r+=_;r>100;)if(r-=100,++d>=this.raAnimNumberOfFrame&&(d=this.raAnimRepeatLoop,0!=this.raAnimRepeat&&(this.raAnimRepeat--,0==this.raAnimRepeat))){if(this.raAnimFrame=this.raAnimNumberOfFrame-1,this.raAnimNumberOfFrame=0,0!=this.raAnimForced&&(this.raAnimForced=0,this.raAnimDirForced=0,this.raAnimSpeedForced=0),this.raAnimFrame<s.adNumberOfFrame&&(u=s.adFrames[this.raAnimFrame])!=this.hoPtr.roc.rcImage&&(this.hoPtr.roc.rcImage=u,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0),this.raAnimCounter=r,(this.hoPtr.hoAdRunHeader.rhGameFlags&nD.GAMEFLAGS_INITIALISING)!=0)return!1;m&&(this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0,null!=(e=this.hoPtr.hoAdRunHeader.rhApp.imageBank.getImageInfoEx(this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY))&&(this.hoPtr.hoImgWidth=e.width,this.hoPtr.hoImgHeight=e.height,this.hoPtr.hoImgXSpot=e.xSpot,this.hoPtr.hoImgYSpot=e.ySpot,this.hoPtr.hoImgXAP=e.xAP,this.hoPtr.hoImgYAP=e.yAP));let A=-131072;return A|=65535&this.hoPtr.hoType,this.hoPtr.hoAdRunHeader.rhEvtProg.rhCurParam0=this.hoPtr.roa.raAnimOn,this.hoPtr.hoAdRunHeader.rhEvtProg.handle_Event(this.hoPtr,A)}this.raAnimCounter=r}else d--;return this.raAnimFrame=d,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0,u=s.adFrames[d],(this.hoPtr.roc.rcImage!=u||this.raOldAngle!=this.hoPtr.roc.rcAngle)&&(this.hoPtr.roc.rcImage=u,this.raOldAngle=this.hoPtr.roc.rcAngle,u>=0&&null!=(e=this.hoPtr.hoAdRunHeader.rhApp.imageBank.getImageInfoEx(u,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY))&&(this.hoPtr.hoImgWidth=e.width,this.hoPtr.hoImgHeight=e.height,this.hoPtr.hoImgXSpot=e.xSpot,this.hoPtr.hoImgYSpot=e.ySpot,this.hoPtr.hoImgXAP=e.xAP,this.hoPtr.hoImgYAP=e.yAP)),!1},anim_Exist:function(t){return 0!=this.hoPtr.hoCommon.ocAnimations.ahAnimExists[t]},animation_OneLoop:function(){0==this.raAnimRepeat&&(this.raAnimRepeat=1)},animation_Force:function(t){this.raAnimForced=t+1,this.animIn(0)},animation_Restore:function(){this.raAnimForced=0,this.animIn(0)},animDir_Force:function(t){t&=31,this.raAnimDirForced=t+1,this.animIn(0)},animDir_Restore:function(){this.raAnimDirForced=0,this.animIn(0)},animSpeed_Force:function(t){t<0&&(t=0),t>100&&(t=100),this.raAnimSpeedForced=t+1,this.animIn(0)},animSpeed_Restore:function(){this.raAnimSpeedForced=0,this.animIn(0)},anim_Restart:function(){this.raAnimOn=-1,this.animIn(0)},animFrame_Force:function(t){t>=this.raAnimNumberOfFrame&&(t=this.raAnimNumberOfFrame-1),t<0&&(t=0),this.raAnimFrameForced=t+1,this.animIn(0)},animFrame_Restore:function(){this.raAnimFrameForced=0,this.animIn(0)},anim_Appear:function(){this.animIn(1),this.raAnimForced!=nY.ANIMID_APPEAR+1&&(this.anim_Exist(nY.ANIMID_STOP)||this.anim_Exist(nY.ANIMID_WALK)||this.anim_Exist(nY.ANIMID_RUN)?(this.raRoutineAnimation=0,this.animation_Restore()):(this.raRoutineAnimation=2,this.hoPtr.hoAdRunHeader.init_Disappear(this.hoPtr)))},anim_Disappear:function(){(this.hoPtr.hoFlags&a0.HOF_FADEOUT)==0&&(this.animIn(1),this.raAnimForced!=nY.ANIMID_DISAPPEAR+1&&this.hoPtr.hoAdRunHeader.destroy_Add(this.hoPtr.hoNumber))}},n7.prototype={doLoad:function(){let t=this.app.resources+"M"+h.formatDiscName(this.handle,"png"),e=new Image;this.imageBank.mosaics[this.handle]=e;let s=this;e.onload=function(){s.app.dataHasLoaded(s)},e.onerror=function(){s.app.dataHasLoaded(s)},e.src=t}},nV.prototype={preLoad:function(t){this.file=t,this.nHandlesReel=this.file.readAShort(),this.offsetsToImage=Array(this.nHandlesReel);let e,s,r=this.file.readAShort(),h=new nU;for(e=0;e<r;e++)s=this.file.getFilePointer(),h.loadHandle(this.file),this.offsetsToImage[h.handle]=s;for(e=0,this.useCount=Array(this.nHandlesReel);e<this.nHandlesReel;e++)this.useCount[e]=0;this.handleToIndex=null,this.nHandlesTotal=this.nHandlesReel,this.nImages=0,this.images=null},getImageFromHandle:function(t){return t>=0&&t<this.nHandlesTotal&&-1!=this.handleToIndex[t]?this.images[this.handleToIndex[t]]:null},getImageFromIndex:function(t){return t>=0&&t<this.nImages?this.images[t]:null},setAllToLoad:function(){let t;for(t=0;t<this.nHandlesReel;t++)this.offsetsToImage[t]&&(this.useCount[t]=1)},resetToLoad:function(){if((this.app.dwOptions&ny.AH2OPT_LOADDATAATSTART)==0&&(this.app.dwOptions&ny.AH2OPT_KEEPRESOURCESBETWEENFRAMES)==0){let t;for(t=0;t<this.nHandlesReel;t++)this.useCount[t]=0}this.oldMosaics=null},setToLoad:function(t){this.useCount[t]++},enumerate:function(t){return this.setToLoad(t),-1},loadMosaic:function(t){null==this.mosaics[t]&&(null!=this.oldMosaics&&t<this.oldMosaics.length&&null!=this.oldMosaics[t]?this.mosaics[t]=this.oldMosaics[t]:(this.mosaics[t]=new n7(this,t),this.app.addDataToLoad(this.mosaics[t])))},load:function(t){if(this.app.mosaicMaxHandle>0){if(null==this.mosaics){if(this.mosaics=Array(this.app.mosaicMaxHandle),this.app.dwOptions&ny.AH2OPT_LOADDATAATSTART)for(e=0;e<this.app.mosaicMaxHandle;e++)this.app.mosaics[e]&&this.loadMosaic(e)}else if((this.app.dwOptions&ny.AH2OPT_LOADDATAATSTART)==0){for(e=0,this.oldMosaics=Array(this.app.mosaicMaxHandle);e<this.app.mosaicMaxHandle;e++)this.oldMosaics[e]=this.mosaics[e];for(e=0,this.mosaics=Array(this.app.mosaicMaxHandle);e<this.app.mosaicMaxHandle;e++)this.mosaics[e]=null}}for(e=0,this.nImages=0;e<this.nHandlesReel;e++)0!=this.useCount[e]&&this.nImages++;let e,s,r=Array(this.nImages),h=0;for(s=0;s<this.nHandlesReel;s++)if(0!=this.useCount[s]){if(null!=this.images&&-1!=this.handleToIndex[s]&&null!=this.images[this.handleToIndex[s]]){if(r[h]=this.images[this.handleToIndex[s]],r[h].useCount=this.useCount[s],null!=this.mosaics&&null!=this.oldMosaics){let n=r[h].mosaic;n>0&&(this.mosaics[n]=this.oldMosaics[n])}}else 0!=this.offsetsToImage[s]&&(r[h]=new nU,t.seek(this.offsetsToImage[s]),r[h].load(this.app),r[h].useCount=this.useCount[s]);h++}for(e=0,this.images=r,this.handleToIndex=Array(this.nHandlesReel);e<this.nHandlesReel;e++)this.handleToIndex[e]=-1;for(e=0;e<this.nImages;e++)this.images[e]&&(this.handleToIndex[this.images[e].handle]=e);this.nHandlesTotal=this.nHandlesReel},delImage:function(t){let e,s=this.getImageFromHandle(t);if(null!=s&&(s.useCount--,s.useCount<=0)){for(e=0;e<this.nImages;e++)if(this.images[e]==s){this.images[e]=null,this.handleToIndex[t]=-1;break}}},addImage:function(t){let e,s,r=-1;for(e=this.nHandlesReel;e<this.nHandlesTotal;e++)if(-1==this.handleToIndex[e]){r=e;break}-1==r&&(this.handleToIndex.push(0),r=this.nHandlesTotal++);let h=-1;for(s=0;s<this.nImages;s++)if(null==this.images[s]){h=s;break}return -1==h&&(this.images.push(0),h=this.nImages++),this.handleToIndex[r]=h,this.images[h]=t,this.useCount[r]=1,r},loadImageList:function(t){let e;for(e=0;e<t.length;e++)if(t[e]>=0&&t[e]<this.nHandlesTotal&&0!=this.offsetsToImage[t[e]]&&null==this.getImageFromHandle(t[e])){var s,r=-1;for(s=0;s<this.nImages;s++)if(null==this.images[s]){r=s;break}if(-1==r){let h=Array(this.nImages+10);for(s=0;s<this.nImages;s++)h[s]=this.images[s];for(;s<this.nImages+10;s++)h[s]=null;r=this.nImages,this.nImages+=10,this.images=h}this.handleToIndex[t[e]]=r,this.images[r]=new nU,this.images[r].useCount=1,this.file.seek(this.offsetsToImage[t[e]]),this.images[r].load(this.app)}},getImageInfoEx:function(t,e,s,r){let h;if(null==this.pIfo&&(this.pIfo=new nU),null!=(h=this.getImageFromHandle(t))){let n=h.width,a=h.height,l=h.xSpot,u=h.ySpot,d=h.xAP,p=h.yAP;return 0==e?(1!=s&&(l*=s,d*=s,n*=s),1!=r&&(u*=r,p*=r,a*=r)):(1!=s&&(l*=s,d*=s,n*=s),1!=r&&(u*=r,p*=r,a*=r),null==this.rcInfo&&(this.rcInfo=new E),null==this.hsInfo&&(this.hsInfo=new _),null==this.apInfo&&(this.apInfo=new _),this.hsInfo.x=l,this.hsInfo.y=u,this.apInfo.x=d,this.apInfo.y=p,this.rcInfo.left=this.rcInfo.top=0,this.rcInfo.right=n,this.rcInfo.bottom=a,this.doRotateRect(this.rcInfo,this.hsInfo,this.apInfo,e),n=this.rcInfo.right,a=this.rcInfo.bottom,l=this.hsInfo.x,u=this.hsInfo.y,d=this.apInfo.x,p=this.apInfo.y),this.pIfo.width=n,this.pIfo.height=a,this.pIfo.xSpot=l,this.pIfo.ySpot=u,this.pIfo.xAP=d,this.pIfo.yAP=p,this.pIfo}return h},doRotateRect:function(t,e,s,r){if(90==r)a=0,l=1;else if(180==r)a=-1,l=0;else if(270==r)a=0,l=-1;else{var h,n,a,l,u,d,p,m,f,$,g,P,E,_,A,v,O=r*Math.PI/180;a=Math.cos(O),l=Math.sin(O)}null==e?(p=m=f=$=0,u=d=0):(p=-e.x*a,m=-e.x*l,f=-e.y*a,u=p+($=-e.y*l),d=f-m),p=(h=null==e?t.right:t.right-e.x)*a,m=h*l,g=p+$,P=f-m,f=(n=null==e?t.bottom:t.bottom-e.y)*a,E=p+($=n*l),_=f-m,A=u+E-g,v=d+_-P;let S=Math.min(u,Math.min(g,Math.min(E,A))),T=Math.min(d,Math.min(P,Math.min(_,v))),b=Math.max(u,Math.max(g,Math.max(E,A))),C=Math.max(d,Math.max(P,Math.max(_,v)));null!=s&&(null==e?(h=s.x,n=s.y):(h=s.x-e.x,n=s.y-e.y),s.x=h*a+n*l-S,s.y=n*a-h*l-T),null!=e&&(e.x=-S,e.y=-T),t.right=b-S,t.bottom=C-T}},nU.maxRotatedMasks=10,nU.createFromFile=function(t,e){let s=new nU;return s.app=t,s.img=new Image,s.img.onload=function(){s.app.imagesLoaded++,s.width=s.img.width,s.height=s.img.height},t.imagesToLoad++,t.loading=!0,s.img.src=t.resources+e,s},nU.prototype={loadHandle:function(t){this.filePointer=t.getFilePointer(),this.handle=t.readAShort(),t.skipBytes(12)},doLoad:function(){this.img=new Image;let t=this;this.img.onload=function(){t.app.dataHasLoaded(t)},this.img.onerror=function(){t.app.dataHasLoaded(t)};let e=this.app.resources+h.formatDiscName(this.handle,"png");this.img.src=e},load:function(t){this.app=t,this.filePointer=t.file.getFilePointer(),this.handle=t.file.readAShort(),this.width=t.file.readAShort(),this.height=t.file.readAShort(),this.xSpot=t.file.readShort(),this.ySpot=t.file.readShort(),this.xAP=t.file.readShort(),this.yAP=t.file.readShort(),this.mosaic=0,this.img=null,null!=this.app.frame.mosaicHandles?(this.mosaic=this.app.frame.mosaicHandles[this.handle],0!=this.mosaic?(this.app.imageBank.loadMosaic(this.mosaic),this.mosaicX=this.app.frame.mosaicX[this.handle],this.mosaicY=this.app.frame.mosaicY[this.handle]):this.app.addDataToLoad(this)):this.app.addDataToLoad(this)},createElement:function(){let t=document.createElement("div");return t.style.width=this.width+"px",t.style.height=this.height+"px",t.style.backgroundRepeat="no-repeat",0==this.mosaic?t.style.backgroundImage="url('"+this.img.src+"')":(t.style.backgroundPosition="-"+this.mosaicX+"px -"+this.mosaicY+"px",t.style.backgroundImage="url('"+this.app.resources+"M"+h.formatDiscName(this.mosaic,"png")+"')"),t},getPixel:function(t,e){let s=document.createElement("canvas");s.width=this.width,s.height=this.height;let r=s.getContext("2d");0==this.mosaic?r.drawImage(this.img,0,0):r.drawImage(this.app.imageBank.mosaics[this.mosaic],this.mosaicX,this.mosaicY,this.width,this.height,0,0,this.width,this.height);let h=r.getImageData(t,e,1,1);return h.data[0]<<16|h.data[1]<<8|h.data[2]},getMask:function(t,e,s,r){if((t&lR.GCMF_PLATFORM)!=0)return null==this.maskPlatform&&(null==this.maskNormal&&(this.maskNormal=new lR,this.maskNormal.createMask(this.app,this,0)),this.maskPlatform=new lR,this.maskPlatform.createMask(this.app,this,t)),this.maskPlatform;if(null==this.maskNormal&&(this.maskNormal=new lR,this.maskNormal.createMask(this.app,this,t)),0==e&&1==s&&1==r)return this.maskNormal;null==this.maskRotation&&(this.maskRotation=new P);let h,n,a=2147483647,l=-1;for(n=0;n<this.maskRotation.size();n++){if(e==(h=this.maskRotation.get(n)).angle&&s==h.scaleX&&r==h.scaleY)return h.mask;h.tick<a&&(a=h.tick,l=n)}return this.maskRotation.size()<this.maxRotatedMasks&&(l=-1),(h=new lM).mask=new lR,h.mask.createRotatedMask(this.maskNormal,e,s,r),h.angle=e,h.scaleX=s,h.scaleY=r,h.tick=this.app.timer,l<0?this.maskRotation.add(h):this.maskRotation.set(l,h),h.mask}},nK.prototype={preLoad:function(t){let e,s=t.readAInt();this.maxHandlesReel=0;let r=t.getFilePointer(),h=new nq;for(e=0;e<s;e++)h.loadHandle(t),this.maxHandlesReel=Math.max(this.maxHandlesReel,h.handle+1);for(t.seek(r),this.offsetsToFonts=Array(this.maxHandlesReel),e=0;e<s;e++)r=t.getFilePointer(),h.loadHandle(t),this.offsetsToFonts[h.handle]=r;for(e=0,this.useCount=Array(this.maxHandlesReel);e<this.maxHandlesReel;e++)this.useCount[e]=0;this.handleToIndex=null,this.maxHandlesTotal=this.maxHandlesReel,this.nFonts=0,this.fonts=null},load:function(t){for(e=0,this.nFonts=0;e<this.maxHandlesReel;e++)0!=this.useCount[e]&&this.nFonts++;let e,s,r=Array(this.nFonts),h=0;for(s=0;s<this.maxHandlesReel;s++)0!=this.useCount[s]&&(null!=this.fonts&&-1!=this.handleToIndex[s]&&null!=this.fonts[this.handleToIndex[s]]?(r[h]=this.fonts[this.handleToIndex[s]],r[h].useCount=this.useCount[s]):(r[h]=new nq,t.seek(this.offsetsToFonts[s]),r[h].load(t),r[h].useCount=this.useCount[s]),h++);for(e=0,this.fonts=r,this.handleToIndex=Array(this.maxHandlesReel);e<this.maxHandlesReel;e++)this.handleToIndex[e]=-1;for(e=0;e<this.nFonts;e++)this.handleToIndex[this.fonts[e].handle]=e;this.maxHandlesTotal=this.maxHandlesReel},getFontFromHandle:function(t){return -1==t?this.nullFont:t>=0&&t<this.maxHandlesTotal&&-1!=this.handleToIndex[t]?this.fonts[this.handleToIndex[t]]:null},getFontFromIndex:function(t){return t>=0&&t<this.nFonts?this.fonts[t]:null},getFontInfoFromHandle:function(t){return this.getFontFromHandle(t).getFontInfo()},resetToLoad:function(){if((this.app.dwOption&ny.AH2OPT_LOADDATAATSTART)==0&&(this.app.dwOptions&ny.AH2OPT_KEEPRESOURCESBETWEENFRAMES)==0){let t;for(t=0;t<this.maxHandlesReel;t++)this.useCount[t]=0}},setAllToLoad:function(){let t;for(t=0;t<this.maxHandlesReel;t++)this.offsetsToFonts[t]&&(this.useCount[t]=1)},setToLoad:function(t){if(-1==t){null==this.nullFont&&(this.nullFont=new nq,this.nullFont.createDefaultFont());return}this.useCount[t]++},enumerate:function(t){return this.setToLoad(t),-1},addFont:function(t){for(s=0;s<this.nFonts&&(null==this.fonts[s]||this.fonts[s].lfHeight!=t.lfHeight||this.fonts[s].lfWeight!=t.lfWeight||this.fonts[s].lfItalic!=t.lfItalic||this.fonts[s].lfFaceName!=t.lfFaceName);s++);if(s<this.nFonts)return this.fonts[s].handle;let e,s,r,h=-1;for(e=this.maxHandlesReel;e<this.maxHandlesTotal;e++)if(-1==this.handleToIndex[e]){this.hFound=e;break}if(-1==h){let n=Array(this.maxHandlesTotal+10);for(e=0;e<this.maxHandlesTotal;e++)n[e]=this.handleToIndex[e];for(;e<this.maxHandlesTotal+10;e++)n[e]=-1;h=this.maxHandlesTotal,this.maxHandlesTotal+=10,this.handleToIndex=n}let a=-1;for(r=0;r<this.nFonts;r++)if(null==this.fonts[r]){a=r;break}return -1==a&&(a=this.nFonts,this.fonts.push(null)),this.handleToIndex[h]=a,this.fonts[a]=new nq,this.fonts[a].handle=h,this.fonts[a].lfHeight=t.lfHeight,this.fonts[a].lfWeight=t.lfWeight,this.fonts[a].lfItalic=t.lfItalic,this.fonts[a].lfFaceName=t.lfFaceName,h}},nq.prototype={loadHandle:function(t){this.handle=t.readAInt(),!1==t.bUnicode?t.skipBytes(72):t.skipBytes(104)},load:function(t){this.handle=t.readAInt();let e=t.getFilePointer();t.skipBytes(12),this.lfHeight=t.readAInt(),this.lfHeight<0&&(this.lfHeight=-this.lfHeight),t.readAInt(),t.readAInt(),t.readAInt(),this.lfWeight=t.readAInt(),this.lfItalic=t.readAByte(),t.readAByte(),t.readAByte(),t.readAByte(),t.readAByte(),t.readAByte(),t.readAByte(),t.readAByte(),this.lfFaceName=t.readAString(),!1==t.bUnicode?t.seek(e+72):t.seek(e+104)},getFontInfo:function(){let t=new v;return t.lfHeight=this.lfHeight,t.lfWeight=this.lfWeight,t.lfItalic=this.lfItalic,t.lfFaceName=this.lfFaceName,t},createDefaultFont:function(){this.lfFaceName="Arial",this.lfHeight=13,this.lfWeight=400,this.lfItalic=0},getHeight:function(){return this.lfHeight+Math.ceil(this.lfHeight/8)},getFont:function(){if(null==this.font){this.lfItalic?this.font="italic ":this.font="normal ";let t=100*Math.floor(this.lfWeight/100);t=Math.min(t=Math.max(t,100),900),this.font+=t+" ";let e=this.lfHeight;this.font+=e+"px ",this.font+=this.lfFaceName}return this.font}},nz.prototype={preLoad:function(t){for(e=0,this.file=t,this.nHandlesReel=this.file.readAShort(),this.offsetsToSounds=Array(this.nHandlesReel),this.useCount=Array(this.nHandlesReel),this.handleToIndex=Array(this.nHandlesReel);e<this.nHandlesReel;e++)this.useCount[e]=0,this.handleToIndex[e]=-1;let e,s,r=this.file.readAShort(),h=new nJ(this.app);for(e=0;e<r;e++)s=this.file.getFilePointer(),h.loadHandle(),this.offsetsToSounds[h.handle]=s;this.nHandlesTotal=this.nHandlesReel,this.nSounds=0,this.sounds=null},getSoundFromHandle:function(t){return t>=0&&t<this.nHandlesTotal&&-1!=this.handleToIndex[t]?this.sounds[this.handleToIndex[t]]:null},checkLoad:function(){let t;for(t=0;t<this.nSounds;t++)null!=this.sounds[t]&&this.sounds[t].checkLoad()},getSoundFromIndex:function(t){return t>=0&&t<this.nSounds?this.sounds[t]:null},resetToLoad:function(){if((this.app.dwOptions&ny.AH2OPT_LOADDATAATSTART)==0&&(this.app.dwOptions&ny.AH2OPT_KEEPRESOURCESBETWEENFRAMES)==0){let t;for(t=0;t<this.nHandlesReel;t++)this.useCount[t]=0}},setAllToLoad:function(){let t;for(t=0;t<this.nHandlesReel;t++)this.offsetsToSounds[t]&&(this.useCount[t]=1)},addAllToLoad:function(){let t;for(t=0;t<this.nHandlesReel;t++)this.offsetsToSounds[t]&&this.app.imagesToLoad++},setToLoad:function(t){this.useCount[t]++},enumerate:function(t){return this.setToLoad(t),-1},load:function(){for(t=0,this.nSounds=0;t<this.nHandlesReel;t++)0!=this.useCount[t]&&this.nSounds++;let t,e,s=Array(this.nSounds),r=0;for(e=0;e<this.nHandlesReel;e++)0!=this.useCount[e]&&(null!=this.sounds&&-1!=this.handleToIndex[e]&&null!=this.sounds[this.handleToIndex[e]]?(s[r]=this.sounds[this.handleToIndex[e]],s[r].useCount=this.useCount[e]):(s[r]=new nJ(this.app),this.file.seek(this.offsetsToSounds[e]),s[r].load(),s[r].useCount=this.useCount[e]),r++);for(t=0,this.sounds=s,this.handleToIndex=Array(this.nHandlesReel);t<this.nHandlesReel;t++)this.handleToIndex[t]=-1;for(t=0;t<this.nSounds;t++)this.handleToIndex[this.sounds[t].handle]=t;this.nHandlesTotal=this.nHandlesReel,this.resetToLoad()}},nJ.prototype={loadHandle:function(){this.handle=this.file.readAShort(),this.file.skipBytes(5);let t=this.file.readAShort();!1==this.file.bUnicode?this.file.skipBytes(t):this.file.skipBytes(2*t)},createFromSound:function(){if(HTMLMediaElement.mozLoadFrom){let t=new nJ(this.application);return t.handle=this.handle,t.sound=HTMLMediaElement.mozLoadFrom(this.sound),t.name=this.name,t.type=this.type,t.song=this.song,t.type=this.type,t}return this},doLoad:function(){let t,e=this.application.soundPlayer.probablePlayableFormats&this.type;for(0==e&&(e=this.application.soundPlayer.maybePlayableFormats&this.type),t=0;t<4&&!(e&1<<t);t++);if(t<4){let s="";switch(t){case 0:s="ogg";break;case 1:s="m4a";break;case 2:s="mp3";break;case 3:s="wav"}if(this.context){var r=this,n=new XMLHttpRequest;n.open("GET",this.application.resources+h.formatDiscName(this.handle,s),!0),n.responseType="arraybuffer",n.addEventListener("load",function(t){r.response=n.response,r.application.soundPlayer.addDataToDecode(r)}),n.send()}else{this.sound=new Audio,this.sound.preload="auto";var r=this;this.sound.addEventListener("loadeddata",function(t){r.application.dataHasLoaded(r),r.sound.removeEventListener("loadeddata",arguments.callee,!1)},!1),this.sound.addEventListener("error",function(t){r.application.dataHasLoaded(r),r.sound=null},!1),this.sound.src=this.application.resources+h.formatDiscName(this.handle,s),this.sound.load(),this.sound.autoplay=!1}}else this.application.dataHasLoaded(this)},load:function(){this.handle=this.file.readAShort(),this.type=this.file.readAByte(),this.frequency=this.file.readAInt(),this.currentFrequency=this.frequency;let t=this.file.readAShort();this.name=this.file.readAString(t),this.sound=null,this.application.addDataToLoad(this)},loadSilent:function(){this.handle=9999,this.type=4,this.frequency=4e4,this.currentFrequency=this.frequency,this.name="",this.sound=null,this.application.addDataToLoad(this)},playIt:function(t,e){if(t||(t=0),e||(e=this.frequency),this.sound)this.sound.volume=this.volume/100,this.currentFrequency=e,this.sound.playbackRate=e/this.frequency,this.sound.duration&&(this.sound.currentTime=0),this.sound.play();else if(this.buffer){this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,0==this.contextType?(this.source.gain.value=this.volume/100,this.source.connect(this.context.destination)):(this.gain=this.context.createGain(),this.source.connect(this.gain),this.gain.connect(this.context.destination),this.gain.gain.value=this.volume/100),t||(t=0),e||(e=this.frequency),this.currentFrequency=e,this.source.playbackRate.value=e/this.frequency,this.startTime=Date.now()-t,void 0!==this.source.start?this.source.start(0,t/1e3):this.source.noteOn(t);let s=this;this.source.onended=function(t){s.bEnded=!0}}this.bPaused=!1,this.bPlaying=!0,this.bEnded=!1},play:function(t,e,s){this.nLoops=t,0==this.nLoops&&(this.nLoops=1e7),this.volume=s,this.playIt()},stop:function(){this.sound?this.sound.pause():this.source&&this.bPlaying&&(void 0!==this.source.stop?this.source.stop(0):this.source.noteOff(0),this.source.onended=null),this.bUninterruptible=!1,this.bPlaying=!1},setVolume:function(t){this.volume=t,this.sound?this.sound.volume=t/100:this.source&&(this.gain?this.gain.gain.value=t/100:this.source.gain.value=t/100)},pause:function(){this.bPaused||(this.sound?this.sound.pause():this.source&&(this.source.onended=null,void 0!==this.source.stop?this.source.stop(0):this.source.noteOff(0),this.pauseTime=Date.now()-this.startTime),this.bPaused=!0)},globalpause:function(){this.bPaused?this.bAllowGlobalResume=!1:(this.pause(),this.bAllowGlobalResume=!0)},resume:function(){this.bPaused&&(this.sound?this.sound.play():this.source&&this.playIt(this.pauseTime),this.bPaused=!1)},globalresume:function(){this.bAllowGlobalResume&&(this.resume(),this.bAllowGlobalResume=!1)},isPaused:function(){return this.bPaused},isPlaying:function(){return(!!this.sound||!!this.source)&&!!this.bPlaying&&!this.bPaused},getDuration:function(){return this.sound&&void 0!=this.sound.duration&&!1==isNaN(this.sound.duration)&&this.sound.duration!=1/0?Math.floor(1e3*this.sound.duration):this.source?1e3*this.buffer.duration:0},getPosition:function(){if(this.sound)return Math.floor(1e3*this.sound.currentTime);if(this.source){let t;return t=this.bPaused?this.pauseTime:Date.now()-this.startTime,Math.min(1e3*this.buffer.duration,t)}return 0},setPosition:function(t){this.sound?this.sound.currentTime=t/1e3:this.source&&(this.bPlaying&&(this.source.onended=null,void 0!==this.source.stop?this.source.stop(0):this.source.noteOff(0)),this.playIt(t))},setFrequency:function(t){let e=t/this.frequency;this.currentFrequency=t,this.sound?this.sound.playbackRate=e:this.source&&(this.source.playbackRate.value=e)},getFrequency:function(t){return this.currentFrequency},checkSound:function(){if(!0==this.bPlaying&&!1==this.bPaused){if(this.sound){if(this.sound.ended)return this.nLoops>0&&(this.nLoops--,this.nLoops>0)?(this.playIt(0,this.currentFrequency),!1):(this.bUninterruptible=!1,this.bPlaying=!1,!0)}else if(this.source&&(3==this.source.playbackState||this.bEnded))return this.nLoops>0&&(this.nLoops--,this.nLoops>0)?(this.playIt(0,this.currentFrequency),!1):(this.bUninterruptible=!1,this.bPlaying=!1,!0)}return!1}},nQ.prototype={AddOnLoop:function(t){this.pointers[this.position++]=t}},nZ.EVENTS_EXTBASE=80,nZ.PARAMCLICK_DOUBLE=256,nZ.bts=function(t,e){let s=e>>5,r=1<<(31&e),h=(t[s]&r)!=0;return t[s]|=r,h},nZ.evg_FindAction=function(t,e){return t.evgNCond+e},nZ.EVTTYPE=function(t){let e=65535&t;return(32768&e)!=0?e-65536:e},nZ.EVTNUM=function(t){return t>>16},nZ.getEventCode=function(t){return 4294901760&t},nZ.prototype={evt_FirstObjectFromType:function(t){if(this.rh2EventType=t,-1==t){var e,s,r,h,n=null,a=!0;for(r=0;r<this.rhPtr.rhOiList.length;r++)h=this.rhPtr.rhOiList[r],!1==nZ.bts(this.rh4PickFlags,h.oilType)&&null!=(s=this.evt_SelectAllFromType(h.oilType,a))&&(n=s,a=!1);if(null!=n)return n}else if(!1==nZ.bts(this.rh4PickFlags,t))return this.evt_SelectAllFromType(t,!0);let l=0;do{if((e=this.rhPtr.rhOiList[l]).oilType==t&&(2147483648&e.oilListSelected)==0){var s=this.rhPtr.rhObjectList[e.oilListSelected];return this.rh2EventPrev=null,this.rh2EventPrevOiList=e,this.rh2EventPos=s,this.rh2EventPosOiList=l,s}l++}while(l<this.rhPtr.rhMaxOI);return null},evt_NextObjectFromType:function(){let t,e=this.rh2EventPos;if(null==e&&(2147483648&(t=this.rhPtr.rhOiList[this.rh2EventPosOiList]).oilListSelected)==0)return e=this.rhPtr.rhObjectList[t.oilListSelected],this.rh2EventPrev=null,this.rh2EventPrevOiList=t,this.rh2EventPos=e,e;if(null!=e&&(2147483648&e.hoNextSelected)==0)return this.rh2EventPrev=e,this.rh2EventPrevOiList=null,e=this.rhPtr.rhObjectList[e.hoNextSelected],this.rh2EventPos=e,e;let s=this.rh2EventPosOiList,r=this.rhPtr.rhOiList[s].oilType;for(s++;s<this.rhPtr.rhMaxOI;){if((-1!=this.rh2EventType&&this.rhPtr.rhOiList[s].oilType==r||-1==this.rh2EventType)&&(2147483648&this.rhPtr.rhOiList[s].oilListSelected)==0)return e=this.rhPtr.rhObjectList[this.rhPtr.rhOiList[s].oilListSelected],this.rh2EventPrev=null,this.rh2EventPrevOiList=this.rhPtr.rhOiList[s],this.rh2EventPos=e,this.rh2EventPosOiList=s,e;s++}return null},evt_SelectAllFromType:function(t,e){let s,r,h=-1,n=this.rh2EventCount,a=0;do{if((s=this.rhPtr.rhOiList[a]).oilType==t&&s.oilEventCount!=n){if(s.oilEventCount=n,this.rh4ConditionsFalse)s.oilListSelected=-1,s.oilNumOfSelected=0;else{s.oilNumOfSelected=s.oilNObjects;let l=s.oilObject;if((2147483648&l)==0){-1==h&&!0==e&&(h=l,this.rh2EventPrev=null,this.rh2EventPrevOiList=s,this.rh2EventPosOiList=a);do(r=this.rhPtr.rhObjectList[l]).hoNextSelected=r.hoNumNext,l=r.hoNumNext;while((2147483648&l)==0);l=s.oilObject}s.oilListSelected=l}}a++}while(a<this.rhPtr.rhMaxOI);return!1==e||h<0?null:(r=this.rhPtr.rhObjectList[h],this.rh2EventPos=r,r)},evt_FirstObject:function(t){if(this.evtNSelectedObjects=0,this.rh2EventQualPos=null,this.rh2EventQualPosNum=-1,(32768&t)!=0)return(32767&t)==32767?null:this.qualProc(t);let e,s=this.rhPtr.rhOiList[t];if(s.oilEventCount==this.rh2EventCount)return(2147483648&s.oilListSelected)!=0?null:(e=this.rhPtr.rhObjectList[s.oilListSelected],this.rh2EventPrev=null,this.rh2EventPrevOiList=s,this.rh2EventPos=e,this.rh2EventPosOiList=t,this.evtNSelectedObjects=s.oilNumOfSelected,e);if(s.oilEventCount=this.rh2EventCount,this.rh4ConditionsFalse)return s.oilListSelected=-1,s.oilNumOfSelected=0,null;if(s.oilListSelected=s.oilObject,(2147483648&s.oilObject)!=0)return s.oilNumOfSelected=0,null;let r=s.oilObject;do r=(e=this.rhPtr.rhObjectList[r]).hoNumNext,e.hoNextSelected=r;while((2147483648&r)==0);return e=this.rhPtr.rhObjectList[s.oilObject],this.rh2EventPrev=null,this.rh2EventPrevOiList=s,this.rh2EventPos=e,this.rh2EventPosOiList=t,s.oilNumOfSelected=s.oilNObjects,this.evtNSelectedObjects=s.oilNumOfSelected,e},qualProc:function(t){for(var e,s,r,h,n=0,a=0,l=this.qualToOiList[32767&t];a<l.qoiList.length;){if(r=l.qoiList[a+1],(s=this.rhPtr.rhOiList[r]).oilEventCount==this.rh2EventCount)h=0,(2147483648&s.oilListSelected)==0&&(h=s.oilNumOfSelected,null==this.rh2EventQualPos&&(this.rh2EventQualPos=l,this.rh2EventQualPosNum=a));else if(h=0,s.oilEventCount=this.rh2EventCount,this.rh4ConditionsFalse)s.oilListSelected=-1,s.oilNumOfSelected=0;else if(s.oilListSelected=s.oilObject,(2147483648&s.oilObject)!=0)s.oilNumOfSelected=0;else{null==this.rh2EventQualPos&&(this.rh2EventQualPos=l,this.rh2EventQualPosNum=a);let u=s.oilObject;do(e=this.rhPtr.rhObjectList[u]).hoNextSelected=e.hoNumNext,u=e.hoNumNext;while((2147483648&u)==0);s.oilNumOfSelected=s.oilNObjects,h=s.oilNObjects}n+=h,a+=2}return null!=(l=this.rh2EventQualPos)?(s=this.rhPtr.rhOiList[l.qoiList[this.rh2EventQualPosNum+1]],this.rh2EventPrev=null,this.rh2EventPrevOiList=s,e=this.rhPtr.rhObjectList[s.oilListSelected],this.rh2EventPos=e,this.rh2EventPosOiList=l.qoiList[this.rh2EventQualPosNum+1],this.evtNSelectedObjects=n,e):null},evt_NextObject:function(){let t,e=this.rh2EventPos;if(null==e&&(2147483648&(t=this.rhPtr.rhOiList[this.rh2EventPosOiList]).oilListSelected)==0)return e=this.rhPtr.rhObjectList[t.oilListSelected],this.rh2EventPrev=null,this.rh2EventPrevOiList=t,this.rh2EventPos=e,e;if(null!=e&&(2147483648&e.hoNextSelected)==0)return this.rh2EventPrev=e,this.rh2EventPrevOiList=null,e=this.rhPtr.rhObjectList[e.hoNextSelected],this.rh2EventPos=e,e;if(null==this.rh2EventQualPos)return null;do{if(this.rh2EventQualPosNum+=2,this.rh2EventQualPosNum>=this.rh2EventQualPos.qoiList.length)return null;t=this.rhPtr.rhOiList[this.rh2EventQualPos.qoiList[this.rh2EventQualPosNum+1]]}while((2147483648&t.oilListSelected)!=0);return this.rh2EventPrev=null,this.rh2EventPrevOiList=t,e=this.rhPtr.rhObjectList[t.oilListSelected],this.rh2EventPos=e,this.rh2EventPosOiList=this.rh2EventQualPos.qoiList[this.rh2EventQualPosNum+1],e},evt_AddCurrentQualifier:function(t){for(var e,s=this.qualToOiList[32767&t],r=0;r<s.qoiList.length;)(e=this.rhPtr.rhOiList[s.qoiList[r+1]]).oilEventCount!=this.rh2EventCount&&(e.oilEventCount=this.rh2EventCount,e.oilNumOfSelected=0,e.oilListSelected=-1),r+=2},evt_DeleteCurrentObject:function(){this.rh2EventPos.hoOiList.oilNumOfSelected-=1,null!=this.rh2EventPrev?(this.rh2EventPrev.hoNextSelected=this.rh2EventPos.hoNextSelected,this.rh2EventPos=this.rh2EventPrev):(this.rh2EventPrevOiList.oilListSelected=this.rh2EventPos.hoNextSelected,this.rh2EventPos=null)},evt_AddCurrentObject:function(t){let e=t.hoOiList;if(e.oilEventCount!=this.rh2EventCount)e.oilEventCount=this.rh2EventCount,e.oilListSelected=t.hoNumber,e.oilNumOfSelected=1,t.hoNextSelected=-1;else{let s,r=e.oilListSelected;if((2147483648&r)!=0)e.oilListSelected=t.hoNumber,e.oilNumOfSelected+=1,t.hoNextSelected=-1;else{do{if(t.hoNumber==r)return;r=(s=this.rhPtr.rhObjectList[r]).hoNextSelected}while((2147483648&r)==0);s.hoNextSelected=t.hoNumber,t.hoNextSelected=-1,t.hoOiList.oilNumOfSelected+=1}}},deselectThem:function(t){let e=this.rhPtr.rhOiList[t];e.oilEventCount=this.rh2EventCount,e.oilListSelected=-1,e.oilNumOfSelected=0},evt_ForceOneObject:function(t,e){if((32768&t)==0)this.deselectThem(t);else{if((32767&t)==32767)return;let s,r=this.qualToOiList[32767&t];for(s=0;s<r.qoiList.length;s+=2)this.deselectThem(r.qoiList[s+1])}e.hoNextSelected=-1,e.hoOiList.oilListSelected=e.hoNumber,e.hoOiList.oilNumOfSelected=1,e.hoOiList.oilEventCount=this.rh2EventCount},evt_DeleteCurrentType:function(t){let e,s;for(nZ.bts(this.rh4PickFlags,t),e=0;e<this.rhPtr.rhMaxOI;e++)(s=this.rhPtr.rhOiList[e]).oilType==t&&(s.oilEventCount=this.rh2EventCount,s.oilListSelected=-1,s.oilNumOfSelected=0)},evt_DeleteCurrent:function(){let t,e;for(t=0,this.rh4PickFlags[0]=-1,this.rh4PickFlags[1]=-1,this.rh4PickFlags[2]=-1,this.rh4PickFlags[3]=-1;t<this.rhPtr.rhMaxOI;t++)(e=this.rhPtr.rhOiList[t]).oilEventCount=this.rh2EventCount,e.oilListSelected=-1,e.oilNumOfSelected=0},evt_MarkSelectedObjects:function(){let t,e,s,r;for(s=0;s<this.rhPtr.rhMaxOI;s++)if((r=this.rhPtr.rhOiList[s]).oilEventCount==this.rh2EventCount){if(r.oilEventCountOR!=this.rh4EventCountOR)for(r.oilEventCountOR=this.rh4EventCountOR,t=r.oilObject;(2147483648&t)==0;)(e=this.rhPtr.rhObjectList[t]).hoSelectedInOR=0,t=e.hoNumNext;for(t=r.oilListSelected;(2147483648&t)==0;)(e=this.rhPtr.rhObjectList[t]).hoSelectedInOR=1,t=e.hoNextSelected}},evt_BranchSelectedObjects:function(){let t,e,s,r,h;for(r=0;r<this.rhPtr.rhMaxOI;r++)if((h=this.rhPtr.rhOiList[r]).oilEventCountOR==this.rh4EventCountOR)for(h.oilEventCount=this.rh2EventCount,t=h.oilObject,s=null;(2147483648&t)==0;)0!=(e=this.rhPtr.rhObjectList[t]).hoSelectedInOR&&(null!=s?s.hoNextSelected=t:h.oilListSelected=t,e.hoNextSelected=-1,s=e),t=e.hoNumNext},get_ExpressionObjects:function(t){if(this.rh2ActionOn){this.rh2EnablePick=!1;var e,s,e=this.get_CurrentObjects(t);return e}if((32768&t)==0)return(s=this.rhPtr.rhOiList[t]).oilEventCount==this.rh2EventCount&&(2147483648&s.oilListSelected)==0?this.rhPtr.rhObjectList[s.oilListSelected]:(2147483648&s.oilObject)==0?this.rhPtr.rhObjectList[s.oilObject]:null;let r=this.qualToOiList[32767&t],h=0;if(h>=r.qoiList.length)return null;do{if((s=this.rhPtr.rhOiList[r.qoiList[h+1]]).oilEventCount==this.rh2EventCount&&(2147483648&s.oilListSelected)==0)return this.rhPtr.rhObjectList[s.oilListSelected];h+=2}while(h<r.qoiList.length);h=0;do{if((2147483648&(s=this.rhPtr.rhOiList[r.qoiList[h+1]]).oilObject)==0)return this.rhPtr.rhObjectList[s.oilObject];h+=2}while(h<r.qoiList.length);return null},get_ParamActionObjects:function(t,e){this.rh2EnablePick=!0;let s=this.get_CurrentObjects(t);return null!=s?(!1==this.repeatFlag||(e.evtFlags|=I.ACTFLAGS_REPEAT,this.rh2ActionLoop=!0),s):(e.evtFlags|=at.EVFLAGS_NOTDONEINSTART,s)},get_ActionObjects:function(t){t.evtFlags&=~at.EVFLAGS_NOTDONEINSTART,this.rh2EnablePick=!0;let e=t.evtOiList,s=this.get_CurrentObjects(e);return null!=s?(!1==this.repeatFlag||(t.evtFlags|=I.ACTFLAGS_REPEAT,this.rh2ActionLoop=!0),s):(t.evtFlags|=at.EVFLAGS_NOTDONEINSTART,s)},get_CurrentObjects:function(t){return(32768&t)==0?this.get_CurrentObject(t):this.get_CurrentObjectQualifier(t)},get_CurrentObject:function(t){let e,s,r=this.rhPtr.rhOiList[t];if(r.oilActionCount!=this.rh2ActionCount)return(r.oilActionCount=this.rh2ActionCount,r.oilActionLoopCount=this.rh2ActionLoopCount,r.oilEventCount==this.rh2EventCount&&(2147483648&r.oilListSelected)==0)?(r.oilCurrentOi=r.oilListSelected,e=this.rhPtr.rhObjectList[r.oilListSelected],r.oilNext=e.hoNextSelected,(2147483648&e.hoNextSelected)!=0)?(r.oilNextFlag=!1,r.oilCurrentRoutine=1,this.repeatFlag=!1,e):(r.oilNextFlag=!0,r.oilCurrentRoutine=2,this.repeatFlag=!0,e):this.rh2EnablePick&&r.oilEventCount==this.rh2EventCount?(r.oilCurrentRoutine=0,r.oilCurrentOi=-1,null):(2147483648&r.oilObject)!=0?(r.oilCurrentRoutine=0,r.oilCurrentOi=-1,null):(r.oilCurrentOi=r.oilObject,null==(e=this.rhPtr.rhObjectList[r.oilObject]))?(r.oilCurrentRoutine=0,r.oilCurrentOi=-1,null):(2147483648&e.hoNumNext)==0?(r.oilNext=e.hoNumNext,r.oilNextFlag=!0,r.oilCurrentRoutine=3,this.repeatFlag=!0,e):(r.oilNextFlag=!1,r.oilCurrentRoutine=1,this.repeatFlag=!1,e);if(r.oilActionLoopCount!=this.rh2ActionLoopCount)switch(r.oilActionLoopCount=this.rh2ActionLoopCount,r.oilCurrentRoutine){case 0:return this.repeatFlag=r.oilNextFlag,null;case 1:return e=this.rhPtr.rhObjectList[r.oilCurrentOi],this.repeatFlag=r.oilNextFlag,e;case 2:if(r.oilCurrentOi=r.oilNext,null==(e=this.rhPtr.rhObjectList[r.oilNext]))return null;return(2147483648&(s=e.hoNextSelected))!=0&&(r.oilNextFlag=!1,s=r.oilListSelected),r.oilNext=s,this.repeatFlag=r.oilNextFlag,e;case 3:if(r.oilCurrentOi=r.oilNext,null==(e=this.rhPtr.rhObjectList[r.oilNext]))return null;return(2147483648&(s=e.hoNumNext))!=0&&(r.oilNextFlag=!1,s=r.oilObject),r.oilNext=s,this.repeatFlag=r.oilNextFlag,e}return r.oilCurrentOi<0?null:(e=this.rhPtr.rhObjectList[r.oilCurrentOi],this.repeatFlag=r.oilNextFlag,e)},get_CurrentObjectQualifier:function(t){let e,s,r,h=this.qualToOiList[32767&t];if(h.qoiActionCount!=this.rh2ActionCount)return(h.qoiActionCount=this.rh2ActionCount,h.qoiActionLoopCount=this.rh2ActionLoopCount,(r=this.qoi_GetFirstListSelected(h))>=0)?(h.qoiCurrentOi=r,null==(e=this.rhPtr.rhObjectList[r]))?(h.qoiCurrentRoutine=0,h.qoiCurrentOi=-1,null):(2147483648&(s=e.hoNextSelected))!=0&&(s=this.qoi_GetNextListSelected(h))<0?(h.qoiCurrentRoutine=1,h.qoiNextFlag=!1,this.repeatFlag=!1,e):(h.qoiNext=s,h.qoiCurrentRoutine=2,h.qoiNextFlag=!0,this.repeatFlag=!0,e):this.rh2EnablePick&&h.qoiSelectedFlag?(h.qoiCurrentRoutine=0,h.qoiCurrentOi=-1,null):(r=this.qoi_GetFirstList(h))>=0&&(h.qoiCurrentOi=r,null!=(e=this.rhPtr.rhObjectList[r]))?(2147483648&(r=e.hoNumNext))!=0&&(2147483648&(r=this.qoi_GetNextList(h)))!=0?(h.qoiCurrentRoutine=1,h.qoiNextFlag=!1,this.repeatFlag=!1,e):(h.qoiNext=r,h.qoiCurrentRoutine=3,h.qoiNextFlag=!0,this.repeatFlag=!0,e):(h.qoiCurrentRoutine=0,h.qoiCurrentOi=-1,null);if(h.qoiActionLoopCount!=this.rh2ActionLoopCount)switch(h.qoiActionLoopCount=this.rh2ActionLoopCount,h.qoiCurrentRoutine){case 0:return this.repeatFlag=h.qoiNextFlag,null;case 1:return e=this.rhPtr.rhObjectList[h.qoiCurrentOi],this.repeatFlag=h.qoiNextFlag,e;case 2:return h.qoiCurrentOi=h.qoiNext,null!=(e=this.rhPtr.rhObjectList[h.qoiNext])&&((2147483648&(s=e.hoNextSelected))!=0&&(s=this.qoi_GetNextListSelected(h))<0&&(h.qoiNextFlag=!1,s=this.qoi_GetFirstListSelected(h)),h.qoiNext=s),this.repeatFlag=h.qoiNextFlag,e;case 3:return h.qoiCurrentOi=h.qoiNext,null!=(e=this.rhPtr.rhObjectList[h.qoiNext])&&((2147483648&(s=e.hoNumNext))!=0&&(2147483648&(s=this.qoi_GetNextList(h)))!=0&&(h.qoiNextFlag=!1,s=this.qoi_GetFirstList(h)),h.qoiNext=s),this.repeatFlag=h.qoiNextFlag,e}return h.qoiCurrentOi<0?null:(e=this.rhPtr.rhObjectList[h.qoiCurrentOi],this.repeatFlag=h.qoiNextFlag,e)},qoi_GetNextListSelected:function(t){for(var e,s,r=t.qoiActionPos;r<t.qoiList.length;){if(e=t.qoiList[r+1],(s=this.rhPtr.rhOiList[e]).oilEventCount==this.rh2EventCount&&(t.qoiSelectedFlag=!0,(2147483648&s.oilListSelected)==0))return t.qoiActionPos=r+2,s.oilListSelected;r+=2}return -1},qoi_GetFirstListSelected:function(t){return t.qoiActionPos=0,t.qoiSelectedFlag=!1,this.qoi_GetNextListSelected(t)},qoi_GetNextList:function(t){for(var e,s,r=t.qoiActionPos;r<t.qoiList.length;){if(e=t.qoiList[r+1],(2147483648&(s=this.rhPtr.rhOiList[e]).oilObject)==0)return t.qoiActionPos=r+2,s.oilObject;r+=2}return -1},qoi_GetFirstList:function(t){return t.qoiActionPos=0,this.qoi_GetNextList(t)},endForEach:function(){this.callEndForEach=!1;for(var t=this.rhPtr.rh4CurrentForEach,e=this.rhPtr.rh4CurrentForEach2;;){for(var s=null,r=null,n=this.rhPtr.rh4ForEachs;null!=n;){if(n.index<0){(s=n.next)&&!h.compareStringsIgnoreCase(n.name,s.name)&&(s=null);break}r=n,n=n.next}if(null==n)break;for(n.stop=!1,n.index=0;n.index<n.number&&(this.rhPtr.rh4CurrentForEach=n,this.rhPtr.rh4CurrentForEach2=s,s&&(s.index=n.index),this.rh2ActionOn=0,this.handle_Event(n.objects[n.index],-2686976),!n.stop);n.index++);if(s)for(s.index=0;s.index<s.number&&(this.rhPtr.rh4CurrentForEach=s,this.rhPtr.rh4CurrentForEach2=n,n&&(n.index=s.index),this.rh2ActionOn=0,this.handle_Event(s.objects[s.index],-2686976),!s.stop);s.index++);s&&(n.next=s.next),null==r?this.rhPtr.rh4ForEachs=n.next:r.next=n.next}this.rhPtr.rh4CurrentForEach=t,this.rhPtr.rh4CurrentForEach2=e},addForEach:function(t,e,s){for(var r=this.rhPtr.rh4ForEachs,n=null;null!=r;){if(r.oi==s&&h.compareStringsIgnoreCase(t,r.name)){r.objects[r.number++]=e;return}n=r,r=r.next}var r=new ah;n?n.next=r:this.rhPtr.rh4ForEachs=r,r.next=null,r.number=1,r.oi=s,r.objects[0]=e,r.index=-1,r.name=t},handle_GlobalEvents:function(t){let e=65535&t;(32768&e)!=0&&(e=65536-e);let s=this.listPointers[this.rhEvents[e]+-(t>>16)];0!=s&&this.computeEventList(s,null)},handle_Event:function(t,e){this.rhCurCode=e;let s=this.listPointers[t.hoEvents+-(e>>16)];return 0!=s&&(this.computeEventList(s,t),!0)},handle_TimerEvents:function(){for(var t=!1,e=this.rhPtr.rh4TimerEvents;e;){if(this.rhPtr.rhTimer>=e.timer){if(e.type==ao.TIMEREVENTTYPE_ONESHOT){this.rhPtr.rhEvtProg.rhCurParam0=e.name;var s=this.listPointers[this.rhEvents[-ac.OBJ_TIMER]+iX.NUM_ONEVENT];0!=s&&this.computeEventList(s,null),e.bDelete=!0,t=!0}else for(0==e.timerPosition&&(e.timerPosition=this.rhPtr.rhTimer);this.rhPtr.rhTimer>=e.timerPosition;){this.rhPtr.rhEvtProg.rhCurParam0=e.name,this.rhPtr.rhEvtProg.rhCurParam1=e.index;var s=this.listPointers[this.rhEvents[-ac.OBJ_TIMER]+iX.NUM_ONEVENT];if(0!=s&&this.computeEventList(s,null),e.index++,e.loops--,0==e.loops){e.bDelete=!0,t=!0;break}e.timerPosition+=e.timerNext}}e=e.next}if(t){e=this.rhPtr.rh4TimerEvents;for(var r,h=null;e;)r=e.next,e.bDelete?null==h?this.rhPtr.rh4TimerEvents=r:h.next=r:h=e,e=r}},compute_TimerEvents:function(){let t,e,s,r,h,n;if((this.rhPtr.rhGameFlags&nD.GAMEFLAGS_FIRSTLOOPFADEIN)!=0){0!=(t=this.listPointers[this.rhEvents[-ac.OBJ_GAME]+1])&&(this.listPointers[this.rhEvents[-ac.OBJ_GAME]+1]=-1,this.computeEventList(t,null),this.rh4CheckDoneInstart=!0);return}if(0!=(t=this.listPointers[this.rhEvents[-ac.OBJ_TIMER]+3])&&this.computeEventList(t,null),0!=(t=this.listPointers[this.rhEvents[-ac.OBJ_GAME]+1])){if(this.rh4CheckDoneInstart){h=null,e=t;do{if((r=this.eventPointersGroup[e])!=h)for(h=r,s=r.evgNCond;s<r.evgNCond+r.evgNAct;s++)((n=r.evgEvents[s]).evtFlags&at.EVFLAGS_NOTDONEINSTART)==0&&(n.evtFlags|=at.EVFLAGS_DONEBEFOREFADEIN);e++}while(null!=this.eventPointersGroup[e])}if(this.computeEventList(t,null),this.listPointers[this.rhEvents[-ac.OBJ_GAME]+1]=0,this.rh4CheckDoneInstart){h=null,e=t;do{if((r=this.eventPointersGroup[e])!=h)for(h=r,s=r.evgNCond;s<r.evgNCond+r.evgNAct;s++)n=r.evgEvents[s],n.evtFlags&=~at.EVFLAGS_DONEBEFOREFADEIN;e++}while(null!=this.eventPointersGroup[e]);this.rh4CheckDoneInstart=!1}}0!=(t=this.listPointers[this.rhEvents[-ac.OBJ_TIMER]+2])&&this.computeEventList(t,null),0!=(t=this.listPointers[this.rhEvents[-ac.OBJ_TIMER]+1])&&this.computeEventList(t,null)},restartTimerEvents:function(){let t,e,s=this.rhPtr.rhTimer,r=this.listPointers[this.rhEvents[-ac.OBJ_TIMER]+3];if(0!=r)do t=(e=this.eventPointersGroup[r]).evgEvents[this.eventPointersCnd[r]],t.evtFlags|=at.EVFLAGS_DONE,t.evtParams[0].timer>s&&(t.evtFlags&=~at.EVFLAGS_DONE),r++;while(null!=this.eventPointersGroup[r])},computeEventFastLoopList:function(t){let e,s,r=0;do{if(((e=t[r]).evgFlags&n9.EVGFLAGS_INACTIVE)==0){for(this.rhEventGroup=e,this.rh4PickFlags[0]=0,this.rh4PickFlags[1]=0,this.rh4PickFlags[2]=0,this.rh4PickFlags[3]=0,this.rh2EventCount+=1,this.rh4ConditionsFalse=!1,s=1;s<e.evgNCond&&!1!=e.evgEvents[s].eva2(this.rhPtr);s++);s==e.evgNCond&&this.call_Actions(e)}r++}while(r<t.length)},computeEventList:function(t,e){let s,r,h,n,a;this.rh3DoStop=!1;do if(((r=this.eventPointersGroup[t]).evgFlags&n9.EVGFLAGS_INACTIVE)==0){if(this.rhEventGroup=r,this.rh4PickFlags[0]=0,this.rh4PickFlags[1]=0,this.rh4PickFlags[2]=0,this.rh4PickFlags[3]=0,(r.evgFlags&n9.EVGFLAGS_ORINGROUP)==0){if(this.rh2EventCount+=1,this.rh4ConditionsFalse=!1,n=0,r.evgEvents[n].eva1(this.rhPtr,e))for(n++;n<r.evgNCond&&!1!=r.evgEvents[n].eva2(this.rhPtr);n++);n==r.evgNCond&&(this.rh3DoStop?null!=e&&this.call_Stops(e):this.call_Actions(r)),t++}else if(this.rh4EventCountOR++,(r.evgFlags&n9.EVGFLAGS_ORLOGICAL)==0){s=!1;do{for(this.rh2EventCount++,this.rh4ConditionsFalse=!1,n=this.eventPointersCnd[t],!1==r.evgEvents[n].eva1(this.rhPtr,e)&&(this.rh4ConditionsFalse=!0),n++;n<r.evgNCond&&-1507329!=r.evgEvents[n].evtCode;)!1==r.evgEvents[n].eva2(this.rhPtr)&&(this.rh4ConditionsFalse=!0),n++;if(this.evt_MarkSelectedObjects(),!1==this.rh4ConditionsFalse&&(s=!0),t++,null==(r=this.eventPointersGroup[t]))break}while(r==this.rhEventGroup);s&&(this.rh2EventCount++,this.evt_BranchSelectedObjects(),this.call_Actions(this.rhEventGroup))}else{this.rh4ConditionsFalse=!1,s=!1;do{if(this.rh2EventCount++,a=!1,n=this.eventPointersCnd[t],r.evgEvents[n].eva1(this.rhPtr,e))for(n++;n<r.evgNCond&&-1572865!=r.evgEvents[n].evtCode;){if(!1==r.evgEvents[n].eva2(this.rhPtr)){a=!0;break}n++}else a=!0;if(!1==a&&(this.evt_MarkSelectedObjects(),s=!0),t++,null==(r=this.eventPointersGroup[t]))break}while(r==this.rhEventGroup);s&&(this.rh2EventCount++,this.evt_BranchSelectedObjects(),this.call_Actions(this.rhEventGroup))}}else if(t++,null!=this.eventPointersGroup[t])for(h=this.eventPointersGroup[t];h==r&&(t++,null!=this.eventPointersGroup[t]);)h=this.eventPointersGroup[t];while(null!=this.eventPointersGroup[t])},call_Actions:function(t){if((t.evgFlags&n9.EVGFLAGS_LIMITED)!=0){if((t.evgFlags&n9.EVGFLAGS_SHUFFLE)!=0&&(this.rh2ShuffleBuffer=new P),(t.evgFlags&n9.EVGFLAGS_NOTALWAYS)!=0){var e,s=this.rhPtr.rhLoopCount,r=t.evgInhibit;if(t.evgInhibit=s,s==r||(s-=1)==r)return}if((t.evgFlags&n9.EVGFLAGS_REPEAT)!=0){if(0==t.evgInhibitCpt)return;t.evgInhibitCpt--}if((t.evgFlags&n9.EVGFLAGS_NOMORE)!=0){let h=this.rhPtr.rhTimer/10,n=t.evgInhibitCpt;if(0!=n&&h<n)return;t.evgInhibitCpt=h+t.evgInhibit}}this.rh2ActionCount++,this.rh2ActionLoop=!1,this.rh2ActionLoopCount=0,this.rh2ActionOn=!0;let a=0;do((e=t.evgEvents[a+t.evgNCond]).evtFlags&(at.EVFLAGS_BADOBJECT|at.EVFLAGS_DONEBEFOREFADEIN))==0&&(e.evtFlags&=~I.ACTFLAGS_REPEAT,e.execute(this.rhPtr)),a++;while(a<t.evgNAct);if(this.rh2ActionLoop)do for(this.rh2ActionLoop=!1,this.rh2ActionLoopCount++,a=0;a<t.evgNAct;a++)((e=t.evgEvents[a+t.evgNCond]).evtFlags&I.ACTFLAGS_REPEAT)!=0&&(e.evtFlags&=~I.ACTFLAGS_REPEAT,e.execute(this.rhPtr));while(this.rh2ActionLoop);this.rh2ActionOn=!1,null!=this.rh2ShuffleBuffer&&this.endShuffle(),this.callEndForEach&&this.endForEach()},call_Stops:function(t){e=t.hoOi,this.rh2EventCount+=1,this.evt_AddCurrentObject(t),this.rh2ActionCount++,this.rh2ActionLoop=!1,this.rh2ActionLoopCount=0,this.rh2ActionOn=!0;let e,s,r,h,n=0;do{if(262144==(r=4294901760&(s=this.rhEventGroup.evgEvents[this.rhEventGroup.evgNCond+n]).evtCode)||589824==r){if(e==s.evtOi)s.execute(this.rhPtr);else{let a=s.evtOiList;if((32768&a)!=0){let l=this.qualToOiList[32767&a];for(h=0;h<l.qoiList.length;){if(l.qoiList[h]==e){s.execute(this.rhPtr);break}h+=2}}}}n++}while(n<this.rhEventGroup.evgNAct);this.rh2ActionOn=!1},endShuffle:function(){if(!(1>=this.rh2ShuffleBuffer.size())){let t,e=this.rhPtr.random(this.rh2ShuffleBuffer.size());do t=this.rhPtr.random(this.rh2ShuffleBuffer.size());while(e==t);let s=this.rh2ShuffleBuffer.get(e),r=this.rh2ShuffleBuffer.get(t),h=s.hoX,n=s.hoY,a=r.hoX,l=r.hoY;nD.setXPosition(s,a),nD.setYPosition(s,l),nD.setXPosition(r,h),nD.setYPosition(r,n),this.rh2ShuffleBuffer=null}},onMouseButton:function(t,e){if(this.rhPtr.getMouseCoords(),null!=this.rhPtr&&0==this.rhPtr.rh2PauseCompteur&&!1!=this.bReady&&(s=t,2==e&&(s+=nZ.PARAMCLICK_DOUBLE),this.rhPtr.rh4TimeOut=0,0==this.rhPtr.rhMouseUsed)){this.rhCurParam0=s,this.rh2CurrentClick=s,this.handle_GlobalEvents(-262150),this.handle_GlobalEvents(-327686);var s,r,h,n,a,l,u,d=0,p=new P;for(r=0;r<this.rhPtr.rhNObjects;r++){for(;null==this.rhPtr.rhObjectList[d];)d++;h=this.rhPtr.rhObjectList[d],d++,n=h.hoX-h.hoImgXSpot,a=h.hoY-h.hoImgYSpot,l=n+h.hoImgWidth,u=a+h.hoImgHeight,this.rhPtr.rh2MouseX>=n&&this.rhPtr.rh2MouseX<l&&this.rhPtr.rh2MouseY>=a&&this.rhPtr.rh2MouseY<u&&(h.hoLimitFlags&n3.OILIMITFLAGS_QUICKCOL)!=0&&(h.hoFlags&a0.HOF_DESTROYED)==0&&(h.hoType==ac.OBJ_SPR&&(h.ros.rsFlags&l2.RSFLAG_COLBOX)==0?this.application.imageBank.getImageFromHandle(h.roc.rcImage).getMask(lR.GCMF_OBSTACLE,0,1,1).testPointEx(this.rhPtr.rh2MouseX-h.hoX,this.rhPtr.rh2MouseY-h.hoY,h.roc.rcAngle,h.roc.rcScaleX,h.roc.rcScaleY)&&p.add(h):p.add(h))}for(d=0;d<p.size();d++)h=p.get(d),this.rhCurParam1=h.hoOi,this.rh4_2ndObject=h,this.handle_GlobalEvents(-393222)}},onKeyDown:function(t){null!=this.rhPtr&&!1!=this.bReady&&(this.rhPtr.rh4TimeOut=0,this.handle_GlobalEvents(-524294))},onMouseMove:function(){!1!=this.bReady&&0==this.rhPtr.rh2PauseCompteur&&(this.rhPtr.rh4TimeOut=0)},ctoCompare:function(t,e){return 0!=e.hoImgWidth&&0!=e.hoImgHeight&&!(e.hoX<t.x1)&&!(e.hoX>=t.x2)&&!(e.hoY<t.y1)&&!(e.hoY>=t.y2)},count_ZoneTypeObjects:function(t,e,s){e++,this.evtNSelectedObjects=0;for(var r,h,n=0,a=null;;){for(;n<this.rhPtr.rhOiList.length&&(a=this.rhPtr.rhOiList[n],0!=s&&(0==s||s!=a.oilType));n++);if(n==this.rhPtr.rhOiList.length)return null;let l=a;if(n++,l.oilEventCount!=this.rh2EventCount){if(!1==this.rh4ConditionsFalse)for(h=l.oilObject;(2147483648&h)==0;){if(null==(r=this.rhPtr.rhObjectList[h]))return null;if((r.hoFlags&a0.HOF_DESTROYED)==0&&this.ctoCompare(t,r)&&(this.evtNSelectedObjects++,this.evtNSelectedObjects==e))return r;h=r.hoNumNext}}else for(h=l.oilListSelected;(2147483648&h)==0;){if(null==(r=this.rhPtr.rhObjectList[h]))return null;if((r.hoFlags&a0.HOF_DESTROYED)==0&&this.ctoCompare(t,r)&&(this.evtNSelectedObjects++,this.evtNSelectedObjects==e))return r;h=r.hoNextSelected}}},count_ObjectsFromType:function(t,e){e++,this.evtNSelectedObjects=0;for(var s,r,h=0,n=null;;){for(;h<this.rhPtr.rhOiList.length&&(n=this.rhPtr.rhOiList[h],0!=t&&(0==t||t!=n.oilType));h++);if(h==this.rhPtr.rhOiList.length)return null;let a=n;if(h++,a.oilEventCount!=this.rh2EventCount){if(!1==this.rh4ConditionsFalse)for(r=a.oilObject;(2147483648&r)==0;){if(null==(s=this.rhPtr.rhObjectList[r]))return null;if((s.hoFlags&a0.HOF_DESTROYED)==0&&(this.evtNSelectedObjects++,this.evtNSelectedObjects==e))return s;r=s.hoNumNext}}else for(r=a.oilListSelected;(2147483648&r)==0;){if(null==(s=this.rhPtr.rhObjectList[r]))return null;if((s.hoFlags&a0.HOF_DESTROYED)==0&&(this.evtNSelectedObjects++,this.evtNSelectedObjects==e))return s;r=s.hoNextSelected}}},czaCompare:function(t,e){return!(e.hoX<t.x1)&&!(e.hoX>=t.x2)&&!(e.hoY<t.y1)&&!(e.hoY>=t.y2)},select_ZoneTypeObjects:function(t,e){for(var s,r,h,n=0,a=0,l=null;;){for(;a<this.rhPtr.rhOiList.length&&(l=this.rhPtr.rhOiList[a],0!=e&&(0==e||e!=l.oilType));a++);if(a==this.rhPtr.rhOiList.length)return n;let u=l;if(a++,u.oilEventCount!=this.rh2EventCount){if(s=null,u.oilNumOfSelected=0,u.oilEventCount=this.rh2EventCount,u.oilListSelected=-1,!1==this.rh4ConditionsFalse)for(h=u.oilObject;(2147483648&h)==0&&null!=(r=this.rhPtr.rhObjectList[h]);)(r.hoFlags&a0.HOF_DESTROYED)==0&&this.czaCompare(t,r)&&(n++,u.oilNumOfSelected++,r.hoNextSelected=-1,null==s?u.oilListSelected=r.hoNumber:s.hoNextSelected=r.hoNumber,s=r),h=r.hoNumNext;continue}for(s=null,h=u.oilListSelected;(2147483648&h)==0&&null!=(r=rhPtr.rhObjectList[h]);)(r.hoFlags&a0.HOF_DESTROYED)==0&&(!1==this.czaCompare(t,r)?(u.oilNumOfSelected--,null==s?u.oilListSelected=r.hoNextSelected:s.hoNextSelected=r.hoNextSelected):(n++,s=r)),h=r.hoNextSelected}},losCompare:function(t,e,s,r,h){let n,a,l,u=h.hoX-h.hoImgXSpot,d=u+h.hoImgWidth,p=h.hoY-h.hoImgYSpot,m=p+h.hoImgHeight;if(s-t>r-e){if(n=(r-e)/(s-t),s>t){if(d<t||u>=s)return!1}else if(d<s||u>=t)return!1;return(l=n*(u-t)+e)>=p&&l<m||(l=n*(d-t)+e)>=p&&l<m}if(n=(s-t)/(r-e),r>e){if(m<e||p>=r)return!1}else if(m<r||p>=e)return!1;return(a=n*(p-e)+t)>=u&&a<d||(a=n*(p-e)+t)>=u&&a<d},select_LineOfSight:function(t,e,s,r){let h,n,a,l,u,d=0;for(n=0;n<this.rhPtr.rhOiList.length;n++){if((h=this.rhPtr.rhOiList[n]).oilEventCount!=this.rh2EventCount){if(a=null,h.oilNumOfSelected=0,h.oilEventCount=this.rh2EventCount,h.oilListSelected=-1,!1==this.rh4ConditionsFalse)for(u=h.oilObject;(2147483648&u)==0&&null!=(l=this.rhPtr.rhObjectList[u]);)(l.hoFlags&a0.HOF_DESTROYED)==0&&this.losCompare(t,e,s,r,l)&&(d++,h.oilNumOfSelected++,l.hoNextSelected=-1,null==a?h.oilListSelected=l.hoNumber:a.hoNextSelected=l.hoNumber,a=l),u=l.hoNumNext;continue}for(a=null,u=h.oilListSelected;(2147483648&u)==0&&null!=(l=this.rhPtr.rhObjectList[u]);)(l.hoFlags&a0.HOF_DESTROYED)==0&&(!1==this.losCompare(t,e,s,r,l)?(h.oilNumOfSelected--,null==a?h.oilListSelected=l.hoNextSelected:a.hoNextSelected=l.hoNextSelected):(d++,a=l)),u=l.hoNextSelected}return d},czoCountThem:function(t,e){let s,r,h=0,n=this.rhPtr.rhOiList[t];if(n.oilEventCount!=this.rh2EventCount){if(!1==this.rh4ConditionsFalse)for(r=n.oilObject;(2147483648&r)==0;){if(null==(s=this.rhPtr.rhObjectList[r]))return 0;(s.hoFlags&a0.HOF_DESTROYED)==0&&this.czaCompare(e,s)&&h++,r=s.hoNumNext}return h}for(r=n.oilListSelected;(2147483648&r)==0;){if(null==(s=this.rhPtr.rhObjectList[r]))return 0;(s.hoFlags&a0.HOF_DESTROYED)==0&&this.czaCompare(e,s)&&h++,r=s.hoNextSelected}return h},count_ZoneOneObject:function(t,e){if((32768&t)==0)return this.czoCountThem(t,e);if((32767&t)==32767)return 0;let s,r=this.qualToOiList[32767&t],h=0;for(s=0;s<r.qoiList.length;s+=2)h+=this.czoCountThem(r.qoiList[s+1],e);return h},countThem:function(t,e){let s,r,h=this.rhPtr.rhOiList[t];if(h.oilEventCount!=this.rh2EventCount){if(this.rh4ConditionsFalse)return this.evtNSelectedObjects=0,null;for(r=h.oilObject;(2147483648&r)==0&&null!=(s=this.rhPtr.rhObjectList[r]);){if((s.hoFlags&a0.HOF_DESTROYED)==0&&(this.evtNSelectedObjects++,this.evtNSelectedObjects==e))return s;r=s.hoNumNext}return null}for(r=h.oilListSelected;(2147483648&r)==0&&null!=(s=this.rhPtr.rhObjectList[r]);){if((s.hoFlags&a0.HOF_DESTROYED)==0&&(this.evtNSelectedObjects++,this.evtNSelectedObjects==e))return s;r=s.hoNextSelected}return null},count_ObjectsFromOiList:function(t,e){if(e++,this.evtNSelectedObjects=0,(32768&t)==0)return this.countThem(t,e);if((32767&t)==32767)return null;let s,r=this.qualToOiList[32767&t];for(s=0;s<r.qoiList.length;s+=2){let h=this.countThem(r.qoiList[s+1],e);if(null!=h)return h}return null},pickFromId:function(t){let e=65535&t;if(e>=this.rhPtr.rhMaxObjects)return!1;let s=this.rhPtr.rhObjectList[e];if(null==s||t>>>16!=s.hoCreationId)return!1;let r=s.hoOiList;if(r.oilEventCount==this.rh2EventCount){for(var h=r.oilListSelected,n=null;(2147483648&h)==0&&s!=(n=this.rhPtr.rhObjectList[h]);)h=n.hoNextSelected;if(s!=n)return!1}return r.oilEventCount=this.rh2EventCount,r.oilListSelected=-1,r.oilNumOfSelected=0,s.hoNextSelected=-1,this.evt_AddCurrentObject(s),!0},push_Event:function(t,e,s,r,h){let n=new as(t,e,s,r,h);null==this.rh2PushedEvents&&(this.rh2PushedEvents=new P),this.rh2PushedEvents.add(n)},handle_PushedEvents:function(){if(null!=this.rh2PushedEvents){let t;for(t=0;t<this.rh2PushedEvents.size();t++){let e=this.rh2PushedEvents.get(t);if(null!=e&&0!=e.code)switch(this.rhCurParam0=e.param,this.rhCurOi=e.oi,e.routine){case 0:this.handle_GlobalEvents(e.code);break;case 1:this.handle_Event(e.pHo,e.code)}}this.rh2PushedEvents.clear()}},load:function(t){for(var e,s,r=[,,,,],h=0;;){var r=t.file.readBuffer(4);if(69==r[0]&&82==r[1]&&62==r[2]&&62==r[3]){for(this.maxObjects=t.file.readAShort(),this.maxObjects<300&&(this.maxObjects=300),this.maxOi=t.file.readAShort(),this.nPlayers=t.file.readAShort(),s=0;s<7+ac.OBJ_LAST;s++)this.nConditions[s]=t.file.readAShort();if(this.nQualifiers=t.file.readAShort(),this.nQualifiers>0)for(s=0,this.qualifiers=Array(this.nQualifiers);s<this.nQualifiers;s++)this.qualifiers[s]=new ai,this.qualifiers[s].qOi=t.file.readShort(),this.qualifiers[s].qType=t.file.readShort()}else if(69==r[0]&&82==r[1]&&101==r[2]&&115==r[3])t.file.readAInt(),this.nEvents=t.file.readAInt(),this.events=Array(this.nEvents),this.eventPos=0;else if(69==r[0]&&82==r[1]&&101==r[2]&&118==r[3])for(t.file.readAInt(),e=t.file.readAInt(),s=0;s<e;s++)this.events[h]=n9.create(t),h++;else if(60==r[0]&&60==r[1]&&69==r[2]&&82==r[3])break}this.maxEvents=Math.max(this.maxEvents,h)},inactiveGroup:function(t){let e,s,r,h;for(s=this.events[t],s.evgFlags&=n9.EVGFLAGS_DEFAULTMASK,s.evgFlags|=n9.EVGFLAGS_INACTIVE,t++,e=!1;;){switch(s=this.events[t],s.evgFlags&=n9.EVGFLAGS_DEFAULTMASK,s.evgFlags|=n9.EVGFLAGS_INACTIVE,(r=s.evgEvents[0]).evtCode){case -589825:h=r.evtParams[0],h.grpFlags|=a1.GRPFLAGS_PARENTINACTIVE,t=this.inactiveGroup(t);continue;case -655361:e=!0,t++}if(e)break;t++}return t},prepareProgram:function(){let t,e,s,r,h,n,a,l,u,d=new P;for(h=0;h<this.events.length;)t=this.events[h],t.evgFlags&=n9.EVGFLAGS_DEFAULTMASK,-589825==(e=t.evgEvents[0]).evtCode&&(s=e.evtParams[0],(l=new ae).id=s.grpId,l.evg=h,d.add(l),s.grpFlags&=~(a1.GRPFLAGS_PARENTINACTIVE|a1.GRPFLAGS_GROUPINACTIVE),(s.grpFlags&a1.GRPFLAGS_INACTIVE)!=0&&(s.grpFlags|=a1.GRPFLAGS_GROUPINACTIVE)),h++;for(h=0;h<this.events.length;){if(t=this.events[h],t.evgFlags&=n9.EVGFLAGS_DEFAULTMASK,-589825==(e=t.evgEvents[0]).evtCode&&(s=e.evtParams[0],s.grpFlags&=~a1.GRPFLAGS_PARENTINACTIVE,(s.grpFlags&a1.GRPFLAGS_GROUPINACTIVE)!=0)){h=this.inactiveGroup(h);continue}h++}for(h=0;h<this.events.length;h++)switch((e=(t=this.events[h]).evgEvents[0]).evtCode){case -589825:case -655361:break;default:for(n=0,t.evgInhibit=0,t.evgInhibitCpt=0;n<t.evgNCond+t.evgNAct;n++)if((e=t.evgEvents[n]).evtCode<0?e.evtFlags&=at.EVFLAGS_DEFAULTMASK:e.evtFlags&=~(I.ACTFLAGS_REPEAT|at.EVFLAGS_NOTDONEINSTART),0!=e.evtNParams)for(a=0;a<e.evtNParams;a++)switch((r=e.evtParams[a]).code){case 25:r.value2=0;break;case 13:r.compteur=r.delay;break;case 39:for(u=0;u<d.size();u++)if((l=d.get(u)).id==r.id){r.pointer=l.evg;break}}}},assemblePrograms:function(t){this.rhPtr=t,this.rh2ActionCount=0;let e,s,r,n=0;for(A=0,O=0;O<this.rhPtr.rhMaxOI;O++)-1!=this.rhPtr.rhOiList[O].oilOi&&(this.rhPtr.rhOiList[O].oilActionCount=-1,this.rhPtr.rhOiList[O].oilLimitFlags=0,this.rhPtr.rhOiList[O].oilLimitList=-1,A++,this.rhPtr.rhOiList[O].oilOi+1>n&&(n=this.rhPtr.rhOiList[O].oilOi+1));if(this.qualToOiList=null,this.nQualifiers>0){let a=Array(this.nQualifiers);for(R=0;R<this.nQualifiers;R++)for(V=0,g=32767&this.qualifiers[R].qOi,a[R]=0;V<this.rhPtr.rhMaxOI;V++)if(this.rhPtr.rhOiList[V].oilType==this.qualifiers[R].qType)for(O=0;O<8&&-1!=this.rhPtr.rhOiList[V].oilQualifiers[O];O++)g==this.rhPtr.rhOiList[V].oilQualifiers[O]&&a[R]++;for(R=0,this.qualToOiList=Array(this.nQualifiers);R<this.nQualifiers;R++){for(this.qualToOiList[R]=new ar,0!=a[R]&&(this.qualToOiList[R].qoiList=Array(2*a[R])),v=0,g=32767&this.qualifiers[R].qOi,V=0;V<this.rhPtr.rhMaxOI;V++)if(this.rhPtr.rhOiList[V].oilType==this.qualifiers[R].qType)for(O=0;O<8&&-1!=this.rhPtr.rhOiList[V].oilQualifiers[O];O++)g==this.rhPtr.rhOiList[V].oilQualifiers[O]&&(this.qualToOiList[R].qoiList[2*v]=this.rhPtr.rhOiList[V].oilOi,this.qualToOiList[R].qoiList[2*v+1]=V,v++);this.qualToOiList[R].qoiActionCount=-1}}this.colBuffer=Array(200*n+1);let l=0,u=[];for(U=0;U<this.events.length;U++){for(K=0,d=this.events[U];K<d.evgNAct+d.evgNCond;K++){if(p=d.evgEvents[K],p.evtFlags&=~at.EVFLAGS_BADOBJECT,nZ.EVTTYPE(p.evtCode)>=0&&(p.evtOiList=this.get_OiListOffset(p.evtOi,nZ.EVTTYPE(p.evtCode))),p.evtCode==I.ACT_STARTLOOP){var d,p,m,f,$,g,P,E,_,A,v,O,S,T,b,C,L,F,R,M,w,k,N,D,H,B,G,Y,j,X,W,V,U,K,q,z,J=p.evtParams[0];if(J.tokens[0].code==rW.EXP_STRING&&0==J.tokens[1].code){let Q={};Q.address=p.evtParams[0],Q.name=J.tokens[0].string,u.push(Q),this.rhPtr.addFastLoop(J.tokens[0].string)}}else if(p.evtCode==I.ACT_STOPLOOP||p.evtCode==I.ACT_SETLOOPINDEX){var J=p.evtParams[0];J.tokens[0].code==rW.EXP_STRING&&0==J.tokens[1].code&&(J.tokens[0]=new rU,J.tokens[0].code=rW.EXP_LONG,J.tokens[0].value=this.rhPtr.addFastLoop(J.tokens[0].string))}if(p.evtNParams>0)for(q=0;q<p.evtNParams;q++)switch((m=p.evtParams[q]).code){case 25:m.value=0;break;case 21:if((p.evtOi&ac.OIFLAG_QUALIFIER)==0){for(z=this.rhPtr.rhFrame.LOList.first_LevObj();null!=z;z=this.rhPtr.rhFrame.LOList.next_LevObj())if(p.evtOi==z.loOiHandle){m.cdpHFII=z.loHandle;break}}else m.cdpHFII=-1;-1!=(g=m.posOINUMParent)&&(m.posOiList=this.get_OiListOffset(g,m.posTypeParent));break;case 9:case 18:case 16:-1!=(g=m.posOINUMParent)&&(m.posOiList=this.get_OiListOffset(g,m.posTypeParent));break;case 1:m.oiList=this.get_OiListOffset(m.oi,m.type);break;case 15:case 27:case 28:case 45:case 46:case 22:case 23:case 52:case 59:case 53:case 62:case 54:var Z=m;for(O=0;O<Z.tokens.length;O++)if(nZ.EVTTYPE(Z.tokens[O].code)>0){let tt=Z.tokens[O];tt.oiList=this.get_OiListOffset(tt.oi,nZ.EVTTYPE(tt.code))}}}for(K=0,L=0,F=n9.EVGFLAGS_ONCE|n9.EVGFLAGS_LIMITED|n9.EVGFLAGS_STOPINGROUP;K<d.evgNCond+d.evgNAct;K++){if(p=d.evgEvents[K],_=nZ.EVTTYPE(p.evtCode),k=p.evtCode,O=0,M=0,w=0,m=null,_>=ac.OBJ_SPR)switch(nZ.getEventCode(k)){case 262144:case 589824:if(L|=n9.EVGFLAGS_STOPINGROUP,((g=p.evtOi)&ac.OIFLAG_QUALIFIER)!=0)for(f=this.qual_GetFirstOiList2(p.evtOiList);-1!=f;f=this.qual_GetNextOiList2())l=this.make_ColList1(d,l,this.rhPtr.rhOiList[f].oilOi);else l=this.make_ColList1(d,l,g);break;case 1638400:L|=n9.EVGFLAGS_SHUFFLE;break;case -917504:m=p.evtParams[0];var te=p.evtParams[0];this.addColList(p.evtOiList,p.evtOi,te.oiList,te.oi),this.addColList(te.oiList,te.oi,p.evtOiList,p.evtOi),T=nZ.EVTTYPE(p.evtCode),w=this.isTypeRealSprite(T)?n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_ONCOLLIDE:n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_QUICKEXT|n3.OILIMITFLAGS_ONCOLLIDE,b=te.type,M=this.isTypeRealSprite(b)?n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_ONCOLLIDE:n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_QUICKEXT|n3.OILIMITFLAGS_ONCOLLIDE,O=3;break;case -262144:T=nZ.EVTTYPE(p.evtCode),w=this.isTypeRealSprite(T)?n3.OILIMITFLAGS_QUICKCOL:n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_QUICKEXT,m=p.evtParams[0],b=p.evtParams[0].type,M=this.isTypeRealSprite(b)?n3.OILIMITFLAGS_QUICKCOL:n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_QUICKEXT,O=3;break;case -720896:case -786432:M=n3.OILIMITFLAGS_QUICKBORDER,O=1;break;case -851968:M=n3.OILIMITFLAGS_QUICKBACK,O=1}else switch(k){case -327681:F&=~n9.EVGFLAGS_ONCE;break;case -393217:case -262145:F|=n9.EVGFLAGS_NOMORE;break;case -196609:F|=n9.EVGFLAGS_NOTALWAYS+n9.EVGFLAGS_REPEAT;break;case -196614:w=n3.OILIMITFLAGS_QUICKCOL,m=p.evtParams[0],O=2;break;case -393222:w=n3.OILIMITFLAGS_QUICKCOL,m=p.evtParams[1],O=2}if((1&O)!=0)for(f=this.qual_GetFirstOiList(p.evtOiList);-1!=f;f=this.qual_GetNextOiList())this.rhPtr.rhOiList[f].oilLimitFlags|=M;if((2&O)!=0)for(f=this.qual_GetFirstOiList(m.oiList);-1!=f;f=this.qual_GetNextOiList())this.rhPtr.rhOiList[f].oilLimitFlags|=w}d.evgFlags&=~F,d.evgFlags|=L}this.colBuffer[l]=-1;let ti=Array(ac.NUMBEROF_SYSTEMTYPES+n+1);for(tn=0,G=0,_=-ac.NUMBEROF_SYSTEMTYPES;_<0;_++,tn++)ti[tn]=G,G+=this.nConditions[ac.NUMBEROF_SYSTEMTYPES+_];for(V=0;V<this.rhPtr.rhMaxOI;V++,tn++)ti[tn]=G,this.rhPtr.rhOiList[V].oilType<ac.KPX_BASE?G+=this.nConditions[ac.NUMBEROF_SYSTEMTYPES+this.rhPtr.rhOiList[V].oilType]+nZ.EVENTS_EXTBASE+1:G+=this.application.extLoader.getNumberOfConditions(this.rhPtr.rhOiList[V].oilType)+nZ.EVENTS_EXTBASE+1;let ts=G;for(O=0,this.listPointers=Array(ts);O<ts;O++)this.listPointers[O]=0;D=0;let tr=Array(this.rhPtr.rhFrame.maxObjects);for(U=0;U<this.nEvents;U++)for(d=this.events[U],d.evgFlags&=~n9.EVGFLAGS_ORINGROUP,Y=!0,j=0,K=0;K<d.evgNCond;K++){if(p=d.evgEvents[K],_=nZ.EVTTYPE(p.evtCode),k=p.evtCode,S=-nZ.EVTNUM(k),Y){if((p.evtFlags&at.EVFLAGS_ALWAYS)!=0&&D++,_<0)this.listPointers[ti[7+_]+S]++;else{for(ta=0,f=this.qual_GetFirstOiList(p.evtOiList);-1!=f;f=this.qual_GetNextOiList())this.listPointers[ti[ac.NUMBEROF_SYSTEMTYPES+f]+S]++,tr[ta++]=f;if(tr[ta]=-1,-917504==nZ.getEventCode(k))for(m=p.evtParams[0],$=this.qual_GetFirstOiList(m.oiList);-1!=$;$=this.qual_GetNextOiList()){for(ta=0;tr[ta]!=$&&-1!=tr[ta];)ta++;-1==tr[ta]&&this.listPointers[ti[ac.NUMBEROF_SYSTEMTYPES+$]+S]++}}}Y=!1,(-1507329==p.evtCode||-1572865==p.evtCode)&&(Y=!0,d.evgFlags|=n9.EVGFLAGS_ORINGROUP,0==j?j=p.evtCode:p.evtCode=j,-1572865==j&&(d.evgFlags|=n9.EVGFLAGS_ORLOGICAL))}let th=D+1;for(tl=0;tl<ts;tl++)0!=this.listPointers[tl]&&(G=this.listPointers[tl],this.listPointers[tl]=th,th+=G+1);for(O=0,this.eventPointersGroup=Array(th),this.eventPointersCnd=Array(th);O<th;O++)this.eventPointersGroup[O]=null,this.eventPointersCnd[O]=0;let to=Array(ts);for(O=0;O<ts;O++)to[O]=this.listPointers[O];for(U=0,this.rhPtr.rh4PosOnLoop=null,H=0,D=0,this.complexOnLoop=!1;U<this.nEvents;U++)for(K=0,d=this.events[U],Y=!0;K<d.evgNCond;K++){if(p=d.evgEvents[K],_=nZ.EVTTYPE(p.evtCode),k=p.evtCode,S=-nZ.EVTNUM(k),Y){if((p.evtFlags&at.EVFLAGS_ALWAYS)!=0&&(D++,this.eventPointersGroup[H]=d,this.eventPointersCnd[H]=K,H++),_<0){if(tu=ti[ac.NUMBEROF_SYSTEMTYPES+_]+S,this.eventPointersGroup[to[tu]]=d,this.eventPointersCnd[to[tu]]=K,to[tu]++,p.evtCode==iX.CND_ONLOOP){var tn,ta,tl,tu,O,tc=!1;for(O=0;O<d.evgNCond&&d.evgEvents[O].evtCode!=iX.CND_OR&&d.evgEvents[O].evtCode!=iX.CND_ORLOGICAL;O++);O<d.evgNCond&&(tc=!0);var J=p.evtParams[0];if(J.tokens[0].code==rW.EXP_STRING&&0==J.tokens[1].code){let td=J.tokens[0].string,tp=this.rhPtr.addFastLoop(td);for(O=0;O<u.length;O++){let tm=u[O];if(h.compareStringsIgnoreCase(tm.name,td)){this.rhPtr.rh4PosOnLoop||(this.rhPtr.rh4PosOnLoop=[]);let tf=null;for(O=0;O<this.rhPtr.rh4PosOnLoop.length;O++)if(h.compareStringsIgnoreCase(td,this.rhPtr.rh4PosOnLoop[O].name)){tf=this.rhPtr.rh4PosOnLoop[O];break}tf||(tf=new nQ(td,tp),this.rhPtr.rh4PosOnLoop.push(tf)),tf.AddOnLoop(d),tf.m_bOR|=tc,tm.address.fastFastLoop=O+1;break}}}else this.complexOnLoop=!0}}else{for(ta=0,f=this.qual_GetFirstOiList(p.evtOiList);-1!=f;f=this.qual_GetNextOiList())tu=ti[ac.NUMBEROF_SYSTEMTYPES+f]+S,this.eventPointersGroup[to[tu]]=d,this.eventPointersCnd[to[tu]]=K,to[tu]++,tr[ta++]=f;if(tr[ta]=-1,-917504==nZ.getEventCode(k))for(m=p.evtParams[0],$=this.qual_GetFirstOiList(m.oiList);-1!=$;$=this.qual_GetNextOiList()){for(ta=0;tr[ta]!=$&&-1!=tr[ta];)ta++;-1==tr[ta]&&(tu=ti[ac.NUMBEROF_SYSTEMTYPES+$]+S,this.eventPointersGroup[to[tu]]=d,this.eventPointersCnd[to[tu]]=K,to[tu]++)}}}Y=!1,(-1507329==p.evtCode||-1572865==p.evtCode)&&(Y=!0)}tl=ti[ac.NUMBEROF_SYSTEMTYPES+ac.OBJ_TIMER],B=this.listPointers[tl-nZ.EVTNUM(-131076)],this.limitBuffer=Array(n+1+l/2);let t$=0;for(V=0;V<this.rhPtr.rhMaxOI;V++)if(X=this.rhPtr.rhOiList[V],tl=ti[ac.NUMBEROF_SYSTEMTYPES+V],X.oilEvents=tl,(X.oilOEFlags&a$.OEFLAG_MOVEMENTS)!=0){if(N=0,0!=(G=this.listPointers[tl-nZ.EVTNUM(-786432)]))for(;null!=this.eventPointersGroup[G];){for(C=(p=(d=this.eventPointersGroup[G]).evgEvents[this.eventPointersCnd[G]]).evtParams[0].value,r=nZ.evg_FindAction(d,0),O=d.evgNAct;O>0;O--,r++)(p=d.evgEvents[r]).evtCode==(524288|65535&X.oilType)&&(N|=C);G++}for(l=0,X.oilWrap=N,P=X.oilOi,e=0;-1!=this.colBuffer[l];l+=2)if(this.colBuffer[l]==P){if((32768&(E=this.colBuffer[l+1]))!=0){X.oilLimitFlags|=E;continue}for(s=0;s<e&&this.limitBuffer[t$+s]!=E;)s++;s==e&&(this.limitBuffer[t$+e++]=E)}e>0&&(X.oilLimitList=t$,this.limitBuffer[t$+e++]=-1,t$+=e)}for(O=1,this.rhEvents[0]=0;O<=ac.NUMBEROF_SYSTEMTYPES;O++)this.rhEvents[O]=ti[ac.NUMBEROF_SYSTEMTYPES-O];for(V=0;V<this.rhPtr.rhMaxOI;V++)if((2147483648&(f=(X=this.rhPtr.rhOiList[V]).oilObject))==0)do(W=this.rhPtr.rhObjectList[f]).hoEvents=X.oilEvents,W.hoOiList=X,W.hoLimitFlags=X.oilLimitFlags,(W.hoOEFlags&a$.OEFLAG_MOVEMENTS)!=0&&(W.rom.rmWrapping=X.oilWrap),(W.hoOEFlags&a$.OEFLAG_SPRITES)!=0&&(W.hoLimitFlags&n3.OILIMITFLAGS_QUICKCOL)==0&&W.ros.setColFlag(!1),(W.hoOEFlags&a$.OEFLAG_MANUALSLEEP)==0&&(W.hoOEFlags&=~a$.OEFLAG_NEVERSLEEP,(W.hoLimitFlags&n3.OILIMITFLAGS_QUICKBACK)!=0&&(this.rhPtr.rhFrame.leFlags&nR.LEF_TOTALCOLMASK)!=0&&(W.hoOEFlags|=a$.OEFLAG_NEVERSLEEP),(W.hoLimitFlags&(n3.OILIMITFLAGS_QUICKCOL|n3.OILIMITFLAGS_QUICKBORDER))!=0&&(W.hoOEFlags|=a$.OEFLAG_NEVERSLEEP)),f=W.hoNumNext;while((2147483648&f)==0);0!=D?this.rhEventAlways=!0:this.rhEventAlways=!1,0!=B?this.rh4TimerEventsBase=B:this.rh4TimerEventsBase=0,this.colBuffer=null,this.bReady=!0},unBranchPrograms:function(){this.bReady=!1,this.qualToOiList=null,this.limitBuffer=null,this.listPointers=null,this.eventPointersGroup=null,this.eventPointersCnd=null},get_OiListOffset:function(t,e){let s,r;if((t&ac.OIFLAG_QUALIFIER)!=0){for(s=0;t!=this.qualifiers[s].qOi||e!=this.qualifiers[s].qType;)s++;return 32768|s}for(r=0;r<this.rhPtr.rhMaxOI&&this.rhPtr.rhOiList[r].oilOi!=t;)r++;return r},isTypeRealSprite:function(t){let e;for(e=0;e<this.rhPtr.rhMaxOI;e++)if(-1!=this.rhPtr.rhOiList[e].oilOi&&this.rhPtr.rhOiList[e].oilType==t){if((this.rhPtr.rhOiList[e].oilOEFlags&a$.OEFLAG_SPRITES)==0||(this.rhPtr.rhOiList[e].oilOEFlags&a$.OEFLAG_QUICKDISPLAY)!=0)return!1;break}return!0},qual_GetFirstOiList:function(t){return(32768&t)==0?(this.qualOilPtr=-1,t):-1==t?-1:(t&=32767,this.qualOilPtr=t,this.qualOilPos=0,this.qual_GetNextOiList())},qual_GetNextOiList:function(){let t;return -1==this.qualOilPtr||this.qualOilPos>=this.qualToOiList[this.qualOilPtr].qoiList.length?-1:(t=this.qualToOiList[this.qualOilPtr].qoiList[this.qualOilPos+1],this.qualOilPos+=2,t)},qual_GetFirstOiList2:function(t){return(32768&t)==0?(this.qualOilPtr2=-1,t):-1==t?-1:(t&=32767,this.qualOilPtr2=t,this.qualOilPos2=0,this.qual_GetNextOiList2())},qual_GetNextOiList2:function(){let t;return -1==this.qualOilPtr2||this.qualOilPos2>=this.qualToOiList[this.qualOilPtr2].qoiList.length?-1:(t=this.qualToOiList[this.qualOilPtr2].qoiList[this.qualOilPos2+1],this.qualOilPos2+=2,t)},addColList:function(t,e,s,r){if(e<0){if(null!=this.qualToOiList)for(h=this.qualToOiList[32767&t],n=0;n<h.qoiList.length;)this.addColList(h.qoiList[n+1],h.qoiList[n],s,r),n+=2;return}if(r<0){if(null!=this.qualToOiList)for(h=this.qualToOiList[32767&s],n=0;n<h.qoiList.length;)this.addColList(t,e,h.qoiList[n+1],h.qoiList[n]),n+=2;return}let h,n,a,l,u=this.rhPtr.rhOiList[t];if(null==u.oilColList)u.oilColList=[],a=u.oilColList;else for(l=0,a=u.oilColList;l<a.length;l+=2)if(r==a[l])return;a.push(r),a.push(s)},make_ColList1:function(t,e,s){let r,h,n,a,l,u,d;for(d=0;d<t.evgNCond;d++)if(l=t.evgEvents[d],nZ.EVTTYPE(l.evtCode)>=2)switch(h=32768+n3.OILIMITFLAGS_BACKDROPS,n=nZ.getEventCode(l.evtCode)){case -917504:for(u=l.evtParams[0],a=this.qual_GetFirstOiList(l.evtOiList);-1!=a;a=this.qual_GetNextOiList())s==(r=this.rhPtr.rhOiList[a].oilOi)&&(h=0,e=this.make_ColList2(e,s,u.oiList));if(0==h)break;for(a=this.qual_GetFirstOiList(u.oiList);-1!=a;a=this.qual_GetNextOiList())s==(r=this.rhPtr.rhOiList[a].oilOi)&&(e=this.make_ColList2(e,s,l.evtOiList));break;case -786432:h=32768+(u=l.evtParams[0]).value;case -851968:for(a=this.qual_GetFirstOiList(l.evtOiList);-1!=a;a=this.qual_GetNextOiList())s==(r=this.rhPtr.rhOiList[a].oilOi)&&(this.colBuffer[e++]=s,this.colBuffer[e++]=h)}return e},make_ColList2:function(t,e,s){let r,h,n;for(h=this.qual_GetFirstOiList(s);-1!=h;h=this.qual_GetNextOiList()){for(n=0,r=this.rhPtr.rhOiList[h].oilOi;n<t&&(this.colBuffer[n]!=e||this.colBuffer[n+1]!=r);n+=2);n==t&&(this.colBuffer[t++]=e,this.colBuffer[t++]=r)}return t},getCollisionFlags:function(){for(r=0;r<this.events.length;r++)for(h=0,t=this.events[r];h<t.evgNAct+t.evgNCond;h++)if((e=t.evgEvents[h]).evtNParams>0){for(n=0;n<e.evtNParams;n++)if(43==(s=e.evtParams[n]).code){var t,e,s,r,h,n,a,l=s;switch(l.value){case 1:a|=lx.CM_OBSTACLE;break;case 2:a|=lx.CM_PLATFORM}}}return a},enumSounds:function(t){let e,s,r,h,n,a;for(r=0;r<this.nEvents;r++)for(h=0,e=this.events[r];h<e.evgNCond+e.evgNAct;h++)for(n=0,s=e.evgEvents[h];n<s.evtNParams;n++)switch(s.evtParams[n].code){case 6:case 35:a=s.evtParams[n],t.enumerate(a.sndHandle)}},HandleKeyRepeat:function(){let t,e,s,r;for(s=0;s<this.nEvents;s++)for(r=0,t=this.events[s];r<t.evgNCond;r++)if(-6==(e=t.evgEvents[r]).evtCode){t.evgInhibit=this.rhPtr.rhLoopCount;break}}},n9.EVGFLAGS_ONCE=1,n9.EVGFLAGS_NOTALWAYS=2,n9.EVGFLAGS_REPEAT=4,n9.EVGFLAGS_NOMORE=8,n9.EVGFLAGS_SHUFFLE=16,n9.EVGFLAGS_UNDOMARK=64,n9.EVGFLAGS_COMPLEXGROUP=128,n9.EVGFLAGS_BREAKPOINT=256,n9.EVGFLAGS_ALWAYSCLEAN=512,n9.EVGFLAGS_ORINGROUP=1024,n9.EVGFLAGS_STOPINGROUP=2048,n9.EVGFLAGS_ORLOGICAL=4096,n9.EVGFLAGS_GROUPED=8192,n9.EVGFLAGS_INACTIVE=16384,n9.EVGFLAGS_NOGOOD=32768,n9.EVGFLAGS_LIMITED=n9.EVGFLAGS_SHUFFLE+n9.EVGFLAGS_NOTALWAYS+n9.EVGFLAGS_REPEAT+n9.EVGFLAGS_NOMORE,n9.EVGFLAGS_DEFAULTMASK=n9.EVGFLAGS_BREAKPOINT+n9.EVGFLAGS_GROUPED,n9.create=function(t){let e,s=t.file.getFilePointer(),r=t.file.readShort(),h=new n9;h.evgNCond=t.file.readAByte(),h.evgNAct=t.file.readAByte(),h.evgFlags=t.file.readAShort(),t.file.skipBytes(2),h.evgInhibit=t.file.readAInt(),h.evgInhibitCpt=t.file.readAInt(),h.evgEvents=Array(h.evgNCond+h.evgNAct);let n=0;for(e=0;e<h.evgNCond;e++)h.evgEvents[n++]=iX.create(t);for(e=0;e<h.evgNAct;e++)h.evgEvents[n++]=I.create(t);return t.file.seek(s-r),h},at.EVFLAGS_REPEAT=1,at.EVFLAGS_DONE=2,at.EVFLAGS_DEFAULT=4,at.EVFLAGS_DONEBEFOREFADEIN=8,at.EVFLAGS_NOTDONEINSTART=16,at.EVFLAGS_ALWAYS=32,at.EVFLAGS_BAD=64,at.EVFLAGS_BADOBJECT=128,at.EVFLAGS_DEFAULTMASK=at.EVFLAGS_ALWAYS+at.EVFLAGS_REPEAT+at.EVFLAGS_DEFAULT+at.EVFLAGS_DONEBEFOREFADEIN+at.EVFLAGS_NOTDONEINSTART,at.EVFLAG2_NOT=1,ao.TIMEREVENTTYPE_ONESHOT=0,ao.TIMEREVENTTYPE_REPEAT=1,an.PARENT_NONE=0,an.PARENT_FRAME=1,an.PARENT_FRAMEITEM=2,an.PARENT_QUALIFIER=3,an.prototype={load:function(t){this.loHandle=t.readAShort(),this.loOiHandle=t.readAShort(),this.loX=t.readAInt(),this.loY=t.readAInt(),this.loParentType=t.readAShort(),this.loOiParentHandle=t.readAShort(),this.loLayer=t.readAShort(),t.skipBytes(2)},addInstance:function(t,e){this.loInstances[t]=e}},aa.prototype={load:function(t){this.nIndex=t.file.readAInt(),this.list=Array(this.nIndex);let e,s=0;for(e=0;e<this.nIndex;e++){this.list[e]=new an,this.list[e].load(t.file),this.list[e].loHandle+1>s&&(s=this.list[e].loHandle+1);let r=t.OIList.getOIFromHandle(this.list[e].loOiHandle);this.list[e].loType=r.oiType}for(e=0,this.handleToIndex=Array(s);e<this.nIndex;e++)this.handleToIndex[this.list[e].loHandle]=e},getLOFromIndex:function(t){return this.list[t]},getLOFromHandle:function(t){return t<this.handleToIndex.length?this.list[this.handleToIndex[t]]:null},next_LevObj:function(){let t;if(this.loFranIndex<this.nIndex)do if((t=this.list[this.loFranIndex++]).loType>=2)return t;while(this.loFranIndex<this.nIndex);return null},first_LevObj:function(){return this.loFranIndex=0,this.next_LevObj()}},al.FLOPT_XCOEF=1,al.FLOPT_YCOEF=2,al.FLOPT_NOSAVEBKD=4,al.FLOPT_VISIBLE=16,al.FLOPT_WRAP_HORZ=32,al.FLOPT_WRAP_VERT=64,al.FLOPT_REDRAW=65536,al.FLOPT_TOHIDE=131072,al.FLOPT_TOSHOW=262144,al.prototype={load:function(t){this.dwOptions=t.readAInt(),this.xCoef=t.readAFloat(),this.yCoef=t.readAFloat(),this.nBkdLOs=t.readAInt(),this.nFirstLOIndex=t.readAInt(),this.pName=t.readAString(),this.backUp_dwOptions=this.dwOptions,this.backUp_xCoef=this.xCoef,this.backUp_yCoef=this.yCoef,this.backUp_nBkdLOs=this.nBkdLOs,this.backUp_nFirstLOIndex=this.nFirstLOIndex},reset:function(){this.dwOptions=this.backUp_dwOptions,this.xCoef=this.backUp_xCoef,this.yCoef=this.backUp_yCoef,this.nBkdLOs=this.backUp_nBkdLOs,this.nFirstLOIndex=this.backUp_nFirstLOIndex,this.x=this.y=this.dx=this.dy=0,this.pObstacles=null,this.pPlatforms=null,this.pLadders=null,this.addedBackdrops=null,this.setAngle(0),this.scale=1,this.setScaleX(1),this.setScaleY(1),this.setXSpot(this.app.gaCxWin/2),this.setYSpot(this.app.gaCyWin/2),this.setXDest(this.app.gaCxWin/2),this.setYDest(this.app.gaCyWin/2),this.setZoom(!1),this.dwOptions&al.FLOPT_TOHIDE?(this.bVisible=!0,this.hide()):(this.bVisible=!1,this.show())},deleteBackObjects:function(){this.planeBack.removeAll()},addObstacle:function(t){null==this.pObstacles&&(this.pObstacles=new P),this.pObstacles.add(t)},delObstacle:function(t){null!=this.pObstacles&&this.pObstacles.removeObject(t)},addPlatform:function(t){null==this.pPlatforms&&(this.pPlatforms=new P),this.pPlatforms.add(t)},delPlatform:function(t){null!=this.pPlatforms&&this.pPlatforms.removeObject(t)},addBackdrop:function(t){null==this.addedBackdrops&&(this.addedBackdrops=new P),this.addedBackdrops.add(t)},resetLevelBackground:function(){this.pPlatforms=null,this.pObstacles=null,this.pLadders=null,this.addedBackdrops=null,this.planeBack.removeAll()},createPlanes:function(t,e){this.planeBack=new ly,this.planeBack.x=t,this.planeBack.y=e,this.planeQuickDisplay=new ly,this.planeQuickDisplay.x=t,this.planeQuickDisplay.y=e,this.planeSprites=new ly,this.planeSprites.x=t,this.planeSprites.y=e,this.setAngle(0),this.scale=1,this.setScaleX(1),this.setScaleY(1),this.setXSpot(this.app.gaCxWin/2),this.setYSpot(this.app.gaCyWin/2),this.setXDest(this.app.gaCxWin/2),this.setYDest(this.app.gaCyWin/2),this.setZoom(!1),this.app.mainSprite.addChild(this.planeBack),this.app.mainSprite.addChild(this.planeQuickDisplay),this.app.mainSprite.addChild(this.planeSprites),this.showHide()},setAngle:function(t){this.angle=t,this.planeBack.angle=t,this.planeQuickDisplay.angle=t,this.planeSprites.angle=t},setScaleX:function(t){this.scaleX=t,this.planeBack.scaleX=t,this.planeQuickDisplay.scaleX=t,this.planeSprites.scaleX=t},setScaleY:function(t){this.scaleY=t,this.planeBack.scaleY=t,this.planeQuickDisplay.scaleY=t,this.planeSprites.scaleY=t},setXSpot:function(t){this.xSpot=t,this.planeBack.xSpot=t,this.planeQuickDisplay.xSpot=t,this.planeSprites.xSpot=t},setYSpot:function(t){this.ySpot=t,this.planeBack.ySpot=t,this.planeQuickDisplay.ySpot=t,this.planeSprites.ySpot=t},setXDest:function(t){t=this.app.gaCxWin-t,this.xDest=t,this.planeBack.xDest=t,this.planeQuickDisplay.xDest=t,this.planeSprites.xDest=t},setYDest:function(t){t=this.app.gaCyWin-t,this.yDest=t,this.planeBack.yDest=t,this.planeQuickDisplay.yDest=t,this.planeSprites.yDest=t},setZoom:function(t){this.bZoom=t,this.planeBack.bZoom=t,this.planeQuickDisplay.bZoom=t,this.planeSprites.bZoom=t},resetPlanes:function(t,e){this.planeBack.x=t,this.planeBack.y=e,this.planeQuickDisplay.x=t,this.planeQuickDisplay.y=e,this.planeSprites.x=t,this.planeSprites.y=e,this.show()},fillBack:function(t,e,s){},showHide:function(){this.dwOptions&al.FLOPT_VISIBLE?this.show():this.hide()},hide:function(){this.dwOptions&=~al.FLOPT_TOHIDE,this.bVisible&&(this.planeBack.visible=!1,this.planeQuickDisplay.visible=!1,this.planeSprites.visible=!1,this.bVisible=!1)},show:function(){!1==this.bVisible&&(this.planeBack.visible=!0,this.planeQuickDisplay.visible=!0,this.planeSprites.visible=!0,this.bVisible=!0)},deletePlanes:function(){null!=this.planeBack&&(this.app.mainSprite.removeChild(this.planeBack),this.planeBack=null),null!=this.planeQuickDisplay&&(this.app.mainSprite.removeChild(this.planeQuickDisplay),this.planeQuickDisplay=null),null!=this.planeSprites&&(this.app.mainSprite.removeChild(this.planeSprites),this.planeSprites=null)},deleteAddedBackdrops:function(){let t;if(null!=this.addedBackdrops)for(t=0;t<this.addedBackdrops.size();t++){let e=this.addedBackdrops.get(t);e.delInstance(this),null!=e.body&&this.app.run.rh4Box2DBase.rSubABackdrop(e.body)}this.addedBackdrops=null},deleteAddedBackdropsAt:function(t,e,s){if(t+=this.x,e+=this.y,null!=this.addedBackdrops)for(r=0;r<this.addedBackdrops.size();r++){var r,h=this.addedBackdrops.get(r);if(t>=h.x&&t<h.x+h.width&&e>=h.y&&e<h.y+h.height){let n=!0;if(s&&(n=h.testPoint(t,e)),n){h.delInstance(this),this.addedBackdrops.removeObject(h),null!=h.body&&this.app.run.rh4Box2DBase.rSubABackdrop(h.body);return}}}},addLadder:function(t,e,s,r){let h=new E;h.left=t,h.top=e,h.right=s,h.bottom=r,null==this.pLadders&&(this.pLadders=new P),this.pLadders.add(h)},ladderSub:function(t,e,s,r){if(null!=pLadders){let h,n,a=new E;for(h=0,a.left=Math.min(t,s),a.top=Math.min(e,r),a.right=Math.max(t,s),a.bottom=Math.max(e,r);h<pLadders.size();h++)!0==(n=this.pLadders.get(h)).intersectRect(a)&&(this.pLadders.removeIndex(h),h--)}},getLadderAt:function(t,e){let s,r;if(t+=this.x,e+=this.y,null!=this.pLadders){for(s=0;s<this.pLadders.size();s++)if(t>=(r=this.pLadders.get(s)).left&&e>=r.top&&t<r.right&&e<r.bottom)return r}return null},testMask:function(t,e,s,r,h){let n,a,l,u=e+this.x-t.xSpot,d=s+this.y-t.ySpot,p=u+t.width,m=d+t.height,f=d;if(0!=r&&(f=m-r),null==(l=h==lx.CM_TEST_OBSTACLE?this.pObstacles:this.pPlatforms))return null;for(n=0;n<l.size();n++)if((a=l.get(n)).x<p&&a.x+a.width>u&&a.y<m&&a.y+a.height>f&&a.testMask(t,u,d,r))return a;return null},testRect:function(t,e,s,r,h,n){if(null==(a=n==lx.CM_TEST_OBSTACLE?this.pObstacles:this.pPlatforms))return null;for(t+=this.x,e+=this.y,s+=this.x,r+=this.y,0!=h&&(e=r-h),l=0;l<a.size();l++){var a,l,u=a.get(l);if(u.x<s&&u.x+u.width>t&&u.y<r&&u.y+u.height>e&&u.testRect(t,e,s,r))return u}return null},testPoint:function(t,e,s){if(null==(r=s==lx.CM_TEST_OBSTACLE?this.pObstacles:this.pPlatforms))return null;for(t+=this.x,e+=this.y,h=0;h<r.size();h++){var r,h,n=r.get(h);if(t>=n.x&&t<n.x+n.width&&e>=n.y&&e<n.y+n.height&&n.testPoint(t,e))return n}return null}},au.prototype={draw:function(t,e,s){if(null!=this.levelObject){if(this.type==ac.OBJ_BOX){let r,h=this.poi.oiOC;switch(h.ocFillType){case 0:break;case 1:switch(h.ocShape){case 1:t.renderLine(e+this.x,s+this.y,this.width,this.height,this.color1,this.effect,this.effectParam);break;case 2:t.renderSolidColor(e+this.x,s+this.y,this.width,this.height,this.color1,this.effect,this.effectParam);break;case 3:t.renderSolidColorEllipse(e+this.x,s+this.y,this.width,this.height,this.color1,this.effect,this.effectParam)}break;case 2:switch(h.ocShape){case 1:t.renderLine(e+this.x,s+this.y,this.width,this.height,this.color1,this.effect,this.effectParam);break;case 2:t.renderGradient(e+this.x,s+this.y,this.width,this.height,this.color1,this.color2,0!=this.gradientFlags,this.effect,this.effectParam);break;case 3:t.renderGradientEllipse(e+this.x,s+this.y,this.width,this.height,this.color1,this.color2,0!=this.gradientFlags,this.effect,this.effectParam)}break;case 3:switch(h.ocShape){case 1:break;case 2:r=this.app.imageBank.getImageFromHandle(h.ocImage),t.renderPattern(r,e+this.x,s+this.y,this.width,this.height,this.effect,this.effectParam);break;case 3:r=this.app.imageBank.getImageFromHandle(h.ocImage),t.renderPatternEllipse(r,e+this.x,s+this.y,this.width,this.height,this.effect,this.effectParam)}}if(this.borderWidth>0)switch(h.ocShape){case 1:var n=0,a=0,l=this.width,u=this.height;(h.ocLineFlags&af.LINEF_INVX)!=0&&(n+=l,l=-l),(h.ocLineFlags&af.LINEF_INVY)!=0&&(a+=u,u=-u),t.renderLine(e+this.x+n,s+this.y+a,e+this.x+n+l,s+this.y+a+u,this.borderColor,this.borderWidth);break;case 2:t.renderRect(e+this.x,s+this.y,this.width,this.height,this.borderColor,this.borderWidth);break;case 3:t.renderEllipse(e+this.x,s+this.y,this.width,this.height,1,this.borderColor,this.borderWidth)}}else this.type==ac.OBJ_BKD?t.renderImageWithSubPixelCorrection(this.imageUsed,e+this.x+this.imageUsed.xSpot,s+this.y+this.imageUsed.ySpot,0,1,1,this.effect,this.effectParam):null!=this.ho&&this.ho.draw(t,e,s)}else t.renderImage(this.imageUsed,e+this.x+this.imageUsed.xSpot,s+this.y+this.imageUsed.ySpot,0,1,1,this.effect,this.effectParam)},setEffect:function(t,e){this.effect=t,this.effectParam=e},addInstance:function(t,e){switch(e.planeBack.addChild(this),this.type==ac.OBJ_PASTED&&e.addBackdrop(this),this.obstacleType){case ap.OBSTACLE_SOLID:e.addObstacle(this),e.addPlatform(this);break;case ap.OBSTACLE_PLATFORM:e.addPlatform(this);break;case ap.OBSTACLE_LADDER:e.addLadder(this.x,this.y,this.x+this.width,this.y+this.height)}},delInstance:function(t){switch(t.planeBack.removeChild(this),this.obstacleType){case ap.OBSTACLE_SOLID:t.delObstacle(this),t.delPlatform(this);break;case ap.OBSTACLE_PLATFORM:t.delPlatform(this);break;case ap.OBSTACLE_LADDER:t.ladderSub(x,y,x+width,y+height)}},testMask:function(t,e,s,r){switch(this.type){case 0:var h,n,a=this.height;return this.obstacleType==ap.OBSTACLE_PLATFORM&&(a=nR.HEIGHT_PLATFORM),t.testRect2(e,s,r,this.x,this.y,this.width,a,0);case 1:case 11:if(0!=this.colBox)return!0;return h=lR.GCMF_OBSTACLE,this.obstacleType==ap.OBSTACLE_PLATFORM&&(h=lR.GCMF_PLATFORM),n=this.imageUsed.getMask(h,0,1,1),t.testMask(e,s,r,n,this.x,this.y,0)}return!1},testRect:function(t,e,s,r){switch(this.type){case 0:if(this.obstacleType==ap.OBSTACLE_PLATFORM){var h,n,a=this.y,l=this.y+Math.min(this.height,nR.HEIGHT_PLATFORM);if(a<r&&l>e)return!0;break}return!0;case 1:case 11:if(0!=this.colBox)return!0;return h=lR.GCMF_OBSTACLE,this.obstacleType==ap.OBSTACLE_PLATFORM&&(h=lR.GCMF_PLATFORM),(n=this.imageUsed.getMask(h,0,1,1)).testRect2(this.x,this.y,0,t,e,s,r,0)}return!1},testPoint:function(t,e){switch(this.type){case 0:if(this.obstacleType==ap.OBSTACLE_PLATFORM){var s,r,h=y+this.height-nR.HEIGHT_PLATFORM,n=this.y+this.height;if(e>=h&&e<n)return!0;break}return!0;case 1:case 11:if(0!=this.colBox)return!0;return s=lR.GCMF_OBSTACLE,this.obstacleType==ap.OBSTACLE_PLATFORM&&(s=lR.GCMF_PLATFORM),(r=this.imageUsed.getMask(s,0,1,1)).testPoint(this.x,this.y,t,e)}return!1}},ac.OILF_OCLOADED=1,ac.OILF_ELTLOADED=2,ac.OILF_TOLOAD=4,ac.OILF_TODELETE=8,ac.OILF_CURFRAME=16,ac.OILF_TORELOAD=32,ac.OILF_IGNORELOADONCALL=64,ac.OIF_LOADONCALL=1,ac.OIF_DISCARDABLE=2,ac.OIF_GLOBAL=4,ac.NUMBEROF_SYSTEMTYPES=7,ac.OBJ_PLAYER=-7,ac.OBJ_KEYBOARD=-6,ac.OBJ_CREATE=-5,ac.OBJ_TIMER=-4,ac.OBJ_GAME=-3,ac.OBJ_SPEAKER=-2,ac.OBJ_SYSTEM=-1,ac.OBJ_BOX=0,ac.OBJ_BKD=1,ac.OBJ_SPR=2,ac.OBJ_TEXT=3,ac.OBJ_QUEST=4,ac.OBJ_SCORE=5,ac.OBJ_LIVES=6,ac.OBJ_COUNTER=7,ac.OBJ_RTF=8,ac.OBJ_CCA=9,ac.NB_SYSOBJ=10,ac.OBJ_PASTED=11,ac.OBJ_LAST=10,ac.KPX_BASE=32,ac.OIFLAG_QUALIFIER=32768,ac.prototype={loadHeader:function(t){this.oiHandle=t.readAShort(),this.oiType=t.readAShort(),this.oiFlags=t.readAShort(),t.skipBytes(2),this.oiInkEffect=t.readAInt(),this.oiInkEffectParam=t.readAInt()},load:function(t){switch(t.seek(this.oiFileOffset),this.oiType){case 0:this.oiOC=new af;break;case 1:this.oiOC=new am;break;default:this.oiOC=new a$}this.oiOC.load(t,this.oiType),this.oiLoadFlags=0},unLoad:function(){this.oiOC=null},enumElements:function(t,e){this.oiOC.enumElements(t,e)}},ad.prototype={preLoad:function(t){for(s=0,this.oiMaxIndex=t.readAInt(),this.ois=Array(this.oiMaxIndex),this.oiMaxHandle=0;s<this.oiMaxIndex;s++)for(var e,s,r,h,n,a=0;32639!=a;)if(a=t.readAShort(),r=t.readAShort(),0!=(h=t.readAInt())){switch(n=t.getFilePointer()+h,a){case 17476:this.ois[s]=new ac,this.ois[s].loadHeader(t),this.ois[s].oiHandle>=this.oiMaxHandle&&(this.oiMaxHandle=this.ois[s].oiHandle+1);break;case 17477:this.ois[s].oiName=t.readAString();break;case 17478:this.ois[s].oiFileOffset=t.getFilePointer()}t.seek(n)}for(s=0,this.oiHandleToIndex=Array(this.oiMaxHandle);s<this.oiMaxIndex;s++)this.oiHandleToIndex[this.ois[s].oiHandle]=s;for(e=0,this.oiToLoad=Array(this.oiMaxHandle),this.oiLoaded=Array(this.oiMaxHandle);e<this.oiMaxHandle;e++)this.oiToLoad[e]=0,this.oiLoaded[e]=0},getOIFromHandle:function(t){return this.ois[this.oiHandleToIndex[t]]},getOIFromIndex:function(t){return this.ois[t]},resetOICurrent:function(){let t;for(t=0;t<this.oiMaxIndex;t++)this.ois[t].oiFlags&=~ac.OILF_CURFRAME},setOICurrent:function(t){this.ois[this.oiHandleToIndex[t]].oiFlags|=ac.OILF_CURFRAME},getFirstOI:function(){let t;for(t=0;t<this.oiMaxIndex;t++)if((this.ois[t].oiFlags&ac.OILF_CURFRAME)!=0)return this.currentOI=t,this.ois[t];return null},getNextOI:function(){if(this.currentOI<this.oiMaxIndex){let t;for(t=this.currentOI+1;t<this.oiMaxIndex;t++)if((this.ois[t].oiFlags&ac.OILF_CURFRAME)!=0)return this.currentOI=t,this.ois[t]}return null},resetToLoad:function(){let t;for(t=0;t<this.oiMaxHandle;t++)this.oiToLoad[t]=0},setToLoad:function(t){this.oiToLoad[t]=1},load:function(t){let e;for(e=0;e<this.oiMaxHandle;e++)0!=this.oiToLoad[e]?(0==this.oiLoaded[e]||0!=this.oiLoaded[e]&&(this.ois[this.oiHandleToIndex[e]].oiLoadFlags&ac.OILF_TORELOAD)!=0)&&(this.ois[this.oiHandleToIndex[e]].load(t),this.oiLoaded[e]=1):0!=this.oiLoaded[e]&&(this.ois[this.oiHandleToIndex[e]].unLoad(),this.oiLoaded[e]=0);this.resetToLoad()},enumElements:function(t,e){let s;for(s=0;s<this.oiMaxHandle;s++)0!=this.oiLoaded[s]&&this.ois[this.oiHandleToIndex[s]].enumElements(t,e)}},ap.OBSTACLE_NONE=0,ap.OBSTACLE_SOLID=1,ap.OBSTACLE_PLATFORM=2,ap.OBSTACLE_LADDER=3,ap.OBSTACLE_TRANSPARENT=4,am.prototype={load:function(t,e){t.skipBytes(4),this.ocObstacleType=t.readAShort(),this.ocColMode=t.readAShort(),this.ocCx=t.readAInt(),this.ocCy=t.readAInt(),this.ocImage=t.readAShort()},enumElements:function(t,e){if(null!=t){let s=t.enumerate(this.ocImage);-1!=s&&(this.ocImage=s)}}},af.LINEF_INVX=1,af.LINEF_INVY=2,af.prototype={load:function(t,e){if(t.skipBytes(4),this.ocObstacleType=t.readAShort(),this.ocColMode=t.readAShort(),this.ocCx=t.readAInt(),this.ocCy=t.readAInt(),this.ocBorderSize=t.readAShort(),this.ocBorderColor=t.readAColor(),this.ocShape=t.readAShort(),this.ocFillType=t.readAShort(),1==this.ocShape)this.ocLineFlags=t.readAShort();else switch(this.ocFillType){case 1:this.ocColor1=this.ocColor2=t.readAColor();break;case 2:this.ocColor1=t.readAColor(),this.ocColor2=t.readAColor(),this.ocGradientFlags=t.readAInt();break;case 3:this.ocImage=t.readAShort()}},enumElements:function(t,e){if(3==this.ocFillType&&null!=t){let s=t.enumerate(this.ocImage);-1!=s&&(ocImage=s)}}},a$.OEFLAG_DISPLAYINFRONT=1,a$.OEFLAG_BACKGROUND=2,a$.OEFLAG_BACKSAVE=4,a$.OEFLAG_RUNBEFOREFADEIN=8,a$.OEFLAG_MOVEMENTS=16,a$.OEFLAG_ANIMATIONS=32,a$.OEFLAG_TABSTOP=64,a$.OEFLAG_WINDOWPROC=128,a$.OEFLAG_VALUES=256,a$.OEFLAG_SPRITES=512,a$.OEFLAG_INTERNALBACKSAVE=1024,a$.OEFLAG_SCROLLINGINDEPENDANT=2048,a$.OEFLAG_QUICKDISPLAY=4096,a$.OEFLAG_NEVERKILL=8192,a$.OEFLAG_NEVERSLEEP=16384,a$.OEFLAG_MANUALSLEEP=32768,a$.OEFLAG_TEXT=65536,a$.OEFLAG_DONTCREATEATSTART=131072,a$.OEFLAG_DONTRESETANIMCOUNTER=1048576,a$.OCFLAGS2_DONTSAVEBKD=1,a$.OCFLAGS2_SOLIDBKD=2,a$.OCFLAGS2_COLBOX=4,a$.OCFLAGS2_VISIBLEATSTART=8,a$.OCFLAGS2_OBSTACLESHIFT=4,a$.OCFLAGS2_OBSTACLEMASK=48,a$.OCFLAGS2_OBSTACLE_SOLID=16,a$.OCFLAGS2_OBSTACLE_PLATFORM=32,a$.OCFLAGS2_OBSTACLE_LADDER=48,a$.OCFLAGS2_AUTOMATICROTATION=64,a$.OCFLAGS2_INITFLAGS=128,a$.OEPREFS_BACKSAVE=1,a$.OEPREFS_SCROLLINGINDEPENDANT=2,a$.OEPREFS_QUICKDISPLAY=4,a$.OEPREFS_SLEEP=8,a$.OEPREFS_LOADONCALL=16,a$.OEPREFS_GLOBAL=32,a$.OEPREFS_BACKEFFECTS=64,a$.OEPREFS_KILL=128,a$.OEPREFS_INKEFFECTS=256,a$.OEPREFS_TRANSITIONS=512,a$.OEPREFS_FINECOLLISIONS=1024,a$.prototype=ap,a$.prototype={load:function(t,e){let s,r=t.getFilePointer();this.ocQualifiers=Array(8),t.skipBytes(4),t.skipBytes(2);let h=t.readAShort();t.skipBytes(2);let n=t.readAShort(),a=t.readAShort(),l=t.readAShort();for(s=0,this.ocOEFlags=t.readAInt();s<8;s++)this.ocQualifiers[s]=t.readShort();this.ocOEPrefs=t.readAShort();let u=t.readAShort(),d=t.readAShort();this.ocFlags2=t.readAShort();let p=t.readAShort();this.ocIdentifier=t.readAInt(),this.ocBackColor=t.readAColor();let m=t.readAInt(),f=t.readAInt();if(this.ocFadeIn=null,this.ocFadeOut=null,0!=l&&(t.seek(r+l),this.ocMovements=new lG,this.ocMovements.load(t)),0!=u&&(t.seek(r+u),this.ocValues=new lk,this.ocValues.load(t,(this.ocFlags2&a$.OCFLAGS2_INITFLAGS)!=0)),0!=d&&(t.seek(r+d),this.ocStrings=new lw,this.ocStrings.load(t)),0!=a&&(t.seek(r+a),this.ocAnimations=new nj,this.ocAnimations.load(t)),0!=n&&(t.seek(r+n),this.ocObject=new aP,this.ocObject.load(t)),0!=p){t.seek(r+p);let $=t.readAInt();t.skipBytes(4),this.ocVersion=t.readAInt(),this.ocID=t.readAInt(),this.ocPrivate=t.readAInt(),0!=($-=20)&&(this.ocExtension=t.getFilePointer())}if(0!=m&&(t.seek(r+m),this.ocFadeIn=new aK,this.ocFadeIn.load(t)),0!=f&&(t.seek(r+f),this.ocFadeOut=new aK,this.ocFadeOut.load(t)),0!=h)switch(t.seek(r+h),e){case 3:case 4:this.ocObject=new aA,this.ocObject.load(t);break;case 5:case 6:case 7:this.ocCounters=new a8,this.ocCounters.load(t);break;case 8:this.ocObject=new aE,this.ocObject.load(t),this.ocOEFlags&=~(a$.OEFLAG_SPRITES|a$.OEFLAG_QUICKDISPLAY|a$.OEFLAG_BACKSAVE);break;case 9:this.ocObject=new ag,this.ocObject.load(t)}},enumElements:function(t,e){null!=this.ocAnimations&&this.ocAnimations.enumElements(t),null!=this.ocObject&&this.ocObject.enumElements(t,e),null!=this.ocCounters&&this.ocCounters.enumElements(t,e)}},ag.prototype={load:function(t){t.skipBytes(4),this.odCx=t.readAInt(),this.odCy=t.readAInt(),this.odVersion=t.readAShort(),this.odNStartFrame=t.readAShort(),this.odOptions=t.readAInt(),t.skipBytes(8),this.odName=t.readAString()},enumElements:function(t,e){}},aP.prototype={load:function(t){t.skipBytes(2),this.ctInit=t.readAInt(),this.ctMini=t.readAInt(),this.ctMaxi=t.readAInt()},enumElements:function(t,e){}},a8.CTA_HIDDEN=0,a8.CTA_DIGITS=1,a8.CTA_VBAR=2,a8.CTA_HBAR=3,a8.CTA_ANIM=4,a8.CTA_TEXT=5,a8.BARFLAG_INVERSE=256,a8.prototype={load:function(t){switch(t.skipBytes(4),this.odCx=t.readAInt(),this.odCy=t.readAInt(),this.odPlayer=t.readAShort(),this.odDisplayType=t.readAShort(),this.odDisplayFlags=t.readAShort(),this.odFont=t.readAShort(),this.odDisplayType){case 0:break;case 1:case 4:var e;for(e=0,this.nFrames=t.readAShort(),this.frames=Array(this.nFrames);e<this.nFrames;e++)this.frames[e]=t.readAShort();break;case 2:case 3:case 5:if(this.ocBorderSize=t.readAShort(),this.ocBorderColor=t.readAColor(),this.ocShape=t.readAShort(),this.ocFillType=t.readAShort(),1==this.ocShape)this.ocLineFlags=t.readAShort();else switch(this.ocFillType){case 1:this.ocColor1=t.readAColor();break;case 2:this.ocColor1=t.readAColor(),this.ocColor2=t.readAColor(),this.ocGradientFlags=t.readAInt()}}},enumElements:function(t,e){let s,r;switch(this.odDisplayType){case 1:case 4:for(r=0;r<this.nFrames;r++)null!=t&&(s=t.enumerate(this.frames[r]));break;case 5:null!=e&&(s=e.enumerate(this.odFont))}}},aE.prototype={load:function(t){this.odDWSize=t.readAInt(),this.odVersion=t.readAInt(),this.odOptions=t.readAInt(),this.odBackColor=t.readAColor(),this.odCx=t.readAInt(),this.odCy=t.readAInt(),t.skipBytes(4);let e=t.readAInt();this.text=t.readAString(e)},enumElements:function(t,e){}},a_.TSF_LEFT=0,a_.TSF_HCENTER=1,a_.TSF_RIGHT=2,a_.TSF_VCENTER=4,a_.TSF_HALIGN=15,a_.TSF_CORRECT=256,a_.TSF_RELIEF=512,a_.prototype={load:function(t){this.tsFont=t.readShort(),this.tsFlags=t.readAShort(),this.tsColor=t.readAColor(),this.tsText=t.readAString()},enumElements:function(t,e){null!=e&&e.enumerate(this.tsFont)}},aA.prototype={load:function(t){let e,s=t.getFilePointer();t.skipBytes(4),this.otCx=t.readAInt(),this.otCy=t.readAInt(),this.otNumberOfText=t.readAInt(),this.otTexts=Array(this.otNumberOfText);let r=Array(this.otNumberOfText);for(e=0;e<this.otNumberOfText;e++)r[e]=t.readAInt();for(e=0;e<this.otNumberOfText;e++)this.otTexts[e]=new a_,t.seek(s+r[e]),this.otTexts[e].load(t)},enumElements:function(t,e){let s;for(s=0;s<this.otNumberOfText;s++)this.otTexts[s].enumElements(t,e)}},a0.HOF_DESTROYED=1,a0.HOF_TRUEEVENT=2,a0.HOF_REALSPRITE=4,a0.HOF_FADEIN=8,a0.HOF_FADEOUT=16,a0.HOF_OWNERDRAW=32,a0.HOF_NOCOLLISION=8192,a0.HOF_FLOAT=16384,a0.HOF_STRING=32768,a0.prototype={setScale:function(t,e){if(this.roc.rcScaleX!=t||this.roc.rcScaleY!=e){t>=0&&(this.roc.rcScaleX=t),e>=0&&(this.roc.rcScaleY=e),this.roc.rcChanged=!0;let s=this.hoAdRunHeader.rhApp.imageBank.getImageInfoEx(this.roc.rcImage,this.roc.rcAngle,this.roc.rcScaleX,this.roc.rcScaleY);this.hoImgWidth=s.width,this.hoImgHeight=s.height,this.hoImgXSpot=s.xSpot,this.hoImgYSpot=s.ySpot}},shtCreate:function(t,e,s,r){let h=this.hoLayer,n=this.hoAdRunHeader.f_CreateObject(t.cdpHFII,t.cdpOi,e,s,r,nD.COF_NOMOVEMENT|nD.COF_HIDDEN,h,-1);if(n>=0){let a=this.hoAdRunHeader.rhObjectList[n];null!=a.rom?(a.roc.rcDir=r,a.rom.initSimple(a,l6.MVTYPE_BULLET,!1),a.roc.rcSpeed=t.shtSpeed,a.rom.rmMovement.init2(this),-1!=h&&(a.hoOEFlags&a$.OEFLAG_SPRITES)!=0&&(this.hoAdRunHeader.rhFrame.layers[h].dwOptions&(al.FLOPT_TOHIDE|al.FLOPT_VISIBLE))!=al.FLOPT_VISIBLE&&a.ros.obHide(),this.hoAdRunHeader.rhEvtProg.evt_AddCurrentObject(a),(this.hoOEFlags&a$.OEFLAG_ANIMATIONS)!=0&&this.roa.anim_Exist(nY.ANIMID_SHOOT)&&(this.roa.animation_Force(nY.ANIMID_SHOOT),this.roa.animation_OneLoop())):this.hoAdRunHeader.destroy_Add(a.hoNumber)}},fixedValue:function(){return this.hoCreationId<<16|65535&this.hoNumber},init:function(t,e){},handle:function(){},callComputeNewDisplay:function(){},createFont:function(){},display:function(){},kill:function(t){},getSurface:function(t){return!1},getCollisionMask:function(t){return null},setEffect:function(t,e){},addSprite:function(t,e,s,r,h){},addOwnerDrawSprite:function(t,e,s,r,h,n){},delSprite:function(){return 0},showSprite:function(){},hideSprite:function(){},setTransparency:function(t){},getChildIndex:function(){return -1},getChildMaxIndex:function(){return 0},setChildIndex:function(t){},autoResize:function(){},forcePosition:function(){}},av.prototype=h.extend(new a0,{handle:function(){this.ros.handle(),this.roc.rcChanged&&(this.roc.rcChanged=!1)},addSprite:function(t,e,s,r,h){this.nLayer=r,this.pLayer=this.hoAdRunHeader.rhFrame.layers[r],this.bShown=h,this.pLayer.planeSprites.addChild(this)},draw:function(t,e,s){if(this.bShown&&((this.hoFlags&a0.HOF_FADEIN)==0||this.ros.rsTrans)){let r=this.ros.rsEffect;this.ros.rsFlags&l2.RSFLAG_ROTATE_ANTIA&&(r|=l2.BOP_SMOOTHING);let h=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(this.roc.rcImage);h&&(this.transitionImage?t.renderSimpleImage(this.transitionImage,e+this.hoX-this.hoAdRunHeader.rhWindowX+this.pLayer.x-h.xSpot,s+this.hoY-this.hoAdRunHeader.rhWindowY+this.pLayer.y-h.ySpot,this.transitionImage.width*this.roc.rcScaleX,this.transitionImage.height*this.roc.rcScaleY,r,this.ros.rsEffectParam):t.renderImage(h,e+this.hoX-this.hoAdRunHeader.rhWindowX+this.pLayer.x,s+this.hoY-this.hoAdRunHeader.rhWindowY+this.pLayer.y,this.roc.rcAngle,this.roc.rcScaleX,this.roc.rcScaleY,r,this.ros.rsEffectParam))}},delSprite:function(){return this.pLayer.planeSprites.removeChild(this)},showSprite:function(){this.bShown=!0},hideSprite:function(){this.bShown=!1},getChildIndex:function(){return this.pLayer.planeSprites.getChildIndex(this)},getChildMaxIndex:function(){return this.pLayer.planeSprites.children.length},setChildIndex:function(t){t>=this.pLayer.planeSprites.children.length&&(t=this.pLayer.planeSprites.children.length),t<0&&(t=0),this.pLayer.planeSprites.setChildIndex(this,t)},setTransparency:function(t){this.ros.rsEffect=l2.BOP_BLEND,this.ros.rsEffectParam=t}}),aO.CCAF_SHARE_GLOBALVALUES=1,aO.CCAF_SHARE_LIVES=2,aO.CCAF_SHARE_SCORES=4,aO.CCAF_SHARE_WINATTRIB=8,aO.CCAF_STRETCH=16,aO.CCAF_POPUP=32,aO.CCAF_CAPTION=64,aO.CCAF_TOOLCAPTION=128,aO.CCAF_BORDER=256,aO.CCAF_WINRESIZE=512,aO.CCAF_SYSMENU=1024,aO.CCAF_DISABLECLOSE=2048,aO.CCAF_MODAL=4096,aO.CCAF_DIALOGFRAME=8192,aO.CCAF_INTERNAL=16384,aO.CCAF_HIDEONCLOSE=32768,aO.CCAF_CUSTOMSIZE=65536,aO.CCAF_INTERNALABOUTBOX=131072,aO.CCAF_CLIPSIBLINGS=262144,aO.CCAF_SHARE_PLAYERCTRLS=524288,aO.CCAF_MDICHILD=1048576,aO.CCAF_DOCKED=2097152,aO.CCAF_DOCKING_AREA=12582912,aO.CCAF_DOCKED_LEFT=0,aO.CCAF_DOCKED_TOP=4194304,aO.CCAF_DOCKED_RIGHT=8388608,aO.CCAF_DOCKED_BOTTOM=12582912,aO.CCAF_REOPEN=16777216,aO.CCAF_MDIRUNEVENIFNOTACTIVE=33554432,aO.prototype=h.extend(new a0,{startCCA:function(t,e,s){let r=t.ocObject;this.hoImgWidth=r.odCx,this.hoImgHeight=r.odCy,this.odOptions=r.odOptions,(this.odOptions&aO.CCAF_STRETCH)!=0&&(this.odOptions|=aO.CCAF_CUSTOMSIZE),-1==s&&(s=0,(this.odOptions&aO.CCAF_INTERNAL)!=0&&(s=r.odNStartFrame)),null==r.odName||0!=r.odName.length||(this.odOptions&aO.CCAF_INTERNAL)==0||s>=this.hoAdRunHeader.rhApp.gaNbFrames||s==this.hoAdRunHeader.rhApp.currentFrame||((t.ocFlags2&a$.OCFLAGS2_VISIBLEATSTART)!=0?this.bVisible=!0:this.bVisible=!1,this.appSprite=new ly,this.appSprite.x=this.hoX-this.hoAdRunHeader.rhWindowX,this.appSprite.y=this.hoY-this.hoAdRunHeader.rhWindowY,this.hoAdRunHeader.rhApp.mainSprite.addChild(this),this.oldX=this.hoX,this.oldY=this.hoY,this.subApp=new ny(this.hoAdRunHeader.rhApp,this.hoAdRunHeader.rhApp.file,this.hoAdRunHeader.rhApp.path,!0),this.subApp.setParentApp(this.hoAdRunHeader.rhApp,s,this.odOptions,this.appSprite,this.hoImgWidth,this.hoImgHeight),this.subApp.digest(),(this.odOptions&aO.CCAF_MODAL)!=0&&null==this.hoAdRunHeader.rhApp.modalSubappObject&&(this.hoAdRunHeader.rhApp.modalSubappObject=this,this.hoAdRunHeader.rhApp.run.pause()),this.subApp.startApplication(),this.subApp.setMouseOffsets((this.hoAdRunHeader.rhApp.xMouseOffset+this.appSprite.x)*this.hoAdRunHeader.rhApp.scaleX,(this.hoAdRunHeader.rhApp.yMouseOffset+this.appSprite.y)*this.hoAdRunHeader.rhApp.scaleY),this.subApp.stepApplication(),this.hoAdRunHeader.rhApp.subApps.push(this.subApp))},init:function(t,e){this.startCCA(t,!0,-1)},handle:function(){if(this.rom.move(),null!=this.subApp){if((this.oldX!=this.hoX||this.oldY!=this.hoY)&&(this.appSprite.x=this.hoX-this.hoAdRunHeader.rhWindowX,this.appSprite.y=this.hoY-this.hoAdRunHeader.rhWindowY,this.oldX=this.hoX,this.oldY=this.hoY,this.subApp.setMouseOffsets(this.appSprite.x*this.hoAdRunHeader.rhApp.scaleX,this.appSprite.y*this.hoAdRunHeader.rhApp.scaleY),this.updateChildControlPos()),!1==this.subApp.stepApplication()){this.destroyObject(),(this.odOptions&aO.CCAF_MODAL)!=0&&null!=this.subApp.parentApp&&this.subApp.parentApp.modalSubappObject==this&&(this.subApp.parentApp.modalSubappObject=null,this.subApp.parentApp.run.resume()),this.subApp=null;return}this.oldLevel=this.level,this.level=this.subApp.currentFrame}},draw:function(t,e,s){this.bVisible&&null!=this.subApp&&this.subApp.drawSubApplication(t,this.appSprite.x,this.appSprite.y)},kill:function(t){null!=this.subApp&&(3===this.subApp.appRunningState&&this.subApp.endFrame(),this.destroyObject(),this.subApp.endApplication(),(this.odOptions&aO.CCAF_MODAL)!=0&&null!=this.subApp.parentApp&&this.subApp.parentApp.modalSubappObject==this&&(this.subApp.parentApp.modalSubappObject=null,this.subApp.parentApp.run.resume()),this.subApp=null)},destroyObject:function(){let t;for(t=0;t<this.hoAdRunHeader.rhApp.subApps.length;t++)if(this.hoAdRunHeader.rhApp.subApps[t]==this.subApp){this.hoAdRunHeader.rhApp.subApps.splice(t,1);break}this.hoAdRunHeader.rhApp.mainSprite.removeChild(this.appSprite)},restartApp:function(){if(null!=this.subApp){if(null!=this.subApp.run){this.subApp.run.rhQuit=nD.LOOPEXIT_NEWGAME;return}this.kill(!0)}this.startCCA(this.hoCommon,!1,-1)},endApp:function(){null!=this.subApp&&(null!=this.subApp.run&&(this.subApp.run.rhQuit=nD.LOOPEXIT_ENDGAME),(this.odOptions&aO.CCAF_MODAL)!=0&&null!=this.subApp.parentApp&&this.subApp.parentApp.modalSubappObject==this&&(this.subApp.parentApp.modalSubappObject=null,this.subApp.parentApp.run.resume()))},hide:function(){this.bVisible=!1},show:function(){this.bVisible=!0},jumpFrame:function(t){null!=this.subApp&&null!=this.subApp.run&&t>=0&&t<4096&&(this.subApp.run.rhQuit=nD.LOOPEXIT_GOTOLEVEL,this.subApp.run.rhQuitParam=32768|t)},nextFrame:function(){null!=this.subApp&&null!=this.subApp.run&&(this.subApp.run.rhQuit=nD.LOOPEXIT_NEXTLEVEL)},previousFrame:function(){null!=this.subApp&&null!=this.subApp.run&&(this.subApp.run.rhQuit=nD.LOOPEXIT_PREVLEVEL)},restartFrame:function(){null!=this.subApp&&null!=this.subApp.run&&(this.subApp.run.rhQuit=nD.LOOPEXIT_RESTART)},pause:function(){null!=this.subApp&&null!=this.subApp.run&&this.subApp.run.pause()},resume:function(){null!=this.subApp&&null!=this.subApp.run&&this.subApp.run.resume()},setGlobalValue:function(t,e){null!=this.subApp&&this.subApp.setGlobalValueAt(t,e)},setGlobalString:function(t,e){null!=this.subApp&&this.subApp.setGlobalStringAt(t,e)},isPaused:function(){return null!=this.subApp&&null!=this.subApp.run&&0!=this.subApp.run.rh2PauseCompteur},appFinished:function(){return null==this.subApp},isVisible:function(){return this.bVisible},frameChanged:function(){return this.level!=this.oldLevel},getGlobalString:function(t){return null!=this.subApp?this.subApp.getGlobalStringAt(t):""},getGlobalValue:function(t){return null!=this.subApp?this.subApp.getGlobalValueAt(t):0},getFrameNumber:function(){return this.level+1},setWidth:function(t){},setHeight:function(t){},bringToFront:function(){null!=this.subApp&&this.bVisible&&(hoAdRunHeader.rhApp.planeControls.removeChild(this),hoAdRunHeader.rhApp.planeControls.addChild(this))},updateChildControlPos:function(){if(null!=this.subApp&&null!=this.subApp.run){let t,e=this.subApp.run,s=0;for(t=0;t<e.rhNObjects;t++){for(;null==e.rhObjectList[s];)s++;let r=e.rhObjectList[s];s++,r.forcePosition()}}},autoResize:function(){this.subApp.setMouseOffsets((this.hoAdRunHeader.rhApp.xMouseOffset+this.appSprite.x)*this.hoAdRunHeader.rhApp.scaleX,(this.hoAdRunHeader.rhApp.yMouseOffset+this.appSprite.y)*this.hoAdRunHeader.rhApp.scaleY),null!=this.subApp&&this.subApp.resizeCanvas()}}),aS.prototype={init:function(){this.rcScaleX=1,this.rcScaleY=1,this.rcAngle=0,this.rcMovementType=-1},kill:function(t){}},aT.CPTDISPFLAG_INTNDIGITS=15,aT.CPTDISPFLAG_FLOATNDIGITS=240,aT.CPTDISPFLAG_FLOATNDIGITS_SHIFT=4,aT.CPTDISPFLAG_FLOATNDECIMALS=61440,aT.CPTDISPFLAG_FLOATNDECIMALS_SHIFT=12,aT.CPTDISPFLAG_FLOAT_FORMAT=512,aT.CPTDISPFLAG_FLOAT_USENDECIMALS=1024,aT.CPTDISPFLAG_FLOAT_PADD=2048,aT.prototype=h.extend(new a0,{init:function(t,e){if(this.rsFont=-1,this.rsColor1=0,this.rsColor2=0,this.hoImgWidth=this.hoImgHeight=1,null==this.hoCommon.ocCounters)this.hoImgWidth=this.rsBoxCx=1,this.hoImgHeight=this.rsBoxCy=1;else{let s=this.hoCommon.ocCounters;switch(this.hoImgWidth=this.rsBoxCx=s.odCx,this.hoImgHeight=this.rsBoxCy=s.odCy,this.displayFlags=s.odDisplayFlags,this.type=s.odDisplayType,this.type){case 5:var r=this.rsFont;-1==r&&(r=s.odFont),this.font=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(r),this.fontHeight=this.font.getHeight(),this.rsColor1=s.ocColor1;break;case 2:case 3:this.rsColor1=s.ocColor1,this.rsColor2=s.ocColor2}}let h=this.hoCommon.ocObject;this.rsMini=h.ctMini,this.rsMaxi=h.ctMaxi,this.rsValue=h.ctInit,this.bFloat=!1},kill:function(){},handle:function(){this.ros.handle(),this.roc.rcChanged&&(this.roc.rcChanged=!1)},getFont:function(){let t=this.hoCommon.ocCounters;if(5==this.type){let e=rsFont;return -1==e&&(e=t.odFont),this.hoAdRunHeader.rhApp.fontBank.getFontInfoFromHandle(e)}return null},setFont:function(t,e){5==this.type&&(this.rsFont=this.hoAdRunHeader.rhApp.fontBank.addFont(t),this.font=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(this.rsFont),this.fontHeight=this.font.getHeight(),null!=e&&(this.hoImgWidth=this.rsBoxCx=e.right-e.left,this.hoImgHeight=this.rsBoxCy=e.bottom-e.top),this.computeNewDisplay())},getFontColor:function(){return this.rsColor1},setFontColor:function(t){this.rsColor1=t,this.computeNewDisplay()},cpt_ToFloat:function(t){!1!=this.bFloat||h.isInt(t)||(this.bFloat=!0)},cpt_Change:function(t){if(!1==this.bFloat){let e=h.floatToInt(t);e<this.rsMini&&(e=this.rsMini),e>this.rsMaxi&&(e=this.rsMaxi),e!=Math.round(this.rsValue)&&(this.rsValue=e,this.roc.rcChanged=!0,this.computeNewDisplay())}else t<this.rsMini&&(t=this.rsMini),t>this.rsMaxi&&(t=this.rsMaxi),t!=this.rsValue&&(this.rsValue=t,this.roc.rcChanged=!0,this.computeNewDisplay())},cpt_Add:function(t){this.cpt_ToFloat(t),this.cpt_Change(this.rsValue+t)},cpt_Sub:function(t){this.cpt_ToFloat(t),this.cpt_Change(this.rsValue-t)},cpt_SetMin:function(t){this.rsMini=t,this.cpt_Change(this.rsValue)},cpt_SetMax:function(t){this.rsMaxi=t,this.cpt_Change(this.rsValue)},cpt_SetColor1:function(t){this.rsColor1=t,this.computeNewDisplay()},cpt_SetColor2:function(t){this.rsColor2=t,this.computeNewDisplay()},cpt_GetValue:function(){return this.rsValue},cpt_GetMin:function(){return this.rsMini},cpt_GetMax:function(){return this.rsMaxi},cpt_GetColor1:function(){return this.rsColor1},cpt_GetColor2:function(){return this.rsColor2},addOwnerDrawSprite:function(t,e,s,r,h,n){null!=this.hoCommon.ocCounters&&!0!=this.bAddedToPlane&&(this.bAddedToPlane=!0,this.bQuickDisplay=r,this.bShown=h,this.pLayer=this.hoAdRunHeader.rhFrame.layers[s],this.bQuickDisplay?this.plane=this.pLayer.planeQuickDisplay:this.plane=this.pLayer.planeSprites,n<0?this.plane.addChild(this):this.plane.addChildIndex(this,n),5!=this.type&&this.computeNewDisplay())},delSprite:function(){if(null==this.hoCommon.ocCounters||!1==this.bAddedToPlane)return -1;this.bAddedToPlane=!1;let t=this.plane.getChildIndex(this);return this.plane.removeChild(this),t},getChildIndex:function(){return this.bAddedToPlane?this.plane.getChildIndex(this):-1},getChildMaxIndex:function(){return this.bAddedToPlane?this.plane.getNumChildren():-1},setChildIndex:function(t){this.bAddedToPlane&&this.plane.setChildIndex(this,t)},showSprite:function(){null!=this.hoCommon.ocCounters&&!1==this.bShown&&(this.bShown=!0,this.computeNewDisplay())},hideSprite:function(){null!=this.hoCommon.ocCounters&&!0==this.bShown&&(this.bShown=!1)},callComputeNewDisplay:function(){this.computed||this.computeNewDisplay()},computeNewDisplay:function(){let t,e=this.hoCommon.ocCounters;switch(this.type){case 4:this.rsMaxi<=this.rsMini?this.rsOldFrame=0:this.rsOldFrame=Math.floor((this.rsValue-this.rsMini)*e.nFrames/(this.rsMaxi-this.rsMini)),this.rsOldFrame=Math.min(this.rsOldFrame,e.nFrames-1),s=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(e.frames[Math.max(this.rsOldFrame,0)]),this.hoImgWidth=s.width,this.hoImgHeight=s.height,this.hoImgXSpot=s.xSpot,this.hoImgYSpot=s.ySpot;break;case 2:case 3:n=this.rsBoxCx,e.odDisplayType==a8.CTA_VBAR&&(n=this.rsBoxCy),this.rsMaxi<=this.rsMini?this.rsOldFrame=0:this.rsOldFrame=(this.rsValue-this.rsMini)*n/(this.rsMaxi-this.rsMini),e.odDisplayType==a8.CTA_HBAR?(this.hoImgYSpot=0,this.hoImgHeight=this.rsBoxCy,this.hoImgWidth=this.rsOldFrame,(e.odDisplayFlags&a8.BARFLAG_INVERSE)!=0?this.hoImgXSpot=this.rsOldFrame-this.rsBoxCx:this.hoImgXSpot=0):(this.hoImgXSpot=0,this.hoImgWidth=this.rsBoxCx,this.hoImgHeight=this.rsOldFrame,(e.odDisplayFlags&a8.BARFLAG_INVERSE)!=0?this.hoImgYSpot=this.rsOldFrame-this.rsBoxCy:this.hoImgYSpot=0);break;case 1:r=!1==this.bFloat?h.intToString(this.rsValue,this.displayFlags):h.doubleToString(this.rsValue,this.displayFlags);var s,r,n,a,l,u,d,p=0,m=0;for(a=r.length-1;a>=0;a--)l=r.charCodeAt(a),u=0,45==l?u=e.frames[10]:46==l?u=e.frames[12]:43==l?u=e.frames[11]:101==l||69==l?u=e.frames[13]:l>=48&&l<=57&&(u=e.frames[l-48]),u>=0&&(null!=(d=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(u))?(p+=d.width,m=Math.max(m,d.height)):toto=2);this.hoImgXSpot=p,this.hoImgYSpot=m,this.hoImgWidth=p,this.hoImgHeight=m;break;case 5:r=!1==this.bFloat?h.intToString(this.rsValue,this.displayFlags):h.doubleToString(this.rsValue,this.displayFlags),t=null!=this.textSurface?this.textSurface.measureText(r,this.font):new S(this.hoAdRunHeader.rhApp,16,16).measureText(r,this.font),this.hoImgXSpot=t,this.hoImgYSpot=this.rsBoxCy/2+this.fontHeight/2,this.hoImgWidth=t,this.hoImgHeight=this.fontHeight,null==this.textSurface?this.textSurface=new S(this.hoAdRunHeader.rhApp,this.hoImgWidth,this.hoImgHeight):(this.hoImgWidth>this.textSurface.width||this.hoImgHeight>this.textSurface.height)&&this.textSurface.resize(this.hoImgWidth,this.hoImgHeight);var f=new E(0,0,1e3,1e3);this.textSurface.setText(r,h.DT_LEFT|h.DT_TOP,f,this.font,this.rsColor1)}this.computed=!0},draw:function(t,e,s){if(this.bShown&&this.computed){let r=this.hoCommon.ocCounters,n=e+this.hoX-this.hoImgXSpot-this.hoAdRunHeader.rhWindowX+this.pLayer.x,a=s+this.hoY-this.hoImgYSpot-this.hoAdRunHeader.rhWindowY+this.pLayer.y,l=this.hoImgWidth,u=this.hoImgHeight;switch(this.type){case 4:f=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(r.frames[Math.max(this.rsOldFrame,0)]),t.renderImage(f,n+f.xSpot,a+f.ySpot,0,1,1,this.ros.rsEffect,this.ros.rsEffectParam);break;case 2:case 3:var d=this.rsColor1,p=this.rsColor2;switch(r.ocFillType){case 1:t.renderSolidColor(n,a,l,u,d,this.ros.rsEffect,this.ros.rsEffectParam);break;case 2:(r.odDisplayFlags&a8.BARFLAG_INVERSE)!=0&&(dl=d,d=p,p=dl);var m=0!=r.ocGradientFlags;t.renderGradient(n,a,l,u,d,p,m,this.ros.rsEffect,this.ros.rsEffectParam)}break;case 1:for(g=0,$=!1==this.bFloat?h.intToString(this.rsValue,this.displayFlags):h.doubleToString(this.rsValue,this.displayFlags);g<$.length;g++){var f,d,p,$,g,P,E,_=$.charCodeAt(g);P=0,45==_?P=r.frames[10]:46==_||44==_?P=r.frames[12]:43==_?P=r.frames[11]:69==_||101==_?P=r.frames[13]:_>=48&&_<=57&&(P=r.frames[_-48]),null!=(E=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(P))&&(t.renderImage(E,n+E.xSpot,a+E.ySpot,0,1,1,this.ros.rsEffect,this.ros.rsEffectParam),n+=E.width)}break;case 5:this.textSurface.draw(t,n,a,this.ros.rsEffect,this.ros.rsEffectParam)}}},setTransparency:function(t){this.ros.rsEffect=l2.BOP_BLEND,this.ros.rsEffectParam=t}}),ab.prototype=h.extend(new a0,{init:function(t,e){this.rsFont=-1,this.rsColor1=0,this.hoImgWidth=this.hoImgHeight=1;let s=this.hoCommon.ocCounters;if(this.hoImgWidth=this.rsBoxCx=s.odCx,this.hoImgHeight=this.rsBoxCy=s.odCy,this.type=s.odDisplayType,this.rsColor1=s.ocColor1,this.rsPlayer=s.odPlayer,this.rsValue=this.hoAdRunHeader.rhApp.getScores()[this.rsPlayer-1],this.displayFlags=s.odDisplayFlags,5==this.type){let r=this.rsFont;-1==r&&(r=s.odFont),this.font=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(r),this.fontHeight=this.font.getHeight()}},kill:function(){},handle:function(){let t=this.hoAdRunHeader.rhApp.getScores()[this.rsPlayer-1];t!=this.rsValue&&(this.rsValue=t,this.computeNewDisplay()),this.ros.handle(),this.roc.rcChanged&&(this.roc.rcChanged=!1)},getFont:function(){let t=this.hoCommon.ocCounters;if(5==t.odDisplayType){let e=this.rsFont;return -1==e&&(e=t.odFont),this.hoAdRunHeader.rhApp.fontBank.getFontInfoFromHandle(e)}return null},setFont:function(t,e){if(5==type){this.rsFont=hoAdRunHeader.rhApp.fontBank.addFont(t);var t=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(this.rsFont);this.fontHeight=t.getHeight(),null!=e&&(this.hoImgWidth=this.rsBoxCx=e.right-e.left,this.hoImgHeight=this.rsBoxCy=e.bottom-e.top),this.computeNewDisplay()}},getFontColor:function(){return this.rsColor1},setFontColor:function(t){this.rsColor1=t,this.computeNewDisplay()},addOwnerDrawSprite:function(t,e,s,r,h,n){null!=this.hoCommon.ocCounters&&!0!=this.bAddedToPlane&&(this.bAddedToPlane=!0,this.bShown=h,this.pLayer=this.hoAdRunHeader.rhFrame.layers[s],r?this.plane=this.pLayer.planeQuickDisplay:this.plane=this.pLayer.planeSprites,n<0?this.plane.addChild(this):this.plane.addChildIndex(this,n),5!=this.type&&this.computeNewDisplay())},delSprite:function(){if(null==this.hoCommon.ocCounters||!1==this.bAddedToPlane)return -1;this.bAddedToPlane=!1;let t=this.plane.getChildIndex(this);return this.plane.removeChild(this),t},getChildIndex:function(){return this.bAddedToPlane?this.plane.getChildIndex(this):-1},getChildMaxIndex:function(){return this.bAddedToPlane?this.plane.getNumChildren():-1},setChildIndex:function(t){this.bAddedToPlane&&this.plane.setChildIndex(this,t)},showSprite:function(){null!=this.hoCommon.ocCounters&&!1==this.bShown&&(this.bShown=!0,this.computeNewDisplay())},hideSprite:function(){null!=this.hoCommon.ocCounters&&!0==this.bShown&&(this.bShown=!1)},setValue:function(t){t!=this.rsValue&&(this.rsValue=t,this.computeNewDisplay())},callComputeNewDisplay:function(){this.computed||this.computeNewDisplay()},computeNewDisplay:function(){if(this.computed=!0,this.hoImgWidth=this.hoImgHeight=1,null!=this.hoCommon.ocCounters){let t,e=this.hoCommon.ocCounters,s=h.intToString(this.rsValue,this.displayFlags);switch(e.odDisplayType){case 1:var r,n,a,l,u=0,d=0;for(n=s.length-1;n>=0;n--)a=s.charCodeAt(n),r=0,45==a?r=e.frames[10]:46==a?r=e.frames[12]:43==a?r=e.frames[11]:101==a||69==a?r=e.frames[13]:a>=48&&a<=57&&(r=e.frames[a-48]),r>=0&&(u+=(l=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(r)).width,d=Math.max(d,l.height));this.hoImgXSpot=u,this.hoImgYSpot=d,this.hoImgWidth=u,this.hoImgHeight=d;break;case 5:t=null!=this.textSurface?this.textSurface.measureText(s,this.font):new S(this.hoAdRunHeader.rhApp,8,8).measureText(s,this.font),this.hoImgXSpot=t,this.hoImgYSpot=this.rsBoxCy/2+this.fontHeight/2,this.hoImgWidth=t,this.hoImgHeight=this.fontHeight,null==this.textSurface?this.textSurface=new S(this.hoAdRunHeader.rhApp,this.hoImgWidth,this.hoImgHeight):(this.hoImgWidth>this.textSurface.width||this.hoImgHeight>this.textSurface.height)&&this.textSurface.resize(this.hoImgWidth,this.hoImgHeight);var p=new E(0,0,1e3,1e3);this.textSurface.setText(s,h.DT_LEFT|h.DT_TOP,p,this.font,this.rsColor1)}}},draw:function(t,e,s){if(this.bShown&&this.computed){this.globalAlpha=this.alpha,this.globalCompositeOperation=this.composite;let r,n,a,l,u=this.hoCommon.ocCounters,d=e+this.hoX-this.hoImgXSpot-this.hoAdRunHeader.rhWindowX+this.pLayer.x,p=s+this.hoY-this.hoImgYSpot-this.hoAdRunHeader.rhWindowY+this.pLayer.y;switch(r=h.intToString(this.rsValue,this.displayFlags),this.type){case 1:for(n=0;n<r.length;n++){let m=r.charCodeAt(n);a=0,45==m?a=u.frames[10]:46==m||44==m?a=u.frames[12]:43==m?a=u.frames[11]:69==m||101==m?a=u.frames[13]:m>=48&&m<=57&&(a=u.frames[m-48]),l=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(a),t.renderImage(l,d+l.xSpot,p+l.ySpot,0,1,1,this.ros.rsEffect,this.ros.rsEffectParam),d+=l.width}break;case 5:this.textSurface.draw(t,d,p,this.ros.rsEffect,this.ros.rsEffectParam)}}},setTransparency:function(t){this.ros.rsEffect=l2.BOP_BLEND,this.ros.rsEffectParam=t}}),aC.prototype=h.extend(new a0,{init:function(t,e){this.rsFont=-1,this.rsColor1=0,this.hoImgWidth=this.hoImgHeight=1;let s=this.hoCommon.ocCounters;if(this.hoImgWidth=this.rsBoxCx=s.odCx,this.hoImgHeight=this.rsBoxCy=s.odCy,this.type=s.odDisplayType,this.rsColor1=s.ocColor1,this.rsPlayer=s.odPlayer,this.rsValue=this.hoAdRunHeader.rhApp.getLives()[this.rsPlayer-1],this.displayFlags=s.odDisplayFlags,5==this.type){let r=this.rsFont;-1==r&&(r=s.odFont),this.font=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(r),this.fontHeight=this.font.getHeight()}},kill:function(){},handle:function(){let t=this.hoAdRunHeader.rhApp.getLives()[this.rsPlayer-1];t!=this.rsValue&&(this.rsValue=t,this.computeNewDisplay()),this.ros.handle(),this.roc.rcChanged&&(this.roc.rcChanged=!1)},getFont:function(){let t=this.hoCommon.ocCounters;if(5==t.odDisplayType){let e=this.rsFont;return -1==e&&(e=t.odFont),this.hoAdRunHeader.rhApp.fontBank.getFontInfoFromHandle(e)}return null},setFont:function(t,e){if(5==type){this.rsFont=hoAdRunHeader.rhApp.fontBank.addFont(t);var t=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(this.rsFont);this.fontHeight=t.getHeight(),null!=e&&(this.hoImgWidth=this.rsBoxCx=e.right-e.left,this.hoImgHeight=this.rsBoxCy=e.bottom-e.top),this.computeNewDisplay()}},getFontColor:function(){return this.rsColor1},setFontColor:function(t){this.rsColor1=t,this.computeNewDisplay()},addOwnerDrawSprite:function(t,e,s,r,h,n){null!=this.hoCommon.ocCounters&&!0!=this.bAddedToPlane&&(this.bAddedToPlane=!0,this.bShown=h,this.pLayer=this.hoAdRunHeader.rhFrame.layers[s],r?this.plane=this.pLayer.planeQuickDisplay:this.plane=this.pLayer.planeSprites,n<0?this.plane.addChild(this):this.plane.addChildIndex(this,n),5!=this.type&&this.computeNewDisplay())},delSprite:function(){if(null==this.hoCommon.ocCounters||!1==this.bAddedToPlane)return -1;this.bAddedToPlane=!1;let t=this.plane.getChildIndex(this);return this.plane.removeChild(this),t},getChildIndex:function(){return this.bAddedToPlane?this.plane.getChildIndex(this):-1},getChildMaxIndex:function(){return this.bAddedToPlane?this.plane.getNumChildren():-1},setChildIndex:function(t){this.bAddedToPlane&&this.plane.setChildIndex(this,t)},showSprite:function(){null!=this.hoCommon.ocCounters&&!1==this.bShown&&(this.bShown=!0,this.computeNewDisplay())},hideSprite:function(){null!=this.hoCommon.ocCounters&&!0==this.bShown&&(this.bShown=!1)},setValue:function(t){t!=this.rsValue&&(this.rsValue=t,this.computeNewDisplay())},callComputeNewDisplay:function(){this.computed||this.computeNewDisplay()},computeNewDisplay:function(){if(this.computed=!0,this.hoImgWidth=this.hoImgHeight=1,null!=this.hoCommon.ocCounters){let t=this.hoCommon.ocCounters;switch(t.odDisplayType){case 4:if(0!=this.rsValue){a=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(t.frames[0]);let e=this.rsValue*a.width;e<=this.rsBoxCx?(this.hoImgWidth=e,this.hoImgHeight=a.height):(this.hoImgWidth=this.rsBoxCx,this.hoImgHeight=(this.rsBoxCx/a.width+this.rsValue-1)*a.height);break}this.hoImgWidth=this.hoImgHeight=1;break;case 1:var s,r,n,a,l=0,u=0,d=h.intToString(this.rsValue,this.displayFlags);for(s=d.length-1;s>=0;s--)r=d.charCodeAt(s),n=0,45==r?n=t.frames[10]:46==r?n=t.frames[12]:43==r?n=t.frames[11]:101==r||69==r?n=t.frames[13]:r>=48&&r<=57&&(n=t.frames[r-48]),n>=0&&(l+=(a=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(n)).width,u=Math.max(u,a.height));this.hoImgXSpot=l,this.hoImgYSpot=u,this.hoImgWidth=l,this.hoImgHeight=u;break;case 5:var p,d=h.intToString(this.rsValue,this.displayFlags);p=null!=this.textSurface?this.textSurface.measureText(d,this.font):new S(this.hoAdRunHeader.rhApp,8,8).measureText(d,this.font),this.hoImgXSpot=p,this.hoImgYSpot=this.rsBoxCy/2+this.fontHeight/2,this.hoImgWidth=p,this.hoImgHeight=this.fontHeight,null==this.textSurface?this.textSurface=new S(this.hoAdRunHeader.rhApp,this.hoImgWidth,this.hoImgHeight):(this.hoImgWidth>this.textSurface.width||this.hoImgHeight>this.textSurface.height)&&this.textSurface.resize(this.hoImgWidth,this.hoImgHeight);var m=new E(0,0,1e3,1e3);this.textSurface.setText(d,h.DT_LEFT|h.DT_TOP,m,this.font,this.rsColor1)}}},draw:function(t,e,s){if(this.bShown&&this.computed){this.globalAlpha=this.alpha,this.globalCompositeOperation=this.composite;var r,n,a,l,u=this.hoCommon.ocCounters,d=e+this.hoX-this.hoImgXSpot-this.hoAdRunHeader.rhWindowX+this.pLayer.x,p=s+this.hoY-this.hoImgYSpot-this.hoAdRunHeader.rhWindowY+this.pLayer.y;switch(this.type){case 1:for(n=0,r=h.intToString(this.rsValue,this.displayFlags);n<r.length;n++){let m=r.charCodeAt(n);a=0,45==m?a=u.frames[10]:46==m||44==m?a=u.frames[12]:43==m?a=u.frames[11]:69==m||101==m?a=u.frames[13]:m>=48&&m<=57&&(a=u.frames[m-48]),l=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(a),t.renderImage(l,d+l.xSpot,p+l.ySpot,0,1,1,this.ros.rsEffect,this.ros.rsEffectParam),d+=l.width}break;case 4:if(0!=this.rsValue){var f=d+this.hoImgWidth,$=p+this.hoImgHeight,g=d,P=p,E=this.rsValue,l=this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(u.frames[0]);for(p=P;p<$&&E>0;p+=l.height)for(d=g;d<f&&E>0;d+=l.width,E-=1)t.renderImage(l,d+l.xSpot,p+l.ySpot,0,1,1,this.ros.rsEffect,this.ros.rsEffectParam)}break;case 5:this.textSurface.draw(t,d,p,this.ros.rsEffect,this.ros.rsEffectParam)}}},setTransparency:function(t){this.ros.rsEffect=l2.BOP_BLEND,this.ros.rsEffectParam=t}}),aL.prototype=h.extend(new a0,{init:function(t,e){let s=t.ocObject;this.hoImgWidth=s.otCx,this.hoImgHeight=s.otCy,this.rsBoxCx=s.otCx,this.rsBoxCy=s.otCy,this.rsMaxi=s.otNumberOfText,this.rsTextColor=0,s.otTexts.length>0&&(this.rsTextColor=s.otTexts[0].tsColor),this.rsTextBuffer=null,this.rsFont=-1,this.rsMini=0,this.bShown=!0,this.rsHidden=e.cobFlags,(e.cobFlags&nD.COF_FIRSTTEXT)!=0&&s.otTexts.length>0&&(this.rsTextBuffer=s.otTexts[0].tsText);let r=this.rsFont;-1==r&&s.otTexts.length>0&&(r=s.otTexts[0].tsFont),this.font=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(r),this.textSurface=new S(this.hoAdRunHeader.rhApp,this.hoImgWidth,this.hoImgHeight)},kill:function(){},handle:function(){this.ros.handle(),this.roc.rcChanged&&(this.roc.rcChanged=!1)},getFont:function(){let t=this.rsFont;return -1==t&&(t=this.hoCommon.ocObject.otTexts[0].tsFont),this.hoAdRunHeader.rhApp.fontBank.getFontInfoFromHandle(t)},setFont:function(t,e){this.rsFont=this.hoAdRunHeader.rhApp.fontBank.addFont(t),this.font=this.hoAdRunHeader.rhApp.fontBank.getFontFromHandle(this.rsFont),null!=e&&(this.hoImgWidth=e.right-e.left,this.hoImgHeight=e.bottom-e.top,this.textSurface.resize(this.hoImgWidth,this.hoImgHeight)),this.roc.rcChanged=!0,this.computeNewDisplay()},getFontColor:function(){return this.rsTextColor},setFontColor:function(t){this.rsTextColor=t,this.computeNewDisplay()},addOwnerDrawSprite:function(t,e,s,r,h,n){!0!=this.bAddedToPlane&&(this.bAddedToPlane=!0,this.bShown=h,this.pLayer=this.hoAdRunHeader.rhFrame.layers[s],r?this.plane=this.pLayer.planeQuickDisplay:this.plane=this.pLayer.planeSprites,n<0?this.plane.addChild(this):this.plane.addChildIndex(this,n))},delSprite:function(){if(!1==this.bAddedToPlane)return -1;this.bAddedToPlane=!1;let t=this.plane.getChildIndex(this);return this.plane.removeChild(this),t},getChildIndex:function(){return this.bAddedToPlane?this.plane.getChildIndex(this):-1},getChildMaxIndex:function(){return this.bAddedToPlane?this.plane.getNumChildren():-1},setChildIndex:function(t){this.bAddedToPlane&&this.plane.setChildIndex(this,t)},showSprite:function(){!1==this.bShown&&(this.bShown=!0)},hideSprite:function(){!0==this.bShown&&(this.bShown=!1)},txtChange:function(t){if(t<-1&&(t=-1),t>=this.rsMaxi&&(t=this.rsMaxi-1),t==this.rsMini)return!1;if(this.rsMini=t,t>=0){let e=this.hoCommon.ocObject;this.txtSetString(e.otTexts[this.rsMini].tsText)}return this.computeNewDisplay(),(this.ros.rsFlags&l2.RSFLAG_HIDDEN)==0},txtSetString:function(t){this.rsTextBuffer=t,this.computeNewDisplay()},callComputeNewDisplay:function(){this.computed||this.computeNewDisplay()},computeNewDisplay:function(){this.computed=!0;let t,e=this.hoCommon.ocObject,s=e.otTexts[0].tsFlags;this.hoImgXSpot=0,this.hoImgYSpot=0,this.rect.left=0,this.rect.top=0,this.rect.right=this.hoImgWidth,this.rect.bottom=this.hoImgHeight,this.rsMini>=0?t=e.otTexts[this.rsMini].tsText:null==(t=this.rsTextBuffer)&&(t="");let r=s&(h.DT_LEFT|h.DT_CENTER|h.DT_RIGHT|h.DT_TOP|h.DT_BOTTOM|h.DT_VCENTER|h.DT_SINGLELINE),n=this.textSurface.setText(t,r,this.rect,this.font,this.rsTextColor);(r&(h.DT_BOTTOM|h.DT_VCENTER))==0&&(this.hoImgHeight=n)},setTransparency:function(t){this.ros.rsEffect=l2.BOP_BLEND,this.ros.rsEffectParam=t},draw:function(t,e,s){if(this.bShown&&this.computed){let r=e+this.hoX-this.hoAdRunHeader.rhWindowX+this.pLayer.x,h=s+this.hoY-this.hoAdRunHeader.rhWindowY+this.pLayer.y;this.textSurface.draw(t,r,h,this.ros.rsEffect,this.ros.rsEffectParam)}}}),aI.prototype=h.extend(new a0,{init:function(t,e){},kill:function(){},handle:function(){this.hoAdRunHeader.pause(),this.hoAdRunHeader.questionObjectOn=this,this.hoAdRunHeader.rhFrame.layers[this.hoAdRunHeader.rhFrame.nLayers-1].planeSprites.addChild(this),this.computeTexts()},destroyObject:function(){this.hoAdRunHeader.rhFrame.layers[this.hoAdRunHeader.rhFrame.nLayers-1].planeSprites.removeChild(this)},handleQuestion:function(){let t,e=this.hoAdRunHeader.rhApp.mouseX-this.hoAdRunHeader.rhApp.xOffset,s=this.hoAdRunHeader.rhApp.mouseY-this.hoAdRunHeader.rhApp.yOffset;if(0==this.currentDown)this.hoAdRunHeader.rhApp.keyBuffer[ny.VK_LBUTTON]&&0!=(t=this.getQuestion(e,s))&&(this.currentDown=t);else if(!this.hoAdRunHeader.rhApp.keyBuffer[ny.VK_LBUTTON]){if(this.getQuestion(e,s)==this.currentDown){this.hoAdRunHeader.rhEvtProg.rhCurParam0=this.currentDown,this.hoAdRunHeader.rhEvtProg.handle_Event(this,-5439484),(this.hoCommon.ocObject.otTexts[this.currentDown].tsFlags&a_.TSF_CORRECT)!=0?this.hoAdRunHeader.rhEvtProg.handle_Event(this,-5308412):this.hoAdRunHeader.rhEvtProg.handle_Event(this,-5373948),this.destroyObject(),this.hoAdRunHeader.questionObjectOn=null,this.hoAdRunHeader.resume(),this.hoAdRunHeader.f_KillObject(this.hoNumber,!0);return}this.currentDown=0}},getQuestion:function(t,e){let s;if(null!=this.rcA){for(s=1;s<this.rcA.length;s++)if(t>=this.rcA[s].left&&t<this.rcA[s].right&&e>this.rcA[s].top&&e<this.rcA[s].bottom)return s}return 0},border3D:function(t,e,s){s?(r=8421504,h=16777215):(h=8421504,r=16777215),t.renderRect(e.left,e.top,e.right-e.left,e.bottom-e.top,0,1);let r,h,n,a=[,,,];for(n=0;n<3;n++)a[n]=new _;a[0].x=e.right-1,!1==s&&(a[0].x-=1),a[0].y=e.top+1,a[1].y=e.top+1,a[1].x=e.left+1,a[2].x=e.left+1,a[2].y=e.bottom,!1==s&&(a[2].y-=1),t.renderLine(a[0].x,a[0].y,a[1].x,a[1].y,r,1),t.renderLine(a[1].x,a[1].y,a[2].x,a[2].y,r,1),!1==s&&(a[0].x-=1),a[0].y+=1,a[1].x+=1,a[1].y+=1,a[2].x+=1,!1==s&&(a[2].y-=1),t.renderLine(a[0].x,a[0].y,a[1].x,a[1].y,r,1),t.renderLine(a[1].x,a[1].y,a[2].x,a[2].y,r,1),!1==s&&(a[0].x+=2,a[1].x=e.right-1,a[1].y=e.bottom-1,a[2].y=e.bottom-1,a[2].x-=1,t.renderLine(a[0].x,a[0].y,a[1].x,a[1].y,h,1),t.renderLine(a[1].x,a[1].y,a[2].x,a[2].y,h,1),a[0].x-=1,a[0].y+=1,a[1].x-=1,a[1].y-=1,a[2].x+=1,a[2].y-=1,t.renderLine(a[0].x,a[0].y,a[1].x,a[1].y,h,1),t.renderLine(a[1].x,a[1].y,a[2].x,a[2].y,h,1))},redraw_Answer:function(t,e,s){let r=new E;r.copyRect(this.rcA[e]),this.border3D(t,this.rcA[e],s),r.left+=2,r.top+=2,r.right-=4,r.bottom-=4,s&&(r.left+=2,r.top+=2),this.textSurfaces[e].draw(t,(r.left+r.right)/2-this.textSurfaces[e].width/2,(r.top+r.bottom)/2-this.textSurfaces[e].height/2,0,0)},computeTexts:function(){this.measureTextSurface=new S(this.hoAdRunHeader.rhApp,8,8);let t,e,s=this.hoCommon.ocObject,r=this.hoAdRunHeader,n=s.otTexts[1],a=n.tsColor,l=(n.tsFlags&a_.TSF_RELIEF)!=0,u=r.rhApp.fontBank.getFontFromHandle(n.tsFont);for(t=1,this.xa_margin=Math.floor(3*this.measureTextSurface.measureText("X",u)/2),this.hta=4,this.lgBox=64;t<s.otTexts.length;t++)(n=s.otTexts[t]).tsText.length>0&&(e=this.measureTextSurface.measureText(n.tsText,u),this.lgBox=Math.max(this.lgBox,e+2*this.xa_margin+4),this.hta=Math.max(this.hta,Math.floor(3*u.getHeight()/2)));this.hte=Math.max(Math.floor(this.hta/4),2),this.lgBox+=2*this.xa_margin+4;let d=new E;for(t=1;t<s.otTexts.length;t++)n=s.otTexts[t],this.textSurfaces[t]=new S(r.rhApp,this.lgBox,this.hta),d.right=this.lgBox,d.bottom=this.hta,this.textSurfaces[t].manualDrawText(n.tsText,h.DT_CENTER|h.DT_VCENTER,d,a,u,l?1:0,16777215);let p=s.otTexts[0];l=(p.tsFlags&a_.TSF_RELIEF)!=0;let m=r.rhApp.fontBank.getFontFromHandle(p.tsFont),f=Math.floor(3*this.measureTextSurface.measureText("X",m)/2);e=this.measureTextSurface.measureText(p.tsText,m),this.htq=Math.floor(3*m.getHeight()/2),this.lgBox=Math.max(this.lgBox,e+2*f+4),this.lgBox>r.rhApp.gaCxWin?this.lgBox=r.rhApp.gaCxWin:this.lgBox>r.rhFrame.leWidth&&(this.lgBox=r.rhFrame.leWidth),d.right=this.lgBox,d.bottom=this.htq,this.textSurfaces[0]=new S(r.rhApp,this.lgBox,this.htq),this.textSurfaces[0].manualDrawText(p.tsText,h.DT_CENTER|h.DT_VCENTER,d,a,m,l?1:0,16777215)},draw:function(t,e,s){let r=this.hoCommon.ocObject,h=this.hoAdRunHeader,n=this.hoX-h.rhWindowX,a=this.hoY-h.rhWindowY,l=new E;l.left=n,l.top=a;let u=this.lgBox,d=this.htq+1+(this.hta+this.hte)*(r.otTexts.length-1)+this.hte+4;if(l.right=n+u,l.bottom=a+d,t.renderSolidColor(l.left,l.top,l.right-l.left,l.bottom-l.top,12632256,0,0),this.border3D(t,l,!1),l.left+=2,l.top+=2,l.right-=2,l.bottom=l.top+this.htq,this.textSurfaces[0].draw(t,(l.left+l.right)/2-this.textSurfaces[0].width/2,(l.top+l.bottom)/2-this.textSurfaces[0].height/2,0,0),l.top=l.bottom,t.renderLine(l.left,l.top,l.right,l.bottom,8421504,1,0,0),l.top+=1,l.bottom+=1,t.renderLine(l.left,l.top,l.right,l.bottom,16777215,1,0,0),null==this.rcA)for(i=1,this.rcA=Array(r.otTexts.length);i<r.otTexts.length;i++)this.rcA[i]=new E,this.rcA[i].left=n+2+this.xa_margin,this.rcA[i].right=n+this.lgBox-2-this.xa_margin,this.rcA[i].top=a+2+this.htq+1+this.hte+(this.hta+this.hte)*(i-1),this.rcA[i].bottom=this.rcA[i].top+this.hta;for(i=1;i<r.otTexts.length;i++){let p=this.currentDown==i;this.redraw_Answer(t,i,p)}}}),aF.prototype=h.extend(new a0,{init:function(t,e){this.ext.init(this);let s=this.hoAdRunHeader.rhApp.file.createFromFile(t.ocExtension);this.privateData=t.ocPrivate,this.ext.createRunObject(s,e,t.ocVersion)},addSprite:function(t,e,s,r,h){this.nLayer=r,this.pLayer=this.hoAdRunHeader.rhFrame.layers[r],this.bShown=h,!0!=this.bAddedToPlane&&(this.bAddedToPlane=!0,this.plane=this.pLayer.planeSprites,this.plane.addChild(this))},addOwnerDrawSprite:function(t,e,s,r,h){this.nLayer=s,this.pLayer=this.hoAdRunHeader.rhFrame.layers[s],this.bShown=h,!0!=this.bAddedToPlane&&(this.bAddedToPlane=!0,r?this.plane=this.pLayer.planeQuickDisplay:this.plane=this.pLayer.planeSprites,this.plane.addChild(this))},delSprite:function(){if(!1==this.bAddedToPlane)return -1;this.bAddedToPlane=!1;let t=this.plane.getChildIndex(this);return this.plane.removeChild(this),t},handle:function(){(512&this.hoOEFlags)!=0?this.ros.handle():(48&this.hoOEFlags)==16||(48&this.hoOEFlags)==48?this.rom.move():(48&this.hoOEFlags)==32&&this.roa.animate();let t=0;!1==this.noHandle&&(t=this.ext.handleRunObject()),(t&l4.REFLAG_ONESHOT)!=0&&(this.noHandle=!0),null!=this.roc&&this.roc.rcChanged&&(t|=l4.REFLAG_DISPLAY,this.roc.rcChanged=!1)},autoResize:function(){this.ext.autoResize()},createFont:function(){this.ext.createFont()},draw:function(t,e,s){this.bShown&&this.ext.displayRunObject(t,e,s)},kill:function(t){this.ext.destroyRunObject(t)},getCollisionMask:function(t){return this.ext.getRunObjectCollisionMask(t)},condition:function(t,e){return this.ext.condition(t,e)},action:function(t,e){this.ext.action(t,e)},expression:function(t){return this.ext.expression(t)},setTransparency:function(t){this.ros.rsEffect=l2.BOP_BLEND,this.ros.rsEffectParam=t},setFocus:function(t){this.ext.setFocus(t)},showSprite:function(){this.bShown=!0},hideSprite:function(){this.bShown=!1},getChildIndex:function(){return this.plane.getChildIndex(this)},getChildMaxIndex:function(){return this.plane.children.length},setChildIndex:function(t){t>=this.plane.children.length&&(t=this.plane.children.length),t<0&&(t=0),this.plane.setChildIndex(this,t)},pauseRunObject:function(){this.ext.pauseRunObject()},continueRunObject:function(){this.ext.continueRunObject()},forcePosition:function(){this.ext.forcePosition()},loadImageList:function(t){this.hoAdRunHeader.rhApp.imageBank.loadImageList(t)},getImage:function(t){return this.hoAdRunHeader.rhApp.imageBank.getImageFromHandle(t)},getApplication:function(){return this.hoAdRunHeader.rhApp},getX:function(){return this.hoX},getY:function(){return this.hoY},getWidth:function(){return this.hoImgWidth},getHeight:function(){return this.hoImgHeight},setX:function(t){null!=this.rom?this.rom.rmMovement.setXPosition(t):(this.hoX=t,null!=this.roc&&(this.roc.rcChanged=!0,this.roc.rcCheckCollides=!0))},setY:function(t){null!=this.rom?this.rom.rmMovement.setYPosition(t):(this.hoY=t,null!=this.roc&&(this.roc.rcChanged=!0,this.roc.rcCheckCollides=!0))},setWidth:function(t){this.hoImgWidth=t},setHeight:function(t){this.hoImgHeight=t},setSize:function(t,e){this.hoImgWidth=t,this.hoImgHeight=e},reHandle:function(){this.noHandle=!1},generateEvent:function(t,e){if(0==this.hoAdRunHeader.rh2PauseCompteur){let s=this.hoAdRunHeader.rhEvtProg.rhCurParam0;this.hoAdRunHeader.rhEvtProg.rhCurParam0=e,t=-(t+nZ.EVENTS_EXTBASE+1)<<16,t|=65535&this.hoType,this.hoAdRunHeader.rhEvtProg.handle_Event(this,t),this.hoAdRunHeader.rhEvtProg.rhCurParam0=s}},pushEvent:function(t,e){0==this.hoAdRunHeader.rh2PauseCompteur&&(t=-(t+nZ.EVENTS_EXTBASE+1)<<16,t|=65535&this.hoType,this.hoAdRunHeader.rhEvtProg.push_Event(1,t,e,this,this.hoOi))},pause:function(){this.hoAdRunHeader.pause()},resume:function(){this.hoAdRunHeader.resume()},redraw:function(){},destroy:function(){this.hoAdRunHeader.destroy_Add(this.hoNumber)},setPosition:function(t,e){null!=this.rom?(this.rom.rmMovement.setXPosition(t),this.rom.rmMovement.setYPosition(e)):(this.hoX=t,this.hoY=e,null!=this.roc&&(this.roc.rcChanged=!0,this.roc.rcCheckCollides=!0))},getExtUserData:function(){return this.privateData},setExtUserData:function(t){this.privateData=t},addBackdrop:function(t,e,s,r,h){this.hoAdRunHeader.addBackdrop(t,e,s,h,r,!0)},getEventCount:function(){return this.hoAdRunHeader.rh4EventCount},getExpParam:function(){return this.hoAdRunHeader.rh4CurToken++,this.hoAdRunHeader.getExpression()},getEventParam:function(){return this.hoAdRunHeader.rhEvtProg.rhCurParam0},callMovement:function(t,e,s){return(t.hoOEFlags&a$.OEFLAG_MOVEMENTS)!=0&&t.roc.rcMovementType==l6.MVTYPE_EXT?t.rom.rmMovement.callMovement(e,s):0},getFirstObject:function(){return this.objectCount=0,this.objectNumber=0,this.getNextObject()},getNextObject:function(){if(this.objectNumber<this.hoAdRunHeader.rhNObjects){for(;null==this.hoAdRunHeader.rhObjectList[this.objectCount];)this.objectCount++;let t=this.hoAdRunHeader.rhObjectList[this.objectCount];return this.objectNumber++,this.objectCount++,t}return null},getObjectFromFixed:function(t){let e,s=0;for(e=0;e<this.hoAdRunHeader.rhNObjects;e++){for(;null==this.hoAdRunHeader.rhObjectList[s];)s++;let r=this.hoAdRunHeader.rhObjectList[s];if(s++,(r.hoCreationId<<16|65535&r.hoNumber)==t)return r}return null},findFirstObject:function(t){return this.hoAdRunHeader.findFirstObject(t)},findNextObject:function(t){return this.hoAdRunHeader.findNextObject(t)},openHFile:function(t){return hoAdRunHeader.rhApp.openHFile(t)},closeHFile:function(t){hoAdRunHeader.rhApp.closeHFile(t)}}),ay.PARAM_EXPRESSIONNUM=22,ay.create=function(t){let e=t.file.getFilePointer(),s=null,r=t.file.readAShort(),h=t.file.readAShort();switch(h){case 1:s=new aH(t);break;case 2:s=new aW(t);break;case 3:case 4:case 10:case 11:case 12:case 17:case 26:case 31:case 32:case 37:case 43:case 49:case 50:case 57:case 58:case 60:case 61:case 67:s=new aj(t);break;case 5:case 25:case 29:case 34:case 48:case 56:s=new a4(t);break;case 6:case 35:case 36:s=new aY(t);break;case 9:case 21:s=new aG(t);break;case 13:s=new aw(t);break;case 14:case 44:s=new a3(t);break;case 15:case 22:case 23:case 27:case 28:case 45:case 46:case 52:case 53:case 54:case 59:case 62:s=new ak(t);break;case 16:s=new a6(t);break;case 18:s=new a5(t);break;case 19:s=new a7(t);break;case 24:s=new a2(t);break;case 38:s=new a1(t);break;case 39:s=new aD(t);break;case 40:case 41:case 63:case 64:s=new aX(t);break;case 42:s=new aM(t);break;case 47:case 51:s=new aR(t);break;case 55:s=new aN(t)}return s.code=h,t.file.seek(e+r),s},a1.GRPFLAGS_INACTIVE=1,a1.GRPFLAGS_CLOSED=2,a1.GRPFLAGS_PARENTINACTIVE=4,a1.GRPFLAGS_GROUPINACTIVE=8,a1.GRPFLAGS_GLOBAL=16,aB.CPF_DIRECTION=1,aB.CPF_ACTION=2,aB.CPF_INITIALDIR=4,aB.CPF_DEFAULTDIR=8,aB.prototype={read_Position:function(t,e,s){if(s.layer=-1,-1==this.posOINUMParent){0!=e&&(s.dir=-1,(this.posFlags&aB.CPF_DEFAULTDIR)==0&&(s.dir=t.get_Direction(this.posDir))),s.x=this.posX,s.y=this.posY;let r=this.posLayer;r>t.rhFrame.nLayers-1&&(r=t.rhFrame.nLayers-1),s.layer=r,s.bRepeat=!1}else{if(t.rhEvtProg.rh2EnablePick=!1,h=t.rhEvtProg.get_CurrentObjects(this.posOiList),s.bRepeat=t.rhEvtProg.repeatFlag,null==h)return!1;if(s.x=h.hoX,s.y=h.hoY,s.layer=h.hoLayer,(this.posFlags&aB.CPF_ACTION)!=0&&(h.hoOEFlags&a$.OEFLAG_ANIMATIONS)!=0&&h.roc.rcImage>=0){var h,n,a=h.roc.rcAngle,l=t.GetMBase(h);null!=l&&(a=l.getAngle()),n=t.rhApp.imageBank.getImageInfoEx(h.roc.rcImage,a,h.roc.rcScaleX,h.roc.rcScaleY),s.x+=n.xAP-n.xSpot,s.y+=n.yAP-n.ySpot}if((this.posFlags&aB.CPF_DIRECTION)!=0){let u=this.posAngle+h.hoAdRunHeader.getDir(h)&31,d=lq.getDeltaX(this.posSlope,u),p=lq.getDeltaY(this.posSlope,u);s.x+=d,s.y+=p}else s.x+=this.posX,s.y+=this.posY;(1&e)!=0&&((this.posFlags&aB.CPF_DEFAULTDIR)!=0?s.dir=-1:(this.posFlags&aB.CPF_INITIALDIR)!=0?s.dir=h.hoAdRunHeader.getDir(h):s.dir=t.get_Direction(this.posDir))}return(2&e)==0||!(s.x<t.rh3XMinimumKill)&&!(s.x>t.rh3XMaximumKill)&&!(s.y<t.rh3YMinimumKill)&&!(s.y>t.rh3YMaximumKill)}},a6.prototype=h.extend(new aB,{}),aG.prototype=h.extend(new aB,{}),a5.prototype=h.extend(new aB,{}),aV.prototype={renderSolidColor:function(t,e,s,r,h,n,a){},renderSolidColorEllipse:function(t,e,s,r,h,n,a){},renderGradient:function(t,e,s,r,h,n,a,l,u){},renderGradientEllipse:function(t,e,s,r,h,n,a,l,u){},renderImage:function(t,e,s,r,h,n,a,l){},renderSimpleImage:function(t,e,s,r,h,n,a){},renderPattern:function(t,e,s,r,h,n,a){},renderPatternEllipse:function(t,e,s,r,h,n,a){},renderLine:function(t,e,s,r,h,n,a,l){},renderRect:function(t,e,s,r,h,n,a,l){},renderEllipse:function(t,e,s,r,h,n,a){},pushClip:function(t,e,s,r){let h=this.clips[this.clips.length-1];h&&(t<h.x&&(t=h.x),e<h.y&&(e=h.y),t+s>h.x+h.w&&(s=h.x+h.w-t),e+r>h.y+h.h&&(r=h.y+h.h-e));let n={x:t,y:e,w:s,h:r};return this.clips.push(n),n},popClip:function(){this.clips.pop()}},aU.prototype=h.extend(new aV,{resetEffect:function(t){this.smoothing=t,this.oldSmoothing=t,this._context.imageSmoothingEnabled=t,this._context.webkitImageSmoothingEnabled=t,this._context.mozImageSmoothingEnabled=t,this._context.msImageSmoothingEnabled=t,this.oldEffect=-1,this.setInkEffect(0,0)},setScale:function(t,e){this._context.scale(t,e),this.xScale=t,this.yScale=e,this.dxw=0,this.dyw=0,this.xScale>1?this.dxw=1:this.xScale>0&&this.xScale<1&&(this.dxw=1/this.xScale),this.yScale>1&&(this.dyw=1),this.yScale>0&&this.yScale<1&&(this.dyw=1/this.yScale)},clearBackground:function(t,e,s,r){this._context.clearRect(t,e,s,r)},renderSolidColor:function(t,e,s,r,n,a,l){let u=this._context;this.setInkEffect(a,l),u.fillStyle=h.getColorString(n),u.fillRect(t,e,s,r)},renderSolidColorEllipse:function(t,e,s,r,n,a,l){let u=this._context;this.setInkEffect(a,l),u.fillStyle=h.getColorString(n),h.createEllipse(u,t,e,s,r),u.fill()},renderGradient:function(t,e,s,r,h,n,a,l,u){if(h==n)return this.renderSolidColor(t,e,s,r,h,l,u);let d=this._context;this.setInkEffect(l,u),this.configureGradient(t,e,s,r,a,h,n),d.fillRect(t,e,s,r)},renderGradientEllipse:function(t,e,s,r,n,a,l,u,d){if(n==a)return this.renderSolidColorEllipse(t,e,s,r,n,u,d);let p=this._context;this.setInkEffect(u,d),this.configureGradient(t,e,s,r,l,n,a),h.createEllipse(p,t,e,s,r),this._context.fill()},renderImage:function(t,e,s,r,h,n,a,l){let u=this._context,d=e-t.xSpot,p=s-t.ySpot;this.setInkEffect(a,l),0==r&&1==h&&1==n?0==t.mosaic?null!=t.img&&u.drawImage(t.img,d,p):u.drawImage(t.app.imageBank.mosaics[t.mosaic],t.mosaicX,t.mosaicY,t.width,t.height,d,p,t.width,t.height):(u.save(),u.translate(e,s),0!=r&&u.rotate(-(.0174532925*r)),u.scale(Math.max(.001,h),Math.max(.001,n)),u.translate(-t.xSpot,-t.ySpot),0==t.mosaic?null!=t.img&&0!=t.width&&0!=t.height&&u.drawImage(t.img,0,0,t.width,t.height,0,0,t.width,t.height):u.drawImage(t.app.imageBank.mosaics[t.mosaic],t.mosaicX,t.mosaicY,t.width,t.height,0,0,t.width,t.height),u.restore())},renderImageWithSubPixelCorrection:function(t,e,s,r,h,n,a,l){let u=this._context,d=e-t.xSpot,p=s-t.ySpot;this.setInkEffect(a,l),0==r&&1==h&&1==n?0==t.mosaic?null!=t.img&&u.drawImage(t.img,0,0,t.width,t.height,d,p,t.width+this.dxw,t.height+this.dyw):u.drawImage(t.app.imageBank.mosaics[t.mosaic],t.mosaicX,t.mosaicY,t.width,t.height,d,p,t.width+this.dxw,t.height+this.dyw):(u.save(),u.translate(e,s),0!=r&&u.rotate(-(.0174532925*r)),u.scale(Math.max(.001,h),Math.max(.001,n)),u.translate(-t.xSpot,-t.ySpot),0==t.mosaic?null!=t.img&&u.drawImage(t.img,0,0,t.width,t.height,0,0,t.width,t.height):u.drawImage(t.app.imageBank.mosaics[t.mosaic],t.mosaicX,t.mosaicY,t.width,t.height,0,0,t.width,t.height),u.restore())},renderSimpleImage:function(t,e,s,r,h,n,a){this.setInkEffect(n,a),this._context.drawImage(t,e,s,r,h)},renderPattern:function(t,e,s,r,h,n,a){let l,u,d=this._context;this.setInkEffect(n,a),d.save(),d.beginPath(),d.moveTo(e,s),d.lineTo(e+r,s),d.lineTo(e+r,s+h),d.lineTo(e,s+h),d.lineTo(e,s),d.clip();let p=t.width,m=t.height,f=Math.floor(r/p)+1,$=Math.floor(h/m)+1;for(l=0;l<f;l++)for(u=0;u<$;u++)0==t.mosaic?null!=t.img&&d.drawImage(t.img,0,0,t.width,t.height,e+l*p,s+u*m,t.width+this.dxw,t.height+this.dyw):d.drawImage(t.app.imageBank.mosaics[t.mosaic],t.mosaicX,t.mosaicY,t.width,t.height,e+l*p,s+u*m,t.width+this.dxw,t.height+this.dyw);d.restore()},renderPatternEllipse:function(t,e,s,r,n,a,l){if(!(t instanceof nU))throw Error("renderPatternEllipse: bad image type: "+typeof t);var u=this._context;if(this.setInkEffect(a,l),0==t.mosaic)null!=t.img&&(u.fillStyle=u.createPattern(t.img,"repeat"));else{if(!t.pattern){t.pattern=document.createElement("canvas"),t.pattern.width=t.width,t.pattern.height=t.height;var u=t.pattern.getContext("2d");u.drawImage(t.app.imageBank.mosaics[t.mosaic],t.mosaicX,t.mosaicY,t.width,t.height,0,0,t.width,t.height)}u.fillStyle=u.createPattern(t.pattern,"repeat")}h.createEllipse(u,e,s,r,n),this._context.fill()},renderLine:function(t,e,s,r,n,a,l,u){let d=this._context;this.setInkEffect(l,u),d.strokeStyle=h.getColorString(n),d.lineCap="round",d.lineWidth=a,d.beginPath(),d.moveTo(t,e),d.lineTo(s,r),d.closePath(),d.stroke()},renderRect:function(t,e,s,r,n,a,l,u){let d=this._context;this.setInkEffect(l,u),d.strokeStyle=h.getColorString(n),d.lineWidth=a,d.strokeRect(t,e,s,r)},renderEllipse:function(t,e,s,r,n,a,l,u){let d=this._context;this.setInkEffect(l,u),d.lineWidth=n,d.strokeStyle=h.getColorString(a),h.createEllipse(d,t,e,s,r),this._context.stroke()},clip:function(t,e,s,r){let h=this._context;h.save(),h.beginPath(),h.rect(t,e,s,r),h.clip()},unClip:function(){this._context.restore()},pushClip:function(){let t=this._context,e=aV.prototype.pushClip.apply(this,arguments);t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.clip()},popClip:function(){let t=this._context;if(aV.prototype.popClip.apply(this,arguments),this.clips.length>0){let e=this.clips[this.clips.length-1];t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.clip()}else t.resetClip()},setInkEffect:function(t,e){let s=this._context;if(void 0===t){s.globalAlpha=1,s.composite="source-over";return}if(t!=this.oldEffect||e!=this.oldEffectParam){this.oldEffect=t,this.oldEffectParam=e;let r=t&l2.BOP_MASK,h=(t&l2.BOP_SMOOTHING)!=0|this.smoothing;switch(h!=this.oldSmoothing&&(this.oldSmoothing=h,s.imageSmoothingEnabled=h,s.webkitImageSmoothingEnabled=h,s.mozImageSmoothingEnabled=h,s.msImageSmoothingEnabled=h),(t&l2.BOP_RGBAFILTER)!=0?s.globalAlpha=(e>>>24&255)/255:r==l2.BOP_BLEND?s.globalAlpha=(128-e)/128:s.globalAlpha=1,r){case l2.BOP_ADD:s.composite="lighter";break;case l2.BOP_XOR:s.composite="xor";break;default:s.composite="source-over"}}},configureGradient:function(t,e,s,r,n,a,l){let u=n?this._context.createLinearGradient(t,e,t,e+r):this._context.createLinearGradient(t,e,t+s,e);u.addColorStop(0,h.getColorString(a)),u.addColorStop(1,h.getColorString(l)),this._context.fillStyle=u}}),aK.TRFLAG_COLOR=1,aK.prototype={load:function(t){let e=t.getFilePointer();t.skipBytes(4),this.transID=t.readAInt(),this.transDuration=t.readAInt(),this.transFlags=t.readAInt(),this.transColor=t.readAColor();let s=t.readAInt(),r=t.readAInt();t.seek(e+s),this.dllName=t.readAString(),this.dllName=this.dllName.substr(0,this.dllName.indexOf(".")),this.dataOffset=e+r}},aq.prototype={getTrans:function(t){return null}},az.LEFT_RIGHT=0,az.RIGHT_LEFT=1,az.TOP_BOTTOM=2,az.BOTTOM_TOP=3,az.CENTER_LEFTRIGHT=0,az.LEFTRIGHT_CENTER=1,az.CENTER_TOPBOTTOM=2,az.TOPBOTTOM_CENTER=3,az.TOP_LEFT=0,az.TOP_RIGHT=1,az.BOTTOM_LEFT=2,az.BOTTOM_RIGHT=3,az.CENTER=4,az.DIR_HORZ=0,az.DIR_VERT=1,az.TRFLAG_FADEIN=1,az.TRFLAG_FADEOUT=2,az.prototype={start:function(t,e,s,r){this.dest=e,this.destContext=this.dest.getContext("2d"),this.source1=s,this.source2=r;let h=new Date;this.m_initTime=h.getTime(),this.m_duration=t.transDuration,0==this.m_duration&&(this.m_duration=1),this.m_currentTime=this.m_initTime,this.m_endTime=this.m_initTime+this.m_duration,this.m_running=!0,this.m_starting=!0},finish:function(){},isCompleted:function(){if(this.m_running){let t=new Date;return t.getTime()>=this.m_endTime||t.getTime()>=this.m_endTime}return!0},getDeltaTime:function(){let t=new Date;return this.m_currentTime=t.getTime(),this.m_currentTime>this.m_endTime&&(this.m_currentTime=this.m_endTime),this.m_currentTime-this.m_initTime},getTimePos:function(){return this.m_currentTime-this.m_initTime},setTimePos:function(t){this.m_initTime=this.m_currentTime-this.msTimePos,this.m_endTime=this.m_initTime+this.m_duration},blit:function(t,e,s,r,h,n,a){this.m_objectFadeOut&&(this.destContext.globalCompositeOperation="source-atop"),1==arguments.length?this.destContext.drawImage(t,0,0):n>0&&a>0&&this.destContext.drawImage(t,r,h,n,a,e,s,n,a)},stretch:function(t,e,s,r,h,n,a,l,u){this.m_objectFadeOut&&(this.destContext.globalCompositeOperation="source-atop"),r>0&&h>0&&l>0&&u>0&&this.destContext.drawImage(t,n,a,l,u,e,s,r,h)},stepDraw:function(t){},end:function(){},init:function(t,e,s,r,h){}},aJ.prototype={startObjectFade:function(t,e){var s,r=t.hoCommon.ocFadeIn;e&&(r=t.hoCommon.ocFadeOut);let h=null;if((t.hoOEFlags&a$.OEFLAG_ANIMATIONS)!=0){let n=this.app.imageBank.getImageFromHandle(t.roc.rcImage);(h=document.createElement("canvas")).width=n.width,h.height=n.height;var s=h.getContext("2d");0==n.mosaic?s.drawImage(n.img,0,0):s.drawImage(this.app.imageBank.mosaics[n.mosaic],n.mosaicX,n.mosaicY,n.width,n.height,0,0,n.width,n.height)}else if(t.hoType>=32){(h=document.createElement("canvas")).width=t.hoImgWidth,h.height=t.hoImgHeight;let a=new StandardRendered(h);t.getSurface(a)||(h=null)}if(null==h)return null;let l=h.width,u=h.height,d=document.createElement("canvas");d.width=l,d.height=u;let p=document.createElement("canvas");p.width=l,p.height=u;let m=document.createElement("canvas");m.width=l,m.height=u,e?((s=p.getContext("2d")).drawImage(h,0,0),(s=d.getContext("2d")).drawImage(h,0,0),(r.transFlags&aK.TRFLAG_COLOR)!=0&&this.copyColorMask(m,h,r.transColor)):((s=m.getContext("2d")).drawImage(h,0,0),(r.transFlags&aK.TRFLAG_COLOR)!=0&&this.copyColorMask(p,h,r.transColor));let f=this.createTransition(r,d,p,m);if(null!=f){let $=0;(t.hoFlags&a0.HOF_FADEOUT)!=0?(f.m_objectFadeOut=!0,$|=az.TRFLAG_FADEOUT):(f.m_objectFadeOut=!1,$|=az.TRFLAG_FADEIN),t.transitionImage=d,f.stepDraw($)}return f},copyColorMask:function(t,e,s){let r,h,n=t.getContext("2d");n.drawImage(e,0,0);let a=e.width,l=e.height,u=n.getImageData(0,0,a,l),d=(16711680&s)>>16,p=(65280&s)>>8,m=255&s;for(h=0;h<l;h++)for(r=0;r<a;r++)0!=u.data[(h*a+r)*4+3]&&(u.data[(h*a+r)*4]=d,u.data[(h*a+r)*4+1]=p,u.data[(h*a+r)*4+2]=m);n.putImageData(u,0,0)},createTransition:function(t,e,s,r){let h=t.dllName,n=null;if("cctrans"==h.toLowerCase()&&(n=new aQ),null!=n){let a=n.getTrans(t);return this.app.file.seek(t.dataOffset),a.m_objectFadeOut=!1,a.init(t,this.app.file,e,s,r),a}return null}},aQ.identifiers=["BAND","SE00","SE10","SE12","DOOR","SE03","MOSA","SE05","SE06","SCRL","SE01","SE07","SE09","SE13","SE08","SE02","ZIGZ","SE04","ZOOM","SE11","FADE"],aQ.prototype=h.extend(new aq,{getTrans:function(t){let e,s=t.transID,r="";for(r+=String.fromCharCode(255&s),s>>=8,r+=String.fromCharCode(255&s),s>>=8,r+=String.fromCharCode(255&s),s>>=8,r+=String.fromCharCode(255&s),e=0;e<aQ.identifiers.length&&r!=aQ.identifiers[e];e++);let h=null;switch(e){case 0:h=new lt;break;case 1:h=new aZ;break;case 2:h=new a9;break;case 3:h=new le;break;case 4:h=new li;break;case 5:h=new lr;break;case 6:h=new lh;break;case 7:h=new lo;break;case 8:h=new ln;break;case 9:h=new la;break;case 10:h=new ll;break;case 11:h=new lu;break;case 12:h=new lc;break;case 13:h=new ld;break;case 14:h=new lp;break;case 15:h=new lm;break;case 16:h=new lf;break;case 17:h=new l$;break;case 18:h=new lg;break;case 19:h=new lP;break;case 20:h=new ls}return h}}),aZ.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height,8!=this.dwStyle?this.m_style=this.dwStyle:this.m_style=Math.floor(8*Math.random()));let e,s,r=this.getDeltaTime();if(r/this.m_duration>1)this.blit(this.source2);else switch(this.m_style){case 0:e=this.m_source2Width/3*r/this.m_duration,s=this.m_source2Height,this.blit(this.source2,0,0,this.m_source2Width/3-e,0,e,s),this.blit(this.source2,this.m_source2Width-e,0,2*this.m_source2Width/3,0,e,s),e=this.m_source2Width/3,s=this.m_source2Height*r/this.m_duration,this.blit(this.source2,e,0,e,this.m_source2Height-s,e,s);break;case 1:e=this.m_source2Width/3*r/this.m_duration,s=this.m_source2Height,this.blit(this.source2,0,0,this.m_source2Width/3-e,0,e,s),this.blit(this.source2,this.m_source2Width-e,0,2*this.m_source2Width/3,0,e,s),e=this.m_source2Width/3,s=this.m_source2Height*r/this.m_duration,this.blit(this.source2,e,this.m_source2Height-s,e,0,e,s);break;case 2:e=this.m_source2Width/3*r/this.m_duration,s=this.m_source2Height,this.blit(this.source2,0,0,this.m_source2Width/3-e,0,e,s),this.blit(this.source2,this.m_source2Width-e,0,2*this.m_source2Width/3,0,e,s),e=this.m_source2Width/3,s=this.m_source2Height*r/this.m_duration,this.blit(this.source2,e,0,e,0,e,s);break;case 3:e=this.m_source2Width/3*r/this.m_duration,s=this.m_source2Height,this.blit(this.source2,0,0,this.m_source2Width/3-e,0,e,s),this.blit(this.source2,this.m_source2Width-e,0,2*this.m_source2Width/3,0,e,s),e=this.m_source2Width/3,s=this.m_source2Height*r/this.m_duration,this.blit(this.source2,e,this.m_source2Height-s,e,this.m_source2Height-s,e,s);break;case 4:e=this.m_source2Width/3*r/this.m_duration,s=this.m_source2Height,this.blit(this.source2,0,0,this.m_source2Width/3-e,0,e,s),this.blit(this.source2,this.m_source2Width-e,0,2*this.m_source2Width/3,0,e,s),e=this.m_source2Width/3,s=this.m_source2Height/2*r/this.m_duration,this.blit(this.source2,e,0,e,this.m_source2Height/2-s,e,s),this.blit(this.source2,e,this.m_source2Height-s,e,this.m_source2Height/2,e,s);break;case 5:e=this.m_source2Width/3*r/this.m_duration,s=this.m_source2Height,this.blit(this.source2,0,0,this.m_source2Width/3-e,0,e,s),this.blit(this.source2,this.m_source2Width-e,0,2*this.m_source2Width/3,0,e,s),e=this.m_source2Width/3,s=this.m_source2Height/2*r/this.m_duration,this.blit(this.source2,e,0,e,0,e,s),this.blit(this.source2,e,this.m_source2Height-s,e,this.m_source2Height-s,e,s);break;case 6:e=this.m_source2Width/3,s=this.m_source2Height*r/this.m_duration,this.blit(this.source2,0,this.m_source2Height-s,0,0,e,s),this.blit(this.source2,e,0,e,this.m_source2Height-s,e,s),this.blit(this.source2,2*e,this.m_source2Height-s,2*e,0,e,s);break;case 7:e=this.m_source2Width/7,s=this.m_source2Height*r/this.m_duration,this.blit(this.source2,0,this.m_source2Height-s,0,0,e,s),this.blit(this.source2,e,0,e,this.m_source2Height-s,e,s),this.blit(this.source2,2*e,this.m_source2Height-s,2*e,0,e,s),this.blit(this.source2,3*e,0,3*e,this.m_source2Height-s,e,s),this.blit(this.source2,4*e,this.m_source2Height-s,4*e,0,e,s),this.blit(this.source2,5*e,0,5*e,this.m_source2Height-s,e,s),this.blit(this.source2,6*e,this.m_source2Height-s,6*e,0,2*e,s);break;default:this.blit(this.source2)}return null},end:function(){this.finish()}}),a9.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height);let e,s,r=this.getDeltaTime();if(r/this.m_duration>1)this.blit(this.source2);else switch(this.blit(this.source2),this.dwStyle){case 0:e=this.m_source2Width/2*r/this.m_duration,e=this.m_source2Width/2-e,s=this.m_source2Height/2*r/this.m_duration,s=this.m_source2Height/2-s,this.stretch(this.source1,0,0,e,s,0,0,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,s=this.m_source2Height/2-s,this.stretch(this.source1,this.m_source2Width/2+e,0,this.m_source2Width/2-e,s,this.m_source2Width/2,0,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,e=this.m_source2Width/2-e,s=this.m_source2Height/2*r/this.m_duration,this.stretch(this.source1,0,this.m_source2Height/2+s,e,this.m_source2Height/2-s,0,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,this.stretch(this.source1,this.m_source2Width/2+e,this.m_source2Height/2+s,this.m_source2Width/2-e,this.m_source2Height/2-s,this.m_source2Width/2,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2);break;case 1:e=this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.blit(this.source1,0,0,this.m_source2Width-e,this.m_source2Height-s,e,s);break;case 2:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.blit(this.source1,e,0,0,this.m_source2Height-s,this.m_source2Width-e,s);break;case 3:e=this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=this.m_source2Height*r/this.m_duration,this.blit(this.source1,0,s,this.m_source2Width-e,0,e,this.m_source2Height-s);break;case 4:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height*r/this.m_duration,this.blit(this.source1,e,s,0,0,this.m_source2Width-e,this.m_source2Height-s);break;case 5:e=this.m_source2Width/2*r/this.m_duration,e=this.m_source2Width/2-e,s=this.m_source2Height/2*r/this.m_duration,s=this.m_source2Height/2-s,this.blit(this.source1,e-this.m_source2Width/2,s-this.m_source2Height/2,0,0,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,s=this.m_source2Height/2-s,this.blit(this.source1,this.m_source2Width/2+e,s-this.m_source2Height/2,this.m_source2Width/2,0,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,e=this.m_source2Width/2-e,s=this.m_source2Height/2*r/this.m_duration,this.blit(this.source1,e-this.m_source2Width/2,this.m_source2Height/2+s,0,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,this.blit(this.source1,this.m_source2Width/2+e,this.m_source2Height/2+s,this.m_source2Width/2,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2);break;case 6:e=this.m_source2Width,s=this.m_source2Height/2*r/this.m_duration,s=this.m_source2Height/2-s,this.blit(this.source1,0,s-this.m_source2Height/2,0,0,this.m_source2Width,this.m_source2Height/2),this.blit(this.source1,0,this.m_source2Height-s,0,this.m_source2Height/2,this.m_source2Width,this.m_source2Height/2);break;case 7:e=this.m_source2Width/2*r/this.m_duration,e=this.m_source2Width/2-e,s=this.m_source2Height,this.blit(this.source1,e-this.m_source2Width/2,0,0,0,this.m_source2Width/2,this.m_source2Height),this.blit(this.source1,this.m_source2Width-e,0,this.m_source2Width/2,0,this.m_source2Width/2,this.m_source2Height)}return null},end:function(){this.finish()}}),lt.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.bpNbBands=e.readAShort(),this.bpDirection=e.readAShort(),this.start(t,s,r,h)},stepDraw:function(t){let e,s=this.source1.width,r=this.source1.height;if(this.m_starting){switch(0==this.bpNbBands&&(this.bpNbBands=1),this.bpDirection){case az.LEFT_RIGHT:case az.RIGHT_LEFT:this.m_wbande=(s+this.bpNbBands-1)/this.bpNbBands,0==this.m_wbande&&(this.m_wbande=1,this.bpNbBands=s);break;default:this.m_wbande=(r+this.bpNbBands-1)/this.bpNbBands,0==this.m_wbande&&(this.m_wbande=1,this.bpNbBands=r)}this.m_rw=0,this.m_starting=!1}if(this.bpNbBands<=0||this.m_wbande<=0||0==this.m_duration)this.blit(this.source2);else{let h=this.m_wbande*this.getDeltaTime()/this.m_duration;if(h>this.m_rw){let n=0,a=0,l=0,u=0;for(e=0;e<this.bpNbBands;e++){switch(this.bpDirection){case az.LEFT_RIGHT:n=this.m_rw+e*this.m_wbande,a=0,l=h-this.m_rw,u=r;break;case az.RIGHT_LEFT:n=s-(this.m_rw+e*this.m_wbande)-(h-this.m_rw),a=0,l=h-this.m_rw,u=r;break;case az.TOP_BOTTOM:n=0,a=this.m_rw+e*this.m_wbande,l=s,u=h-this.m_rw;break;case az.BOTTOM_TOP:n=0,a=r-(this.m_rw+e*this.m_wbande)-(h-this.m_rw),l=s,u=h-this.m_rw}this.blit(this.source2,n,a,n,a,l,u)}}this.m_rw=h}return this.m_prc},end:function(){this.finish()}}),le.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwPos=e.readAInt(),this.dwPos2=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height);let e,s,r,h,n,a,l,u,d,p,m=this.getDeltaTime();if(m/this.m_duration>1)this.blit(this.source2);else for(n=0,d=this.m_source2Width/this.dwPos,p=this.m_source2Height/this.dwPos2,r=this.m_source2Width/this.dwPos,h=this.m_source2Height/this.dwPos2;n<this.dwPos;n++)for(a=0;a<this.dwPos2;a++)e=n*d,s=a*p,l=r*m/this.m_duration,u=h*m/this.m_duration,this.stretch(this.source2,e+(r-l)/2,s+(h-u)/2,l,u,e+(r-l)/2,s+(h-u)/2,l,u);return null},end:function(){this.finish()}}),li.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.m_direction=e.readAShort(),this.start(t,s,r,h)},stepDraw:function(t){if(this.m_starting){switch(this.m_direction){case az.CENTER_LEFTRIGHT:case az.LEFTRIGHT_CENTER:this.m_wbande=this.source1.width/2;break;default:this.m_wbande=this.source1.height/2}this.m_rw=0,this.m_starting=!1}if(0==this.m_wbande)this.blit(this.source2);else{let e=0,s=0,r=0,h=0,n=this.m_wbande*this.getDeltaTime()/this.m_duration;if(n>this.m_rw){switch(this.m_direction){case az.CENTER_LEFTRIGHT:e=this.source1.width/2-n,s=0,r=n-this.m_rw,h=this.source2.height;break;case az.LEFTRIGHT_CENTER:e=this.m_rw,s=0,r=n-this.m_rw,h=this.source2.height;break;case az.CENTER_TOPBOTTOM:e=0,s=this.source1.height/2-n,r=this.source2.width,h=n-this.m_rw;break;case az.TOPBOTTOM_CENTER:e=0,s=this.m_rw,r=this.source2.width,h=n-this.m_rw}switch(this.blit(this.source2,e,s,e,s,r,h),this.m_direction){case az.CENTER_LEFTRIGHT:e=this.source1.width/2+this.m_rw;break;case az.LEFTRIGHT_CENTER:e=this.source1.width-n;break;case az.CENTER_TOPBOTTOM:s=this.source1.height/2+this.m_rw;break;case az.TOPBOTTOM_CENTER:s=this.source1.height-n}this.blit(this.source2,e,s,e,s,r,h)}}return null},end:function(){this.finish()}}),ls.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.start(t,s,r,h)},stepDraw:function(t){let e;return this.m_starting&&(this.m_starting=!1),az.TRFLAG_FADEIN,this.destContext.globalAlpha=1,this.blit(this.source1),e=this.getDeltaTime()/this.m_duration,this.destContext.globalAlpha=e,this.blit(this.source2),null},end:function(){this.destContext.globalAlpha=1,this.finish()}}),lr.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwPos=e.readAInt(),this.dwStyle=e.readAInt(),this.dwScrolling=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height);let e=this.getDeltaTime();if(e/this.m_duration>1)this.blit(this.source2);else{let s,r,h,n,a=0,l=0,u=0;if(0==this.dwStyle)for(a=0,u=this.m_source2Height/this.dwPos;a<this.dwPos;a++)0==l?(s=0,r=a*u,h=this.m_source2Width*e/this.m_duration,n=a==this.dwPos-1?this.m_source2Height:u+1,0==this.dwScrolling?this.blit(this.source2,s,r,s,r,h,n):this.blit(this.source2,s,r,this.m_source2Width-h,r,h,n),l=1):(r=a*u,h=this.m_source2Width*e/this.m_duration,s=this.m_source2Width-h,n=a==this.dwPos-1?this.m_source2Height:u+1,0==this.dwScrolling?this.blit(this.source2,s,r,s,r,h,n):this.blit(this.source2,s,r,0,r,h,n),l=0);else for(a=0,u=this.m_source2Width/this.dwPos;a<this.dwPos;a++)0==l?(s=a*u,r=0,n=this.m_source2Height*e/this.m_duration,h=a==this.dwPos-1?this.m_source2Width:u+1,0==this.dwScrolling?this.blit(this.source2,s,r,s,r,h,n):this.blit(this.source2,s,r,s,this.m_source2Height-n,h,n),l=1):(s=a*u,n=this.m_source2Height*e/this.m_duration,r=this.m_source2Height-n,h=a==this.dwPos-1?this.m_source2Width:u+1,0==this.dwScrolling?this.blit(this.source2,s,r,s,r,h,n):this.blit(this.source2,s,r,s,0,h,n),l=0)}return null},end:function(){this.finish()}}),lh.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.m_spotPercent=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){if(this.m_starting){let e,s,r=this.source1.width,h=this.source1.height;for(this.m_spotSize=Math.floor((r*this.m_spotPercent/100+h*this.m_spotPercent/100)/2),0==this.m_spotSize&&(this.m_spotSize=1),this.m_nbBlockPerLine=(r+this.m_spotSize-1)/this.m_spotSize,this.m_nbBlockPerCol=(h+this.m_spotSize-1)/this.m_spotSize,this.m_nbBlocks=this.m_nbBlockPerLine*this.m_nbBlockPerCol,e=Math.floor((this.m_nbBlocks+7)/8+2),this.m_lastNbBlocks=0,this.m_bitbuf=Array(e),s=0;s<e;s++)this.m_bitbuf[s]=0;this.m_starting=!1}if(null==this.m_bitbuf||this.m_nbBlockPerLine<2||this.m_nbBlockPerCol<2||0==this.m_duration)this.blit(this.source2);else{let n,a,l=0,u=0,d=Math.floor(this.m_nbBlocks*this.getDeltaTime()/this.m_duration),p=d-this.m_lastNbBlocks;if(0!=p)for(a=0,this.m_lastNbBlocks=d;a<p;a++){for(n=0;n<1;n++){if(l=Math.floor(this.m_nbBlockPerLine*Math.random()),f=Math.floor((m=(u=Math.floor(this.m_nbBlockPerCol*Math.random()))*this.m_nbBlockPerLine+l)/8),$=1<<(7&m),(this.m_bitbuf[f]&$)==0){this.m_bitbuf[f]|=$;break}var m,f,$,g,P=f,E=(this.m_nbBlocks+7)/8,_=!1;for(g=f;g<E;g++,P++)if(-1!=this.m_bitbuf[P]){for($=1,u=Math.floor(8*g/this.m_nbBlockPerLine),l=Math.floor(8*g%this.m_nbBlockPerLine);0!=$;$<<=1){if((this.m_bitbuf[P]&$)==0){this.m_bitbuf[P]|=$,_=!0;break}if(++l>=this.m_nbBlockPerLine&&(l=0,++u>=this.m_nbBlockPerCol))break}if(_)break}if(_)break;for(g=0,P=0;g<f;g++,P++){if(255!=this.m_bitbuf[P]){for($=1,u=Math.floor(8*g/m_nbBlockPerLine),l=Math.floor(8*g%m_nbBlockPerLine);0!=$;$<<=1){if((this.m_bitbuf[P]&$)==0){this.m_bitbuf[P]|=$,_=!0;break}if(++l>=this.m_nbBlockPerLine&&(l=0,++u>=this.m_nbBlockPerCol))break}if(_)break}if(_)break;_=!1}}n<1&&this.blit(this.source2,Math.floor(l*this.m_spotSize),Math.floor(u*this.m_spotSize),Math.floor(l*this.m_spotSize),Math.floor(u*this.m_spotSize),this.m_spotSize,this.m_spotSize)}}return null},end:function(){this.finish()}}),lo.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height);let e,s,r,h,n=this.getDeltaTime(),a=n/this.m_duration;return a>1?this.blit(this.source2):a<.25?(r=2*this.m_source2Width*n/this.m_duration,r*=2,h=this.m_source2Height/7,e=this.m_source2Width/2-r/2,s=this.m_source2Height/2-h/2,this.blit(this.source2,e,s,e,s,r,h),r=this.m_source2Width/7,h=2*this.m_source2Height*n/this.m_duration,h*=2,e=this.m_source2Width/2-r/2,s=this.m_source2Height/2-h/2,this.blit(this.source2,e,s,e,s,r,h)):(e=this.m_source2Width/2,r=this.m_source2Width*n/this.m_duration-e,h=this.m_source2Height/2,s=0,this.blit(this.source2,e,s,e,s,r,h),s=this.m_source2Height/2,h=this.m_source2Height*n/this.m_duration-s,e=r=this.m_source2Width/2,this.blit(this.source2,e,s,e,s,r,h),r=this.m_source2Width*n/this.m_duration-this.m_source2Width/2,e=this.m_source2Width/2-r,s=h=this.m_source2Height/2,this.blit(this.source2,e,s,e,s,r,h),h=this.m_source2Height*n/this.m_duration-this.m_source2Height/2,s=this.m_source2Height/2-h,r=this.m_source2Width/2,e=0,this.blit(this.source2,e,s,e,s,r,h)),null},end:function(){this.finish()}}),ln.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height,this.m_refresh=!1);let e,s,r,h,n=this.getDeltaTime(),a=n/this.m_duration;if(a>1)this.blit(this.source2);else{if(a<=.5)switch(this.dwStyle){case 0:r=this.m_source2Width*n/this.m_duration*2,h=this.m_source2Height/2,e=this.m_source2Width-r,s=this.m_source2Height/2,this.blit(this.source2,0,0,e,s,r,h);break;case 1:r=this.m_source2Width*n/this.m_duration*2,h=this.m_source2Height/2,e=this.m_source2Width-r,s=this.m_source2Height/2,this.blit(this.source2,e,0,0,s,r,h);break;case 2:r=this.m_source2Width*n/this.m_duration*2,h=this.m_source2Height/2,e=this.m_source2Width-r,s=this.m_source2Height/2,this.blit(this.source2,0,s,e,0,r,h);break;case 3:r=this.m_source2Width*n/this.m_duration*2,h=this.m_source2Height/2,e=this.m_source2Width-r,s=this.m_source2Height/2,this.blit(this.source2,e,s,0,0,r,h)}if(a>.5)switch(!1==this.m_refresh&&(this.dwStyle<=1?this.blit(this.source2,0,0,0,this.m_source2Height/2,this.m_source2Width,this.m_source2Height/2):this.blit(this.source2,0,this.m_source2Height/2,0,0,this.m_source2Width,this.m_source2Height/2),this.m_refresh=!0),a=n-this.m_duration/2,a/=this.m_duration/2,a*=1e3,h=this.m_source2Height/2*a/1e3,this.dwStyle){case 0:case 1:this.stretch(this.source2,0,h,this.m_source2Width,this.m_source2Height/2,0,this.m_source2Height/2,this.m_source2Width,this.m_source2Height/2),this.stretch(this.source2,0,0,this.m_source2Width,h,0,this.m_source2Height/2-h,this.m_source2Width,h);break;case 2:case 3:this.stretch(this.source2,0,this.m_source2Height/2-h,this.m_source2Width,this.m_source2Height/2,0,0,this.m_source2Width,this.m_source2Height/2),this.stretch(this.source2,0,this.m_source2Height-h,this.m_source2Width,h,0,this.m_source2Height/2,this.m_source2Width,h)}}return null},end:function(){this.finish()}}),la.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.m_direction=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){let e=this.source1.width,s=this.source1.height;if(this.m_starting){switch(this.m_direction){case az.LEFT_RIGHT:case az.RIGHT_LEFT:this.m_wbande=e;break;default:this.m_wbande=s}this.m_rw=0,this.m_starting=!1}if(0==this.m_duration)this.blit(this.source2);else{let r=this.m_wbande*this.getDeltaTime()/this.m_duration;if(r>this.m_rw){let h=0,n=0;switch(this.m_direction){case az.LEFT_RIGHT:h=r-e,n=0;break;case az.RIGHT_LEFT:h=e-r,n=0;break;case az.TOP_BOTTOM:h=0,n=r-s;break;case az.BOTTOM_TOP:h=0,n=s-r}this.blit(this.source2,h,n,0,0,e,s),this.m_rw=r}}return null},end:function(){this.finish()}}),ll.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.dwPos=e.readAInt(),this.dwStretch=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height);let e=this.getDeltaTime();if(e/this.m_duration>1)this.blit(this.source2);else{a=this.m_source2Width*this.dwPos/100,l=this.m_source2Height*this.dwPos/100,h=a*e/this.m_duration,n=l*e/this.m_duration,s=this.m_source2Width/2-h/2,r=this.m_source2Height/2-n/2,0==this.dwStretch?this.blit(this.source2,s,r,s,r,h,n):this.stretch(this.source2,s,r,h,n,this.m_source2Width/2-a/2,this.m_source2Height/2-l/2,a,l);let s,r,h,n,a,l,u=100-this.dwPos;a=this.m_source2Width*u/100,l=this.m_source2Height*u/100,h=a/2*e/this.m_duration,n=l/2*e/this.m_duration,this.blit(this.source2,0,0,0,0,this.m_source2Width,n),this.blit(this.source2,0,0,0,0,h,this.m_source2Height),this.blit(this.source2,0,this.m_source2Height-n,0,this.m_source2Height-n,this.m_source2Width,n),this.blit(this.source2,this.m_source2Width-h,0,this.m_source2Width-h,0,h,this.m_source2Height)}return null},end:function(){this.finish()}}),lu.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height);let e,s,r=this.getDeltaTime();if(r/this.m_duration>1)this.blit(this.source2);else switch(this.dwStyle){case 0:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height*r/this.m_duration,this.stretch(this.source2,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height);break;case 1:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height*r/this.m_duration,this.stretch(this.source2,this.m_source2Width-e,0,e,s,0,0,this.m_source2Width,this.m_source2Height);break;case 2:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height*r/this.m_duration,this.stretch(this.source2,0,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height);break;case 3:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height*r/this.m_duration,this.stretch(this.source2,this.m_source2Width-e,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height);break;case 4:e=this.m_source2Width/2*r/this.m_duration,(s=this.m_source2Height/2*r/this.m_duration)<5&&(s=5),this.stretch(this.source2,0,0,e,s,0,0,this.source1.width/2,this.source1.height/2),e=this.m_source2Width/2*r/this.m_duration,(s=this.m_source2Height/2*r/this.m_duration)<5&&(s=5),this.stretch(this.source2,this.m_source2Width-e,0,e,s,this.m_source2Width/2,0,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,this.stretch(this.source2,0,this.m_source2Height-s,e,s,0,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,this.stretch(this.source2,this.m_source2Width-e,this.m_source2Height-s,e,s,this.m_source2Width/2,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2);break;case 5:e=this.m_source2Width/2*r/this.m_duration,(s=this.m_source2Height/2*r/this.m_duration)<5&&(s=5),this.stretch(this.source2,this.m_source2Width/2-e,this.m_source2Height/2-s,e,s,0,0,this.source1.width/2,this.source1.height/2),e=this.m_source2Width/2*r/this.m_duration,(s=this.m_source2Height/2*r/this.m_duration)<5&&(s=5),this.stretch(this.source2,this.m_source2Width/2,this.m_source2Height/2-s,e,s,this.m_source2Width/2,0,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,this.stretch(this.source2,this.m_source2Width/2-e,this.m_source2Height/2,e,s,0,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2),e=this.m_source2Width/2*r/this.m_duration,s=this.m_source2Height/2*r/this.m_duration,this.stretch(this.source2,this.m_source2Width/2,this.m_source2Height/2,e,s,this.m_source2Width/2,this.m_source2Height/2,this.m_source2Width/2,this.m_source2Height/2);break;case 6:e=this.m_source2Width,s=this.m_source2Height*r/this.m_duration,this.stretch(this.source2,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height);break;case 7:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height,this.stretch(this.source2,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height);break;case 8:e=this.m_source2Width*r/this.m_duration,s=this.m_source2Height,this.stretch(this.source2,this.m_source2Width-e,0,e,s,0,0,this.m_source2Width,this.m_source2Height);break;case 9:e=this.m_source2Width,s=this.m_source2Height*r/this.m_duration,this.stretch(this.source2,0,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height)}return null},end:function(){this.finish()}}),lc.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height,this.m_phase=0);let e,s,r=this.getDeltaTime();if(r/this.m_duration>1)this.blit(this.source2);else switch(this.dwStyle){case 0:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.stretch(this.source1,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,this.stretch(this.source2,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 1:0==this.m_phase?(e=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.stretch(this.source1,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,this.stretch(this.source2,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 2:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.stretch(this.source1,this.m_source2Width-e,0,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,this.stretch(this.source2,this.m_source2Width-e,0,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 3:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=this.m_source2Height,this.stretch(this.source1,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=this.m_source2Height,this.stretch(this.source2,0,0,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 4:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=this.m_source2Height,this.stretch(this.source1,this.m_source2Width/2-e/2,0,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=this.m_source2Height,this.stretch(this.source2,this.m_source2Width/2-e/2,0,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 5:0==this.m_phase?(s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,e=this.m_source2Width,this.stretch(this.source1,0,this.m_source2Height/2-s/2,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,e=this.m_source2Width,this.stretch(this.source2,0,this.m_source2Height/2-s/2,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 6:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.stretch(this.source1,this.m_source2Width/2-e/2,this.m_source2Height/2-s/2,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,this.stretch(this.source2,this.m_source2Width/2-e/2,this.m_source2Height/2-s/2,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 7:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=this.m_source2Height,this.stretch(this.source1,this.m_source2Width-e,0,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=this.m_source2Height,this.stretch(this.source2,this.m_source2Height-e,0,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 8:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.stretch(this.source1,0,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,this.stretch(this.source2,0,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 9:0==this.m_phase?(e=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.stretch(this.source1,0,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,this.stretch(this.source2,0,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height));break;case 10:0==this.m_phase?(e=2*this.m_source2Width*r/this.m_duration,e=this.m_source2Width-e,s=2*this.m_source2Height*r/this.m_duration,s=this.m_source2Height-s,this.stretch(this.source1,this.m_source2Width-e,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height),r>=this.m_duration/2&&(this.m_phase=1)):(e=2*this.m_source2Width*r/this.m_duration,e-=this.m_source2Width,s=2*this.m_source2Height*r/this.m_duration,s-=this.m_source2Height,this.stretch(this.source2,this.m_source2Width-e,this.m_source2Height-s,e,s,0,0,this.m_source2Width,this.m_source2Height))}return null},end:function(){this.finish()}}),ld.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height,this.m_index=0,this.m_index2=0);let e,s,r,h,n,a=this.getDeltaTime();if(a/this.m_duration>1)this.blit(this.source2);else{if(s=this.m_source2Height*a/this.m_duration,e=this.m_source2Width*a/this.m_duration,0==this.dwStyle){for(r=0,n=s%2;r<this.m_source2Width;r+=2){for(h=this.m_index;h<s;h++)this.blit(this.source2,r,h,r,h,1,1);for(h=this.m_source2Height-s-n;h<this.m_source2Height-this.m_index;h++)this.blit(this.source2,r+1,h+1,r+1,h+1,1,1)}s%2==0?this.m_index=s:this.m_index=s-1}if(1==this.dwStyle){for(h=0,n=e%2;h<this.m_source2Height;h++){for(r=this.m_index2;r<e;r+=2)this.blit(this.source2,r+1,h,r+1,h,1,1);for(r=this.m_source2Width-e-n;r<this.m_source2Width-this.m_index2;r+=2)this.blit(this.source2,r,h+1,r,h+1,1,1)}e%2==0?this.m_index2=e:this.m_index2=e-1}if(2==this.dwStyle){for(r=0,n=s%2;r<this.m_source2Width;r+=2){for(h=this.m_index;h<s;h+=2)this.blit(this.source2,r,h,r,h,1,1);for(h=this.m_source2Height-s-n;h<this.m_source2Height-this.m_index;h+=2)this.blit(this.source2,r+1,h+1,r+1,h+1,1,1)}for(h=0,n=e%2;h<this.m_source2Height;h+=2){for(r=this.m_index2;r<e;r+=2)this.blit(this.source2,r+1,h,r+1,h,1,1);for(r=this.m_source2Width-e-n;r<this.m_source2Width-this.m_index2;r+=2)this.blit(this.source2,r,h+1,r,h+1,1,1)}s%2==0?this.m_index=s:this.m_index=s-1,e%2==0?this.m_index2=e:this.m_index2=e-1}}return null},end:function(){this.finish()}}),lp.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwPos=e.readAInt(),this.dwCheck1=e.readAInt(),this.dwCheck2=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height,this.m_angle=0);let e,s,r,h,n,a,l,u=this.getDeltaTime();return u/this.m_duration>1?this.blit(this.source2):(a=this.m_source2Width/2,l=this.m_source2Height/2,this.m_angle=6.28318*this.dwPos*u/this.m_duration,1==this.dwCheck2&&(this.m_angle=6.28318-this.m_angle),n=this.m_source2Width/2-this.m_source2Width/2*u/this.m_duration,e=Math.floor(a+Math.cos(this.m_angle)*n),s=Math.floor(l+Math.sin(this.m_angle)*n),r=this.m_source2Width*u/this.m_duration,h=this.m_source2Height*u/this.m_duration,this.stretch(this.source1,0,0,this.m_source2Width,this.m_source2Height,0,0,this.source1.width,this.source1.height),1==this.wCheck1?this.stretch(this.source2,e-r/2,s-h/2,r,h,0,0,this.m_source2Width,this.m_source2Height):this.stretch(this.source2,e-r/2,s-h/2,r,h,this.m_source2Width-r,this.m_source2Height-h,r,h)),null},end:function(){this.finish()}}),lm.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwPos=e.readAInt(),this.dwCheck1=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height,this.m_curcircle=0);let e=this.getDeltaTime();if(e/this.m_duration>1)this.blit(this.source2);else{let s,r,h,n,a,l=0;h=this.m_source2Width/2,n=this.m_source2Height/2,l=6.28318*this.dwPos*e/this.m_duration,l-=6.28318*this.m_curcircle,1==this.dwCheck1&&(l=6.28318-l),s=Math.floor(h+Math.cos(l)*(a=this.m_source2Width*e/this.m_duration)),r=Math.floor(n+Math.sin(l)*a),this.blit(this.source2),this.blit(this.source1,s-this.m_source2Width/2,r-this.m_source2Height/2,0,0,this.m_source2Width,this.m_source2Height),0==this.dwCheck1?l>=6.28318&&this.m_curcircle++:l<=0&&this.m_curcircle++}return null},end:function(){this.finish()}}),lf.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.zpSpotPercent=e.readAInt(),this.zpStartPoint=e.readAShort(),this.zpDirection=e.readAShort(),this.start(t,s,r,h)},stepDraw:function(t){let e=this.source1.width,s=this.source1.height;if(this.m_starting){switch(this.m_spotSize=Math.floor((e*this.zpSpotPercent/100+s*this.zpSpotPercent/100)/2),0==this.m_spotSize&&(this.m_spotSize=1),this.m_nbBlockPerLine=(e+this.m_spotSize-1)/this.m_spotSize,this.m_nbBlockPerCol=(s+this.m_spotSize-1)/this.m_spotSize,this.m_currentDirection=this.zpDirection,this.m_currentStartPoint=this.zpStartPoint,this.zpStartPoint){case az.TOP_LEFT:this.m_curx=this.m_cury=0;break;case az.TOP_RIGHT:this.m_curx=e-this.m_spotSize,this.m_cury=0;break;case az.BOTTOM_LEFT:this.m_curx=0,this.m_cury=s-this.m_spotSize;break;case az.BOTTOM_RIGHT:this.m_curx=e-this.m_spotSize,this.m_cury=s-this.m_spotSize;break;case az.CENTER:this.m_curx=e/2-this.m_spotSize,this.m_cury=s/2-this.m_spotSize,this.m_currentDirection==az.DIR_HORZ?this.m_currentStartPoint=az.TOP_LEFT:this.m_currentStartPoint=az.TOP_RIGHT,this.m_left=this.m_curx-this.m_spotSize,this.m_top=this.m_cury-this.m_spotSize,this.m_bottom=this.m_cury+2*this.m_spotSize,this.m_right=this.m_curx+2*this.m_spotSize,this.m_nbBlockPerLine=2+2*(this.m_curx+this.m_spotSize-1)/this.m_spotSize,this.m_nbBlockPerCol=2+2*(this.m_cury+this.m_spotSize-1)/this.m_spotSize}this.m_nbBlocks=Math.floor(this.m_nbBlockPerLine*this.m_nbBlockPerCol),this.m_lastNbBlocks=0,this.m_starting=!1}if(this.m_spotSize>=e||this.m_spotSize>=s)this.blit(this.source2);else{let r,h=Math.floor(this.m_nbBlocks*this.getDeltaTime()/this.m_duration),n=h-this.m_lastNbBlocks;if(0!=n)for(r=0,this.m_lastNbBlocks=h;r<n;r++)if(this.blit(this.source2,this.m_curx,this.m_cury,this.m_curx,this.m_cury,this.m_spotSize,this.m_spotSize),this.zpStartPoint==az.CENTER)switch(this.m_currentStartPoint){case az.TOP_LEFT:this.m_curx+=this.m_spotSize,this.m_curx>=this.m_right&&(this.m_curx-=this.m_spotSize,this.m_cury+=this.m_spotSize,this.m_currentStartPoint=az.TOP_RIGHT,this.m_right+=this.m_spotSize);break;case az.TOP_RIGHT:this.m_cury+=this.m_spotSize,this.m_cury>=this.m_bottom&&(this.m_cury-=this.m_spotSize,this.m_curx-=this.m_spotSize,this.m_currentStartPoint=az.BOTTOM_RIGHT,this.m_bottom+=this.m_spotSize);break;case az.BOTTOM_RIGHT:this.m_curx-=this.m_spotSize,this.m_curx+this.m_spotSize<=this.m_left&&(this.m_curx+=this.m_spotSize,this.m_cury-=this.m_spotSize,this.m_currentStartPoint=az.BOTTOM_LEFT,this.m_left-=this.m_spotSize);break;case az.BOTTOM_LEFT:this.m_cury-=this.m_spotSize,this.m_cury+this.m_spotSize<=this.m_top&&(this.m_cury+=this.m_spotSize,this.m_curx+=this.m_spotSize,this.m_currentStartPoint=az.TOP_LEFT,this.m_top-=this.m_spotSize)}else switch(this.m_currentDirection){case az.DIR_HORZ:switch(this.m_currentStartPoint){case az.TOP_LEFT:this.m_curx+=this.m_spotSize,this.m_curx>=e&&(this.m_curx-=this.m_spotSize,this.m_cury+=this.m_spotSize,this.m_currentStartPoint=az.TOP_RIGHT);break;case az.TOP_RIGHT:this.m_curx-=this.m_spotSize,this.m_curx+this.m_spotSize<=0&&(this.m_curx+=this.m_spotSize,this.m_cury+=this.m_spotSize,this.m_currentStartPoint=az.TOP_LEFT);break;case az.BOTTOM_LEFT:this.m_curx+=this.m_spotSize,this.m_curx>=e&&(this.m_curx-=this.m_spotSize,this.m_cury-=this.m_spotSize,this.m_currentStartPoint=az.BOTTOM_RIGHT);break;case az.BOTTOM_RIGHT:this.m_curx-=this.m_spotSize,this.m_curx+this.m_spotSize<=0&&(this.m_curx+=this.m_spotSize,this.m_cury-=this.m_spotSize,this.m_currentStartPoint=az.BOTTOM_LEFT)}break;case az.DIR_VERT:switch(this.m_currentStartPoint){case az.TOP_LEFT:this.m_cury+=this.m_spotSize,this.m_cury>=s&&(this.m_cury-=this.m_spotSize,this.m_curx+=this.m_spotSize,this.m_currentStartPoint=az.BOTTOM_LEFT);break;case az.TOP_RIGHT:this.m_cury+=this.m_spotSize,this.m_cury>=s&&(this.m_cury-=this.m_spotSize,this.m_curx-=this.m_spotSize,this.m_currentStartPoint=az.BOTTOM_RIGHT);break;case az.BOTTOM_LEFT:this.m_cury-=this.m_spotSize,this.m_cury+this.m_spotSize<=0&&(this.m_cury+=this.m_spotSize,this.m_curx+=this.m_spotSize,this.m_currentStartPoint=az.TOP_LEFT);break;case az.BOTTOM_RIGHT:this.m_cury-=this.m_spotSize,this.m_cury+this.m_spotSize<=0&&(this.m_cury+=this.m_spotSize,this.m_curx-=this.m_spotSize,this.m_currentStartPoint=az.TOP_RIGHT)}}}return null},end:function(){this.finish()}}),l$.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwStyle=e.readAInt(),this.dwPos=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height,this.m_linepos=0,this.m_dir=0);let e=this.getDeltaTime();if(e/this.m_duration>1)this.blit(this.source2);else{let s,r,h,n,a=0;0==this.dwStyle?(a=this.m_source2Height/this.dwPos,n=Math.floor(this.m_linepos*a)+Math.floor(a),r=0,h=(h=this.m_source2Width*e/this.m_duration)*this.dwPos/2,h-=this.m_source2Width*this.m_linepos,s=0==this.m_dir?0:this.m_source2Width-h,this.blit(this.source2,s,r,s,r,h,n),r=this.m_source2Height-n,s=1==this.m_dir?0:this.m_source2Width-h,this.blit(this.source2,s,r,s,r,h,n),h>=this.m_source2Width&&(this.m_linepos++,this.m_dir++,2==this.m_dir&&(this.m_dir=0))):(a=this.m_source2Width/this.dwPos,h=Math.floor(this.m_linepos*a)+Math.floor(a),s=0,n=(n=this.m_source2Height*e/this.m_duration)*this.dwPos/2,n-=this.m_source2Height*this.m_linepos,r=0==this.m_dir?0:this.m_source2Height-n,this.blit(this.source2,s,r,s,r,h,n),s=this.m_source2Width-h,r=1==this.m_dir?0:this.m_source2Height-n,this.blit(this.source2,s,r,s,r,h,n),n>=this.m_source2Height&&(this.m_linepos++,this.m_dir++,2==this.m_dir&&(this.m_dir=0)))}return null},end:function(){this.finish()}}),lg.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.start(t,s,r,h)},stepDraw:function(t){let e=this.source1.width,s=this.source1.height;if(this.m_starting&&(this.m_starting=!1),0==this.m_duration)this.blit(this.source2);else{let r,h,n=this.getDeltaTime();(t&az.TRFLAG_FADEOUT)!=0?(r=Math.floor(e-e*n/this.m_duration),h=Math.floor(s-s*n/this.m_duration),this.blit(this.source2),this.stretch(this.source1,(e-r)/2,(s-h)/2,r,h,0,0,e,s)):(r=Math.floor(e*n/this.m_duration),h=Math.floor(s*n/this.m_duration),this.blit(this.source1),this.stretch(this.source2,(e-r)/2,(s-h)/2,r,h,0,0,e,s))}return null},end:function(){this.finish()}}),lP.prototype=h.extend(new az,{init:function(t,e,s,r,h){this.dwPos=e.readAInt(),this.start(t,s,r,h)},stepDraw:function(t){this.m_starting&&(this.m_starting=!1,this.m_source2Width=this.source2.width,this.m_source2Height=this.source2.height);let e,s,r,h,n=this.getDeltaTime();return n/this.m_duration>1?this.blit(this.source2):0==this.dwPos?(r=this.m_source2Width*n/this.m_duration,h=this.m_source2Height*n/this.m_duration,e=this.m_source2Width/2-r/2,s=this.m_source2Height/2-h/2,this.stretch(this.source2,0,0,this.m_source2Width,this.m_source2Height,e,s,r,h)):(r=this.m_source2Width*n/this.m_duration,r=this.m_source2Width-r,h=this.m_source2Height*n/this.m_duration,h=this.m_source2Height-h,e=this.m_source2Width/2-r/2,s=this.m_source2Height/2-h/2,this.stretch(this.source1,0,0,this.m_source2Width,this.m_source2Height,e,s,r,h)),null},end:function(){this.finish()}});var l8,lE,l_,lA,l0,lv,lO,lS,lT=function(t,e){this.files={},this.root="",t&&this.load(t,e)};lT.signature={LOCAL_FILE_HEADER:"PK\x03\x04",CENTRAL_FILE_HEADER:"PK\x01\x02",CENTRAL_DIRECTORY_END:"PK\x05\x06",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK\x06\x07",ZIP64_CENTRAL_DIRECTORY_END:"PK\x06\x06",DATA_DESCRIPTOR:"PK\x07\b"},lT.defaults={base64:!1,binary:!1,dir:!1,date:null,compression:null},lT.prototype=((l8=function(t,e,s){this.name=t,this.data=e,this.options=s}).prototype={asText:function(){let t=this.data;return null==t?"":(this.options.base64&&(t=lb.decode(t)),this.options.binary&&(t=lT.prototype.utf8decode(t)),t)},asBinary:function(){let t=this.data;return null==t?"":(this.options.base64&&(t=lb.decode(t)),this.options.binary||(t=lT.prototype.utf8encode(t)),t)},asUint8Array:function(){return lT.utils.string2Uint8Array(this.asBinary())},asArrayBuffer:function(){return lT.utils.string2Uint8Array(this.asBinary()).buffer}},lE=function(t,e){let s,r="";for(s=0;s<e;s++)r+=String.fromCharCode(255&t),t>>>=8;return r},l_=function(){let t,e,s={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===s[e]&&(s[e]=arguments[t][e]);return s},lA=function(t,e,s){let r,h=l0(t);if(h&&lv.call(this,h),(s=(!0===(r=(r=s)||{}).base64&&null==r.binary&&(r.binary=!0),(r=l_(r,lT.defaults)).date=r.date||new Date,null!==r.compression&&(r.compression=r.compression.toUpperCase()),r)).dir||null==e)s.base64=!1,s.binary=!1,e=null;else if(lT.support.uint8array&&e instanceof Uint8Array)s.base64=!1,s.binary=!0,e=lT.utils.uint8Array2String(e);else if(lT.support.arraybuffer&&e instanceof ArrayBuffer){s.base64=!1,s.binary=!0;let n=new Uint8Array(e);e=lT.utils.uint8Array2String(n)}else s.binary&&!s.base64&&(!0!==s.optimizedBinaryString&&(e=lT.utils.string2binary(e)),delete s.optimizedBinaryString);return this.files[t]=new l8(t,e,s)},l0=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));let e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},lv=function(t){if("/"!=t.slice(-1)&&(t+="/"),!this.files[t]){let e=l0(t);e&&lv.call(this,e),lA.call(this,t,null,{dir:!0})}return this.files[t]},lO=function(t,e,s){let r,h,n=e!==t.name,a=t.asBinary(),l=t.options;r=l.date.getHours(),r<<=6,r|=l.date.getMinutes(),r<<=5,r|=l.date.getSeconds()/2,h=l.date.getFullYear()-1980,h<<=4,h|=l.date.getMonth()+1,h<<=5,h|=l.date.getDate();let u=null!==a&&0!==a.length;if(s=l.compression||s,!lT.compressions[s])throw s+" is not a valid compression method !";let d=lT.compressions[s],p=u?d.compress(a):"",m="";return m+="\n\0",m+=n?"\0\b":"\0\0",m+=u?d.magic:lT.compressions.STORE.magic,m+=lE(r,2),m+=lE(h,2),m+=u?lE(this.crc32(a),4):"\0\0\0\0",m+=u?lE(p.length,4):"\0\0\0\0",m+=u?lE(a.length,4):"\0\0\0\0",m+=lE(e.length,2),{header:m+="\0\0",compressedData:p}},{load:function(t,e){throw Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){let e,s,r,h,n=[];for(e in this.files)this.files.hasOwnProperty(e)&&(r=this.files[e],h=new l8(r.name,r.data,l_(r.options)),s=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(s,h)&&n.push(h));return n},file:function(t,e,s){if(1===arguments.length){if(!(t instanceof RegExp))return this.filter(function(e,s){return!s.options.dir&&e===t})[0]||null;let r=t;return this.filter(function(t,e){return!e.options.dir&&r.test(t)})}return t=this.root+t,lA.call(this,t,e,s),this},folder:function(t){if(!t)return this;if(t instanceof RegExp)return this.filter(function(e,s){return s.options.dir&&t.test(e)});let e=this.root+t,s=lv.call(this,e),r=this.clone();return r.root=s.name,r},remove:function(t){t=this.root+t;let e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e){if(e.options.dir)for(let s=this.filter(function(e,s){return s.name.slice(0,t.length)===t}),r=0;r<s.length;r++)delete this.files[s[r].name];else delete this.files[t]}return this},generate:function(t){let e=(t=l_(t||{},{base64:!0,compression:"STORE",type:"base64"})).compression.toUpperCase();if(!lT.compressions[e])throw e+" is not a valid compression method !";let s=[],r=[],h=0;for(let n in this.files)if(this.files.hasOwnProperty(n)){let a=this.files[n],l=this.utf8encode(a.name),u="",d="",p=lO.call(this,a,l,e);u=lT.signature.LOCAL_FILE_HEADER+p.header+l+p.compressedData,d=lT.signature.CENTRAL_FILE_HEADER+"\x14\0"+p.header+"\0\0\0\0\0\0"+(!0===this.files[n].options.dir?"\x10\0\0\0":"\0\0\0\0")+lE(h,4)+l,h+=u.length,r.push(u),s.push(d)}let m=r.join(""),f=s.join(""),$="";$=lT.signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+lE(r.length,2)+lE(r.length,2)+lE(f.length,4)+lE(m.length,4)+"\0\0";let g=m+f+$;switch(t.type.toLowerCase()){case"uint8array":return lT.utils.string2Uint8Array(g);case"arraybuffer":return lT.utils.string2Uint8Array(g).buffer;case"blob":return lT.utils.string2Blob(g);case"base64":return t.base64?lb.encode(g):g;default:return g}},crc32:function(t,e){if(""===t||void 0===t)return 0;let s=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];void 0===e&&(e=0);let r=0,h=0;e^=-1;for(let n=0,a=t.length;n<a;n++)r=s[h=(e^t.charCodeAt(n))&255],e=e>>>8^r;return -1^e},clone:function(){let t=new lT;for(let e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t},utf8encode:function(t){for(var e="",s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e},utf8decode:function(t){for(var e="",s=0,r=0,h=0,n=0;s<t.length;)(r=t.charCodeAt(s))<128?(e+=String.fromCharCode(r),s++):r>191&&r<224?(e+=String.fromCharCode((31&r)<<6|63&(h=t.charCodeAt(s+1))),s+=2):(e+=String.fromCharCode((15&r)<<12|(63&(h=t.charCodeAt(s+1)))<<6|63&(n=t.charCodeAt(s+2))),s+=3);return e}}),lT.compressions={STORE:{magic:"\0\0",compress:function(t){return t},uncompress:function(t){return t}}},lT.support={arraybuffer:"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,uint8array:"undefined"!=typeof Uint8Array,blob:function(){if("undefined"==typeof ArrayBuffer)return!1;let t=new ArrayBuffer(0);try{return 0===new Blob([t],{type:"application/zip"}).size}catch(e){}try{let s=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return s.append(t),0===s.getBlob("application/zip").size}catch(r){}return!1}()},lT.utils={string2binary:function(t){for(var e="",s=0;s<t.length;s++)e+=String.fromCharCode(255&t.charCodeAt(s));return e},string2Uint8Array:function(t){if(!lT.support.uint8array)throw Error("Uint8Array is not supported by this browser");for(var e=new ArrayBuffer(t.length),s=new Uint8Array(e),r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s},uint8Array2String:function(t){if(!lT.support.uint8array)throw Error("Uint8Array is not supported by this browser");for(var e="",s=0;s<t.length;s++)e+=String.fromCharCode(t[s]);return e},string2Blob:function(t){if(!lT.support.blob)throw Error("Blob is not supported by this browser");let e=lT.utils.string2Uint8Array(t).buffer;try{return new Blob([e],{type:"application/zip"})}catch(s){}try{let r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return r.append(e),r.getBlob("application/zip")}catch(h){}throw Error("Bug : can't construct the Blob.")}};var lb=(lS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",{encode:function(t,e){for(var s,r,h,n,a,l,u,d="",p=0;p<t.length;)s=t.charCodeAt(p++),r=t.charCodeAt(p++),h=t.charCodeAt(p++),n=s>>2,a=(3&s)<<4|r>>4,l=(15&r)<<2|h>>6,u=63&h,isNaN(r)?l=u=64:isNaN(h)&&(u=64),d=d+lS.charAt(n)+lS.charAt(a)+lS.charAt(l)+lS.charAt(u);return d},decode:function(t,e){let s,r,h,n,a,l,u,d="",p=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");p<t.length;)n=lS.indexOf(t.charAt(p++)),a=lS.indexOf(t.charAt(p++)),l=lS.indexOf(t.charAt(p++)),u=lS.indexOf(t.charAt(p++)),s=n<<2|a>>4,r=(15&a)<<4|l>>2,h=(3&l)<<6|u,d+=String.fromCharCode(s),64!=l&&(d+=String.fromCharCode(r)),64!=u&&(d+=String.fromCharCode(h));return d}});if(!lT)throw"JSZip not defined";!function(){let t,e,s,r,h,n,a,l,u,d,p,m,f,$,g,P,E,_=null,A=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function C(){this.next=null,this.list=null}function L(){this.e=0,this.b=0,this.n=0,this.t=null}function I(t,e,s,r,h,n){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;let a,l,u,d,p,m,f,$,g,P,E,_,A,v,O,S,T,b=Array(this.BMAX+1),I=Array(this.BMAX+1),F=new L,R=Array(this.BMAX),M=Array(this.N_MAX),w=Array(this.BMAX+1);for(m=0,T=this.root=null;m<b.length;m++)b[m]=0;for(m=0;m<I.length;m++)I[m]=0;for(m=0;m<R.length;m++)R[m]=null;for(m=0;m<M.length;m++)M[m]=0;for(m=0;m<w.length;m++)w[m]=0;l=e>256?t[256]:this.BMAX,g=t,P=0,m=e;do b[g[P]]++,P++;while(--m>0);if(b[0]==e){this.root=null,this.m=0,this.status=0;return}for(f=1;f<=this.BMAX&&0==b[f];f++);for($=f,n<f&&(n=f),m=this.BMAX;0!=m&&0==b[m];m--);for(d=m,n>m&&(n=m),v=1<<f;f<m;f++,v<<=1)if((v-=b[f])<0){this.status=2,this.m=n;return}if((v-=b[m])<0){this.status=2,this.m=n;return}for(b[m]+=v,w[1]=f=0,g=b,P=1,A=2;--m>0;)w[A++]=f+=g[P++];g=t,P=0,m=0;do 0!=(f=g[P++])&&(M[w[f]++]=m);while(++m<e);for(e=w[d],w[0]=m=0,g=M,P=0,p=-1,_=I[0]=0,E=null,O=0;$<=d;$++)for(a=b[$];a-- >0;){for(;$>_+I[1+p];){if(_+=I[1+p],p++,O=(O=d-_)>n?n:O,(u=1<<(f=$-_))>a+1)for(u-=a+1,A=$;++f<O&&!((u<<=1)<=b[++A]);)u-=b[A];for(_+f>l&&_<l&&(f=l-_),O=1<<f,I[1+p]=f,E=Array(O),S=0;S<O;S++)E[S]=new L;(T=null==T?this.root=new C:T.next=new C).next=null,T.list=E,R[p]=E,p>0&&(w[p]=m,F.b=I[p],F.e=16+f,F.t=E,f=(m&(1<<_)-1)>>_-I[p],R[p-1][f].e=F.e,R[p-1][f].b=F.b,R[p-1][f].n=F.n,R[p-1][f].t=F.t)}for(F.b=$-_,P>=e?F.e=99:g[P]<s?(F.e=g[P]<256?16:15,F.n=g[P++]):(F.e=h[g[P]-s],F.n=r[g[P++]-s]),u=1<<$-_,f=m>>_;f<O;f+=u)E[f].e=F.e,E[f].b=F.b,E[f].n=F.n,E[f].t=F.t;for(f=1<<$-1;(m&f)!=0;f>>=1)m^=f;for(m^=f;(m&(1<<_)-1)!=w[p];)_-=I[p],p--}this.m=I[1],this.status=0!=v&&1!=d?1:0}function F(){return P.length==E?-1:255&P.charCodeAt(E++)}function R(t){for(;a<t;)n|=F()<<a,a+=8}function M(t){return n&A[t]}function w(t){n>>=t,a-=t}function k(t,r,h){let n,a,u;if(0==h)return 0;for(u=0;;){for(R($),n=(a=m.list[M($)]).e;n>16;){if(99==n)return -1;w(a.b),R(n-=16),n=(a=a.t[M(n)]).e}if(w(a.b),16==n){if(s&=32767,t[r+u++]=e[s++]=a.n,u==h)return h;continue}if(15==n)break;for(R(n),d=a.n+M(n),w(n),R(g),n=(a=f.list[M(g)]).e;n>16;){if(99==n)return -1;w(a.b),R(n-=16),n=(a=a.t[M(n)]).e}for(w(a.b),R(n),p=s-a.n-M(n),w(n);d>0&&u<h;)d--,p&=32767,s&=32767,t[r+u++]=e[s++]=e[p++];if(u==h)return h}return l=-1,u}function N(t,r,h){let u;if(w(u=7&a),R(16),u=M(16),w(16),R(16),u!=(65535&~n))return -1;for(w(16),d=u,u=0;d>0&&u<h;)d--,s&=32767,R(8),t[r+u++]=e[s++]=M(8),w(8);return 0==d&&(l=-1),u}function D(e,s,n){if(null==_){let a,l,u=Array(288);for(a=0;a<144;a++)u[a]=8;for(;a<256;a++)u[a]=9;for(;a<280;a++)u[a]=7;for(;a<288;a++)u[a]=8;if(h=7,0!=(l=new I(u,288,257,v,O,h)).status)return alert("HufBuild error: "+l.status),-1;for(a=0,_=l.root,h=l.m;a<30;a++)u[a]=5;if(t=5,(l=new I(u,30,0,S,T,t)).status>1)return _=null,alert("HufBuild error: "+l.status),-1;r=l.root,t=l.m}return m=_,f=r,$=h,g=t,k(e,s,n)}function H(t,e,s){let r,h,n,a,l,u,d,p,P,E=Array(316);for(r=0;r<E.length;r++)E[r]=0;if(R(5),d=257+M(5),w(5),R(5),p=1+M(5),w(5),R(4),u=4+M(4),w(4),d>286||p>30)return -1;for(h=0;h<u;h++)R(3),E[b[h]]=M(3),w(3);for(;h<19;h++)E[b[h]]=0;if($=7,0!=(P=new I(E,19,19,null,null,$)).status)return -1;for(m=P.root,$=P.m,a=d+p,r=n=0;r<a;)if(R($),w(h=(l=m.list[M($)]).b),(h=l.n)<16)E[r++]=n=h;else if(16==h){if(R(2),h=3+M(2),w(2),r+h>a)return -1;for(;h-- >0;)E[r++]=n}else if(17==h){if(R(3),h=3+M(3),w(3),r+h>a)return -1;for(;h-- >0;)E[r++]=0;n=0}else{if(R(7),h=11+M(7),w(7),r+h>a)return -1;for(;h-- >0;)E[r++]=0;n=0}if($=9,P=new I(E,d,257,v,O,$),0==$&&(P.status=1),0!=P.status)return P.status,-1;for(r=0,m=P.root,$=P.m;r<p;r++)E[r]=E[r+d];return(g=6,f=(P=new I(E,p,0,S,T,g)).root,0==(g=P.m)&&d>257)?-1:(P.status,0!=P.status)?-1:k(t,e,s)}function B(t,r,h){let n,a;for(n=0;n<h&&(!u||-1!=l);){if(d>0){if(0!=l)for(;d>0&&n<h;)d--,p&=32767,s&=32767,t[r+n++]=e[s++]=e[p++];else{for(;d>0&&n<h;)d--,s&=32767,R(8),t[r+n++]=e[s++]=M(8),w(8);0==d&&(l=-1)}if(n==h)break}if(-1==l){if(u)break;R(1),0!=M(1)&&(u=!0),w(1),R(2),l=M(2),w(2),m=null,d=0}switch(l){case 0:a=N(t,r+n,h-n);break;case 1:a=null!=m?k(t,r+n,h-n):D(t,r+n,h-n);break;case 2:a=null!=m?k(t,r+n,h-n):H(t,r+n,h-n);break;default:a=-1}if(-1==a){if(u)return 0;return -1}n+=a}return n}function G(t){let r,h,f,$;for(null==e&&(e=Array(65536)),s=0,n=0,a=0,l=-1,u=!1,d=p=0,m=null,P=t,E=0,h=Array(1024),r="";(f=B(h,0,h.length))>0;)for($=0;$<f;$++)r+=String.fromCharCode(h[$]);return P=null,r}lT.compressions.DEFLATE?lT.compressions.DEFLATE.uncompress=G:lT.compressions.DEFLATE={magic:"\b\0",uncompress:G}}(),function(){let t=function(t){let e,s,r="";for(s=0;s<(t||"").length;s++)r+="\\x"+((e=t.charCodeAt(s))<16?"0":"")+e.toString(16).toUpperCase();return r},e=function(t){for(let e in lT.compressions)if(lT.compressions.hasOwnProperty(e)&&lT.compressions[e].magic===t)return lT.compressions[e];return null};function s(t){if(this.stream="",lT.support.uint8array&&t instanceof Uint8Array)this.stream=lT.utils.uint8Array2String(t);else if(lT.support.arraybuffer&&t instanceof ArrayBuffer){let e=new Uint8Array(t);this.stream=lT.utils.uint8Array2String(e)}else this.stream=lT.utils.string2binary(t);this.index=0}function r(t,e){this.options=t,this.loadOptions=e}function h(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}s.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.stream.length<t||t<0)throw Error("End of stream reached (stream length = "+this.stream.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){return this.stream.charCodeAt(t)},readInt:function(t){let e,s=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)s=(s<<8)+this.byteAt(e);return this.index+=t,s},readString:function(t){this.checkOffset(t);let e=this.stream.slice(this.index,this.index+t);return this.index+=t,e},readDate:function(){let t=this.readInt(4);return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},r.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(s){let r,h;if(s.skip(22),this.fileNameLength=s.readInt(2),h=s.readInt(2),this.fileName=s.readString(this.fileNameLength),s.skip(h),-1==this.compressedSize||-1==this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(this.compressedFileData=s.readString(this.compressedSize),null===(r=e(this.compressionMethod)))throw Error("Corrupted zip : compression "+t(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.uncompressedFileData=r.uncompress(this.compressedFileData),this.uncompressedFileData.length!==this.uncompressedSize)throw Error("Bug : uncompressed data size mismatch");if(this.loadOptions.checkCRC32&&lT.prototype.crc32(this.uncompressedFileData)!==this.crc32)throw Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readString(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){let e=new s(this.extraFields[1].value);-1===this.uncompressedSize&&(this.uncompressedSize=e.readInt(8)),-1===this.compressedSize&&(this.compressedSize=e.readInt(8)),-1===this.localHeaderOffset&&(this.localHeaderOffset=e.readInt(8)),-1===this.diskNumberStart&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){let e,s,r,h=t.index;for(this.extraFields=this.extraFields||{};t.index<h+this.extraFieldsLength;)e=t.readInt(2),s=t.readInt(2),r=t.readString(s),this.extraFields[e]={id:e,length:s,value:r}},handleUTF8:function(){this.useUTF8()&&(this.fileName=lT.prototype.utf8decode(this.fileName),this.fileComment=lT.prototype.utf8decode(this.fileComment))}},h.prototype={checkSignature:function(e){let s=this.reader.readString(4);if(s!==e)throw Error("Corrupted zip or bug : unexpected signature ("+t(s)+", expected "+t(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,s,r=this.zip64EndOfCentralSize-44;0<r;)t=this.reader.readInt(2),e=this.reader.readInt(4),s=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:s}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){let t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(lT.signature.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8()},readCentralDir:function(){let t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===lT.signature.CENTRAL_FILE_HEADER;)(t=new r({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){let t=this.reader.stream.lastIndexOf(lT.signature.CENTRAL_DIRECTORY_END);if(-1===t)throw Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(t),this.checkSignature(lT.signature.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),65535===this.diskNumber||65535===this.diskWithCentralDirStart||65535===this.centralDirRecordsOnThisDisk||65535===this.centralDirRecords||-1===this.centralDirSize||-1===this.centralDirOffset){if(this.zip64=!0,-1===(t=this.reader.stream.lastIndexOf(lT.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(lT.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(lT.signature.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},load:function(t){this.reader=new s(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},lT.prototype.load=function(t,e){let s,r,n,a;for((e=e||{}).base64&&(t=lb.decode(t)),s=(r=new h(t,e)).files,n=0;n<s.length;n++)a=s[n],this.file(a.fileName,a.uncompressedFileData,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir});return this}}();let lC=document.getElementsByTagName("script"),lL=lC[lC.length-1].src;function t(t,e){let s=new g;r.application=new ny(t,s,e),s.getFile(e,lI)}function lI(){r.application.load()}function lF(){r.application.stepApplication()}function ly(){this.x=0,this.y=0,this.visible=!0,this.children=[],this.bZoom=!1}function lx(){}function lR(){this.mask=null,this.lineWidth=0,this.height=0,this.width=0,this.xSpot=0,this.ySpot=0,this.lineWidth=0}function lM(){this.mask=null,this.angle=0,this.scaleX=1,this.scaleY=1,this.tick=0}function l2(){this.hoPtr=null,this.rsFlash=0,this.rsFlashCpt=0,this.rsLayer=0,this.rsZOrder=0,this.rsCreaFlags=0,this.rsBackColor=0,this.rsEffect=0,this.rsEffectParam=0,this.rsFlags=0,this.rsSpriteType=0,this.rsTransparency=0,this.rsTrans=null}function lw(){this.nStrings=0,this.strings=null}function lk(){this.nValues=0,this.values=null,this.flags=0}function lN(){this.rvValueFlags=0,this.rvValues=null,this.rvStrings=null}function l1(t){this.app=t,this.extensions=null,this.numOfConditions=0}function lD(){this.handle=0}function l4(){this.ho=null,this.rh=null}function l3(){}function lH(){}function lB(){}function l6(){this.mvType=100,this.mvControl=0,this.mvMoveAtStart=0,this.mvDirAtStart=0,this.mvOpt=0}function lG(){this.nMovements=0,this.moveList=null}function l5(){this.mbSpeed=0,this.mbBounce=0,this.mbAngles=0,this.mbSecurity=0,this.mbDecelerate=0}function lY(){this.mgSpeed=0,this.mgAcc=0,this.mgDec=0,this.mgBounceMult=0,this.mgDir=0}function lj(){this.mmDx=0,this.mmFx=0,this.mmDy=0,this.mmFy=0,this.mmFlags=0}function lX(){this.mtNumber=0,this.mtMinSpeed=0,this.mtMaxSpeed=0,this.mtLoop=0,this.mtRepos=0,this.mtReverse=0,this.steps=null}function lW(){this.mdSpeed=0,this.mdDir=0,this.mdDx=0,this.mdDy=0,this.mdCosinus=0,this.mdSinus=0,this.mdLength=0,this.mdPause=0,this.mdName=null}function l7(){this.mpSpeed=0,this.mpAcc=0,this.mpDec=0,this.mpJumpControl=0,this.mpGravity=0,this.mpJump=0}function lV(){this.mrSpeed=0,this.mrAcc=0,this.mrDec=0,this.mrRot=0,this.mrBounceMult=0,this.mrAngles=0,this.mrOkReverse=0}function lU(){}function lK(){this.moduleName=null,this.mvtID=0,this.data=0}function lq(){this.hoPtr=null,this.rmAcc=0,this.rmDec=0,this.rmCollisionCount=0,this.rmStopSpeed=0,this.rmAccValue=0,this.rmDecValue=0,this.rmOpt=0}function lz(){this.MB_StartDir=0,this.MB_Angles=0,this.MB_Securite=0,this.MB_SecuCpt=0,this.MB_Bounce=0,this.MB_Speed=0,this.MB_MaskBounce=0,this.MB_LastBounce=0,this.MB_Blocked=!1}function lJ(){this.MBul_Wait=!1,this.MBul_ShootObject=null}function lQ(){}function lZ(){this.MG_Bounce=0,this.MG_OkDirs=0,this.MG_BounceMu=0,this.MG_Speed=0,this.MG_LastBounce=0,this.MG_DirMask=0}function l9(){this.MM_DXMouse=0,this.MM_DYMouse=0,this.MM_FXMouse=0,this.MM_FYMouse=0,this.MM_Stopped=0,this.MM_OldSpeed=0}function ut(){this.MT_Speed=0,this.MT_Sinus=0,this.MT_Cosinus=0,this.MT_Longueur=0,this.MT_XOrigin=0,this.MT_YOrigin=0,this.MT_XDest=0,this.MT_YDest=0,this.MT_MoveNumber=0,this.MT_Direction=!1,this.MT_Movement=null,this.MT_Calculs=0,this.MT_XStart=0,this.MT_YStart=0,this.MT_Pause=0,this.MT_GotoNode=null,this.MT_FlagBranch=!1}function ue(){this.MP_Type=0,this.MP_Bounce=0,this.MP_BounceMu=0,this.MP_XSpeed=0,this.MP_Gravity=0,this.MP_Jump=0,this.MP_YSpeed=0,this.MP_XMB=0,this.MP_YMB=0,this.MP_HTFOOT=0,this.MP_JumpControl=0,this.MP_JumpStopped=0,this.MP_PreviousDir=0,this.MP_ObjectUnder=null,this.MP_XObjectUnder=0,this.MP_YObjectUnder=0,this.MP_NoJump=!1}function ui(){this.MR_Bounce=0,this.MR_BounceMu=0,this.MR_Speed=0,this.MR_RotSpeed=0,this.MR_RotCpt=0,this.MR_RotPos=0,this.MR_RotMask=0,this.MR_OkReverse=0,this.MR_OldJoy=0,this.MR_LastBounce=0}function us(){}function ur(){this.rmObject=null,this.rmMvtNum=0,this.rmMovement=null,this.rmWrapping=0,this.rmMoveFlag=!1,this.rmReverse=0,this.rmBouncing=!1,this.rmEventFlags=0}function uh(){this.ini=null,this.iniFlags=0,this.iniName=null,this.iniCurrentGroup=null,this.iniCurrentItem=null,this.changeCounter=0}document.srcPath=lL.substring(0,lL.lastIndexOf("/")+1),r.Runtime=t,r.headerLoaded=lI,r.ua="updateApplication",r[window.ua]=lF,ly.prototype={draw:function(t,e,s){if(this.visible){let r;for(this.bZoom&&(t._context.save(),t._context.translate(this.xDest,this.yDest),0!=this.angle&&t._context.rotate(-(.0174532925*this.angle)),t._context.scale(Math.max(.001,this.scaleX),Math.max(.001,this.scaleY)),t._context.translate(-this.xSpot,-this.ySpot)),r=0;r<this.children.length;r++)this.children[r].draw(t,e+this.x,s+this.y);this.bZoom&&t._context.restore()}},addChild:function(t){this.children.push(t)},addChildIndex:function(t,e){e>=this.children.length?this.children.push(t):(e<0&&(e=0),this.children.splice(e,0,t))},removeAll:function(){this.children.length=0},removeChild:function(t){let e;for(e=0;e<this.children.length;e++)if(this.children[e]==t)return this.children.splice(e,1),e;return -1},getChildIndex:function(t){let e;for(e=0;e<this.children.length;e++)if(this.children[e]==t)return e;return -1},getNumChildren:function(){return this.children.length},setChildIndex:function(t,e){let s,r=null;for(s=0;s<this.children.length;s++)if(this.children[s]==t){r=this.children[s];break}null!=r&&(this.children.splice(s,1),e>s&&e--,e<0&&(e=0),e>=this.children.length?this.children.push(t):this.children.splice(e,0,t))}},lx.CM_TEST_OBSTACLE=0,lx.CM_TEST_PLATFORM=1,lx.CM_OBSTACLE=1,lx.CM_PLATFORM=2,lx.COLMASK_XMARGIN=64,lx.COLMASK_YMARGIN=16,lx.HEIGHT_PLATFORM=6,lR.SCMF_FULL=0,lR.SCMF_PLATFORM=1,lR.GCMF_OBSTACLE=0,lR.GCMF_PLATFORM=1,lR.lMask=[65535,32767,16383,8191,4095,2047,1023,511,255,127,63,31,15,7,3,1],lR.rMask=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535],lR.topLeft=new _,lR.topRight=new _,lR.bottomLeft=new _,lR.bottomRight=new _,lR.prototype={createMask:function(t,e,s){this.width=e.width,this.height=e.height,this.xSpot=e.xSpot,this.ySpot=e.ySpot;let r,h,n,a,l,u=Math.floor((this.width+15&4294967280)/16);this.lineWidth=u;let d=u*this.height+1;if("undefined"!=typeof ArrayBuffer)this.mask=new Uint16Array(new ArrayBuffer(2*d));else for(r=0,this.mask=Array(d);r<d;r++)this.mask[r]=0;let p=document.createElement("canvas");p.width=e.width,p.height=e.height;let m=p.getContext("2d");0==e.mosaic?m.drawImage(e.img,0,0):m.drawImage(t.imageBank.mosaics[e.mosaic],e.mosaicX,e.mosaicY,e.width,e.height,0,0,e.width,e.height);let f=m.getImageData(0,0,this.width,this.height);if((s&lR.GCMF_PLATFORM)==0)for(h=0;h<this.height;h++){let $=h*e.width*4+3,g=h*u,P=32768;for(r=0;r<this.width;r++)0!=f.data[$]&&(this.mask[g]|=P),$+=4,0==(P>>>=1)&&(P=32768,g++)}else for(r=0;r<this.width;r++){for(h=0;h<this.height&&0==f.data[(h*e.width+r)*4+3];h++);if(h<this.height)for(a=Math.min(this.height,h+lx.HEIGHT_PLATFORM),l=32768>>(15&r);h<a;h++)0!=f.data[(h*e.width+r)*4+3]&&(n=Math.floor(h*u+(4294967280&r)/16),this.mask[n]|=l)}},rotateRect:function(t,e,s){if(90==s)n=0,a=1;else if(180==s)n=-1,a=0;else if(270==s)n=0,a=-1;else{var r,h,n,a,l,u,d,p,m=s*Math.PI/180;n=Math.cos(m),a=Math.sin(m)}null==e?(l=u=d=p=0,lR.topLeft.x=lR.topLeft.y=0):(l=-e.x*n,u=-e.x*a,d=-e.y*n,p=-e.y*a,lR.topLeft.x=Math.floor(l+p),lR.topLeft.y=Math.floor(d-u)),l=(r=null==e?t.right:t.right-e.x)*n,u=r*a,lR.topRight.x=Math.floor(l+p),lR.topRight.y=Math.floor(d-u),d=(h=null==e?t.bottom:t.bottom-e.y)*n,p=h*a,lR.bottomRight.x=Math.floor(l+p),lR.bottomRight.y=Math.floor(d-u),lR.bottomLeft.x=lR.topLeft.x+lR.bottomRight.x-lR.topRight.x,lR.bottomLeft.y=lR.topLeft.y+lR.bottomRight.y-lR.topRight.y;let f=Math.min(lR.topLeft.x,Math.min(lR.topRight.x,Math.min(lR.bottomRight.x,lR.bottomLeft.x))),$=Math.min(lR.topLeft.y,Math.min(lR.topRight.y,Math.min(lR.bottomRight.y,lR.bottomLeft.y))),g=Math.max(lR.topLeft.x,Math.max(lR.topRight.x,Math.max(lR.bottomRight.x,lR.bottomLeft.x))),P=Math.max(lR.topLeft.y,Math.max(lR.topRight.y,Math.max(lR.bottomRight.y,lR.bottomLeft.y)));null!=e&&(e.x=-f,e.y=-$),t.right=g-f,t.bottom=P-$},createRotatedMask:function(t,e,s,r){let h=t.width,n=t.height,a=new E;a.right=Math.floor(t.width*s),a.bottom=Math.floor(t.height*r);let l=new _;l.x=Math.floor(t.xSpot*s),l.y=Math.floor(t.ySpot*r),this.rotateRect(a,l,e);let u=a.right,d=a.bottom;if(u<=0||d<=0)return!1;let p=t.lineWidth,m=(u+15&2147483632)/16;for("undefined"!=typeof ArrayBuffer?this.mask=new Uint16Array(new ArrayBuffer((m*d+1)*2)):this.mask=Array(m*d+1),w=m*d;w>=0;w--)this.mask[w]=0;this.lineWidth=m,this.width=u,this.height=d,this.xSpot=l.x,this.ySpot=l.y;let f=.017453292*e,$=Math.cos(f),g=Math.sin(f),P=0,A=Math.floor(65536*(h/2-(u/2*$-d/2*g)/s)),v=Math.floor(65536*(n/2-(u/2*g+d/2*$)/r)),O=Math.floor(65536*$/s),S=Math.floor(65536*g/r),T=u/16,b=u%16,C=Math.floor(65536*$/r),L=Math.floor(65536*g/s),I=65536*h,F=65536*n;for(M=0;M<d;M++){var R,M,w,k,N,D,H,B=A,G=v,Y=P;for(R=0;R<T;R++){let j=0;B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=32768)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=16384)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=8192)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=4096)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=2048)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=1024)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=512)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=256)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=128)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=64)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=32)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=16)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=8)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=4)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=2)),B+=O,G+=S,B>=0&&B<I&&G>=0&&G<F&&(D=Math.floor(B/65536),H=Math.floor(G/65536),k=32768>>>D%16,((N=t.mask[Math.floor(H*p+D/16)])&k)!=0&&(j|=1)),B+=O,G+=S,this.mask[Y++]=j}if(0!=b){let X=32768,W=0;for(R=0;R<b;R++,X=X>>1&32767){if(B>=0&&B<I&&G>=0&&G<F){let V=Math.floor(B/65536),U=Math.floor(G/65536);k=32768>>>V%16,((N=t.mask[Math.floor(U*p+V/16)])&k)!=0&&(W|=X)}B+=O,G+=S}this.mask[Y]=W}P+=m,A-=L,v+=C}return!0},testMask:function(t,e,s,r,h,n,a){t<=h?(l=this,u=r,P=Math.floor(s),E=Math.floor(a),d=Math.floor(t),p=Math.floor(e),m=Math.floor(h),f=Math.floor(n)):(l=r,u=this,P=Math.floor(a),E=Math.floor(s),d=Math.floor(h),p=Math.floor(n),m=Math.floor(t),f=Math.floor(e)),$=l.height;let l,u,d,p,m,f,$,g,P,E,_,A,v,O,S,T,b,C,L,I,F=0;0!=P&&($=P,p+=l.height-P,F=l.height-P),g=u.height;let R=0;if(0!=E&&(g=E,f+=u.height-E,R=u.height-E),d>=m+u.width||d+l.width<=m||p>=f+g||p+$<f)return!1;let M=m-d,w=Math.floor(M/16),k=M%16,N=Math.min(d+l.width-m,u.width);if(N=Math.floor((N+15)/16),p<=f?(_=f-p+F,A=R,v=Math.min(p+$,f+g)-f):(_=F,A=p-f+R,v=Math.min(p+$,f+g)-p),T=_*l.lineWidth,b=A*u.lineWidth,0!=k)switch(N){case 1:for(S=0;S<v;S++){if(((C=l.mask[T+w]<<k)&u.mask[b])!=0||w+1<l.lineWidth&&(L=l.mask[T+w+1]<<k,((L>>>=16)&u.mask[b])!=0))return!0;T+=l.lineWidth,b+=u.lineWidth}break;case 2:for(S=0;S<v;S++){if(((C=l.mask[T+w]<<k)&u.mask[b])!=0||((I=(L=l.mask[T+w+1]<<k)>>>16)&u.mask[b])!=0||(L&u.mask[b+1])!=0||w+2<l.lineWidth&&(L=l.mask[T+w+2]<<k,((L>>>=16)&u.mask[b+1])!=0))return!0;T+=l.lineWidth,b+=u.lineWidth}break;default:for(S=0;S<v;S++){if(((C=l.mask[T+w]<<k)&u.mask[b])!=0)return!0;for(O=0;O<N-1;O++)if(((I=(L=l.mask[T+w+O+1]<<k)>>>16)&u.mask[b+O])!=0||(L&u.mask[b+O+1])!=0)return!0;if(w+O+1<l.lineWidth&&(L=l.mask[T+w+O+1]<<k,((L>>>=16)&u.mask[b+O])!=0))return!0;T+=l.lineWidth,b+=u.lineWidth}}else for(S=0;S<v;S++){for(O=0;O<N;O++)if(C=l.mask[T+w+O],(u.mask[b+O]&C)!=0)return!0;T+=l.lineWidth,b+=u.lineWidth}return!1},testRect2:function(t,e,s,r,h,n,a,l){t=Math.floor(t),e=Math.floor(e),r=Math.floor(r),h=Math.floor(h);let u,d,p,m,f,$,g,P,E=0,_=this.height;s>0&&(e+=E=this.height-s,_=s);let A=0,v=a;if(l>0&&(h+=A=a-l,v=l),t>=r+n||t+this.width<=r||e>=h+v||e+_<h)return!1;t<=r?(u=r-t,d=Math.min(this.width-u,n)):(u=0,d=Math.min(r+n-t,this.width)),e<=h?(p=h-e+E,m=Math.min(e+_,h+v)-h):(p=E,m=Math.min(e+_,h+v)-e);let O=Math.floor(u/8),S=Math.floor((u+d+15)/16)-Math.floor(u/16);for(g=0;g<m;g++)switch($=(g+p)*this.lineWidth,S){case 1:if(f=lR.lMask[15&u]&lR.rMask[(u+d-1&15)+1],(this.mask[$+O]&f)!=0)return!0;break;case 2:if(f=lR.lMask[15&u],(this.mask[$+O]&f)!=0||(f=lR.rMask[(u+d-1&15)+1],(this.mask[$+O+1]&f)!=0))return!0;break;default:if(f=lR.lMask[15&u],(this.mask[$+O]&f)!=0)return!0;for(P=1;P<S-1;P++)if(0!=this.mask[$+O+P])return!0;if(f=lR.rMask[(u+d-1&15)+1],(this.mask[$+O+P]&f)!=0)return!0}return!1},testPoint:function(t,e,s,r){let h=Math.floor(s-t),n=Math.floor(r-e);if(h<0||h>=this.width||n<0||n>=this.height)return!1;let a=n*this.lineWidth+Math.floor(h/16);return this.mask[a],(this.mask[a]&32768>>>(15&h))!=0},testPointEx:function(t,e,s,r,h){let n=Math.floor(t),a=Math.floor(e),l=n,u=a;if(0==s)(1!=r||1!=h)&&(l=Math.floor(l/r),u=Math.floor(u/h)),l+=this.xSpot,u+=this.ySpot;else{let d=3.141592653589*s/180,p=Math.cos(d),m=Math.sin(d);l=n*p-a*m,u=a*p+n*m,(1!=r||1!=h)&&(l/=r,u/=h),l+=this.xSpot,u+=this.ySpot}if(n=Math.floor(l),a=Math.floor(u),n<0||n>=this.width||a<0||a>=this.height)return!1;let f=a*this.lineWidth+Math.floor(n/16),$=32768>>>(15&n);return this.mask[f],(this.mask[f]&$)!=0}},l2.RSFLAG_HIDDEN=1,l2.RSFLAG_INACTIVE=2,l2.RSFLAG_SLEEPING=4,l2.RSFLAG_ROTATE_ANTIA=16,l2.RSFLAG_VISIBLE=32,l2.RSFLAG_RAMBO=64,l2.RSFLAG_COLBOX=128,l2.SPRTYPE_TRUESPRITE=0,l2.SPRTYPE_OWNERDRAW=1,l2.BOP_COPY=0,l2.BOP_BLEND=1,l2.BOP_INVERT=2,l2.BOP_XOR=3,l2.BOP_AND=4,l2.BOP_OR=5,l2.BOP_BLEND_REPLACETRANSP=6,l2.BOP_DWROP=7,l2.BOP_ANDNOT=8,l2.BOP_ADD=9,l2.BOP_MONO=10,l2.BOP_SUB=11,l2.BOP_BLEND_DONTREPLACECOLOR=12,l2.BOP_EFFECTEX=13,l2.BOP_MAX=13,l2.BOP_MASK=4095,l2.BOP_RGBAFILTER=4096,l2.BOP_SMOOTHING=8192,l2.prototype={init1:function(t,e,s){this.hoPtr=t,this.rsLayer=s.cobLayer,this.rsZOrder=s.cobZOrder,this.rsFlags=0,this.rsFlags|=l2.RSFLAG_RAMBO,(this.hoPtr.hoLimitFlags&n3.OILIMITFLAGS_QUICKCOL)==0&&(this.rsFlags&=~l2.RSFLAG_RAMBO),(this.hoPtr.hoOiList.oilOCFlags2&a$.OCFLAGS2_COLBOX)!=0&&(this.rsFlags|=l2.RSFLAG_COLBOX),(s.cobFlags&nD.COF_HIDDEN)!=0?(this.rsFlags|=l2.RSFLAG_HIDDEN,this.hoPtr.hoType==ac.OBJ_TEXT&&(this.hoPtr.hoFlags|=a0.HOF_NOCOLLISION,this.rsFlags&=~l2.RSFLAG_RAMBO)):this.rsFlags|=l2.RSFLAG_VISIBLE,this.rsEffect=this.hoPtr.hoOiList.oilInkEffect,this.rsEffectParam=this.hoPtr.hoOiList.oilEffectParam;let r=1;(this.rsEffect&l2.BOP_RGBAFILTER)!=0?r=(this.rsEffectParam>>>24&255)/255:(this.rsEffect&l2.BOP_MASK)==l2.BOP_BLEND&&(r=(128-this.rsEffectParam)/128),this.rsTransparency=128-128*r,this.hoPtr.roc.rcMovementType==l6.MVTYPE_STATIC&&(this.rsFlags|=l2.RSFLAG_INACTIVE)},init2:function(t){this.createSprite(t),t&&this.hoPtr.hoCommon.ocFadeIn&&(this.hoPtr.hoFlags|=a0.HOF_FADEIN)},handle:function(){let t,e,s,r,h=this.hoPtr.hoAdRunHeader;if((this.hoPtr.hoFlags&a0.HOF_FADEIN)!=0){this.rsTrans||this.createTransition(!1),this.performFadeIn();return}if((this.hoPtr.hoFlags&a0.HOF_FADEOUT)!=0){this.performFadeOut();return}if((this.rsFlags&l2.RSFLAG_SLEEPING)==0){if(0!=this.rsFlash&&(this.rsFlashCpt-=h.rhTimerDelta,this.rsFlashCpt<0&&(this.rsFlashCpt=this.rsFlash,(this.rsFlags&l2.RSFLAG_VISIBLE)==0?(this.rsFlags|=l2.RSFLAG_VISIBLE,this.obShow()):(this.rsFlags&=~l2.RSFLAG_VISIBLE,this.obHide()))),null!=this.hoPtr.rom&&this.hoPtr.rom.move(),0!=this.hoPtr.roc.rcPlayer)return;if((this.hoPtr.hoOEFlags&a$.OEFLAG_NEVERSLEEP)!=0){(this.hoPtr.hoOEFlags&a$.OEFLAG_NEVERKILL)==0&&(h.rhApp.dwOptions&ny.AH2OPT_DESTROYIFNOINACTIVATE)!=0&&(t=this.hoPtr.hoX-this.hoPtr.hoImgXSpot,e=this.hoPtr.hoY-this.hoPtr.hoImgYSpot,s=t+this.hoPtr.hoImgWidth,r=e+this.hoPtr.hoImgHeight,(s<h.rh3XMinimumKill||t>h.rh3XMaximumKill||r<h.rh3YMinimumKill||e>h.rh3YMaximumKill)&&h.destroy_Add(this.hoPtr.hoNumber));return}if(t=this.hoPtr.hoX-this.hoPtr.hoImgXSpot,e=this.hoPtr.hoY-this.hoPtr.hoImgYSpot,s=t+this.hoPtr.hoImgWidth,r=e+this.hoPtr.hoImgHeight,s>=h.rh3XMinimum&&t<=h.rh3XMaximum&&r>=h.rh3YMinimum&&e<=h.rh3YMaximum)return;if(s>=h.rh3XMinimumKill&&t<=h.rh3XMaximumKill&&r>=h.rh3YMinimumKill&&e<=h.rh3YMaximumKill){this.rsFlags|=l2.RSFLAG_SLEEPING,this.rsZOrder=this.hoPtr.delSprite();return}(this.hoPtr.hoOEFlags&a$.OEFLAG_NEVERKILL)==0&&h.destroy_Add(this.hoPtr.hoNumber);return}t=this.hoPtr.hoX-this.hoPtr.hoImgXSpot,e=this.hoPtr.hoY-this.hoPtr.hoImgYSpot,s=t+this.hoPtr.hoImgWidth,r=e+this.hoPtr.hoImgHeight,s>=h.rh3XMinimum&&t<=h.rh3XMaximum&&r>=h.rh3YMinimum&&e<=h.rh3YMaximum&&(this.rsFlags&=~l2.RSFLAG_SLEEPING,this.init2(!1),this.hoPtr.setChildIndex(this.rsZOrder))},createSprite:function(t){(this.hoPtr.hoOEFlags&a$.OEFLAG_ANIMATIONS)!=0?(this.hoPtr.addSprite(this.hoPtr.hoX-this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY-this.hoPtr.hoAdRunHeader.rhWindowY,this.hoPtr.roc.rcImage,this.rsLayer,(this.rsFlags&l2.RSFLAG_HIDDEN)==0),this.rsSpriteType=l2.SPRTYPE_TRUESPRITE,this.hoPtr.setEffect(this.rsEffect,this.rsEffectParam)):(this.hoPtr.hoFlags|=a0.HOF_OWNERDRAW,this.hoPtr.addOwnerDrawSprite(this.hoPtr.hoX-this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY-this.hoPtr.hoAdRunHeader.rhWindowY,this.rsLayer,(this.hoPtr.hoOEFlags&a$.OEFLAG_QUICKDISPLAY)!=0,(this.rsFlags&l2.RSFLAG_HIDDEN)==0,-1),this.hoPtr.setEffect(this.rsEffect,this.rsEffectParam),this.rsSpriteType=l2.SPRTYPE_OWNERDRAW)},createTransition:function(t){if(this.hoPtr.hoFlags&=~(a0.HOF_FADEIN|a0.HOF_FADEOUT),!1==t){if(!this.hoPtr.hoCommon.ocFadeIn)return!1;this.hoPtr.hoFlags|=a0.HOF_FADEIN}else{if(!this.hoPtr.hoCommon.ocFadeOut)return!1;this.hoPtr.hoFlags|=a0.HOF_FADEOUT}return this.rsTrans=this.hoPtr.hoAdRunHeader.rhApp.getTransitionManager().startObjectFade(this.hoPtr,t),!!this.rsTrans||(this.hoPtr.hoFlags&=~(a0.HOF_FADEIN|a0.HOF_FADEOUT),!1)},performFadeIn:function(){return(this.hoPtr.hoFlags&a0.HOF_FADEIN)!=0&&(this.rsTrans.isCompleted()?(this.hoPtr.hoFlags&=~a0.HOF_FADEIN,this.hoPtr.transitionImage=null,this.rsTrans=null,this.hoPtr.hoType>=32&&hoPtr.ext.continueRunObject(),!1):(this.rsTrans.stepDraw(az.TRFLAG_FADEIN),!0))},performFadeOut:function(){return(this.hoPtr.hoFlags&a0.HOF_FADEOUT)!=0&&(this.rsTrans.isCompleted()?(this.rsTrans=null,this.transitionImage=null,this.hoPtr.hoAdRunHeader.destroy_Add(this.hoPtr.hoNumber),!1):(this.rsTrans.stepDraw(az.TRFLAG_FADEOUT),!0))},initFadeOut:function(){return!!this.createTransition(!0)&&(this.hoPtr.hoFlags|=a0.HOF_NOCOLLISION,!0)},kill:function(t){this.rsZOrder=this.hoPtr.delSprite()},obHide:function(){(this.rsFlags&l2.RSFLAG_HIDDEN)==0&&(this.rsFlags|=l2.RSFLAG_HIDDEN,this.hoPtr.roc.rcChanged=!0,this.hoPtr.hideSprite())},obShow:function(){(this.rsFlags&l2.RSFLAG_HIDDEN)!=0&&(this.hoPtr.hoAdRunHeader.rhFrame.layers[this.hoPtr.hoLayer].dwOptions&(al.FLOPT_TOHIDE|al.FLOPT_VISIBLE))==al.FLOPT_VISIBLE&&(this.rsFlags&=~l2.RSFLAG_HIDDEN,this.hoPtr.hoFlags&=~a0.HOF_NOCOLLISION,this.hoPtr.roc.rcChanged=!0,this.hoPtr.showSprite())},setSemiTransparency:function(t){t>=0&&t<=128&&(this.rsTransparency=t,this.hoPtr.setTransparency(t))},getSemiTransparency:function(){return this.rsTransparency},setColFlag:function(t){t?this.rsFlags|=l2.RSFLAG_RAMBO:this.rsFlags&=~l2.RSFLAG_RAMBO},modifSpriteEffect:function(t,e){this.rsEffect=t,this.rsEffectParam=e}},lw.prototype={load:function(t){let e;for(e=0,this.nStrings=t.readAShort(),this.strings=Array(this.nStrings);e<this.nStrings;e++)this.strings[e]=t.readAString()}},lk.prototype={load:function(t,e){let s;for(s=0,this.nValues=t.readAShort(),this.values=Array(this.nValues);s<this.nValues;s++)this.values[s]=t.readAInt();e&&(this.flags=t.readAInt())}},lN.VALUES_NUMBEROF_ALTERABLE=26,lN.STRINGS_NUMBEROF_ALTERABLE=10,lN.prototype={init:function(t,e,s){let r;for(r=0,this.rvValueFlags=0,this.rvValues=Array(lN.VALUES_NUMBEROF_ALTERABLE),this.rvStrings=Array(lN.STRINGS_NUMBEROF_ALTERABLE);r<this.rvValues.length;r++)this.rvValues[r]=0;for(r=0;r<this.rvStrings.length;r++)this.rvStrings[r]="";if(null!=e.ocValues)for(r=0,this.rvValueFlags=e.ocValues.flags;r<e.ocValues.nValues;r++)this.rvValues[r]=e.ocValues.values[r];if(null!=e.ocStrings)for(r=0;r<e.ocStrings.nStrings;r++)this.rvStrings[r]=e.ocStrings.strings[r]},kill:function(t){let e;for(e=0;e<this.rvValues.length;e++)this.rvValues[e]=0;for(e=0;e<this.rvStrings.length;e++)this.rvStrings[e]=null},getValue:function(t){return t<this.rvValues.length?this.rvValues[t]:0},getString:function(t){return t<this.rvStrings.length?this.rvStrings[t]:""},setString:function(t,e){t>this.rov.rvStrings.length&&this.growStrings(t+10),this.rvStrings[t]=e},setValue:function(t,e){t>this.rov.rvValues.length&&this.growValues(t+10),this.rvValues[t]=e},growValues:function(t){if(t>=this.rvValues.length){let e;for(e=0;e<t;e++)this.rvValues[e]=0}},growStrings:function(t){if(t>=this.rvStrings.length){let e;for(e=0;e<t;e++)this.rvStrings[e]=""}}},l1.KPX_BASE=32,l1.prototype={createList:function(t){let e,s;for(e=0,this.extensions=[,,],this.numOfConditions=[,,];e<2;e++)this.extensions[e]=null,this.numOfConditions[e]=0;(s=new lD).handle=0,this.addExt(s)},addExt:function(t){let e=t.loadRunObject();null!=e&&(this.extensions[t.handle]=t,this.numOfConditions[t.handle]=e.getNumberOfConditions())},loadRunObject:function(t){t-=l1.KPX_BASE;let e=null;return t<this.extensions.length&&null!=this.extensions[t]&&(e=this.extensions[t].loadRunObject()),e},getNumberOfConditions:function(t){return(t-=l1.KPX_BASE)<this.extensions.length?this.numOfConditions[t]:0}},lD.prototype={loadRunObject:function(){return 0===this.handle?new uh:null}},l4.REFLAG_DISPLAY=1,l4.REFLAG_ONESHOT=2,l4.prototype={init:function(t){this.ho=t,this.rh=t.hoAdRunHeader},getNumberOfConditions:function(){return 0},createRunObject:function(t,e,s){return!1},handleRunObject:function(){return l4.REFLAG_ONESHOT},displayRunObject:function(t,e,s){},destroyRunObject:function(t){},createFont:function(){},pauseRunObject:function(){},continueRunObject:function(){},getZoneInfos:function(){},condition:function(t,e){return!1},action:function(t,e){},expression:function(t){return null},getRunObjectCollisionMask:function(t){return null},getRunObjectFont:function(){return null},setRunObjectFont:function(t,e){},getRunObjectTextColor:function(){return 0},setRunObjectTextColor:function(t){},autoResize:function(){},forcePosition:function(){}},l3.prototype={evaluate:function(t){let e=t.rhEvtProg.get_ExpressionObjects(this.oiList);if(null==e){t.rh4Results[t.rh4PosPile]=0;return}let s=(this.code>>16)-nZ.EVENTS_EXTBASE;t.currentPtr=this,t.rh4Results[t.rh4PosPile]=e.expression(s)}},lH.prototype={execute:function(t){let e=t.rhEvtProg.get_ActionObjects(this);if(null!=e){let s=(this.evtCode>>>16)-nZ.EVENTS_EXTBASE;t.currentPtr=this,e.action(s,this)}},getParamObject:function(t,e){return t.rhEvtProg.get_ParamActionObjects(this.evtParams[e].oiList,this)},getParamBorder:function(t,e){return this.evtParams[e].value},getParamShort:function(t,e){return this.evtParams[e].value},getParamAltValue:function(t,e){return this.evtParams[e].value},getParamDirection:function(t,e){return this.evtParams[e].value},getParamEffect:function(t,e){return this.evtParams[e].string},getParamCreate:function(t,e){return this.evtParams[e]},getParamAnimation:function(t,e){return 10==this.evtParams[e].code?this.evtParams[e].value:t.get_EventExpressionInt(this.evtParams[e])},getParamPlayer:function(t,e){return this.evtParams[e].value},getParamEvery:function(t,e){return this.evtParams[e].delay},getParamKey:function(t,e){return this.evtParams[e].key},getParamSpeed:function(t,e){return t.get_EventExpressionInt(this.evtParams[e])},getParamPosition:function(t,e){let s=this.evtParams[e],r=new ax;return s.read_Position(t,0,r)&&(r.found=!0),r},getParamJoyDirection:function(t,e){return this.evtParams[e].value},getParamShoot:function(t,e){return this.evtParams[e]},getParamZone:function(t,e){return this.evtParams[e]},getParamExpression:function(t,e){return t.get_EventExpressionInt(this.evtParams[e])},getParamColour:function(t,e){return 24==this.evtParams[e].code?this.evtParams[e].color:h.swapRGB(t.get_EventExpressionInt(this.evtParams[e]))},getParamFrame:function(t,e){return this.evtParams[e].value},getParamNewDirection:function(t,e){return 29==this.evtParams[e].code?this.evtParams[e].value:t.get_EventExpressionInt(this.evtParams[e])},getParamClick:function(t,e){return this.evtParams[e].value},getParamExpString:function(t,e){return t.get_EventExpressionString(this.evtParams[e])},getParamFilename:function(t,e){return 40==this.evtParams[e].code?this.evtParams[e].string:t.get_EventExpressionString(this.evtParams[e])},getParamExpDouble:function(t,e){return t.get_EventExpressionAny(this.evtParams[e])},getParamFilename2:function(t,e){return 63==this.evtParams[e].code?this.evtParams[e].string:t.get_EventExpressionString(this.evtParams[e])},getParamExtension:function(t,e){let s=this.evtParams[e];return 0!=s.data?t.rhApp.file.createFromFile(s.data):null},getParamTime:function(t,e){return 2==this.evtParams[e].code?this.evtParams[e].timer:t.get_EventExpressionInt(this.evtParams[e])}},lB.prototype={eva1:function(t,e){if(null==e)return this.eva2(t);e.hoFlags|=a0.HOF_TRUEEVENT;let s=-(this.evtCode>>16)-nZ.EVENTS_EXTBASE-1;return t.currentPtr=this,!!e.condition(s,this)&&(t.rhEvtProg.evt_AddCurrentObject(e),!0)},eva2:function(t){let e=t.rhEvtProg.evt_FirstObject(this.evtOiList),s=t.rhEvtProg.evtNSelectedObjects,r=-(this.evtCode>>16)-nZ.EVENTS_EXTBASE-1;for(t.currentPtr=this;null!=e;)e.hoFlags&=~a0.HOF_TRUEEVENT,e.condition(r,this)?(this.evtFlags2&at.EVFLAG2_NOT)!=0&&(s--,t.rhEvtProg.evt_DeleteCurrentObject()):(this.evtFlags2&at.EVFLAG2_NOT)==0&&(s--,t.rhEvtProg.evt_DeleteCurrentObject()),e=t.rhEvtProg.evt_NextObject();return 0!=s},getParamObject:function(t,e){return this.evtParams[e]},getParamTime:function(t,e){return 2==this.evtParams[e].code?this.evtParams[e].timer:t.get_EventExpressionInt(this.evtParams[e])},getParamBorder:function(t,e){return this.evtParams[e].value},getParamAltValue:function(t,e){return this.evtParams[e].value},getParamDirection:function(t,e){return this.evtParams[e].value},getParamAnimation:function(t,e){return 10==this.evtParams[e].code?this.evtParams[e].value:t.get_EventExpressionInt(this.evtParams[e])},getParamPlayer:function(t,e){return this.evtParams[e].value},getParamEvery:function(t,e){return this.evtParams[e].delay},getParamKey:function(t,e){return this.evtParams[e].key},getParamSpeed:function(t,e){return t.get_EventExpressionInt(this.evtParams[e])},getParamPosition:function(t,e){let s=this.evtParams[e],r=new ax;return s.read_Position(t,0,r)&&(r.found=!0),r},getParamJoyDirection:function(t,e){return this.evtParams[e].value},getParamExpression:function(t,e){return t.get_EventExpressionInt(this.evtParams[e])},getParamColour:function(t,e){return 24==this.evtParams[e].code?this.evtParams[e].color:h.swapRGB(t.get_EventExpressionInt(this.evtParams[e]))},getParamFrame:function(t,e){return this.evtParams[e].value},getParamNewDirection:function(t,e){return 29==this.evtParams[e].code?this.evtParams[e].value:t.get_EventExpressionInt(this.evtParams[e])},getParamClick:function(t,e){return this.evtParams[e].value},getParamExpString:function(t,e){return t.get_EventExpressionString(this.evtParams[e])},compareValues:function(t,e,s){let r=t.get_EventExpressionAny(this.evtParams[e]),h=this.evtParams[e].comparaison;return nD.compareTo(s,r,h)},compareTime:function(t,e,s){let r=this.evtParams[e];return nD.compareTo(s,r.timer,r.comparaison)}},(function t(){this.element=null,this.controlIgnoreHeight=!1,this.bnShownOld=!1}).prototype=h.extend(new l4,{forcePosition:function(){this.setPosition(this.ho.hoX,this.ho.hoY)},autoResize:function(){this.setPosition(this.ho.hoX,this.ho.hoY),this.setSize(this.ho.hoImgWidth,this.ho.hoImgHeight)},setElement:function(t,e){this.element=t,t.style.position="absolute",this.setSize(this.ho.hoImgWidth,this.ho.hoImgHeight),this.setPosition(this.ho.hoX,this.ho.hoY),this.fontInfo&&this.setFont(this.fontInfo),this.ho.bShown=e,this.bShownOld=e,this.rh.rhApp.loading?(t.style.visibility="hidden",this.bShownOld=!1):e?t.style.visibility="visible":t.style.visibility="hidden",this.rh.rhApp.container.appendChild(t)},getXOffset:function(){return this.rh.rhApp.canvas?this.rh.rhApp.canvas.offsetLeft:0},getYOffset:function(){return this.rh.rhApp.canvas?this.rh.rhApp.canvas.offsetTop:0},setX:function(t){this.ctrlLastX=t,this.ho.setX(t),this.element&&(this.element.style.left=this.getXOffset()+this.rh.rhApp.xMouseOffset+(this.ho.hoX-this.ho.hoAdRunHeader.rhWindowX)*this.rh.rhApp.scaleX+"px")},setY:function(t){this.ctrlLastY=t,this.ho.setY(t),this.element&&(this.element.style.top=this.getYOffset()+this.rh.rhApp.yMouseOffset+(this.ho.hoY-this.ho.hoAdRunHeader.rhWindowY)*this.rh.rhApp.scaleY+"px")},setPosition:function(t,e){this.ctrlLastX=t,this.ctrlLastY=e,this.ho.setPosition(t,e),this.element&&(this.element.style.left=this.getXOffset()+this.rh.rhApp.xMouseOffset+(this.ho.hoX-this.ho.hoAdRunHeader.rhWindowX)*this.rh.rhApp.scaleX+"px",this.element.style.top=this.getYOffset()+this.rh.rhApp.yMouseOffset+(this.ho.hoY-this.ho.hoAdRunHeader.rhWindowY)*this.rh.rhApp.scaleY+"px")},setWidth:function(t){this.ctrlLastWidth=t,this.ho.setWidth(t),this.element&&(this.element.style.width=this.ho.hoImgWidth*this.rh.rhApp.scaleX+"px")},setHeight:function(t){this.ctrlLastHeight=t,this.ho.setHeight(t),this.element&&!this.controlIgnoreHeight&&(this.element.style.height=this.ho.hoImgHeight*this.rh.rhApp.scaleY+"px")},setSize:function(t,e){this.ctrlLastWidth=t,this.ctrlLastHeight=e,this.ho.setSize(t,e),this.element&&(this.element.style.width=this.ho.hoImgWidth*this.rh.rhApp.scaleX+"px",this.controlIgnoreHeight||(this.element.style.height=this.ho.hoImgHeight*this.rh.rhApp.scaleY+"px"))},setFont:function(t){this.fontInfo=t,this.element&&(this.element.style.font=t.getFont())},destroyRunObject:function(){this.element&&this.rh.rhApp.container.removeChild(this.element)},getRunObjectFont:function(){return this.fontInfo},setRunObjectFont:function(t,e){this.setFont(t)},handleRunObject:function(){return this.rh.rhApp.loading||this.ho.bShown==this.bShownOld||(this.bShownOld=this.ho.bShown,this.ho.bShown?this.element.style.visibility="visible":this.element.style.visibility="hidden"),(this.ho.hoX!=this.ctrlLastX||this.ho.hoY!=this.ctrlLastY)&&this.setPosition(this.ho.hoX,this.ho.hoY),(this.ho.hoImgWidth!=this.ctrlLastWidth||this.ho.hoImgHeight!=this.ctrlLastHeight)&&this.setSize(this.ho.hoImgWidth,this.ho.hoImgHeight),0}}),l6.MVTYPE_STATIC=0,l6.MVTYPE_MOUSE=1,l6.MVTYPE_RACE=2,l6.MVTYPE_GENERIC=3,l6.MVTYPE_BALL=4,l6.MVTYPE_TAPED=5,l6.MVTYPE_PLATFORM=9,l6.MVTYPE_DISAPPEAR=11,l6.MVTYPE_APPEAR=12,l6.MVTYPE_BULLET=13,l6.MVTYPE_EXT=14,l6.prototype={setData:function(t,e,s,r,h){this.mvType=t,this.mvControl=e,this.mvMoveAtStart=s,this.mvDirAtStart=r,this.mvOpt=h}},lG.prototype={load:function(t){let e,s=t.getFilePointer();for(e=0,this.nMovements=t.readAInt(),this.moveList=Array(this.nMovements);e<this.nMovements;e++){t.seek(s+4+16*e);let r=t.readAInt(),h=t.readAInt(),n=t.readAInt(),a=t.readAInt();t.seek(s+n);let l=t.readAShort(),u=t.readAShort(),d=t.readAByte(),p=t.readAByte();t.skipBytes(2);let m=t.readAInt();switch(u){case 0:this.moveList[e]=new lU;break;case 1:this.moveList[e]=new lj;break;case 2:this.moveList[e]=new lV;break;case 3:this.moveList[e]=new lY;break;case 4:this.moveList[e]=new l5;break;case 5:this.moveList[e]=new lX;break;case 9:this.moveList[e]=new l7;break;case 14:this.moveList[e]=new lK}if(this.moveList[e].setData(u,l,d,m,p),this.moveList[e].load(t,a-12),14==u){t.seek(s+r);let f=t.readAString();f=(f=f.substring(0,f.length-4)).toLowerCase(),this.moveList[e].setModuleName(f,h)}}}},l5.prototype=h.extend(new l6,{load:function(t,e){this.mbSpeed=t.readAShort(),this.mbBounce=t.readAShort(),this.mbAngles=t.readAShort(),this.mbSecurity=t.readAShort(),this.mbDecelerate=t.readAShort()}}),lY.prototype=h.extend(new l6,{load:function(t,e){this.mgSpeed=t.readAShort(),this.mgAcc=t.readAShort(),this.mgDec=t.readAShort(),this.mgBounceMult=t.readAShort(),this.mgDir=t.readAInt()}}),lj.prototype=h.extend(new l6,{load:function(t,e){this.mmDx=t.readShort(),this.mmFx=t.readShort(),this.mmDy=t.readShort(),this.mmFy=t.readShort(),this.mmFlags=t.readAShort()}}),lX.prototype=h.extend(new l6,{load:function(t,e){let s,r,h;for(this.mtNumber=t.readAShort(),this.mtMinSpeed=t.readAShort(),this.mtMaxSpeed=t.readAShort(),this.mtLoop=t.readAByte(),this.mtRepos=t.readAByte(),this.mtReverse=t.readAByte(),t.skipBytes(1),this.steps=Array(this.mtNumber),s=0;s<this.mtNumber;s++)h=t.getFilePointer(),this.steps[s]=new lW,t.readUnsignedByte(),r=t.readUnsignedByte(),this.steps[s].load(t),t.seek(h+r)}}),lW.prototype={load:function(t){this.mdSpeed=t.readAByte(),this.mdDir=t.readAByte(),this.mdDx=t.readShort(),this.mdDy=t.readShort(),this.mdCosinus=t.readShort(),this.mdSinus=t.readShort(),this.mdLength=t.readAShort(),this.mdPause=t.readAShort();let e=t.readAString();e.length>0&&(this.mdName=e)}},l7.prototype=h.extend(new l6,{load:function(t,e){this.mpSpeed=t.readAShort(),this.mpAcc=t.readAShort(),this.mpDec=t.readAShort(),this.mpJumpControl=t.readAShort(),this.mpGravity=t.readAShort(),this.mpJump=t.readAShort()}}),lV.prototype=h.extend(new l6,{load:function(t,e){this.mrSpeed=t.readAShort(),this.mrAcc=t.readAShort(),this.mrDec=t.readAShort(),this.mrRot=t.readAShort(),this.mrBounceMult=t.readAShort(),this.mrAngles=t.readAShort(),this.mrOkReverse=t.readAShort()}}),lU.prototype=h.extend(new l6,{load:function(t,e){}}),lK.prototype=h.extend(new l6,{load:function(t,e){t.skipBytes(14),this.data=t.getFilePointer()},setModuleName:function(t,e){this.moduleName=t,this.mvtID=e}}),lq.Cosinus32=[256,251,236,212,181,142,97,49,0,-49,-97,-142,-181,-212,-236,-251,-256,-251,-236,-212,-181,-142,-97,-49,0,49,97,142,181,212,236,251],lq.Sinus32=[0,-49,-97,-142,-181,-212,-236,-251,-256,-251,-236,-212,-181,-142,-97,-49,0,49,97,142,181,212,236,251,256,251,236,212,181,142,97,49],lq.accelerators=[2,3,4,6,8,10,12,16,20,24,48,56,64,72,80,88,96,104,112,120,144,160,176,192,208,224,240,256,272,288,320,336,352,368,384,400,416,432,448,480,512,544,560,592,624,640,672,688,720,736,768,784,816,848,864,896,928,944,976,992,1024,1120,1216,1312,1440,1536,1632,1728,1824,1952,2048,2240,2432,2688,2880,3072,3264,3456,3712,3904,4096,6544,4914,5216,5732,6144,6553,6962,7366,7780,8192,9836,11672,13316,14960,16604,18248,19892,21504,25600,25600],lq.Joy2Dir=[-1,8,24,-1,16,12,20,16,0,4,28,0,-1,8,24,-1],lq.CosSurSin32=[2599,0,844,31,479,30,312,29,210,28,137,27,78,26,25,25,0,24],lq.mvap_TableDirs=[0,-2,0,2,0,-4,0,4,0,-8,0,8,-4,0,-8,0,0,0,-2,-2,2,2,-4,-4,4,4,-8,-8,8,8,-4,4,-8,8,0,0,-2,0,2,0,-4,0,4,0,-8,0,8,0,0,4,0,8,0,0,-2,2,2,-2,-4,4,4,-4,-8,8,8,-8,4,4,8,8,0,0,0,2,0,-2,0,4,0,-4,0,8,0,-8,4,0,8,0,0,0,2,2,-2,-2,4,4,-4,-4,8,8,-8,-8,4,-4,8,-8,0,0,2,0,-2,0,4,0,-4,0,8,0,-8,0,0,-4,0,-8,0,0,2,-2,-2,2,4,-4,-4,4,8,-8,-8,8,-4,-4,-8,-8,0,0],lq.MVTOPT_8DIR_STICK=1,lq.getDeltaX=function(t,e){return t*lq.Cosinus32[e]/256},lq.getDeltaY=function(t,e){return t*lq.Sinus32[e]/256},lq.prototype={newMake_Move:function(t,e){let s,r,h;if(this.hoPtr.hoAdRunHeader.rh3CollisionCount++,this.rmCollisionCount=this.hoPtr.hoAdRunHeader.rh3CollisionCount,this.hoPtr.rom.rmMoveFlag=!1,0==t)return this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr),!1;for(h=(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0?Math.floor(t*this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef*32):t<<5;h>2048;){if(s=65536*this.hoPtr.hoX+(65535&this.hoPtr.hoCalculX),r=65536*this.hoPtr.hoY+(65535&this.hoPtr.hoCalculY),s+=2048*lq.Cosinus32[e],r+=2048*lq.Sinus32[e],this.hoPtr.hoCalculX=65535&s,this.hoPtr.hoX=Math.floor(s/65536),this.hoPtr.hoCalculY=65535&r,this.hoPtr.hoY=Math.floor(r/65536),this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr))return!0;if(this.hoPtr.rom.rmMoveFlag)break;h-=2048}return!!(!this.hoPtr.rom.rmMoveFlag&&(s=65536*this.hoPtr.hoX+(65535&this.hoPtr.hoCalculX),r=65536*this.hoPtr.hoY+(65535&this.hoPtr.hoCalculY),s+=lq.Cosinus32[e]*h,r+=lq.Sinus32[e]*h,this.hoPtr.hoCalculX=65535&s,this.hoPtr.hoX=Math.floor(s/65536),this.hoPtr.hoCalculY=65535&r,this.hoPtr.hoY=Math.floor(r/65536),this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr)))||(this.hoPtr.roc.rcChanged=!0,this.hoPtr.rom.rmMoveFlag||(this.hoPtr.hoAdRunHeader.rhVBLObjet=0),this.hoPtr.rom.rmMoveFlag)},moveAtStart:function(t){0==t.mvMoveAtStart&&this.stop()},getAccelerator:function(t){return t<=100?lq.accelerators[t]:t<<8},mv_Approach:function(t){if(t){this.mb_Approach(!1);return}switch(4294901760&this.hoPtr.hoAdRunHeader.rhEvtProg.rhCurCode){case -786432:var e=this.hoPtr.hoX-this.hoPtr.hoImgXSpot,s=this.hoPtr.hoY-this.hoPtr.hoImgYSpot,r=this.hoPtr.hoAdRunHeader.quadran_Out(e,s,e+this.hoPtr.hoImgWidth,s+this.hoPtr.hoImgHeight);e=this.hoPtr.hoX,s=this.hoPtr.hoY,(r&nD.BORDER_LEFT)!=0&&(e=this.hoPtr.hoImgXSpot),(r&nD.BORDER_RIGHT)!=0&&(e=this.hoPtr.hoAdRunHeader.rhLevelSx-this.hoPtr.hoImgWidth+this.hoPtr.hoImgXSpot),(r&nD.BORDER_TOP)!=0&&(s=this.hoPtr.hoImgYSpot),(r&nD.BORDER_BOTTOM)!=0&&(s=this.hoPtr.hoAdRunHeader.rhLevelSy-this.hoPtr.hoImgHeight+this.hoPtr.hoImgYSpot),this.hoPtr.hoX=e,this.hoPtr.hoY=s;return;case -851968:case -917504:var h=(this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)>>2)*18;do{if(this.tst_Position(this.hoPtr.hoX+lq.mvap_TableDirs[h],this.hoPtr.hoY+lq.mvap_TableDirs[h+1],!1)){this.hoPtr.hoX+=lq.mvap_TableDirs[h],this.hoPtr.hoY+=lq.mvap_TableDirs[h+1];return}h+=2}while(0!=lq.mvap_TableDirs[h]||0!=lq.mvap_TableDirs[h+1]);this.hoPtr.hoX=this.hoPtr.roc.rcOldX,this.hoPtr.hoY=this.hoPtr.roc.rcOldY,this.hoPtr.roc.rcImage=this.hoPtr.roc.rcOldImage,this.hoPtr.roc.rcAngle=this.hoPtr.roc.rcOldAngle;return}},mb_Approach:function(t){switch(4294901760&this.hoPtr.hoAdRunHeader.rhEvtProg.rhCurCode){case -786432:var e=this.hoPtr.hoX-this.hoPtr.hoImgXSpot,s=this.hoPtr.hoY-this.hoPtr.hoImgYSpot,r=this.hoPtr.hoAdRunHeader.quadran_Out(e,s,e+this.hoPtr.hoImgWidth,s+this.hoPtr.hoImgHeight);e=this.hoPtr.hoX,s=this.hoPtr.hoY,(r&nD.BORDER_LEFT)!=0&&(e=this.hoPtr.hoImgXSpot),(r&nD.BORDER_RIGHT)!=0&&(e=this.hoPtr.hoAdRunHeader.rhLevelSx-this.hoPtr.hoImgWidth+this.hoPtr.hoImgXSpot),(r&nD.BORDER_TOP)!=0&&(s=this.hoPtr.hoImgYSpot),(r&nD.BORDER_BOTTOM)!=0&&(s=this.hoPtr.hoAdRunHeader.rhLevelSy-this.hoPtr.hoImgHeight+this.hoPtr.hoImgYSpot),this.hoPtr.hoX=e,this.hoPtr.hoY=s;return;case -851968:case -917504:var h=new _;if(this.mbApproachSprite(this.hoPtr.hoX,this.hoPtr.hoY,this.hoPtr.roc.rcOldX,this.hoPtr.roc.rcOldY,t,h)){this.hoPtr.hoX=h.x,this.hoPtr.hoY=h.y;return}var n=(this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)>>2)*18;do{if(this.tst_Position(this.hoPtr.hoX+lq.mvap_TableDirs[n],this.hoPtr.hoY+lq.mvap_TableDirs[n+1],t)){this.hoPtr.hoX+=lq.mvap_TableDirs[n],this.hoPtr.hoY+=lq.mvap_TableDirs[n+1];return}n+=2}while(0!=lq.mvap_TableDirs[n]||0!=lq.mvap_TableDirs[n+1]);if(!1==t){this.hoPtr.hoX=this.hoPtr.roc.rcOldX,this.hoPtr.hoY=this.hoPtr.roc.rcOldY,this.hoPtr.roc.rcImage=this.hoPtr.roc.rcOldImage,this.hoPtr.roc.rcAngle=this.hoPtr.roc.rcOldAngle;return}}},tst_SpritePosition:function(t,e,s,r,h){p=-1,h&&(p=this.hoPtr.hoOi);let n=this.hoPtr.hoOiList;if((15&n.oilLimitFlags)!=0){let a=t-this.hoPtr.hoImgXSpot,l=e-this.hoPtr.hoImgYSpot;if((this.hoPtr.hoAdRunHeader.quadran_Out(a,l,a+this.hoPtr.hoImgWidth,l+this.hoPtr.hoImgHeight)&n.oilLimitFlags)!=0)return!1}if((16&n.oilLimitFlags)!=0&&this.hoPtr.hoAdRunHeader.colMask_TestObject_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,t,e,s,r))return!1;if(-1==n.oilLimitList)return!0;let u=this.hoPtr.hoAdRunHeader.objectAllCol_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,t,e,n.oilColList);if(null==u)return!0;let d=this.hoPtr.hoAdRunHeader.rhEvtProg.limitBuffer;for(m=0;m<u.size();m++){var p,m,f,$=u.get(m).hoOi;if($!=p){for(f=n.oilLimitList;d[f]>=0;f++)if(d[f]==$)return!1}}return!0},tst_Position:function(t,e,s){u=-1,s&&(u=this.hoPtr.hoOi);let r=this.hoPtr.hoOiList;if((15&r.oilLimitFlags)!=0){let h=t-this.hoPtr.hoImgXSpot,n=e-this.hoPtr.hoImgYSpot;if((this.hoPtr.hoAdRunHeader.quadran_Out(h,n,h+this.hoPtr.hoImgWidth,n+this.hoPtr.hoImgHeight)&r.oilLimitFlags)!=0)return!1}if((16&r.oilLimitFlags)!=0&&this.hoPtr.hoAdRunHeader.colMask_TestObject_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,t,e,0,nR.CM_TEST_PLATFORM))return!1;if(-1==r.oilLimitList)return!0;let a=this.hoPtr.hoAdRunHeader.objectAllCol_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,t,e,r.oilColList);if(null==a)return!0;let l=this.hoPtr.hoAdRunHeader.rhEvtProg.limitBuffer;for(d=0;d<a.size();d++){var u,d,p,m=a.get(d).hoOi;if(m!=u){for(p=r.oilLimitList;l[p]>=0;p++)if(l[p]==m)return!1}}return!0},mpApproachSprite:function(t,e,s,r,n,a,l){for(var u,d,p=t,m=e,f=s,$=r,g=h.floatToInt((p+f)/2),P=h.floatToInt((m+$)/2);;)if(this.tst_SpritePosition(g+this.hoPtr.hoAdRunHeader.rhWindowX,P+this.hoPtr.hoAdRunHeader.rhWindowY,n,a,!1)){if(f=g,$=P,u=g,d=P,g=h.floatToInt((f+p)/2),P=h.floatToInt(($+m)/2),g==u&&P==d)return(f!=p||$!=m)&&this.tst_SpritePosition(p+this.hoPtr.hoAdRunHeader.rhWindowX,m+this.hoPtr.hoAdRunHeader.rhWindowY,n,a,!1)&&(g=p,P=m),l.x=g,l.y=P,!0}else if(p=g,m=P,u=g,d=P,g=h.floatToInt((f+p)/2),P=h.floatToInt(($+m)/2),g==u&&P==d){if((f!=p||$!=m)&&this.tst_SpritePosition(f+this.hoPtr.hoAdRunHeader.rhWindowX,$+this.hoPtr.hoAdRunHeader.rhWindowY,n,a,!1))return l.x=f,l.y=$,!0;return l.x=g,l.y=P,!1}},mbApproachSprite:function(t,e,s,r,n,a){for(var l,u,d=t,p=e,m=s,f=r,$=h.floatToInt((d+m)/2),g=h.floatToInt((p+f)/2);;)if(this.tst_Position($,g,n)){if(m=$,f=g,l=$,u=g,$=h.floatToInt((m+d)/2),g=h.floatToInt((f+p)/2),$==l&&g==u)return(m!=d||f!=p)&&this.tst_Position(d,p,n)&&($=d,g=p),a.x=$,a.y=g,!0}else if(d=$,p=g,l=$,u=g,$=h.floatToInt((m+d)/2),g=h.floatToInt((f+p)/2),$==l&&g==u){if((m!=d||f!=p)&&this.tst_Position(m,f,n))return a.x=m,a.y=f,!0;return a.x=$,a.y=g,!1}},setAcc:function(t){this.rmAcc=t,this.rmAccValue=this.getAccelerator(t),this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT&&this.movement.setAcc(t)},setDec:function(t){this.rmDec=t,this.rmDecValue=this.getAccelerator(t),this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT&&this.movement.setDec(t)},setRotSpeed:function(t){this.hoPtr.roc.rcMovementType==l6.MVTYPE_RACE&&(t>250&&(t=250),t<0&&(t=0),this.setRotSpeed(t)),this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT&&this.movement.setRotSpeed(t)},set8Dirs:function(t){this.hoPtr.roc.rcMovementType==l6.MVTYPE_GENERIC&&this.set8DirsGeneric(t),this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT&&this.movement.set8Dirs(t)},setGravity:function(t){this.hoPtr.roc.rcMovementType==l6.MVTYPE_PLATFORM&&(t>250&&(t=250),t<0&&(t=0),this.setGravity(t)),this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT&&this.movement.setGravity(t)},getSpeed:function(){return this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT?this.movement.getSpeed():this.hoPtr.roc.rcSpeed},getDir:function(){return this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT&&this.movement.getDir?this.movement.getDir():this.hoPtr.roc.rcDir},getAcc:function(){return this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT?this.movement.getAcceleration():this.rmAcc},getDec:function(){return this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT?this.movement.getDeceleration():this.rmDec},getGravity:function(){return this.hoPtr.roc.rcMovementType==l6.MVTYPE_PLATFORM?this.mp.MP_Gravity:this.hoPtr.roc.rcMovementType==l6.MVTYPE_EXT?this.movement.getGravity():0},kill:function(t){},start:function(){}},lz.rebond_List=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,30,31,0,1,4,3,2,1,0,31,30,29,28,27,26,25,24,23,22,21,20,24,25,26,27,27,28,28,28,28,29,29,24,23,22,21,20,19,18,17,16,15,14,13,12,16,17,18,19,19,20,20,20,20,21,21,22,23,24,25,28,27,26,25,0,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,20,21,22,22,23,24,24,24,24,25,26,27,28,29,30,8,7,6,5,4,8,9,10,11,11,12,12,12,12,13,13,14,15,16,17,20,19,18,17,16,15,14,13,12,11,10,9,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,16,15,14,13,12,11,10,9,8,12,13,14,15,15,16,16,16,16,17,17,18,19,20,21,24,23,22,21,20,19,18,17,16,17,18,19,20,21,22,23,24,23,22,21,20,19,18,17,16,17,18,19,20,21,22,23,24,23,22,21,20,19,18,17,3,3,4,4,4,4,5,5,6,7,8,9,12,11,10,9,8,7,6,5,4,3,2,1,0,31,30,29,28,0,1,2,0,0,1,1,2,3,4,5,8,7,6,5,4,3,2,1,0,31,30,29,28,27,26,25,24,28,29,30,31,31,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,0,31,30,29,28,27,26,25,24,25,26,27,28,29,30,31,0,31,30,29,28,27,25,25,24,25,26,27,28,29,30,31,0,4,5,6,7,7,8,8,8,8,9,9,10,11,12,13,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,1,2,3,4,5,6,7,8,7,6,5,4,3,2,1,0,1,2,3,4,5,6,7,8,7,6,5,4,3,2,1,16,15,14,13,12,11,10,9,8,9,10,11,12,13,14,15,16,15,14,13,12,11,10,9,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],lz.MaskBounce=[4294967292,4294967294,4294967295],lz.PlusAngles=[-4,4,-2,2,-1,1],lz.PlusAnglesTry=[-4,4,-4,4,-4,4],lz.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t;let s=e;this.hoPtr.hoCalculX=0,this.hoPtr.hoCalculY=0,this.hoPtr.roc.rcSpeed=s.mbSpeed,this.hoPtr.roc.rcMaxSpeed=s.mbSpeed,this.hoPtr.roc.rcMinSpeed=s.mbSpeed,this.MB_Speed=s.mbSpeed<<8;let r=s.mbDecelerate;0!=r&&(r=this.getAccelerator(r),this.hoPtr.roc.rcMinSpeed=0),this.rmDecValue=r,this.MB_Bounce=s.mbBounce,this.MB_Angles=s.mbAngles,this.MB_MaskBounce=lz.MaskBounce[this.MB_Angles],this.MB_Blocked=!1,this.MB_LastBounce=-1,this.MB_Securite=(100-s.mbSecurity)/8,this.MB_SecuCpt=this.MB_Securite,this.moveAtStart(e),this.hoPtr.roc.rcChanged=!0},move:function(){if(this.hoPtr.rom.rmBouncing=!1,this.hoPtr.hoAdRunHeader.rhVBLObjet=1,this.hoPtr.roc.rcAnim=nY.ANIMID_WALK,null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),0!=this.rmDecValue){let t=this.MB_Speed;if(t>0){let e=this.rmDecValue;(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(e*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(t-=e)<0&&(t=0),this.MB_Speed=t,t>>=8,this.hoPtr.roc.rcSpeed=t}}this.newMake_Move(this.hoPtr.roc.rcSpeed,this.hoPtr.hoAdRunHeader.getDir(this.hoPtr))},stop:function(){0==this.rmStopSpeed&&(this.rmStopSpeed=32768|this.hoPtr.roc.rcSpeed,this.hoPtr.roc.rcSpeed=0,this.MB_Speed=0,this.hoPtr.rom.rmMoveFlag=!0)},start:function(){let t=this.rmStopSpeed;0!=t&&(t&=32767,this.hoPtr.roc.rcSpeed=t,this.MB_Speed=t<<8,this.rmStopSpeed=0,this.hoPtr.rom.rmMoveFlag=!0)},bounce:function(){if(0==this.rmStopSpeed&&this.hoPtr.hoAdRunHeader.rhLoopCount!=this.MB_LastBounce){this.MB_LastBounce=this.hoPtr.hoAdRunHeader.rhLoopCount,this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount&&this.mb_Approach(this.MB_Blocked);let t=this.hoPtr.hoX,e=this.hoPtr.hoY,s=0;t-=8,e-=8,!1==this.tst_Position(t,e,this.MB_Blocked)&&(s|=1),t+=16,!1==this.tst_Position(t,e,this.MB_Blocked)&&(s|=2),e+=16,!1==this.tst_Position(t,e,this.MB_Blocked)&&(s|=4),t-=16,!1==this.tst_Position(t,e,this.MB_Blocked)&&(s|=8);let r=lz.rebond_List[32*s+this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)];if(r&=this.MB_MaskBounce,!this.mvb_Test(r)){let h=lz.PlusAnglesTry[2*this.MB_Angles+1],n=h,a=!1;do{if(r-=h,r&=31,this.mvb_Test(r)||(r+=2*h,r&=31,this.mvb_Test(r))){a=!0;break}r-=h,r&=31,h+=n}while(h<=16);if(!1==a){this.MB_Blocked=!0,this.hoPtr.roc.rcDir=this.hoPtr.hoAdRunHeader.random(32)&this.MB_MaskBounce,this.hoPtr.rom.rmBouncing=!0,this.hoPtr.rom.rmMoveFlag=!0;return}}this.MB_Blocked=!1,this.hoPtr.roc.rcDir=r;let l=this.hoPtr.hoAdRunHeader.random(100);if(l<this.MB_Bounce&&(l>>=2)<25&&(l-=12,l&=31,l&=this.MB_MaskBounce,this.mvb_Test(l))){this.hoPtr.roc.rcDir=l,this.hoPtr.rom.rmBouncing=!0,this.hoPtr.rom.rmMoveFlag=!0;return}r=7&this.hoPtr.hoAdRunHeader.getDir(this.hoPtr),12!=this.MB_SecuCpt&&(0==r?(this.MB_SecuCpt--,this.MB_SecuCpt<0&&(r=this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)+lz.PlusAngles[this.hoPtr.hoAdRunHeader.random(2)+2*this.MB_Angles],r&=31,this.mvb_Test(r)&&(this.hoPtr.roc.rcDir=r,this.MB_SecuCpt=this.MB_Securite))):this.MB_SecuCpt=this.MB_Securite),this.hoPtr.rom.rmBouncing=!0,this.hoPtr.rom.rmMoveFlag=!0}},mvb_Test:function(t){let e=65536*this.hoPtr.hoX+(65535&this.hoPtr.hoCalculX),s=65536*this.hoPtr.hoY+(65535&this.hoPtr.hoCalculY),r=2048*lq.Cosinus32[t]+e,h=2048*lq.Sinus32[t]+s;return r=Math.floor(r/65536),h=Math.floor(h/65536),this.tst_Position(r,h,!1)},setDir:function(t){},setSpeed:function(t){t<0&&(t=0),t>250&&(t=250),this.hoPtr.roc.rcSpeed=t,this.MB_Speed=t<<8,this.rmStopSpeed=0,this.hoPtr.rom.rmMoveFlag=!0},setMaxSpeed:function(t){this.setSpeed(t)},reverse:function(){0==this.rmStopSpeed&&(this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcDir+=16,this.hoPtr.roc.rcDir&=31)},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)}}),lJ.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t,this.rhPtr=t.hoAdRunHeader,this.rhPtr.GetBase(),null!=this.hoPtr.ros&&this.hoPtr.ros.setColFlag(!1),null!=this.hoPtr.ros&&(this.hoPtr.ros.rsFlags&=~l2.RSFLAG_VISIBLE,this.hoPtr.ros.obHide()),this.MBul_Wait=!0,this.hoPtr.hoCalculX=0,this.hoPtr.hoCalculY=0,null!=this.hoPtr.roa&&this.hoPtr.roa.init_Animation(nY.ANIMID_WALK),this.hoPtr.roc.rcSpeed=0,this.hoPtr.roc.rcCheckCollides=!0,this.hoPtr.roc.rcChanged=!0},init2:function(t){this.hoPtr.roc.rcMaxSpeed=this.hoPtr.roc.rcSpeed,this.hoPtr.roc.rcMinSpeed=this.hoPtr.roc.rcSpeed,this.MBul_ShootObject=t},kill:function(t){this.freeBullet(this.hoPtr)},move:function(){if(this.MBul_Wait){if(null!=this.MBul_ShootObject.roa&&this.MBul_ShootObject.roa.raAnimOn==nY.ANIMID_SHOOT)return;this.startBullet()}null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),this.newMake_Move(this.hoPtr.roc.rcSpeed,this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)),(this.hoPtr.hoX<-64||this.hoPtr.hoX>this.hoPtr.hoAdRunHeader.rhLevelSx+64||this.hoPtr.hoY<-64||this.hoPtr.hoY>this.hoPtr.hoAdRunHeader.rhLevelSy+64)&&(this.hoPtr.hoCallRoutine=!1,this.hoPtr.hoAdRunHeader.destroy_Add(this.hoPtr.hoNumber)),this.hoPtr.roc.rcCheckCollides&&(this.hoPtr.roc.rcCheckCollides=!1,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr))},startBullet:function(){if(null!=this.hoPtr.ros&&this.hoPtr.ros.setColFlag(!0),null!=this.hoPtr.ros&&(this.hoPtr.ros.rsFlags|=l2.RSFLAG_VISIBLE,this.hoPtr.ros.obShow()),null!=this.rhPtr.rh4Box2DBase){let t=this.MBul_ShootObject,e=this.rhPtr.GetMBase(t);if(null!=e){let s=this.rhPtr.rh4Box2DBase,r=new n5;this.MBul_MBase=r,r.InitBase(this.hoPtr,n5.MTYPE_OBJECT),r.m_identifier=s.identifier,this.MBul_Body=s.rCreateBullet(e.m_currentAngle,this.hoPtr.roc.rcSpeed/250*50,r),r.m_body=this.MBul_Body,null==this.MBul_Body&&(this.MBul_MBase=null)}}this.MBul_Wait=!1,this.MBul_ShootObject=null},freeBullet:function(t){null!=this.MBul_Body&&((pBase=this.hoPtr.hoAdRunHeader.rh4Box2DBase).rDestroyBody(this.MBul_Body),this.MBul_Body=null),null!=this.MBul_MBase&&(this.MBul_MBase=null)},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setDir:function(t){},reverse:function(t){},stop:function(){},start:function(){},bounce:function(){},setSpeed:function(t){},setMaxSpeed:function(t){}}),lQ.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t},move:function(){(this.hoPtr.hoFlags&a0.HOF_FADEOUT)==0&&null!=this.hoPtr.roa&&(this.hoPtr.roa.animate(),this.hoPtr.roa.raAnimForced!=nY.ANIMID_DISAPPEAR+1&&this.hoPtr.hoAdRunHeader.destroy_Add(this.hoPtr.hoNumber))},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0)},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0)},setDir:function(t){},reverse:function(t){},stop:function(){},start:function(){},bounce:function(){},setSpeed:function(t){},setMaxSpeed:function(t){}}),lZ.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t,this.hoPtr.hoCalculX=0,this.hoPtr.hoCalculY=0,this.MG_Speed=0,this.hoPtr.roc.rcSpeed=0,this.MG_Bounce=0,this.MG_LastBounce=-1,this.hoPtr.roc.rcPlayer=e.mvControl,this.rmAcc=e.mgAcc,this.rmAccValue=this.getAccelerator(this.rmAcc),this.rmDec=e.mgDec,this.rmDecValue=this.getAccelerator(this.rmDec),this.hoPtr.roc.rcMaxSpeed=e.mgSpeed,this.hoPtr.roc.rcMinSpeed=0,this.MG_BounceMu=e.mgBounceMult,this.MG_OkDirs=e.mgDir,this.rmOpt=e.mvOpt,this.hoPtr.roc.rcChanged=!0},move:function(){if(this.hoPtr.hoAdRunHeader.rhVBLObjet=1,t=this.hoPtr.hoAdRunHeader.getDir(this.hoPtr),this.hoPtr.roc.rcOldDir=t,0==this.MG_Bounce){this.hoPtr.rom.rmBouncing=!1,e=0;var t,e,s,r,h,n,a=15&this.hoPtr.hoAdRunHeader.rhPlayer[this.hoPtr.roc.rcPlayer-1];if(0!=a&&-1!=(h=lq.Joy2Dir[a])&&(1<<h&this.MG_OkDirs)!=0&&(e=1,t=h),s=this.MG_Speed,0==e?0!=s&&(n=this.rmDecValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(n*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(s-=n)<=0&&(s=0)):(r=s>>8)<this.hoPtr.roc.rcMaxSpeed&&(n=this.rmAccValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(n*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),s+=n,(r=s>>8)>this.hoPtr.roc.rcMaxSpeed&&(s=this.hoPtr.roc.rcMaxSpeed<<8)),this.MG_Speed=s,this.hoPtr.roc.rcSpeed=s>>8,this.hoPtr.roc.rcDir=t,this.hoPtr.roc.rcAnim=nY.ANIMID_WALK,null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),!1==this.newMake_Move(this.hoPtr.roc.rcSpeed,this.hoPtr.hoAdRunHeader.getDir(this.hoPtr))||0==this.hoPtr.roc.rcSpeed&&(0==(s=this.MG_Speed)||this.hoPtr.roc.rcOldDir==this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)||(this.hoPtr.roc.rcSpeed=s>>8,this.hoPtr.roc.rcDir=this.hoPtr.roc.rcOldDir,!1==this.newMake_Move(this.hoPtr.roc.rcSpeed,this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)))))return}for(;;){if(0==this.MG_Bounce||0==this.hoPtr.hoAdRunHeader.rhVBLObjet)return;if(s=this.MG_Speed,(s-=this.rmDecValue)>0){if(this.MG_Speed=s,s>>=8,this.hoPtr.roc.rcSpeed=s,h=this.hoPtr.hoAdRunHeader.getDir(this.hoPtr),0!=this.MG_Bounce&&(h+=16,h&=31),!1==this.newMake_Move(s,h))return;continue}this.MG_Speed=0,this.hoPtr.roc.rcSpeed=0,this.MG_Bounce=0;break}},bounce:function(){if(this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount&&this.mv_Approach((this.rmOpt&lq.MVTOPT_8DIR_STICK)!=0),this.hoPtr.hoAdRunHeader.rhLoopCount!=this.MG_LastBounce){if(this.MG_LastBounce=this.hoPtr.hoAdRunHeader.rhLoopCount,this.MG_Bounce++,this.MG_Bounce>=12){this.stop();return}this.hoPtr.rom.rmBouncing=!0,this.hoPtr.rom.rmMoveFlag=!0}},reverse:function(){},setDir:function(t){},stop:function(){this.hoPtr.roc.rcSpeed=0,this.MG_Bounce=0,this.MG_Speed=0,this.hoPtr.rom.rmMoveFlag=!0,this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount&&(this.mv_Approach((this.rmOpt&lq.MVTOPT_8DIR_STICK)!=0),this.MG_Bounce=0)},start:function(){this.hoPtr.rom.rmMoveFlag=!0,this.rmStopSpeed=0},setMaxSpeed:function(t){t<0&&(t=0),t>250&&(t=250),this.hoPtr.roc.rcMaxSpeed=t,this.hoPtr.roc.rcSpeed>t&&(this.hoPtr.roc.rcSpeed=t,this.MG_Speed=t<<8),this.hoPtr.rom.rmMoveFlag=!0},setSpeed:function(t){t<0&&(t=0),t>250&&(t=250),t>this.hoPtr.roc.rcMaxSpeed&&(t=this.hoPtr.roc.rcMaxSpeed),this.hoPtr.roc.rcSpeed=t,this.MG_Speed=t<<8,this.hoPtr.rom.rmMoveFlag=!0},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},set8DirsGeneric:function(t){this.MG_OkDirs=t}}),l9.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t,this.hoPtr.roc.rcPlayer=e.mvControl,this.MM_DXMouse=e.mmDx+this.hoPtr.hoX,this.MM_DYMouse=e.mmDy+this.hoPtr.hoY,this.MM_FXMouse=e.mmFx+this.hoPtr.hoX,this.MM_FYMouse=e.mmFy+this.hoPtr.hoY,this.hoPtr.roc.rcSpeed=0,this.MM_OldSpeed=0,this.MM_Stopped=0,this.hoPtr.roc.rcMinSpeed=0,this.hoPtr.roc.rcMaxSpeed=100,this.rmOpt=e.mvOpt,this.moveAtStart(e),this.hoPtr.roc.rcChanged=!0},move:function(){let t,e,s,r,h,n,a=this.hoPtr.hoX,l=this.hoPtr.hoY;if(0==this.rmStopSpeed&&0!=this.hoPtr.hoAdRunHeader.rh2InputMask[this.hoPtr.roc.rcPlayer-1]&&((a=this.hoPtr.hoAdRunHeader.rh2MouseX)<this.MM_DXMouse&&(a=this.MM_DXMouse),a>this.MM_FXMouse&&(a=this.MM_FXMouse),(l=this.hoPtr.hoAdRunHeader.rh2MouseY)<this.MM_DYMouse&&(l=this.MM_DYMouse),l>this.MM_FYMouse&&(l=this.MM_FYMouse),t=a-this.hoPtr.hoX,e=l-this.hoPtr.hoY,s=0,t<0&&(t=-t,s|=1),e<0&&(e=-e,s|=2),(r=t+e<<2)>250&&(r=250),this.hoPtr.roc.rcSpeed=r,0!=r)){for(t<<=8,0==e&&(e=1),t/=e,n=0;!(t>=lq.CosSurSin32[n]);n+=2);h=lq.CosSurSin32[n+1],(2&s)!=0&&(h=-h+32,h&=31),(1&s)!=0&&(h-=8,h&=31,h=-h,h&=31,h+=8,h&=31),this.hoPtr.roc.rcDir=h}0!=this.hoPtr.roc.rcSpeed&&(this.MM_Stopped=0,this.MM_OldSpeed=this.hoPtr.roc.rcSpeed),this.MM_Stopped++,this.MM_Stopped>10&&(this.MM_OldSpeed=0),this.hoPtr.roc.rcSpeed=this.MM_OldSpeed,null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),this.hoPtr.hoX=a,this.hoPtr.hoY=l,this.hoPtr.roc.rcChanged=!0,this.hoPtr.hoAdRunHeader.rh3CollisionCount++,this.rmCollisionCount=this.hoPtr.hoAdRunHeader.rh3CollisionCount,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr)},stop:function(){this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount&&this.mv_Approach((this.rmOpt&lq.MVTOPT_8DIR_STICK)!=0),this.hoPtr.roc.rcSpeed=0},start:function(){this.rmStopSpeed=0,this.hoPtr.rom.rmMoveFlag=!0},bounce:function(){this.stop()},reverse:function(){},setDir:function(t){},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)}}),ut.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t,this.MT_XStart=this.hoPtr.hoX,this.MT_YStart=this.hoPtr.hoY,this.MT_Direction=!1,this.MT_Pause=0,this.hoPtr.hoMark1=0,this.MT_Movement=e,this.hoPtr.roc.rcMinSpeed=e.mtMinSpeed,this.hoPtr.roc.rcMaxSpeed=e.mtMaxSpeed,this.MT_Calculs=0,this.MT_GotoNode=null,this.mtGoAvant(0),this.moveAtStart(e),this.hoPtr.roc.rcSpeed=this.MT_Speed,this.hoPtr.roc.rcChanged=!0,0==this.MT_Movement.steps.length&&this.stop()},move:function(){if(this.hoPtr.hoMark1=0,this.hoPtr.roc.rcAnim=nY.ANIMID_WALK,null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),0==this.MT_Speed){var t,e,s=this.MT_Pause;if(0==s){this.hoPtr.roc.rcSpeed=0,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr);return}if((s-=this.hoPtr.hoAdRunHeader.rhTimerDelta)>0){this.MT_Pause=s,this.hoPtr.roc.rcSpeed=0,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr);return}this.MT_Pause=0,this.MT_Speed=32767&this.rmStopSpeed,this.rmStopSpeed=0,this.hoPtr.roc.rcSpeed=this.MT_Speed}for(t=(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0?256*this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef:256,this.hoPtr.hoAdRunHeader.rhMT_VBLCount=t;;){for(e=!1,this.hoPtr.hoAdRunHeader.rhMT_VBLStep=t,t*=this.MT_Speed,(t<<=5)<=524288?this.hoPtr.hoAdRunHeader.rhMT_MoveStep=t:(t=16384,t/=this.MT_Speed,this.hoPtr.hoAdRunHeader.rhMT_VBLStep=t,this.hoPtr.hoAdRunHeader.rhMT_MoveStep=524288);;){if(this.MT_FlagBranch=!1,!0==this.mtMove(this.hoPtr.hoAdRunHeader.rhMT_MoveStep)&&!1==this.MT_FlagBranch||this.hoPtr.hoAdRunHeader.rhMT_VBLCount==this.hoPtr.hoAdRunHeader.rhMT_VBLStep){e=!0;break}if(this.hoPtr.hoAdRunHeader.rhMT_VBLCount>this.hoPtr.hoAdRunHeader.rhMT_VBLStep){this.hoPtr.hoAdRunHeader.rhMT_VBLCount-=this.hoPtr.hoAdRunHeader.rhMT_VBLStep,t=this.hoPtr.hoAdRunHeader.rhMT_VBLCount;break}t=this.hoPtr.hoAdRunHeader.rhMT_VBLCount*MT_Speed,t<<=5,this.mtMove(t),e=!0;break}if(e)break}},mtMove:function(t){let e=(t+=this.MT_Calculs)>>>16;if(e<this.MT_Longueur){this.MT_Calculs=t;let s=e*this.MT_Cosinus/16384+this.MT_XOrigin,r=e*this.MT_Sinus/16384+this.MT_YOrigin;return this.hoPtr.hoX=s,this.hoPtr.hoY=r,this.hoPtr.roc.rcChanged=!0,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr),this.hoPtr.rom.rmMoveFlag}if(e-=this.MT_Longueur,t=e<<16|65535&t,0!=this.MT_Speed&&(t/=this.MT_Speed),t>>=5,this.hoPtr.hoAdRunHeader.rhMT_VBLCount+=65535&t,this.hoPtr.hoX=this.MT_XDest,this.hoPtr.hoY=this.MT_YDest,this.hoPtr.roc.rcChanged=!0,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr),this.hoPtr.rom.rmMoveFlag)return!0;this.hoPtr.hoMark1=this.hoPtr.hoAdRunHeader.rhLoopCount,this.hoPtr.hoMT_NodeName=null;let n=this.MT_MoveNumber;return(this.MT_Calculs=0,!1==this.MT_Direction)?++n<this.MT_Movement.mtNumber?(this.hoPtr.hoMT_NodeName=this.MT_Movement.steps[n].mdName,null!=this.MT_GotoNode&&null!=this.MT_Movement.steps[n].mdName&&h.compareStringsIgnoreCase(this.MT_GotoNode,this.MT_Movement.steps[n].mdName))?(this.MT_MoveNumber=n,this.mtMessages(),this.mtTheEnd()):(this.mtGoAvant(n),this.mtMessages(),this.hoPtr.rom.rmMoveFlag):(this.hoPtr.hoMark2=this.hoPtr.hoAdRunHeader.rhLoopCount,this.MT_MoveNumber=n,this.MT_Direction)?(this.mtMessages(),this.hoPtr.rom.rmMoveFlag):0!=this.MT_Movement.mtReverse?(this.MT_Direction=!0,n--,this.hoPtr.hoMT_NodeName=this.MT_Movement.steps[n].mdName,this.mtGoArriere(n),this.mtMessages(),this.hoPtr.rom.rmMoveFlag):(this.mtReposAtEnd(),0==this.MT_Movement.mtLoop)?(this.mtTheEnd(),this.mtMessages(),this.hoPtr.rom.rmMoveFlag):(n=0,this.mtGoAvant(n),this.mtMessages(),this.hoPtr.rom.rmMoveFlag):null!=this.MT_GotoNode&&null!=this.MT_Movement.steps[n].mdName&&h.compareStringsIgnoreCase(this.MT_GotoNode,this.MT_Movement.steps[n].mdName)?(this.mtMessages(),this.mtTheEnd()):(this.hoPtr.hoMT_NodeName=this.MT_Movement.steps[n].mdName,this.MT_Pause=this.MT_Movement.steps[n].mdPause,--n>=0)?(this.mtGoArriere(n),this.mtMessages(),this.hoPtr.rom.rmMoveFlag):(this.mtReposAtEnd(),!1==this.MT_Direction)?(this.mtMessages(),this.hoPtr.rom.rmMoveFlag):0==this.MT_Movement.mtLoop?(this.mtTheEnd(),this.mtMessages(),this.hoPtr.rom.rmMoveFlag):(n=0,this.MT_Direction=!1,this.mtGoAvant(n),this.mtMessages(),this.hoPtr.rom.rmMoveFlag)},mtGoAvant:function(t){t>=this.MT_Movement.steps.length?this.stop():(this.MT_Direction=!1,this.MT_MoveNumber=t,this.MT_Pause=this.MT_Movement.steps[t].mdPause,this.MT_Cosinus=this.MT_Movement.steps[t].mdCosinus,this.MT_Sinus=this.MT_Movement.steps[t].mdSinus,this.MT_XOrigin=this.hoPtr.hoX,this.MT_YOrigin=this.hoPtr.hoY,this.MT_XDest=this.hoPtr.hoX+this.MT_Movement.steps[t].mdDx,this.MT_YDest=this.hoPtr.hoY+this.MT_Movement.steps[t].mdDy,this.hoPtr.roc.rcDir=this.MT_Movement.steps[t].mdDir,this.mtBranche())},mtGoArriere:function(t){if(t>=this.MT_Movement.steps.length)this.stop();else{this.MT_Direction=!0,this.MT_MoveNumber=t,this.MT_Cosinus=-this.MT_Movement.steps[t].mdCosinus,this.MT_Sinus=-this.MT_Movement.steps[t].mdSinus,this.MT_XOrigin=this.hoPtr.hoX,this.MT_YOrigin=this.hoPtr.hoY,this.MT_XDest=this.hoPtr.hoX-this.MT_Movement.steps[t].mdDx,this.MT_YDest=this.hoPtr.hoY-this.MT_Movement.steps[t].mdDy;let e=this.MT_Movement.steps[t].mdDir;e+=16,e&=31,this.hoPtr.roc.rcDir=e,this.mtBranche()}},mtBranche:function(){this.MT_Longueur=this.MT_Movement.steps[this.MT_MoveNumber].mdLength;let t=this.MT_Movement.steps[this.MT_MoveNumber].mdSpeed,e=this.MT_Pause;0!=e&&(this.MT_Pause=20*e,t|=32768,this.rmStopSpeed=t),0!=this.rmStopSpeed&&(t=0),(t!=this.MT_Speed||0!=t)&&(this.MT_Speed=t,this.hoPtr.rom.rmMoveFlag=!0,this.MT_FlagBranch=!0),this.hoPtr.roc.rcSpeed=this.MT_Speed},mtMessages:function(){this.hoPtr.hoMark1==this.hoPtr.hoAdRunHeader.rhLoopCount&&(this.hoPtr.hoAdRunHeader.rhEvtProg.rhCurParam0=0,this.hoPtr.hoAdRunHeader.rhEvtProg.handle_Event(this.hoPtr,-1310720|65535&this.hoPtr.hoType),this.hoPtr.hoAdRunHeader.rhEvtProg.handle_Event(this.hoPtr,-2293760|65535&this.hoPtr.hoType)),this.hoPtr.hoMark2==this.hoPtr.hoAdRunHeader.rhLoopCount&&(this.hoPtr.hoAdRunHeader.rhEvtProg.rhCurParam0=0,this.hoPtr.hoAdRunHeader.rhEvtProg.handle_Event(this.hoPtr,-1376256|65535&this.hoPtr.hoType))},mtTheEnd:function(){return this.MT_Speed=0,this.rmStopSpeed=0,this.hoPtr.rom.rmMoveFlag=!0,this.MT_FlagBranch=!1,!0},mtReposAtEnd:function(){0!=this.MT_Movement.mtRepos&&(this.hoPtr.hoX=this.MT_XStart,this.hoPtr.hoY=this.MT_YStart,this.hoPtr.roc.rcChanged=!0)},mtBranchNode:function(t){let e;for(e=0;e<this.MT_Movement.mtNumber;e++)if(null!=this.MT_Movement.steps[e].mdName&&h.compareStringsIgnoreCase(t,this.MT_Movement.steps[e].mdName)){!1==this.MT_Direction?(this.mtGoAvant(e),this.hoPtr.hoMark1=this.hoPtr.hoAdRunHeader.rhLoopCount,this.hoPtr.hoMT_NodeName=this.MT_Movement.steps[e].mdName,this.hoPtr.hoMark2=0,this.mtMessages()):e>0&&(e--,this.mtGoArriere(e),this.hoPtr.hoMark1=this.hoPtr.hoAdRunHeader.rhLoopCount,this.hoPtr.hoMT_NodeName=this.MT_Movement.steps[e].mdName,this.hoPtr.hoMark2=0,this.mtMessages()),this.hoPtr.rom.rmMoveFlag=!0;return}},mtGotoNode:function(t){let e;for(e=0;e<this.MT_Movement.mtNumber;e++)if(null!=this.MT_Movement.steps[e].mdName&&h.compareStringsIgnoreCase(t,this.MT_Movement.steps[e].mdName)){if(e==this.MT_MoveNumber&&0==this.MT_Calculs)return;if(this.MT_GotoNode=t,!1==this.MT_Direction){if(e>this.MT_MoveNumber){if(0!=this.MT_Speed)return;(32768&this.rmStopSpeed)!=0?this.start():this.mtGoAvant(this.MT_MoveNumber);return}if(0!=this.MT_Speed){this.reverse();return}(32768&this.rmStopSpeed)!=0?(this.start(),this.reverse()):this.mtGoArriere(MT_MoveNumber-1);return}if(e<=this.MT_MoveNumber){if(0!=this.MT_Speed)return;(32768&this.rmStopSpeed)!=0?this.start():this.mtGoArriere(this.MT_MoveNumber-1);return}if(0!=this.MT_Speed){this.reverse();return}(32768&this.rmStopSpeed)!=0?(this.start(),this.reverse()):this.mtGoAvant(this.MT_MoveNumber);return}},stop:function(){0==this.rmStopSpeed&&(this.rmStopSpeed=32768|this.MT_Speed),this.MT_Speed=0,this.hoPtr.rom.rmMoveFlag=!0},start:function(){(32768&this.rmStopSpeed)!=0&&(this.MT_Speed=32767&this.rmStopSpeed,this.MT_Pause=0,this.rmStopSpeed=0,this.hoPtr.rom.rmMoveFlag=!0)},reverse:function(){if(0==this.rmStopSpeed){this.hoPtr.rom.rmMoveFlag=!0;let t=this.MT_MoveNumber;if(0==this.MT_Calculs){if(this.MT_Direction=!this.MT_Direction,this.MT_Direction){if(0==t){this.MT_Direction=!this.MT_Direction;return}t--,this.mtGoArriere(t)}else this.mtGoAvant(t)}else{this.MT_Direction=!this.MT_Direction,this.MT_Cosinus=-this.MT_Cosinus,this.MT_Sinus=-this.MT_Sinus;let e=this.MT_XOrigin,s=this.MT_XDest;this.MT_XOrigin=s,this.MT_XDest=e,e=this.MT_YOrigin,s=this.MT_YDest,this.MT_YOrigin=s,this.MT_YDest=e,this.hoPtr.roc.rcDir+=16,this.hoPtr.roc.rcDir&=31;let r=this.MT_Calculs>>>16;r=this.MT_Longueur-r,this.MT_Calculs=r<<16|65535&this.MT_Calculs}}},setXPosition:function(t){let e=this.hoPtr.hoX;this.hoPtr.hoX=t,e-=this.MT_XOrigin,t-=e,e=this.MT_XDest-this.MT_XOrigin+t,this.MT_XDest=e,e=this.MT_XOrigin,this.MT_XOrigin=t,e-=t,this.MT_XStart-=e,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0},setYPosition:function(t){let e=this.hoPtr.hoY;this.hoPtr.hoY=t,e-=this.MT_YOrigin,t-=e,e=this.MT_YDest-this.MT_YOrigin+t,this.MT_YDest=e,e=this.MT_YOrigin,this.MT_YOrigin=t,e-=t,this.MT_YStart-=e,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0},setSpeed:function(t){t<0&&(t=0),t>250&&(t=250),this.MT_Speed=t,this.hoPtr.roc.rcSpeed=t,this.hoPtr.rom.rmMoveFlag=!0},setMaxSpeed:function(t){this.setSpeed(t)},setDir:function(t){}}),ue.MPJC_NOJUMP=0,ue.MPJC_DIAGO=1,ue.MPJC_BUTTON1=2,ue.MPJC_BUTTON2=3,ue.MPTYPE_WALK=0,ue.MPTYPE_CLIMB=1,ue.MPTYPE_JUMP=2,ue.MPTYPE_FALL=3,ue.MPTYPE_CROUCH=4,ue.MPTYPE_UNCROUCH=5,ue.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t,this.rhPtr=this.hoPtr.hoAdRunHeader,this.hoPtr.hoCalculX=0,this.hoPtr.hoCalculY=0,this.MP_XSpeed=0,this.hoPtr.roc.rcSpeed=0,this.MP_Bounce=0,this.hoPtr.roc.rcPlayer=e.mvControl,this.rmAcc=e.mpAcc,this.rmAccValue=this.getAccelerator(this.rmAcc),this.rmDec=e.mpDec,this.rmDecValue=this.getAccelerator(this.rmDec),this.hoPtr.roc.rcMaxSpeed=e.mpSpeed,this.hoPtr.roc.rcMinSpeed=0,this.MP_Gravity=e.mpGravity,this.MP_Jump=e.mpJump;let s=e.mpJumpControl;s>3&&(s=ue.MPJC_DIAGO),this.MP_JumpControl=s,this.MP_YSpeed=0,this.MP_JumpStopped=0,this.MP_ObjectUnder=null,this.moveAtStart(e),this.MP_PreviousDir=this.hoPtr.hoAdRunHeader.getDir(this.hoPtr),this.hoPtr.roc.rcChanged=!0,this.MP_Type=ue.MPTYPE_WALK},move:function(){this.hoPtr.hoAdRunHeader.rhVBLObjet=1;let t=this.hoPtr.hoAdRunHeader.rhPlayer[this.hoPtr.roc.rcPlayer-1];this.calcMBFoot();let e=this.MP_XSpeed;0==this.MP_JumpStopped&&(e<=0&&((4&t)!=0?(p=this.rmAccValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),e-=p,(d=e/256)<-this.hoPtr.roc.rcMaxSpeed&&(e=-(256*this.hoPtr.roc.rcMaxSpeed))):e<0&&(p=this.rmDecValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(e+=p)>0&&(e=0)),(8&t)!=0&&(e=-e)),e>=0&&((8&t)!=0?(p=this.rmAccValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),e+=p,(d=e/256)>this.hoPtr.roc.rcMaxSpeed&&(e=256*this.hoPtr.roc.rcMaxSpeed)):e>0&&(p=this.rmDecValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(e-=p)<0&&(e=0)),(4&t)!=0&&(e=-e)),this.MP_XSpeed=e);for(var s=this.MP_YSpeed,r=!1;;){switch(this.MP_Type){case 2:case 3:p=this.MP_Gravity<<5,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(s+=p)>64e3&&(s=64e3);break;case 0:if((1&t)!=0){if(this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB-4)==nD.INTBAD)break;this.MP_Type=ue.MPTYPE_CLIMB,r=!0;continue}if((2&t)!=0){if(this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB+4)==nD.INTBAD)break;this.MP_Type=ue.MPTYPE_CLIMB,r=!0;continue}break;case 1:if(!1==r&&(this.MP_JumpStopped=0,this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB)==nD.INTBAD&&this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB-4)==nD.INTBAD))break;s<=0&&((1&t)!=0?(p=this.rmAccValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),s-=p,(d=s/256)<-this.hoPtr.roc.rcMaxSpeed&&(s=-(256*this.hoPtr.roc.rcMaxSpeed))):(p=this.rmDecValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(s+=p)>0&&(s=0)),(2&t)!=0&&(s=-s)),s>=0&&((2&t)!=0?(p=this.rmAccValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),s+=p,(d=s/256)>this.hoPtr.roc.rcMaxSpeed&&(s=256*this.hoPtr.roc.rcMaxSpeed)):(p=this.rmDecValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(p*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(s-=p)<0&&(s=0)),(1&t)!=0&&(s=-s))}break}this.MP_YSpeed=s;let h=0;e<0&&(h=16);let n=e,a=s;if(0!=a){var l,u,d,p,m,f=0;for(n<0&&(f|=1,n=-n),a<0&&(f|=2,a=-a),n<<=8,n/=a,m=0;!(n>=lq.CosSurSin32[m]);m+=2);h=lq.CosSurSin32[m+1],(2&f)!=0&&(h=-h+32,h&=31),(1&f)!=0&&(h-=8,h&=31,h=-h,h&=31,h+=8,h&=31)}n=e;let $=lq.Cosinus32[h],g=lq.Sinus32[h];switch($<0&&($=-$),g<0&&(g=-g),$<g&&($=g,n=s),n<0&&(n=-n),(n/=$)>250&&(n=250),this.hoPtr.roc.rcSpeed=n,this.MP_Type){case 1:s<0?this.hoPtr.roc.rcDir=8:s>0&&(this.hoPtr.roc.rcDir=24);break;case 3:this.hoPtr.roc.rcDir=h;break;default:e<0?this.hoPtr.roc.rcDir=16:e>0&&(this.hoPtr.roc.rcDir=0)}switch(this.MP_Type){case 4:this.hoPtr.roc.rcAnim=nY.ANIMID_CROUCH;break;case 5:this.hoPtr.roc.rcAnim=nY.ANIMID_UNCROUCH;break;case 3:this.hoPtr.roc.rcAnim=nY.ANIMID_FALL;break;case 2:this.hoPtr.roc.rcAnim=nY.ANIMID_JUMP;break;case 1:this.hoPtr.roc.rcAnim=nY.ANIMID_CLIMB;break;default:this.hoPtr.roc.rcAnim=nY.ANIMID_WALK}if(null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),this.calcMBFoot(),this.newMake_Move(this.hoPtr.roc.rcSpeed,h),(this.MP_Type==ue.MPTYPE_WALK||this.MP_Type==ue.MPTYPE_CLIMB)&&!1==this.MP_NoJump){let P=!1,E=this.MP_JumpControl;0!=E&&(0==--E?((5&t)==5&&(P=!0),(9&t)==9&&(P=!0)):(t&(E<<=4))!=0&&(P=!0)),P&&(this.MP_YSpeed=-this.MP_Jump<<8,this.MP_Type=ue.MPTYPE_JUMP)}switch(this.MP_Type){case 2:this.MP_YSpeed>=0&&(this.MP_Type=ue.MPTYPE_FALL);break;case 3:this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB)!=nD.INTBAD&&(this.MP_YSpeed=0,this.MP_Type=ue.MPTYPE_CLIMB,this.hoPtr.roc.rcDir=8);break;case 0:if((3&t)!=0&&(12&t)==0&&this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB)!=nD.INTBAD){this.MP_Type=ue.MPTYPE_CLIMB,this.MP_XSpeed=0;break}if((2&t)!=0&&null!=this.hoPtr.roa&&this.hoPtr.roa.anim_Exist(nY.ANIMID_CROUCH)&&(this.MP_XSpeed=0,this.MP_Type=ue.MPTYPE_CROUCH),this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB)!=nD.INTBAD)break;if(!1==this.tst_SpritePosition(this.hoPtr.hoX,this.hoPtr.hoY+10,this.MP_HTFOOT,nR.CM_TEST_PLATFORM,!0)){l=this.hoPtr.hoX-this.hoPtr.hoAdRunHeader.rhWindowX;let A=(u=this.hoPtr.hoY-this.hoPtr.hoAdRunHeader.rhWindowY)+this.MP_HTFOOT-1,v=new _;this.mpApproachSprite(l,A,l,u,this.MP_HTFOOT,nR.CM_TEST_PLATFORM,v),this.hoPtr.hoX=v.x+this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY=v.y+this.hoPtr.hoAdRunHeader.rhWindowY,this.MP_NoJump=!1}else this.MP_Type=ue.MPTYPE_FALL;break;case 1:if(this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB)==nD.INTBAD){if(this.MP_YSpeed<0){for(a=0;a<32;a++)if(this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB+a)!=nD.INTBAD){this.hoPtr.hoY+=a;break}}this.MP_YSpeed=0}(12&t)!=0&&(this.MP_Type=ue.MPTYPE_WALK,this.MP_YSpeed=0);break;case 4:if((2&t)==0){if(null!=hoPtr.roa&&this.hoPtr.roa.anim_Exist(nY.ANIMID_UNCROUCH)){this.MP_Type=ue.MPTYPE_UNCROUCH,this.hoPtr.roc.rcAnim=nY.ANIMID_UNCROUCH,this.hoPtr.roa.animate(),this.hoPtr.roa.raAnimRepeat=1;break}this.MP_Type=ue.MPTYPE_WALK}break;case 5:null!=this.hoPtr.roa&&0==this.hoPtr.roa.raAnimNumberOfFrame&&(this.MP_Type=ue.MPTYPE_WALK)}if(this.MP_Type==ue.MPTYPE_WALK||this.MP_Type==ue.MPTYPE_CROUCH||this.MP_Type==ue.MPTYPE_UNCROUCH)do{let O=null;if(null!=this.hoPtr.hoOiList&&(O=this.hoPtr.hoOiList.oilColList),null==this.hoPtr.hoAdRunHeader.objectAllCol_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,this.hoPtr.hoX,this.hoPtr.hoY,O)){let S=this.hoPtr.hoAdRunHeader.objectAllCol_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,this.hoPtr.hoX,this.hoPtr.hoY+1,O);if(null!=S&&1==S.size()){let T=S.get(0);if((null==this.MP_ObjectUnder||this.MP_ObjectUnder!=T)&&this.hoPtr.hoOi!=T.hoOi){this.MP_ObjectUnder=T,this.MP_XObjectUnder=T.hoX,this.MP_YObjectUnder=T.hoY;break}let b=T.hoX-this.MP_XObjectUnder,C=T.hoY-this.MP_YObjectUnder;this.MP_XObjectUnder=T.hoX,this.MP_YObjectUnder=T.hoY,this.hoPtr.hoX+=b,this.hoPtr.hoY+=C,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr),this.hoPtr.roc.rcChanged=!0;break}}this.MP_ObjectUnder=null}while(!1);else this.MP_ObjectUnder=null},mpStopIt:function(){this.hoPtr.roc.rcSpeed=0,this.MP_XSpeed=0,this.MP_YSpeed=0},bounce:function(){this.stop()},stop:function(){if(this.MP_Bounce=0,this.rmCollisionCount!=this.hoPtr.hoAdRunHeader.rh3CollisionCount){this.mpStopIt();return}this.hoPtr.rom.rmMoveFlag=!0;let t,e,s,r=this.hoPtr.hoX-this.hoPtr.hoAdRunHeader.rhWindowX,h=this.hoPtr.hoY-this.hoPtr.hoAdRunHeader.rhWindowY;switch(4294901760&this.hoPtr.hoAdRunHeader.rhEvtProg.rhCurCode){case -786432:t=this.hoPtr.hoX-this.hoPtr.hoImgXSpot,e=this.hoPtr.hoY-this.hoPtr.hoImgYSpot,s=this.hoPtr.hoAdRunHeader.quadran_Out(t,e,t+this.hoPtr.hoImgWidth,e+this.hoPtr.hoImgHeight),t=this.hoPtr.hoX,e=this.hoPtr.hoY,(s&nD.BORDER_LEFT)!=0&&(t=this.hoPtr.hoImgXSpot,this.MP_XSpeed=0,this.MP_NoJump=!0),(s&nD.BORDER_RIGHT)!=0&&(t=this.hoPtr.hoAdRunHeader.rhLevelSx-this.hoPtr.hoImgWidth+this.hoPtr.hoImgXSpot,this.MP_XSpeed=0,this.MP_NoJump=!0),(s&nD.BORDER_TOP)!=0&&(e=this.hoPtr.hoImgYSpot,this.MP_YSpeed=0,this.MP_NoJump=!1),(s&nD.BORDER_BOTTOM)!=0&&(e=this.hoPtr.hoAdRunHeader.rhLevelSy-this.hoPtr.hoImgHeight+this.hoPtr.hoImgYSpot,this.MP_YSpeed=0,this.MP_NoJump=!1),this.hoPtr.hoX=t,this.hoPtr.hoY=e,this.MP_Type==ue.MPTYPE_JUMP?this.MP_Type=ue.MPTYPE_FALL:this.MP_Type=ue.MPTYPE_WALK,this.MP_JumpStopped=0;return;case -851968:case -917504:this.MP_NoJump=!1;var n=new _;if(this.MP_Type==ue.MPTYPE_FALL){this.mpApproachSprite(r,h,this.hoPtr.roc.rcOldX-this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.roc.rcOldY-this.hoPtr.hoAdRunHeader.rhWindowY,this.MP_HTFOOT,nR.CM_TEST_PLATFORM,n),this.hoPtr.hoX=n.x+this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY=n.y+this.hoPtr.hoAdRunHeader.rhWindowY,this.MP_Type=ue.MPTYPE_WALK,this.hoPtr.roc.rcChanged=!0,this.tst_SpritePosition(this.hoPtr.hoX,this.hoPtr.hoY+1,0,nR.CM_TEST_PLATFORM,!0)?(this.hoPtr.roc.rcSpeed=0,this.MP_XSpeed=0):(this.MP_JumpStopped=0,this.hoPtr.roc.rcSpeed=Math.abs(this.MP_XSpeed/256),this.MP_YSpeed=0);return}if(this.MP_Type==ue.MPTYPE_WALK){if(this.mpApproachSprite(r,h,r,h-this.MP_HTFOOT,0,nR.CM_TEST_PLATFORM,n)){this.hoPtr.hoX=n.x+this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY=n.y+this.hoPtr.hoAdRunHeader.rhWindowY,this.hoPtr.roc.rcChanged=!0;return}if(this.mpApproachSprite(r,h,this.hoPtr.roc.rcOldX-this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.roc.rcOldY-this.hoPtr.hoAdRunHeader.rhWindowY,0,nR.CM_TEST_PLATFORM,n)){this.hoPtr.hoX=n.x+this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY=n.y+this.hoPtr.hoAdRunHeader.rhWindowY,this.hoPtr.roc.rcChanged=!0,this.mpStopIt();return}}if(this.MP_Type==ue.MPTYPE_JUMP){if(this.mpApproachSprite(r,h,r,h-this.MP_HTFOOT,0,nR.CM_TEST_PLATFORM,n)){this.hoPtr.hoX=n.x+this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY=n.y+this.hoPtr.hoAdRunHeader.rhWindowY,this.hoPtr.roc.rcChanged=!0;return}this.MP_JumpStopped=1,this.MP_XSpeed=0}if(this.MP_Type==ue.MPTYPE_CLIMB&&this.mpApproachSprite(r,h,this.hoPtr.roc.rcOldX-this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.roc.rcOldY-this.hoPtr.hoAdRunHeader.rhWindowY,0,nR.CM_TEST_PLATFORM,n)){this.hoPtr.hoX=n.x+this.hoPtr.hoAdRunHeader.rhWindowX,this.hoPtr.hoY=n.y+this.hoPtr.hoAdRunHeader.rhWindowY,this.hoPtr.roc.rcChanged=!0,this.mpStopIt();return}if(this.hoPtr.roc.rcImage=this.hoPtr.roc.rcOldImage,this.hoPtr.roc.rcAngle=this.hoPtr.roc.rcOldAngle,this.tst_SpritePosition(this.hoPtr.hoX,this.hoPtr.hoY,0,nR.CM_TEST_PLATFORM,!0))return;this.hoPtr.hoX=this.hoPtr.roc.rcOldX,this.hoPtr.hoY=this.hoPtr.roc.rcOldY,this.hoPtr.roc.rcChanged=!0}},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setSpeed:function(t){t<0&&(t=0),t>250&&(t=250),t>this.hoPtr.roc.rcMaxSpeed&&(t=this.hoPtr.roc.rcMaxSpeed),this.hoPtr.roc.rcSpeed=t,this.MP_XSpeed=this.hoPtr.roc.rcSpeed*lq.Cosinus32[this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)],this.MP_YSpeed=this.hoPtr.roc.rcSpeed*lq.Sinus32[this.hoPtr.hoAdRunHeader.getDir(this.hoPtr)],this.hoPtr.rom.rmMoveFlag=!0},setMaxSpeed:function(t){t<0&&(t=0),t>250&&(t=250),this.hoPtr.roc.rcMaxSpeed=t,t<<=8,this.MP_XSpeed>t&&(this.MP_XSpeed=t),this.hoPtr.rom.rmMoveFlag=!0},setGravity:function(t){this.MP_Gravity=t},setDir:function(t){this.hoPtr.roc.rcDir=t,this.MP_XSpeed=this.hoPtr.roc.rcSpeed*lq.Cosinus32[t],this.MP_YSpeed=this.hoPtr.roc.rcSpeed*lq.Sinus32[t]},calcMBFoot:function(){let t;this.hoPtr.roc.rcImage>0?t=this.hoPtr.hoAdRunHeader.rhApp.imageBank.getImageInfoEx(this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY):((t=new nU).width=this.hoPtr.hoImgWidth,t.height=this.hoPtr.hoImgHeight,t.xSpot=this.hoPtr.hoImgXSpot,t.ySpot=this.hoPtr.hoImgYSpot),this.MP_XMB=0,this.MP_YMB=t.height-t.ySpot,this.MP_HTFOOT=2*t.height+t.height>>>3},mpHandle_Background:function(){this.calcMBFoot(),this.rhPtr.check_Ladder(this.hoPtr.hoLayer,this.hoPtr.hoX+this.MP_XMB,this.hoPtr.hoY+this.MP_YMB)!=nD.INTBAD||!1==this.hoPtr.hoAdRunHeader.colMask_TestObject_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,this.hoPtr.hoX,this.hoPtr.hoY,0,nR.CM_TEST_OBSTACLE)&&(this.MP_Type==ue.MPTYPE_JUMP&&this.MP_YSpeed<0||!1==this.hoPtr.hoAdRunHeader.colMask_TestObject_IXY(this.hoPtr,this.hoPtr.roc.rcImage,this.hoPtr.roc.rcAngle,this.hoPtr.roc.rcScaleX,this.hoPtr.roc.rcScaleY,this.hoPtr.hoX,this.hoPtr.hoY,this.MP_HTFOOT,nR.CM_TEST_PLATFORM))||this.hoPtr.hoAdRunHeader.rhEvtProg.handle_Event(this.hoPtr,-851968|65535&this.hoPtr.hoType)}}),ui.RaceMask=[4294967288,4294967292,4294967294,4294967295],ui.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t,this.MR_Speed=0,this.hoPtr.roc.rcSpeed=0,this.MR_Bounce=0,this.MR_LastBounce=-1,this.hoPtr.roc.rcPlayer=e.mvControl,this.rmAcc=e.mrAcc,this.rmAccValue=this.getAccelerator(e.mrAcc),this.rmDec=e.mrDec,this.rmDecValue=this.getAccelerator(e.mrDec),this.hoPtr.roc.rcMaxSpeed=e.mrSpeed,this.hoPtr.roc.rcMinSpeed=0,this.MR_BounceMu=e.mrBounceMult,this.MR_OkReverse=e.mrOkReverse,this.hoPtr.rom.rmReverse=0,this.rmOpt=e.mvOpt,this.MR_OldJoy=0,this.MR_RotMask=ui.RaceMask[e.mrAngles],this.MR_RotSpeed=e.mrRot,this.MR_RotCpt=0,this.MR_RotPos=this.hoPtr.hoAdRunHeader.getDir(this.hoPtr),this.hoPtr.hoCalculX=0,this.hoPtr.hoCalculY=0,this.moveAtStart(e),this.hoPtr.roc.rcChanged=!0},move:function(){let t,e,s,r,h,n,a;if(this.hoPtr.hoAdRunHeader.rhVBLObjet=1,0==this.MR_Bounce){if(this.hoPtr.rom.rmBouncing=!1,t=15&this.hoPtr.hoAdRunHeader.rhPlayer[this.hoPtr.roc.rcPlayer-1],e=0,(8&t)!=0&&(e=-1),(4&t)!=0&&(e=1),0!=e){for(a=this.MR_RotSpeed,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(a*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),this.MR_RotCpt+=a;this.MR_RotCpt>100;)this.MR_RotCpt-=100,this.MR_RotPos+=e,this.MR_RotPos&=31,this.hoPtr.roc.rcDir=this.MR_RotPos&this.MR_RotMask;this.hoPtr.roc.rcChanged=!0}for(s=0,0!=this.hoPtr.rom.rmReverse?((1&t)!=0&&(s=1),(2&t)!=0&&(s=2)):((1&t)!=0&&(s=2),(2&t)!=0&&(s=1)),r=this.MR_Speed;;){if((1&s)!=0){if(0==this.MR_Speed){if(0==this.MR_OkReverse||(3&this.MR_OldJoy)!=0)break;this.hoPtr.rom.rmReverse^=1,a=this.rmAccValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(a*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),r+=a,(n=r>>8)>this.hoPtr.roc.rcMaxSpeed&&(r=this.hoPtr.roc.rcMaxSpeed<<8,this.MR_Speed=r),this.MR_Speed=r;break}a=this.rmDecValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(a*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),(r-=a)<0&&(r=0),this.MR_Speed=r}else(2&s)!=0&&(a=this.rmAccValue,(this.hoPtr.hoAdRunHeader.rhFrame.leFlags&nR.LEF_TIMEDMVTS)!=0&&(a*=this.hoPtr.hoAdRunHeader.rh4MvtTimerCoef),r+=a,(n=r>>8)>this.hoPtr.roc.rcMaxSpeed&&(r=this.hoPtr.roc.rcMaxSpeed<<8,this.MR_Speed=r),this.MR_Speed=r);break}if(this.MR_OldJoy=t,this.hoPtr.roc.rcSpeed=this.MR_Speed>>8,this.hoPtr.roc.rcAnim=nY.ANIMID_WALK,null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),h=this.hoPtr.hoAdRunHeader.getDir(this.hoPtr),0!=this.hoPtr.rom.rmReverse&&(h+=16,h&=31),!1==this.newMake_Move(this.hoPtr.roc.rcSpeed,h))return}for(;0!=this.MR_Bounce&&0!=this.hoPtr.hoAdRunHeader.rhVBLObjet;){if(r=this.MR_Speed,(r-=this.rmDecValue)<=0){this.MR_Speed=0,this.MR_Bounce=0;break}if(this.MR_Speed=r,r>>=8,h=this.hoPtr.hoAdRunHeader.getDir(this.hoPtr),0!=this.MR_Bounce&&(h+=16,h&=31),!1==this.newMake_Move(r,h))break}},reverse:function(){},stop:function(){this.MR_Bounce=0,this.MR_Speed=0,this.hoPtr.rom.rmReverse=0,this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount&&(this.mv_Approach((this.rmOpt&lq.MVTOPT_8DIR_STICK)!=0),this.hoPtr.rom.rmMoveFlag=!0)},start:function(){this.rmStopSpeed=0,this.hoPtr.rom.rmMoveFlag=!0},bounce:function(){if(this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount&&this.mv_Approach((this.rmOpt&lq.MVTOPT_8DIR_STICK)!=0),this.hoPtr.hoAdRunHeader.rhLoopCount!=this.MR_LastBounce){if(this.MR_Bounce=this.hoPtr.rom.rmReverse,this.hoPtr.rom.rmReverse=0,this.MR_Bounce++,this.MR_Bounce>=16){this.stop();return}this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.rom.rmBouncing=!0}},setSpeed:function(t){t<0&&(t=0),t>250&&(t=250),t>this.hoPtr.roc.rcMaxSpeed&&(t=this.hoPtr.roc.rcMaxSpeed),t<<=8,this.MR_Speed=t,this.hoPtr.rom.rmMoveFlag=!0},setMaxSpeed:function(t){t<0&&(t=0),t>250&&(t=250),this.hoPtr.roc.rcMaxSpeed=t,t<<=8,this.MR_Speed>t&&(this.MR_Speed=t),this.hoPtr.rom.rmMoveFlag=!0},setRotSpeed:function(t){this.MR_RotSpeed=t},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0)},setDir:function(t){this.MR_RotPos=t,this.hoPtr.roc.rcDir=t&this.MR_RotMask}}),us.prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t,this.hoPtr.roc.rcSpeed=0,this.hoPtr.roc.rcCheckCollides=!0,this.hoPtr.roc.rcChanged=!0},move:function(){null!=this.hoPtr.roa&&this.hoPtr.roa.animate(),this.hoPtr.roc.rcCheckCollides&&(this.hoPtr.roc.rcCheckCollides=!1,this.hoPtr.hoAdRunHeader.newHandle_Collisions(this.hoPtr))},setXPosition:function(t){this.hoPtr.hoX!=t&&(this.hoPtr.hoX=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0),this.hoPtr.roc.rcCheckCollides=!0},setYPosition:function(t){this.hoPtr.hoY!=t&&(this.hoPtr.hoY=t,this.hoPtr.rom.rmMoveFlag=!0,this.hoPtr.roc.rcChanged=!0),this.hoPtr.roc.rcCheckCollides=!0},setDir:function(t){},reverse:function(t){},stop:function(){},start:function(){},bounce:function(){},setSpeed:function(t){},setMaxSpeed:function(t){}}),(function t(e){this.movement=e,this.callParam=0}).prototype=h.extend(new lq,{init:function(t,e){this.hoPtr=t;let s=t.hoAdRunHeader.rhApp.file.createFromFile(e.data);this.movement.initialize(s),this.hoPtr.roc.rcCheckCollides=!0,this.hoPtr.roc.rcChanged=!0},kill:function(){this.movement.kill()},move:function(){this.movement.move()&&(this.hoPtr.roc.rcChanged=!0)},stop:function(){this.movement.stop(this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount)},start:function(){this.movement.start()},bounce:function(){this.movement.bounce(this.rmCollisionCount==this.hoPtr.hoAdRunHeader.rh3CollisionCount)},setSpeed:function(t){this.movement.setSpeed(t)},setMaxSpeed:function(t){this.movement.setMaxSpeed(t)},reverse:function(){this.movement.reverse()},setXPosition:function(t){this.movement.setXPosition(t),this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0},setYPosition:function(t){this.movement.setYPosition(t),this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0},setDir:function(t){this.movement.setDir(t),this.hoPtr.roc.rcChanged=!0,this.hoPtr.roc.rcCheckCollides=!0},callMovement:function(t,e){return this.callParam=e,this.movement.actionEntry(t)}}),(function t(){this.ho=null,this.rh=null}).prototype={init:function(t){this.ho=t,this.rh=this.ho.hoAdRunHeader},initialize:function(t){},kill:function(){},move:function(){return!1},setPosition:function(t,e){},setXPosition:function(t){},setYPosition:function(t){},stop:function(t){},bounce:function(t){},reverse:function(){},start:function(){},setSpeed:function(t){},setMaxSpeed:function(t){},setDir:function(t){},setAcc:function(t){},setDec:function(t){},setRotSpeed:function(t){},set8Dirs:function(t){},setGravity:function(t){},extension:function(t,e){return 0},actionEntry:function(t){return 0},getSpeed:function(){return 0},getAcceleration:function(){return 0},getDeceleration:function(){return 0},getGravity:function(){return 0},getDir:function(){return this.ho.roc.rcDir},dirAtStart:function(t){return this.ho.rom.dirAtStart(this.ho,t,32)},animations:function(t){this.ho.roc.rcAnim=t,null!=this.ho.roa&&this.ho.roa.animate()},collisions:function(){this.ho.hoAdRunHeader.rh3CollisionCount++,this.ho.rom.rmMovement.rmCollisionCount=this.ho.hoAdRunHeader.rh3CollisionCount,this.ho.hoAdRunHeader.newHandle_Collisions(this.ho)},approachObject:function(t,e,s,r,h,n,a){t-=this.ho.hoAdRunHeader.rhWindowX,e-=this.ho.hoAdRunHeader.rhWindowY,s-=this.ho.hoAdRunHeader.rhWindowX,r-=this.ho.hoAdRunHeader.rhWindowY;let l=this.ho.rom.rmMovement.mpApproachSprite(t,e,s,r,h,n,a);return a.x+=this.ho.hoAdRunHeader.rhWindowX,a.y+=this.ho.hoAdRunHeader.rhWindowY,l},moveIt:function(){return this.ho.rom.rmMovement.newMake_Move(this.ho.roc.rcSpeed,this.ho.hoAdRunHeader.getDir(this.ho))},testPosition:function(t,e,s,r,h){return this.ho.rom.rmMovement.tst_SpritePosition(t,e,s,r,h)},getJoystick:function(t){return this.ho.hoAdRunHeader.rhPlayer[t]},colMaskTestRect:function(t,e,s,r,h,n){return!this.ho.hoAdRunHeader.colMask_Test_Rect(t,e,s,r,h,n)},colMaskTestPoint:function(t,e,s,r){return!this.ho.hoAdRunHeader.colMask_Test_XY(t,e,s,r)},getParamDouble:function(){return this.ho.rom.rmMovement.callParam},getParam:function(){return this.ho.rom.rmMovement.callParam}},ur.EF_GOESINPLAYFIELD=1,ur.EF_GOESOUTPLAYFIELD=2,ur.EF_WRAP=4,ur.prototype={init:function(t,e,s,r,h){this.rmObject=e,null!=this.rmMovement&&this.rmMovement.kill(),null!=r&&(e.roc.rcDir=r.cobDir),this.rmWrapping=e.hoOiList.oilWrap;let n=null;if(e.roc.rcMovementType=-1,null!=s.ocMovements&&t<s.ocMovements.nMovements){switch(n=s.ocMovements.moveList[t],this.rmMvtNum=t,-1==h&&(h=n.mvType),e.roc.rcMovementType=h,h){case 0:this.rmMovement=new us;break;case 1:this.rmMovement=new l9;break;case 2:this.rmMovement=new ui;break;case 3:this.rmMovement=new lZ;break;case 4:this.rmMovement=new lz;break;case 5:this.rmMovement=new ut;break;case 9:this.rmMovement=new ue;break;case 14:this.rmMovement=this.loadMvtExtension(e,n),null==this.rmMovement&&(this.rmMovement=new us)}e.roc.rcDir=this.dirAtStart(e,n.mvDirAtStart,e.roc.rcDir),this.rmMovement.init(e,n)}-1==e.roc.rcMovementType&&(e.roc.rcMovementType=0,this.rmMovement=new us,this.rmMovement.init(e,null),e.roc.rcDir=0)},loadMvtExtension:function(t,e){return e.moduleName,null},initSimple:function(t,e,s){switch(this.rmObject=t,null!=this.rmMovement&&this.rmMovement.kill(),t.roc.rcMovementType=e,e){case 11:this.rmMovement=new lQ;break;case 13:this.rmMovement=new lJ}this.rmMovement.hoPtr=t,!1==s&&this.rmMovement.init(t,null)},kill:function(t){this.rmMovement.kill()},move:function(){this.rmMovement.move()},nextMovement:function(t){let e=t.hoCommon;if(null!=e.ocMovements&&this.rmMvtNum+1<e.ocMovements.nMovements){this.init(this.rmMvtNum+1,t,e,null,-1);let s=t.hoAdRunHeader.GetMBase(t);s&&s.CreateBody()}},previousMovement:function(t){let e=t.hoCommon;if(null!=e.ocMovements&&this.rmMvtNum-1>=0){this.init(this.rmMvtNum-1,t,e,null,-1);let s=t.hoAdRunHeader.GetMBase(t);s&&s.CreateBody()}},selectMovement:function(t,e){let s=t.hoCommon;if(null!=s.ocMovements&&e>=0&&e<s.ocMovements.nMovements){this.init(e,t,s,null,-1);let r=t.hoAdRunHeader.GetMBase(t);r&&r.CreateBody()}},dirAtStart:function(t,e,s){if(s<0||s>=32){let r,h,n=0,a=e;for(h=0;h<32;h++)r=a,a>>=1,(1&r)!=0&&n++;if(0==n)s=0;else for(s=0,n=t.hoAdRunHeader.random(n),a=e;r=a,a>>=1,!((1&r)!=0&&--n<0);s++);}return s}},uh.INI_FULLPATH=2,uh.INI_FULLPATHINI_APPFOLDER=4,uh.INI_FULLPATHINI_UTF8=8,uh.prototype=h.extend(new l4,{getNumberOfConditions:function(){return 0},createRunObject:function(t,e,s){this.iniFlags=t.readAShort(),this.iniName=h.parseName(t.readAString()),0==this.iniName.length&&(this.iniName="Ini.ini");let r=0;return this.iniFlags&uh.INI_FULLPATHINI_UTF8&&(r|=O.INIFLAG_UTF8),this.ini=new O(this.rh.rhApp,r),this.iniCurrentGroup="Group",this.iniCurrentItem="Item",this.changeCounter=0,!1},handleRunObject:function(){return this.changeCounter>0&&(this.changeCounter--,0==this.changeCounter&&this.ini.saveIni()),0},destroyRunObject:function(t){this.ini.saveIni()},action:function(t,e){switch(t){case 0:this.SetCurrentGroup(e);break;case 1:this.SetCurrentItem(e);break;case 2:this.SetValue(e);break;case 3:this.SavePosition(e);break;case 4:this.LoadPosition(e);break;case 5:this.SetString(e);break;case 6:this.SetCurrentFile(e);break;case 7:this.SetValueItem(e);break;case 8:this.SetValueGroupItem(e);break;case 9:this.SetStringItem(e);break;case 10:this.SetStringGroupItem(e);break;case 11:this.DeleteItem(e);break;case 12:this.DeleteGroupItem(e);break;case 13:this.DeleteGroup(e)}},SetCurrentGroup:function(t){this.iniCurrentGroup=t.getParamExpString(this.rh,0)},SetCurrentItem:function(t){this.iniCurrentItem=t.getParamExpString(this.rh,0)},SetValue:function(t){let e=t.getParamExpression(this.rh,0).toString();this.ini.writePrivateProfileString(this.iniCurrentGroup,this.iniCurrentItem,e,this.iniName),this.changeCounter=10},SavePosition:function(t){let e=t.getParamObject(this.rh,0),s=e.hoX.toString()+","+e.hoY.toString(),r="pos."+e.hoOiList.oilName;this.ini.writePrivateProfileString(this.iniCurrentGroup,r,s,this.iniName),this.changeCounter=10},LoadPosition:function(t){let e=t.getParamObject(this.rh,0),s="pos."+e.hoOiList.oilName,r=this.ini.getPrivateProfileString(this.iniCurrentGroup,s,"X",this.iniName);if("X"!=r){let h=r.indexOf(","),n=r.substring(0,h),a=r.substring(h+1);e.hoX=parseInt(n,10),isNaN(e.hoX)&&(e.hoX=0),e.hoY=parseInt(a,10),isNaN(e.hoY)&&(e.hoY=0),e.roc.rcChanged=!0,e.roc.rcCheckCollides=!0}},SetString:function(t){let e=t.getParamExpString(this.rh,0);this.ini.writePrivateProfileString(this.iniCurrentGroup,this.iniCurrentItem,e,this.iniName),this.changeCounter=10},SetCurrentFile:function(t){this.iniName=h.parseName(t.getParamExpString(this.rh,0))},SetValueItem:function(t){let e=t.getParamExpString(this.rh,0),s=t.getParamExpression(this.rh,1).toString();this.ini.writePrivateProfileString(this.iniCurrentGroup,e,s,this.iniName),this.changeCounter=10},SetValueGroupItem:function(t){let e=t.getParamExpString(this.rh,0),s=t.getParamExpString(this.rh,1),r=t.getParamExpression(this.rh,2).toString();this.ini.writePrivateProfileString(e,s,r,this.iniName),this.changeCounter=10},SetStringItem:function(t){let e=t.getParamExpString(this.rh,0),s=t.getParamExpString(this.rh,1);this.ini.writePrivateProfileString(this.iniCurrentGroup,e,s,this.iniName),this.changeCounter=10},SetStringGroupItem:function(t){let e=t.getParamExpString(this.rh,0),s=t.getParamExpString(this.rh,1),r=t.getParamExpString(this.rh,2);this.ini.writePrivateProfileString(e,s,r,this.iniName),this.changeCounter=10},DeleteItem:function(t){this.ini.deleteItem(this.iniCurrentGroup,t.getParamExpString(this.rh,0),this.iniName),this.changeCounter=10},DeleteGroupItem:function(t){this.ini.deleteItem(t.getParamExpString(this.rh,0),t.getParamExpString(this.rh,1),this.iniName),this.changeCounter=10},DeleteGroup:function(t){this.ini.deleteGroup(t.getParamExpString(this.rh,0),this.iniName),this.changeCounter=10},expression:function(t){switch(t){case 0:return this.GetValue();case 1:return this.GetString();case 2:return this.GetValueItem();case 3:return this.GetValueGroupItem();case 4:return this.GetStringItem();case 5:return this.GetStringGroupItem()}return null},GetValue:function(){let t=this.ini.getPrivateProfileString(this.iniCurrentGroup,this.iniCurrentItem,"",this.iniName),e=0;return isNaN(e=parseInt(t,10))&&(e=0),e},GetString:function(){return this.ini.getPrivateProfileString(this.iniCurrentGroup,this.iniCurrentItem,"",this.iniName)},GetValueItem:function(){let t=this.ho.getExpParam(),e=this.ini.getPrivateProfileString(this.iniCurrentGroup,t,"",this.iniName),s=parseInt(e,10);return isNaN(s)&&(s=0),s},GetValueGroupItem:function(){let t=this.ho.getExpParam(),e=this.ho.getExpParam(),s=this.ini.getPrivateProfileString(t,e,"",this.iniName),r=parseInt(s,10);return isNaN(r)&&(r=0),r},GetStringItem:function(){let t=this.ho.getExpParam();return this.ini.getPrivateProfileString(this.iniCurrentGroup,t,"",this.iniName)},GetStringGroupItem:function(){let t=this.ho.getExpParam(),e=this.ho.getExpParam();return this.ini.getPrivateProfileString(t,e,"",this.iniName)}}),t(e,s)};